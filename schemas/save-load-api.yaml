openapi: 3.0.3
info:
  title: Save-Load Service API
  version: 1.0.0
  description: |
    Generic save/load system for game state persistence.
    Supports polymorphic ownership, versioned saves, and schema migration.

servers:
- url: http://localhost:5012

tags:
- name: Slots
  description: Save slot management
- name: Saves
  description: Save/load operations
- name: Versions
  description: Version management
- name: Query
  description: Search and filtering
- name: Migration
  description: Schema migration operations

paths:
  # ═══════════════════════════════════════════════════════════════════════════
  # SLOT MANAGEMENT
  # ═══════════════════════════════════════════════════════════════════════════

  /save-load/slot/create:
    post:
      tags: [Slots]
      operationId: CreateSlot
      summary: Create or configure a save slot
      description: |
        Creates a new save slot or updates configuration of an existing slot.
        Slots are auto-created on first save, but pre-creation allows setting
        custom configuration (max versions, retention policy, etc.).
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSlotRequest'
      responses:
        '200':
          description: Slot created or updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SlotResponse'
        '400':
          description: Invalid request
        '409':
          description: Slot already exists with different owner

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateSlotRequest\"\
        ,\n    \"$defs\": {\n        \"CreateSlotRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"\
        slotName\",\n                \"category\"\n            ],\n            \"properties\": {\n                \"gameId\"\
        : {\n                    \"type\": \"string\",\n                    \"minLength\": 1,\n                    \"maxLength\"\
        : 32,\n                    \"pattern\": \"^[a-z][a-z0-9-]*$\",\n                    \"description\": \"Game identifier
        for namespace isolation (e.g., \\\"arcadia\\\", \\\"fantasia\\\")\"\n                },\n                \"ownerId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"ID of the owning entity\"\n                },\n                \"ownerType\": {\n               \
        \     \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"\
        type\": \"string\",\n                    \"minLength\": 1,\n                    \"maxLength\": 64,\n             \
        \       \"pattern\": \"^[a-z0-9]([a-z0-9-]*[a-z0-9])?$\",\n                    \"description\": \"Slot name (lowercase
        alphanumeric with hyphens, single char like \\\"q\\\" allowed)\"\n                },\n                \"category\"\
        : {\n                    \"$ref\": \"#/$defs/SaveCategory\"\n                },\n                \"maxVersions\":
        {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n                    \"maximum\"\
        : 100,\n                    \"description\": \"Override default max versions for this category\"\n               \
        \ },\n                \"retentionDays\": {\n                    \"type\": \"integer\",\n                    \"minimum\"\
        : 1,\n                    \"description\": \"Days to retain versions (null = indefinite)\"\n                },\n \
        \               \"compressionType\": {\n                    \"$ref\": \"#/$defs/CompressionType\"\n              \
        \  },\n                \"tags\": {\n                    \"type\": \"array\",\n                    \"items\": {\n \
        \                       \"type\": \"string\",\n                        \"maxLength\": 32\n                    },\n\
        \                    \"maxItems\": 20,\n                    \"description\": \"Searchable tags for slot categorization
        (e.g., \\\"boss-fight\\\", \\\"chapter-3\\\")\"\n                },\n                \"metadata\": {\n           \
        \         \"type\": \"object\",\n                    \"additionalProperties\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"description\": \"Custom key-value metadata for the slot\"\
        \n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n    \
        \        \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n\
        \                \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\
        \n        },\n        \"SaveCategory\": {\n            \"type\": \"string\",\n            \"enum\": [\n          \
        \      \"QUICK_SAVE\",\n                \"AUTO_SAVE\",\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\"\
        ,\n                \"STATE_SNAPSHOT\"\n            ],\n            \"description\": \"Category of save with predefined
        behaviors.\\nQUICK_SAVE: Single-slot fast save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered
        periodic saves (max 5 versions, rolling).\\nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\
        nCHECKPOINT: Progress markers (max 20 versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max
        3 versions, rolling).\\n\"\n        },\n        \"CompressionType\": {\n            \"type\": \"string\",\n      \
        \      \"enum\": [\n                \"NONE\",\n                \"GZIP\",\n                \"BROTLI\"\n           \
        \ ],\n            \"description\": \"Compression algorithm used for save data\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SlotResponse\"\
        ,\n    \"$defs\": {\n        \"SlotResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\
        ,\n                \"category\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n \
        \               \"slotId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Unique slot identifier\"\n                },\n                \"ownerId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"ID of the owning entity\"\n                },\n                \"ownerType\": {\n               \
        \     \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"\
        type\": \"string\",\n                    \"description\": \"Slot name\"\n                },\n                \"category\"\
        : {\n                    \"$ref\": \"#/$defs/SaveCategory\"\n                },\n                \"maxVersions\":
        {\n                    \"type\": \"integer\",\n                    \"description\": \"Maximum versions to retain\"\
        \n                },\n                \"retentionDays\": {\n                    \"type\": \"integer\",\n         \
        \           \"nullable\": true,\n                    \"description\": \"Days to retain versions (null = indefinite)\"\
        \n                },\n                \"compressionType\": {\n                    \"$ref\": \"#/$defs/CompressionType\"\
        \n                },\n                \"versionCount\": {\n                    \"type\": \"integer\",\n          \
        \          \"description\": \"Current number of versions in slot\"\n                },\n                \"latestVersion\"\
        : {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Latest version number (null if empty)\"\n                },\n                \"totalSizeBytes\": {\n         \
        \           \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\"\
        : \"Total storage used by all versions\"\n                },\n                \"createdAt\": {\n                 \
        \   \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"\
        Slot creation timestamp\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Last modification
        timestamp\"\n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n    \
        \                \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n\
        \                    \"description\": \"Custom key-value metadata\"\n                }\n            }\n        },\n\
        \        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\"\
        ,\n                \"CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n     \
        \       \"description\": \"Type of entity that owns this save slot\"\n        },\n        \"SaveCategory\": {\n  \
        \          \"type\": \"string\",\n            \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\"\
        ,\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n       \
        \     ],\n            \"description\": \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast
        save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\
        nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20
        versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max 3 versions, rolling).\\n\"\n        },\n\
        \        \"CompressionType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"NONE\"\
        ,\n                \"GZIP\",\n                \"BROTLI\"\n            ],\n            \"description\": \"Compression
        algorithm used for save data\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Create or configure a save slot\",\n    \"description\": \"Creates a new
        save slot or updates configuration of an existing slot.\\nSlots are auto-created on first save, but pre-creation allows
        setting\\ncustom configuration (max versions, retention policy, etc.).\\n\",\n    \"tags\": [\n        \"Slots\"\n\
        \    ],\n    \"deprecated\": false,\n    \"operationId\": \"CreateSlot\"\n}"
  /save-load/slot/get:
    post:
      tags: [Slots]
      operationId: GetSlot
      summary: Get slot metadata
      description: Returns slot configuration and version summary.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetSlotRequest'
      responses:
        '200':
          description: Slot found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SlotResponse'
        '404':
          description: Slot not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetSlotRequest\"\
        ,\n    \"$defs\": {\n        \"GetSlotRequest\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\
        \n            ],\n            \"properties\": {\n                \"gameId\": {\n                    \"type\": \"string\"\
        ,\n                    \"minLength\": 1,\n                    \"maxLength\": 32,\n                    \"pattern\"\
        : \"^[a-z][a-z0-9-]*$\",\n                    \"description\": \"Game identifier for namespace isolation\"\n     \
        \           },\n                \"ownerId\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uuid\",\n                    \"description\": \"ID of the owning entity\"\n                },\n      \
        \          \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n           \
        \     \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Slot name\"\
        \n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n    \
        \        \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n\
        \                \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\
        \n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SlotResponse\"\
        ,\n    \"$defs\": {\n        \"SlotResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\
        ,\n                \"category\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n \
        \               \"slotId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Unique slot identifier\"\n                },\n                \"ownerId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"ID of the owning entity\"\n                },\n                \"ownerType\": {\n               \
        \     \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"\
        type\": \"string\",\n                    \"description\": \"Slot name\"\n                },\n                \"category\"\
        : {\n                    \"$ref\": \"#/$defs/SaveCategory\"\n                },\n                \"maxVersions\":
        {\n                    \"type\": \"integer\",\n                    \"description\": \"Maximum versions to retain\"\
        \n                },\n                \"retentionDays\": {\n                    \"type\": \"integer\",\n         \
        \           \"nullable\": true,\n                    \"description\": \"Days to retain versions (null = indefinite)\"\
        \n                },\n                \"compressionType\": {\n                    \"$ref\": \"#/$defs/CompressionType\"\
        \n                },\n                \"versionCount\": {\n                    \"type\": \"integer\",\n          \
        \          \"description\": \"Current number of versions in slot\"\n                },\n                \"latestVersion\"\
        : {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Latest version number (null if empty)\"\n                },\n                \"totalSizeBytes\": {\n         \
        \           \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\"\
        : \"Total storage used by all versions\"\n                },\n                \"createdAt\": {\n                 \
        \   \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"\
        Slot creation timestamp\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Last modification
        timestamp\"\n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n    \
        \                \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n\
        \                    \"description\": \"Custom key-value metadata\"\n                }\n            }\n        },\n\
        \        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\"\
        ,\n                \"CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n     \
        \       \"description\": \"Type of entity that owns this save slot\"\n        },\n        \"SaveCategory\": {\n  \
        \          \"type\": \"string\",\n            \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\"\
        ,\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n       \
        \     ],\n            \"description\": \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast
        save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\
        nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20
        versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max 3 versions, rolling).\\n\"\n        },\n\
        \        \"CompressionType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"NONE\"\
        ,\n                \"GZIP\",\n                \"BROTLI\"\n            ],\n            \"description\": \"Compression
        algorithm used for save data\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get slot metadata\",\n    \"description\": \"Returns slot configuration
        and version summary.\",\n    \"tags\": [\n        \"Slots\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"GetSlot\"\n}"
  /save-load/slot/list:
    post:
      tags: [Slots]
      operationId: ListSlots
      summary: List slots for owner
      description: Returns all slots owned by the specified entity.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListSlotsRequest'
      responses:
        '200':
          description: Slots listed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListSlotsResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListSlotsRequest\"\
        ,\n    \"$defs\": {\n        \"ListSlotsRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\"\n            ],\n  \
        \          \"properties\": {\n                \"gameId\": {\n                    \"type\": \"string\",\n         \
        \           \"minLength\": 1,\n                    \"maxLength\": 32,\n                    \"pattern\": \"^[a-z][a-z0-9-]*$\"\
        ,\n                    \"description\": \"Game identifier for namespace isolation\"\n                },\n        \
        \        \"ownerId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n  \
        \                  \"description\": \"ID of the owning entity\"\n                },\n                \"ownerType\"\
        : {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"category\": {\n  \
        \                  \"$ref\": \"#/$defs/SaveCategory\"\n                },\n                \"includeVersionCount\"\
        : {\n                    \"type\": \"boolean\",\n                    \"default\": true,\n                    \"description\"\
        : \"Include version count in response\"\n                }\n            }\n        },\n        \"OwnerType\": {\n\
        \            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\"\
        ,\n                \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\": \"Type of
        entity that owns this save slot\"\n        },\n        \"SaveCategory\": {\n            \"type\": \"string\",\n  \
        \          \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\",\n                \"MANUAL_SAVE\"\
        ,\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n            ],\n            \"description\"\
        : \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast save, overwritten frequently (max 1
        version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\nMANUAL_SAVE: User-initiated named
        saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20 versions, rolling).\\nSTATE_SNAPSHOT:
        Full state captures for debugging (max 3 versions, rolling).\\n\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListSlotsResponse\"\
        ,\n    \"$defs\": {\n        \"ListSlotsResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"slots\"\n            ],\n            \"properties\": {\n                \"slots\": {\n    \
        \                \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/SlotResponse\"\
        \n                    },\n                    \"description\": \"List of slots\"\n                },\n           \
        \     \"totalCount\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Total
        number of slots for owner\"\n                }\n            }\n        },\n        \"SlotResponse\": {\n         \
        \   \"type\": \"object\",\n            \"required\": [\n                \"slotId\",\n                \"ownerId\",\n\
        \                \"ownerType\",\n                \"slotName\",\n                \"category\",\n                \"\
        createdAt\"\n            ],\n            \"properties\": {\n                \"slotId\": {\n                    \"\
        type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Unique slot
        identifier\"\n                },\n                \"ownerId\": {\n                    \"type\": \"string\",\n    \
        \                \"format\": \"uuid\",\n                    \"description\": \"ID of the owning entity\"\n       \
        \         },\n                \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n            \
        \    },\n                \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Slot name\"\n                },\n                \"category\": {\n                    \"$ref\": \"#/$defs/SaveCategory\"\
        \n                },\n                \"maxVersions\": {\n                    \"type\": \"integer\",\n           \
        \         \"description\": \"Maximum versions to retain\"\n                },\n                \"retentionDays\":
        {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Days to retain versions (null = indefinite)\"\n                },\n                \"compressionType\": {\n  \
        \                  \"$ref\": \"#/$defs/CompressionType\"\n                },\n                \"versionCount\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Current number of versions in
        slot\"\n                },\n                \"latestVersion\": {\n                    \"type\": \"integer\",\n   \
        \                 \"nullable\": true,\n                    \"description\": \"Latest version number (null if empty)\"\
        \n                },\n                \"totalSizeBytes\": {\n                    \"type\": \"integer\",\n        \
        \            \"format\": \"int64\",\n                    \"description\": \"Total storage used by all versions\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Slot creation timestamp\"\n             \
        \   },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"description\": \"Last modification timestamp\"\n                },\n     \
        \           \"metadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"description\": \"\
        Custom key-value metadata\"\n                }\n            }\n        },\n        \"OwnerType\": {\n            \"\
        type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n     \
        \           \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\": \"Type of entity
        that owns this save slot\"\n        },\n        \"SaveCategory\": {\n            \"type\": \"string\",\n         \
        \   \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\",\n                \"MANUAL_SAVE\"\
        ,\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n            ],\n            \"description\"\
        : \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast save, overwritten frequently (max 1
        version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\nMANUAL_SAVE: User-initiated named
        saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20 versions, rolling).\\nSTATE_SNAPSHOT:
        Full state captures for debugging (max 3 versions, rolling).\\n\"\n        },\n        \"CompressionType\": {\n  \
        \          \"type\": \"string\",\n            \"enum\": [\n                \"NONE\",\n                \"GZIP\",\n\
        \                \"BROTLI\"\n            ],\n            \"description\": \"Compression algorithm used for save data\"\
        \n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List slots for owner\",\n    \"description\": \"Returns all slots owned
        by the specified entity.\",\n    \"tags\": [\n        \"Slots\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"ListSlots\"\n}"
  /save-load/slot/delete:
    post:
      tags: [Slots]
      operationId: DeleteSlot
      summary: Delete slot and all versions
      description: |
        Permanently deletes a slot and all save versions within it.
        This is irreversible. Requires owner access or admin role.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteSlotRequest'
      responses:
        '200':
          description: Slot deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteSlotResponse'
        '404':
          description: Slot not found
        '403':
          description: Not authorized to delete this slot

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteSlotRequest\"\
        ,\n    \"$defs\": {\n        \"DeleteSlotRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"\
        slotName\"\n            ],\n            \"properties\": {\n                \"gameId\": {\n                    \"type\"\
        : \"string\",\n                    \"minLength\": 1,\n                    \"maxLength\": 32,\n                   \
        \ \"pattern\": \"^[a-z][a-z0-9-]*$\",\n                    \"description\": \"Game identifier for namespace isolation\"\
        \n                },\n                \"ownerId\": {\n                    \"type\": \"string\",\n                \
        \    \"format\": \"uuid\",\n                    \"description\": \"ID of the owning entity\"\n                },\n\
        \                \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n     \
        \           \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Slot
        name\"\n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n\
        \            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\"\
        ,\n                \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\
        \n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteSlotResponse\"\
        ,\n    \"$defs\": {\n        \"DeleteSlotResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"deleted\",\n                \"versionsDeleted\",\n                \"bytesFreed\"\n        \
        \    ],\n            \"properties\": {\n                \"deleted\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether slot was deleted\"\n                },\n                \"versionsDeleted\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Number of versions deleted\"\
        \n                },\n                \"bytesFreed\": {\n                    \"type\": \"integer\",\n            \
        \        \"format\": \"int64\",\n                    \"description\": \"Storage freed in bytes\"\n               \
        \ }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Delete slot and all versions\",\n    \"description\": \"Permanently deletes
        a slot and all save versions within it.\\nThis is irreversible. Requires owner access or admin role.\\n\",\n    \"\
        tags\": [\n        \"Slots\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"DeleteSlot\"\n}"
  /save-load/slot/rename:
    post:
      tags: [Slots]
      operationId: RenameSlot
      summary: Rename a save slot
      description: |
        Renames an existing slot without affecting its versions or data.
        The new name must not already exist for this owner.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RenameSlotRequest'
      responses:
        '200':
          description: Slot renamed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SlotResponse'
        '404':
          description: Slot not found
        '409':
          description: Target name already exists

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RenameSlotRequest\"\
        ,\n    \"$defs\": {\n        \"RenameSlotRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"\
        slotName\",\n                \"newSlotName\"\n            ],\n            \"properties\": {\n                \"gameId\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Game identifier\"\n       \
        \         },\n                \"ownerId\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uuid\"\n                },\n                \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\
        \n                },\n                \"slotName\": {\n                    \"type\": \"string\",\n               \
        \     \"description\": \"Current slot name\"\n                },\n                \"newSlotName\": {\n           \
        \         \"type\": \"string\",\n                    \"minLength\": 1,\n                    \"maxLength\": 64,\n \
        \                   \"pattern\": \"^[a-z0-9]([a-z0-9-]*[a-z0-9])?$\",\n                    \"description\": \"New
        slot name\"\n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\"\
        ,\n                \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\
        \n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SlotResponse\"\
        ,\n    \"$defs\": {\n        \"SlotResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\
        ,\n                \"category\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n \
        \               \"slotId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Unique slot identifier\"\n                },\n                \"ownerId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"ID of the owning entity\"\n                },\n                \"ownerType\": {\n               \
        \     \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"\
        type\": \"string\",\n                    \"description\": \"Slot name\"\n                },\n                \"category\"\
        : {\n                    \"$ref\": \"#/$defs/SaveCategory\"\n                },\n                \"maxVersions\":
        {\n                    \"type\": \"integer\",\n                    \"description\": \"Maximum versions to retain\"\
        \n                },\n                \"retentionDays\": {\n                    \"type\": \"integer\",\n         \
        \           \"nullable\": true,\n                    \"description\": \"Days to retain versions (null = indefinite)\"\
        \n                },\n                \"compressionType\": {\n                    \"$ref\": \"#/$defs/CompressionType\"\
        \n                },\n                \"versionCount\": {\n                    \"type\": \"integer\",\n          \
        \          \"description\": \"Current number of versions in slot\"\n                },\n                \"latestVersion\"\
        : {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Latest version number (null if empty)\"\n                },\n                \"totalSizeBytes\": {\n         \
        \           \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\"\
        : \"Total storage used by all versions\"\n                },\n                \"createdAt\": {\n                 \
        \   \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"\
        Slot creation timestamp\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Last modification
        timestamp\"\n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n    \
        \                \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n\
        \                    \"description\": \"Custom key-value metadata\"\n                }\n            }\n        },\n\
        \        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\"\
        ,\n                \"CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n     \
        \       \"description\": \"Type of entity that owns this save slot\"\n        },\n        \"SaveCategory\": {\n  \
        \          \"type\": \"string\",\n            \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\"\
        ,\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n       \
        \     ],\n            \"description\": \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast
        save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\
        nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20
        versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max 3 versions, rolling).\\n\"\n        },\n\
        \        \"CompressionType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"NONE\"\
        ,\n                \"GZIP\",\n                \"BROTLI\"\n            ],\n            \"description\": \"Compression
        algorithm used for save data\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Rename a save slot\",\n    \"description\": \"Renames an existing slot
        without affecting its versions or data.\\nThe new name must not already exist for this owner.\\n\",\n    \"tags\"\
        : [\n        \"Slots\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"RenameSlot\"\n}"
  /save-load/slot/bulk-delete:
    post:
      tags: [Slots]
      operationId: BulkDeleteSlots
      summary: Delete multiple slots at once
      description: |
        Deletes multiple slots and all their versions in a single operation.
        Useful for cleanup operations or account deletion.
      x-permissions:
      - role: admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDeleteSlotsRequest'
      responses:
        '200':
          description: Slots deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkDeleteSlotsResponse'

  # ═══════════════════════════════════════════════════════════════════════════
  # SAVE/LOAD OPERATIONS
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkDeleteSlotsRequest\"\
        ,\n    \"$defs\": {\n        \"BulkDeleteSlotsRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"slotIds\"\n            ],\n            \"properties\": {\n   \
        \             \"gameId\": {\n                    \"type\": \"string\",\n                    \"description\": \"Game
        identifier\"\n                },\n                \"slotIds\": {\n                    \"type\": \"array\",\n     \
        \               \"items\": {\n                        \"type\": \"string\",\n                        \"format\": \"\
        uuid\"\n                    },\n                    \"description\": \"Slot IDs to delete\"\n                }\n \
        \           }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkDeleteSlotsResponse\"\
        ,\n    \"$defs\": {\n        \"BulkDeleteSlotsResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"deletedCount\",\n                \"bytesFreed\"\n            ],\n            \"properties\"\
        : {\n                \"deletedCount\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Number of slots deleted\"\n                },\n                \"bytesFreed\": {\n                    \"type\"\
        : \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Total storage freed\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Delete multiple slots at once\",\n    \"description\": \"Deletes multiple
        slots and all their versions in a single operation.\\nUseful for cleanup operations or account deletion.\\n\",\n \
        \   \"tags\": [\n        \"Slots\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"BulkDeleteSlots\"\n\
        }"
  /save-load/save:
    post:
      tags: [Saves]
      operationId: Save
      summary: Save data to slot
      description: |
        Creates a new version in the specified slot with the provided data.
        If the slot doesn't exist, it's auto-created with default configuration.

        Large saves (>1MB by default) are automatically compressed.
        Rolling version cleanup is applied based on slot configuration.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SaveRequest'
      responses:
        '200':
          description: Save successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SaveResponse'
        '400':
          description: Invalid request or data validation failed
        '413':
          description: Save data exceeds maximum size limit
        '403':
          description: Not authorized to save to this slot

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveRequest\"\
        ,\n    \"$defs\": {\n        \"SaveRequest\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\
        ,\n                \"data\"\n            ],\n            \"properties\": {\n                \"gameId\": {\n      \
        \              \"type\": \"string\",\n                    \"description\": \"Game identifier for namespace isolation\"\
        \n                },\n                \"ownerId\": {\n                    \"type\": \"string\",\n                \
        \    \"format\": \"uuid\",\n                    \"description\": \"ID of the owning entity\"\n                },\n\
        \                \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n     \
        \           \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Slot
        name (auto-created if doesn't exist)\"\n                },\n                \"category\": {\n                    \"\
        $ref\": \"#/$defs/SaveCategory\",\n                    \"description\": \"Category for auto-created slots (defaults
        to MANUAL_SAVE)\"\n                },\n                \"data\": {\n                    \"type\": \"string\",\n  \
        \                  \"format\": \"byte\",\n                    \"description\": \"Base64-encoded save data\"\n    \
        \            },\n                \"schemaVersion\": {\n                    \"type\": \"string\",\n               \
        \     \"description\": \"Schema version identifier for migration tracking\"\n                },\n                \"\
        displayName\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 128,\n           \
        \         \"description\": \"Human-readable name for this save\"\n                },\n                \"thumbnail\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"byte\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Optional preview image (JPEG/WebP). Max size configurable\\
        n(default 256KB). Used for save slot previews in game UI.\\n\"\n                },\n                \"deviceId\":
        {\n                    \"type\": \"string\",\n                    \"maxLength\": 64,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Optional device identifier for cloud save conflict detection.\\nWhen
        provided, saves are prefixed/tagged with device info,\\nenabling opt-in cross-device sync with collision awareness.\\\
        n\"\n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n            \
        \        \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n     \
        \               \"description\": \"Custom metadata (e.g., level, playtime, location)\"\n                },\n     \
        \           \"pinAsCheckpoint\": {\n                    \"type\": \"string\",\n                    \"maxLength\":
        64,\n                    \"description\": \"If provided, pin this version with checkpoint name\"\n               \
        \ }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\"\
        : [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n                \"\
        REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\n        },\n  \
        \      \"SaveCategory\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"QUICK_SAVE\"\
        ,\n                \"AUTO_SAVE\",\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\",\n           \
        \     \"STATE_SNAPSHOT\"\n            ],\n            \"description\": \"Category of save with predefined behaviors.\\
        nQUICK_SAVE: Single-slot fast save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered periodic
        saves (max 5 versions, rolling).\\nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT:
        Progress markers (max 20 versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max 3 versions,
        rolling).\\n\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveResponse\"\
        ,\n    \"$defs\": {\n        \"SaveResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"versionNumber\",\n                \"contentHash\",\n             \
        \   \"sizeBytes\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n               \
        \ \"slotId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n          \
        \          \"description\": \"Slot identifier\"\n                },\n                \"versionNumber\": {\n      \
        \              \"type\": \"integer\",\n                    \"description\": \"Assigned version number\"\n        \
        \        },\n                \"contentHash\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"SHA-256 hash of save data\"\n                },\n                \"sizeBytes\": {\n             \
        \       \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"\
        Size of save data in bytes\"\n                },\n                \"compressedSizeBytes\": {\n                   \
        \ \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Compressed
        size (if compression applied)\"\n                },\n                \"compressionRatio\": {\n                   \
        \ \"type\": \"number\",\n                    \"format\": \"double\",\n                    \"description\": \"Compression
        ratio (0-1)\"\n                },\n                \"pinned\": {\n                    \"type\": \"boolean\",\n   \
        \                 \"description\": \"Whether version was pinned\"\n                },\n                \"checkpointName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Checkpoint name if pinned\"\n                },\n                \"thumbnailUrl\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uri\",\n                    \"nullable\": true,\n               \
        \     \"description\": \"Pre-signed URL to retrieve thumbnail (if provided)\"\n                },\n              \
        \  \"conflictDetected\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if this save overwrote a version from a different device.\\nOnly relevant when deviceId is used for cloud sync.\\\
        n\"\n                },\n                \"conflictingDeviceId\": {\n                    \"type\": \"string\",\n \
        \                   \"nullable\": true,\n                    \"description\": \"Device ID of the overwritten version
        (if conflict)\"\n                },\n                \"conflictingVersion\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Version number that was overwritten
        (if conflict)\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"date-time\",\n                    \"description\": \"Save timestamp\"\n       \
        \         },\n                \"versionsCleanedUp\": {\n                    \"type\": \"integer\",\n             \
        \       \"description\": \"Number of old versions cleaned up by rolling policy\"\n                },\n           \
        \     \"uploadPending\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if async upload is enabled and data is queued for MinIO upload.\\nSave is immediately loadable from Redis cache, but
        not yet durable.\\n\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Save data to slot\",\n    \"description\": \"Creates a new version in the
        specified slot with the provided data.\\nIf the slot doesn't exist, it's auto-created with default configuration.\\
        n\\nLarge saves (>1MB by default) are automatically compressed.\\nRolling version cleanup is applied based on slot
        configuration.\\n\",\n    \"tags\": [\n        \"Saves\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"Save\"\n}"
  /save-load/load:
    post:
      tags: [Saves]
      operationId: Load
      summary: Load data from slot
      description: |
        Retrieves save data from the specified slot. By default, loads the
        latest version. Optionally specify a version number or checkpoint name.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoadRequest'
      responses:
        '200':
          description: Load successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoadResponse'
        '404':
          description: Slot or version not found
        '403':
          description: Not authorized to load from this slot

  # ═══════════════════════════════════════════════════════════════════════════
  # DELTA SAVES (Incremental)
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LoadRequest\"\
        ,\n    \"$defs\": {\n        \"LoadRequest\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\
        \n            ],\n            \"properties\": {\n                \"gameId\": {\n                    \"type\": \"string\"\
        ,\n                    \"minLength\": 1,\n                    \"maxLength\": 32,\n                    \"pattern\"\
        : \"^[a-z][a-z0-9-]*$\",\n                    \"description\": \"Game identifier for namespace isolation\"\n     \
        \           },\n                \"ownerId\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uuid\",\n                    \"description\": \"ID of the owning entity\"\n                },\n      \
        \          \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n           \
        \     \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Slot name\"\
        \n                },\n                \"versionNumber\": {\n                    \"type\": \"integer\",\n         \
        \           \"description\": \"Specific version to load (defaults to latest)\"\n                },\n             \
        \   \"checkpointName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Load
        by checkpoint name instead of version number\"\n                },\n                \"includeMetadata\": {\n     \
        \               \"type\": \"boolean\",\n                    \"default\": true,\n                    \"description\"\
        : \"Include version metadata in response\"\n                }\n            }\n        },\n        \"OwnerType\": {\n\
        \            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\"\
        ,\n                \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\": \"Type of
        entity that owns this save slot\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LoadResponse\"\
        ,\n    \"$defs\": {\n        \"LoadResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"versionNumber\",\n                \"data\",\n                \"contentHash\"\
        \n            ],\n            \"properties\": {\n                \"slotId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Slot identifier\"\n         \
        \       },\n                \"versionNumber\": {\n                    \"type\": \"integer\",\n                   \
        \ \"description\": \"Version number loaded\"\n                },\n                \"data\": {\n                  \
        \  \"type\": \"string\",\n                    \"format\": \"byte\",\n                    \"description\": \"Base64-encoded
        save data (decompressed)\"\n                },\n                \"contentHash\": {\n                    \"type\":
        \"string\",\n                    \"description\": \"SHA-256 hash for integrity verification\"\n                },\n\
        \                \"schemaVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Schema version of this save\"\n                },\n              \
        \  \"displayName\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n      \
        \              \"description\": \"Human-readable name\"\n                },\n                \"pinned\": {\n     \
        \               \"type\": \"boolean\",\n                    \"description\": \"Whether this version is pinned\"\n\
        \                },\n                \"checkpointName\": {\n                    \"type\": \"string\",\n          \
        \          \"nullable\": true,\n                    \"description\": \"Checkpoint name if pinned\"\n             \
        \   },\n                \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"description\": \"Save timestamp\"\n                },\n                \"\
        metadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\": {\n      \
        \                  \"type\": \"string\"\n                    },\n                    \"description\": \"Custom metadata\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Load data from slot\",\n    \"description\": \"Retrieves save data from
        the specified slot. By default, loads the\\nlatest version. Optionally specify a version number or checkpoint name.\\\
        n\",\n    \"tags\": [\n        \"Saves\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"Load\"\n}"
  /save-load/save-delta:
    post:
      tags: [Saves]
      operationId: SaveDelta
      summary: Save incremental changes from base version
      description: |
        Creates a new version by applying a delta (patch) to a base version.
        Significantly reduces storage for large saves with small incremental changes.

        Uses JSON Patch (RFC 6902) by default. The implementation is designed to
        allow swapping to binary diff algorithms (bsdiff/xdelta) if needed for
        specific use cases (e.g., binary game state).

        Delta versions store only the patch; full data is reconstructed on load.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SaveDeltaRequest'
      responses:
        '200':
          description: Delta save successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SaveDeltaResponse'
        '400':
          description: Invalid delta or base version not found
        '409':
          description: Base version has been deleted (cannot apply delta)
        '413':
          description: Delta too large (consider full save instead)

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveDeltaRequest\"\
        ,\n    \"$defs\": {\n        \"SaveDeltaRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"\
        slotName\",\n                \"baseVersion\",\n                \"delta\"\n            ],\n            \"properties\"\
        : {\n                \"gameId\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Game identifier\"\n                },\n                \"ownerId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\"\n                },\n                \"ownerType\": {\n              \
        \      \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"\
        type\": \"string\"\n                },\n                \"baseVersion\": {\n                    \"type\": \"integer\"\
        ,\n                    \"description\": \"Version number this delta is based on\"\n                },\n          \
        \      \"delta\": {\n                    \"type\": \"string\",\n                    \"format\": \"byte\",\n      \
        \              \"description\": \"Base64-encoded delta/patch data.\\nFor JSON_PATCH: Array of RFC 6902 operations\\
        nFor BSDIFF/XDELTA: Binary patch data\\n\"\n                },\n                \"algorithm\": {\n               \
        \     \"$ref\": \"#/$defs/DeltaAlgorithm\"\n                },\n                \"schemaVersion\": {\n           \
        \         \"type\": \"string\",\n                    \"nullable\": true\n                },\n                \"displayName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true\n                },\n     \
        \           \"deviceId\": {\n                    \"type\": \"string\",\n                    \"nullable\": true\n \
        \               },\n                \"metadata\": {\n                    \"type\": \"object\",\n                 \
        \   \"additionalProperties\": {\n                        \"type\": \"string\"\n                    }\n           \
        \     }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\"\
        : [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n                \"\
        REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\n        },\n  \
        \      \"DeltaAlgorithm\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"JSON_PATCH\"\
        ,\n                \"BSDIFF\",\n                \"XDELTA\"\n            ],\n            \"default\": \"JSON_PATCH\"\
        ,\n            \"description\": \"Algorithm used for delta computation.\\nJSON_PATCH: RFC 6902, best for structured
        JSON data\\nBSDIFF: Binary diff, good for general binary data\\nXDELTA: RFC 3284 VCDIFF, efficient for large binary
        files\\n\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveDeltaResponse\"\
        ,\n    \"$defs\": {\n        \"SaveDeltaResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"slotId\",\n                \"versionNumber\",\n                \"baseVersion\",\n         \
        \       \"deltaSizeBytes\",\n                \"estimatedFullSizeBytes\",\n                \"createdAt\"\n        \
        \    ],\n            \"properties\": {\n                \"slotId\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"uuid\"\n                },\n                \"versionNumber\": {\n            \
        \        \"type\": \"integer\",\n                    \"description\": \"New version number\"\n                },\n\
        \                \"baseVersion\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Base version this delta is relative to\"\n                },\n                \"deltaSizeBytes\": {\n        \
        \            \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\"\
        : \"Size of stored delta\"\n                },\n                \"estimatedFullSizeBytes\": {\n                  \
        \  \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Estimated
        size when reconstructed\"\n                },\n                \"chainLength\": {\n                    \"type\": \"\
        integer\",\n                    \"description\": \"Number of deltas in chain to base snapshot\"\n                },\n\
        \                \"compressionSavings\": {\n                    \"type\": \"number\",\n                    \"format\"\
        : \"double\",\n                    \"description\": \"Storage savings vs full snapshot (0-1)\"\n                },\n\
        \                \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Save incremental changes from base version\",\n    \"description\": \"\
        Creates a new version by applying a delta (patch) to a base version.\\nSignificantly reduces storage for large saves
        with small incremental changes.\\n\\nUses JSON Patch (RFC 6902) by default. The implementation is designed to\\nallow
        swapping to binary diff algorithms (bsdiff/xdelta) if needed for\\nspecific use cases (e.g., binary game state).\\
        n\\nDelta versions store only the patch; full data is reconstructed on load.\\n\",\n    \"tags\": [\n        \"Saves\"\
        \n    ],\n    \"deprecated\": false,\n    \"operationId\": \"SaveDelta\"\n}"
  /save-load/load-with-deltas:
    post:
      tags: [Saves]
      operationId: LoadWithDeltas
      summary: Load save reconstructing from delta chain
      description: |
        Loads save data, automatically reconstructing from delta chain if needed.
        Returns the full reconstructed data, not the raw delta.

        For performance, the service may cache reconstructed data or collapse
        delta chains during background cleanup.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoadRequest'
      responses:
        '200':
          description: Load successful (reconstructed if delta)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoadResponse'
        '404':
          description: Slot or version not found
        '422':
          description: Delta chain broken (base version missing)

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LoadRequest\"\
        ,\n    \"$defs\": {\n        \"LoadRequest\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\
        \n            ],\n            \"properties\": {\n                \"gameId\": {\n                    \"type\": \"string\"\
        ,\n                    \"minLength\": 1,\n                    \"maxLength\": 32,\n                    \"pattern\"\
        : \"^[a-z][a-z0-9-]*$\",\n                    \"description\": \"Game identifier for namespace isolation\"\n     \
        \           },\n                \"ownerId\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uuid\",\n                    \"description\": \"ID of the owning entity\"\n                },\n      \
        \          \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n           \
        \     \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Slot name\"\
        \n                },\n                \"versionNumber\": {\n                    \"type\": \"integer\",\n         \
        \           \"description\": \"Specific version to load (defaults to latest)\"\n                },\n             \
        \   \"checkpointName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Load
        by checkpoint name instead of version number\"\n                },\n                \"includeMetadata\": {\n     \
        \               \"type\": \"boolean\",\n                    \"default\": true,\n                    \"description\"\
        : \"Include version metadata in response\"\n                }\n            }\n        },\n        \"OwnerType\": {\n\
        \            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\"\
        ,\n                \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\": \"Type of
        entity that owns this save slot\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LoadResponse\"\
        ,\n    \"$defs\": {\n        \"LoadResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"versionNumber\",\n                \"data\",\n                \"contentHash\"\
        \n            ],\n            \"properties\": {\n                \"slotId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Slot identifier\"\n         \
        \       },\n                \"versionNumber\": {\n                    \"type\": \"integer\",\n                   \
        \ \"description\": \"Version number loaded\"\n                },\n                \"data\": {\n                  \
        \  \"type\": \"string\",\n                    \"format\": \"byte\",\n                    \"description\": \"Base64-encoded
        save data (decompressed)\"\n                },\n                \"contentHash\": {\n                    \"type\":
        \"string\",\n                    \"description\": \"SHA-256 hash for integrity verification\"\n                },\n\
        \                \"schemaVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Schema version of this save\"\n                },\n              \
        \  \"displayName\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n      \
        \              \"description\": \"Human-readable name\"\n                },\n                \"pinned\": {\n     \
        \               \"type\": \"boolean\",\n                    \"description\": \"Whether this version is pinned\"\n\
        \                },\n                \"checkpointName\": {\n                    \"type\": \"string\",\n          \
        \          \"nullable\": true,\n                    \"description\": \"Checkpoint name if pinned\"\n             \
        \   },\n                \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"description\": \"Save timestamp\"\n                },\n                \"\
        metadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\": {\n      \
        \                  \"type\": \"string\"\n                    },\n                    \"description\": \"Custom metadata\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Load save reconstructing from delta chain\",\n    \"description\": \"Loads
        save data, automatically reconstructing from delta chain if needed.\\nReturns the full reconstructed data, not the
        raw delta.\\n\\nFor performance, the service may cache reconstructed data or collapse\\ndelta chains during background
        cleanup.\\n\",\n    \"tags\": [\n        \"Saves\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"LoadWithDeltas\"\
        \n}"
  /save-load/collapse-deltas:
    post:
      tags: [Saves]
      operationId: CollapseDeltas
      summary: Collapse delta chain into full snapshot
      description: |
        Collapses a chain of delta versions into a single full snapshot.
        Useful for reducing load latency or before deleting base versions.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CollapseDeltasRequest'
      responses:
        '200':
          description: Delta chain collapsed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SaveResponse'
        '404':
          description: Slot or version not found

  # ═══════════════════════════════════════════════════════════════════════════
  # VERSION MANAGEMENT
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CollapseDeltasRequest\"\
        ,\n    \"$defs\": {\n        \"CollapseDeltasRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"\
        slotName\"\n            ],\n            \"properties\": {\n                \"gameId\": {\n                    \"type\"\
        : \"string\"\n                },\n                \"ownerId\": {\n                    \"type\": \"string\",\n    \
        \                \"format\": \"uuid\"\n                },\n                \"ownerType\": {\n                    \"\
        $ref\": \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"type\":
        \"string\"\n                },\n                \"versionNumber\": {\n                    \"type\": \"integer\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Version to collapse to (latest if
        null)\"\n                },\n                \"deleteIntermediates\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"default\": true,\n                    \"description\": \"Delete intermediate delta versions
        after collapse\"\n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"\
        string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n               \
        \ \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns
        this save slot\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveResponse\"\
        ,\n    \"$defs\": {\n        \"SaveResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"versionNumber\",\n                \"contentHash\",\n             \
        \   \"sizeBytes\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n               \
        \ \"slotId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n          \
        \          \"description\": \"Slot identifier\"\n                },\n                \"versionNumber\": {\n      \
        \              \"type\": \"integer\",\n                    \"description\": \"Assigned version number\"\n        \
        \        },\n                \"contentHash\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"SHA-256 hash of save data\"\n                },\n                \"sizeBytes\": {\n             \
        \       \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"\
        Size of save data in bytes\"\n                },\n                \"compressedSizeBytes\": {\n                   \
        \ \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Compressed
        size (if compression applied)\"\n                },\n                \"compressionRatio\": {\n                   \
        \ \"type\": \"number\",\n                    \"format\": \"double\",\n                    \"description\": \"Compression
        ratio (0-1)\"\n                },\n                \"pinned\": {\n                    \"type\": \"boolean\",\n   \
        \                 \"description\": \"Whether version was pinned\"\n                },\n                \"checkpointName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Checkpoint name if pinned\"\n                },\n                \"thumbnailUrl\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uri\",\n                    \"nullable\": true,\n               \
        \     \"description\": \"Pre-signed URL to retrieve thumbnail (if provided)\"\n                },\n              \
        \  \"conflictDetected\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if this save overwrote a version from a different device.\\nOnly relevant when deviceId is used for cloud sync.\\\
        n\"\n                },\n                \"conflictingDeviceId\": {\n                    \"type\": \"string\",\n \
        \                   \"nullable\": true,\n                    \"description\": \"Device ID of the overwritten version
        (if conflict)\"\n                },\n                \"conflictingVersion\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Version number that was overwritten
        (if conflict)\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"date-time\",\n                    \"description\": \"Save timestamp\"\n       \
        \         },\n                \"versionsCleanedUp\": {\n                    \"type\": \"integer\",\n             \
        \       \"description\": \"Number of old versions cleaned up by rolling policy\"\n                },\n           \
        \     \"uploadPending\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if async upload is enabled and data is queued for MinIO upload.\\nSave is immediately loadable from Redis cache, but
        not yet durable.\\n\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Collapse delta chain into full snapshot\",\n    \"description\": \"Collapses
        a chain of delta versions into a single full snapshot.\\nUseful for reducing load latency or before deleting base
        versions.\\n\",\n    \"tags\": [\n        \"Saves\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"CollapseDeltas\"\
        \n}"
  /save-load/version/list:
    post:
      tags: [Versions]
      operationId: ListVersions
      summary: List versions in slot
      description: Returns all versions in a slot with metadata.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListVersionsRequest'
      responses:
        '200':
          description: Versions listed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListVersionsResponse'
        '404':
          description: Slot not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListVersionsRequest\"\
        ,\n    \"$defs\": {\n        \"ListVersionsRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\"\n            ],\n\
        \            \"properties\": {\n                \"ownerId\": {\n                    \"type\": \"string\",\n      \
        \              \"format\": \"uuid\",\n                    \"description\": \"ID of the owning entity\"\n         \
        \       },\n                \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n              \
        \  },\n                \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Slot name\"\n                },\n                \"offset\": {\n                    \"type\": \"integer\",\n \
        \                   \"default\": 0,\n                    \"description\": \"Pagination offset\"\n                },\n\
        \                \"limit\": {\n                    \"type\": \"integer\",\n                    \"default\": 20,\n\
        \                    \"maximum\": 100,\n                    \"description\": \"Maximum results to return\"\n     \
        \           },\n                \"pinnedOnly\": {\n                    \"type\": \"boolean\",\n                  \
        \  \"default\": false,\n                    \"description\": \"Only return pinned versions\"\n                }\n\
        \            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\": [\n\
        \                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\
        \n            ],\n            \"description\": \"Type of entity that owns this save slot\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListVersionsResponse\"\
        ,\n    \"$defs\": {\n        \"ListVersionsResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"versions\",\n                \"totalCount\"\n            ],\n            \"properties\": {\n\
        \                \"versions\": {\n                    \"type\": \"array\",\n                    \"items\": {\n   \
        \                     \"$ref\": \"#/$defs/VersionResponse\"\n                    },\n                    \"description\"\
        : \"List of versions\"\n                },\n                \"totalCount\": {\n                    \"type\": \"integer\"\
        ,\n                    \"description\": \"Total version count in slot\"\n                }\n            }\n      \
        \  },\n        \"VersionResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n          \
        \      \"versionNumber\",\n                \"contentHash\",\n                \"sizeBytes\",\n                \"createdAt\"\
        \n            ],\n            \"properties\": {\n                \"versionNumber\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Version number\"\n                },\n                \"assetId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"Reference to asset in lib-asset\"\n                },\n                \"contentHash\": {\n     \
        \               \"type\": \"string\",\n                    \"description\": \"SHA-256 hash\"\n                },\n\
        \                \"sizeBytes\": {\n                    \"type\": \"integer\",\n                    \"format\": \"\
        int64\",\n                    \"description\": \"Size in bytes\"\n                },\n                \"compressedSizeBytes\"\
        : {\n                    \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"\
        description\": \"Compressed size if applicable\"\n                },\n                \"schemaVersion\": {\n     \
        \               \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Schema version\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Human-readable name\"\n       \
        \         },\n                \"pinned\": {\n                    \"type\": \"boolean\",\n                    \"description\"\
        : \"Whether version is pinned\"\n                },\n                \"checkpointName\": {\n                    \"\
        type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Checkpoint name
        if pinned\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n   \
        \                 \"format\": \"date-time\",\n                    \"description\": \"Creation timestamp\"\n      \
        \          },\n                \"metadata\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n                \
        \    \"description\": \"Custom metadata\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List versions in slot\",\n    \"description\": \"Returns all versions in
        a slot with metadata.\",\n    \"tags\": [\n        \"Versions\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"ListVersions\"\n}"
  /save-load/version/pin:
    post:
      tags: [Versions]
      operationId: PinVersion
      summary: Pin a version as checkpoint
      description: |
        Pins a specific version, excluding it from rolling cleanup.
        Optionally assigns a checkpoint name for easy retrieval.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PinVersionRequest'
      responses:
        '200':
          description: Version pinned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionResponse'
        '404':
          description: Slot or version not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/PinVersionRequest\"\
        ,\n    \"$defs\": {\n        \"PinVersionRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\",\n               \
        \ \"versionNumber\"\n            ],\n            \"properties\": {\n                \"ownerId\": {\n             \
        \       \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"\
        ID of the owning entity\"\n                },\n                \"ownerType\": {\n                    \"$ref\": \"\
        #/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Slot name\"\n                },\n                \"versionNumber\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Version to pin\"\n           \
        \     },\n                \"checkpointName\": {\n                    \"type\": \"string\",\n                    \"\
        maxLength\": 64,\n                    \"description\": \"Optional checkpoint name for easy retrieval\"\n         \
        \       }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n          \
        \      \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/VersionResponse\"\
        ,\n    \"$defs\": {\n        \"VersionResponse\": {\n            \"type\": \"object\",\n            \"required\":
        [\n                \"versionNumber\",\n                \"contentHash\",\n                \"sizeBytes\",\n        \
        \        \"createdAt\"\n            ],\n            \"properties\": {\n                \"versionNumber\": {\n    \
        \                \"type\": \"integer\",\n                    \"description\": \"Version number\"\n               \
        \ },\n                \"assetId\": {\n                    \"type\": \"string\",\n                    \"format\": \"\
        uuid\",\n                    \"description\": \"Reference to asset in lib-asset\"\n                },\n          \
        \      \"contentHash\": {\n                    \"type\": \"string\",\n                    \"description\": \"SHA-256
        hash\"\n                },\n                \"sizeBytes\": {\n                    \"type\": \"integer\",\n       \
        \             \"format\": \"int64\",\n                    \"description\": \"Size in bytes\"\n                },\n\
        \                \"compressedSizeBytes\": {\n                    \"type\": \"integer\",\n                    \"format\"\
        : \"int64\",\n                    \"description\": \"Compressed size if applicable\"\n                },\n       \
        \         \"schemaVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Schema version\"\n                },\n                \"displayName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Human-readable name\"\n                },\n                \"pinned\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether version is pinned\"\n                },\n                \"checkpointName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Checkpoint name if pinned\"\n                },\n                \"createdAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Creation timestamp\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n        \
        \            \"description\": \"Custom metadata\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Pin a version as checkpoint\",\n    \"description\": \"Pins a specific
        version, excluding it from rolling cleanup.\\nOptionally assigns a checkpoint name for easy retrieval.\\n\",\n   \
        \ \"tags\": [\n        \"Versions\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"PinVersion\"\n}"
  /save-load/version/unpin:
    post:
      tags: [Versions]
      operationId: UnpinVersion
      summary: Unpin a version
      description: Removes pin from a version, making it eligible for rolling cleanup.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UnpinVersionRequest'
      responses:
        '200':
          description: Version unpinned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionResponse'
        '404':
          description: Slot or version not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UnpinVersionRequest\"\
        ,\n    \"$defs\": {\n        \"UnpinVersionRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\",\n               \
        \ \"versionNumber\"\n            ],\n            \"properties\": {\n                \"ownerId\": {\n             \
        \       \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"\
        ID of the owning entity\"\n                },\n                \"ownerType\": {\n                    \"$ref\": \"\
        #/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Slot name\"\n                },\n                \"versionNumber\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Version to unpin\"\n         \
        \       }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n          \
        \      \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/VersionResponse\"\
        ,\n    \"$defs\": {\n        \"VersionResponse\": {\n            \"type\": \"object\",\n            \"required\":
        [\n                \"versionNumber\",\n                \"contentHash\",\n                \"sizeBytes\",\n        \
        \        \"createdAt\"\n            ],\n            \"properties\": {\n                \"versionNumber\": {\n    \
        \                \"type\": \"integer\",\n                    \"description\": \"Version number\"\n               \
        \ },\n                \"assetId\": {\n                    \"type\": \"string\",\n                    \"format\": \"\
        uuid\",\n                    \"description\": \"Reference to asset in lib-asset\"\n                },\n          \
        \      \"contentHash\": {\n                    \"type\": \"string\",\n                    \"description\": \"SHA-256
        hash\"\n                },\n                \"sizeBytes\": {\n                    \"type\": \"integer\",\n       \
        \             \"format\": \"int64\",\n                    \"description\": \"Size in bytes\"\n                },\n\
        \                \"compressedSizeBytes\": {\n                    \"type\": \"integer\",\n                    \"format\"\
        : \"int64\",\n                    \"description\": \"Compressed size if applicable\"\n                },\n       \
        \         \"schemaVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Schema version\"\n                },\n                \"displayName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Human-readable name\"\n                },\n                \"pinned\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether version is pinned\"\n                },\n                \"checkpointName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Checkpoint name if pinned\"\n                },\n                \"createdAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Creation timestamp\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n        \
        \            \"description\": \"Custom metadata\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Unpin a version\",\n    \"description\": \"Removes pin from a version,
        making it eligible for rolling cleanup.\",\n    \"tags\": [\n        \"Versions\"\n    ],\n    \"deprecated\": false,\n\
        \    \"operationId\": \"UnpinVersion\"\n}"
  /save-load/version/delete:
    post:
      tags: [Versions]
      operationId: DeleteVersion
      summary: Delete specific version
      description: |
        Permanently deletes a specific version from a slot.
        Cannot delete pinned versions; unpin first.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteVersionRequest'
      responses:
        '200':
          description: Version deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteVersionResponse'
        '404':
          description: Slot or version not found
        '409':
          description: Cannot delete pinned version

  # ═══════════════════════════════════════════════════════════════════════════
  # QUERY & SEARCH
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteVersionRequest\"\
        ,\n    \"$defs\": {\n        \"DeleteVersionRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\",\n               \
        \ \"versionNumber\"\n            ],\n            \"properties\": {\n                \"ownerId\": {\n             \
        \       \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"\
        ID of the owning entity\"\n                },\n                \"ownerType\": {\n                    \"$ref\": \"\
        #/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Slot name\"\n                },\n                \"versionNumber\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Version to delete\"\n        \
        \        }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n          \
        \      \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteVersionResponse\"\
        ,\n    \"$defs\": {\n        \"DeleteVersionResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"deleted\",\n                \"bytesFreed\"\n            ],\n            \"properties\": {\n\
        \                \"deleted\": {\n                    \"type\": \"boolean\",\n                    \"description\":
        \"Whether version was deleted\"\n                },\n                \"bytesFreed\": {\n                    \"type\"\
        : \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Storage freed in
        bytes\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Delete specific version\",\n    \"description\": \"Permanently deletes
        a specific version from a slot.\\nCannot delete pinned versions; unpin first.\\n\",\n    \"tags\": [\n        \"Versions\"\
        \n    ],\n    \"deprecated\": false,\n    \"operationId\": \"DeleteVersion\"\n}"
  /save-load/query:
    post:
      tags: [Query]
      operationId: QuerySaves
      summary: Query saves with filters
      description: |
        Search and filter saves across slots. Supports filtering by owner,
        category, date range, metadata, and more. Paginated results.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QuerySavesRequest'
      responses:
        '200':
          description: Query results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuerySavesResponse'

  # ═══════════════════════════════════════════════════════════════════════════
  # COPY & TRANSFER OPERATIONS
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QuerySavesRequest\"\
        ,\n    \"$defs\": {\n        \"QuerySavesRequest\": {\n            \"type\": \"object\",\n            \"properties\"\
        : {\n                \"ownerId\": {\n                    \"type\": \"string\",\n                    \"format\": \"\
        uuid\",\n                    \"description\": \"Filter by owner ID\"\n                },\n                \"ownerType\"\
        : {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"category\": {\n  \
        \                  \"$ref\": \"#/$defs/SaveCategory\"\n                },\n                \"createdAfter\": {\n \
        \                   \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        description\": \"Filter by creation date\"\n                },\n                \"createdBefore\": {\n           \
        \         \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Filter by creation date\"\n                },\n                \"pinnedOnly\": {\n                    \"type\"\
        : \"boolean\",\n                    \"description\": \"Only return pinned versions\"\n                },\n       \
        \         \"schemaVersion\": {\n                    \"type\": \"string\",\n                    \"description\": \"\
        Filter by schema version\"\n                },\n                \"metadataFilter\": {\n                    \"type\"\
        : \"object\",\n                    \"additionalProperties\": {\n                        \"type\": \"string\"\n   \
        \                 },\n                    \"description\": \"Filter by metadata key-value pairs\"\n              \
        \  },\n                \"offset\": {\n                    \"type\": \"integer\",\n                    \"default\"\
        : 0,\n                    \"description\": \"Pagination offset\"\n                },\n                \"limit\": {\n\
        \                    \"type\": \"integer\",\n                    \"default\": 20,\n                    \"maximum\"\
        : 100,\n                    \"description\": \"Maximum results\"\n                },\n                \"sortBy\":
        {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"created_at\"\
        ,\n                        \"size\",\n                        \"version_number\"\n                    ],\n       \
        \             \"default\": \"created_at\",\n                    \"description\": \"Sort field\"\n                },\n\
        \                \"sortOrder\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n  \
        \                      \"asc\",\n                        \"desc\"\n                    ],\n                    \"\
        default\": \"desc\",\n                    \"description\": \"Sort order\"\n                }\n            }\n    \
        \    },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"\
        ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n\
        \            \"description\": \"Type of entity that owns this save slot\"\n        },\n        \"SaveCategory\": {\n\
        \            \"type\": \"string\",\n            \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\"\
        ,\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n       \
        \     ],\n            \"description\": \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast
        save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\
        nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20
        versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max 3 versions, rolling).\\n\"\n        }\n\
        \    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QuerySavesResponse\"\
        ,\n    \"$defs\": {\n        \"QuerySavesResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"results\",\n                \"totalCount\"\n            ],\n            \"properties\": {\n\
        \                \"results\": {\n                    \"type\": \"array\",\n                    \"items\": {\n    \
        \                    \"$ref\": \"#/$defs/QueryResultItem\"\n                    },\n                    \"description\"\
        : \"Query results\"\n                },\n                \"totalCount\": {\n                    \"type\": \"integer\"\
        ,\n                    \"description\": \"Total matching results\"\n                }\n            }\n        },\n\
        \        \"QueryResultItem\": {\n            \"type\": \"object\",\n            \"required\": [\n                \"\
        slotId\",\n                \"slotName\",\n                \"ownerId\",\n                \"ownerType\",\n         \
        \       \"category\",\n                \"versionNumber\",\n                \"createdAt\"\n            ],\n       \
        \     \"properties\": {\n                \"slotId\": {\n                    \"type\": \"string\",\n              \
        \      \"format\": \"uuid\",\n                    \"description\": \"Slot identifier\"\n                },\n     \
        \           \"slotName\": {\n                    \"type\": \"string\",\n                    \"description\": \"Slot
        name\"\n                },\n                \"ownerId\": {\n                    \"type\": \"string\",\n          \
        \          \"format\": \"uuid\",\n                    \"description\": \"Owner ID\"\n                },\n        \
        \        \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n             \
        \   \"category\": {\n                    \"$ref\": \"#/$defs/SaveCategory\"\n                },\n                \"\
        versionNumber\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Version number\"\
        \n                },\n                \"sizeBytes\": {\n                    \"type\": \"integer\",\n             \
        \       \"format\": \"int64\",\n                    \"description\": \"Size in bytes\"\n                },\n     \
        \           \"schemaVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Schema version\"\n                },\n                \"displayName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Display name\"\n                },\n                \"pinned\": {\n                    \"type\": \"boolean\",\n\
        \                    \"description\": \"Whether pinned\"\n                },\n                \"checkpointName\":
        {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Checkpoint name\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"description\": \"Creation timestamp\"\n \
        \               },\n                \"metadata\": {\n                    \"type\": \"object\",\n                 \
        \   \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n          \
        \          \"description\": \"Custom metadata\"\n                }\n            }\n        },\n        \"OwnerType\"\
        : {\n            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"\
        CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\"\
        : \"Type of entity that owns this save slot\"\n        },\n        \"SaveCategory\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\",\n                \"MANUAL_SAVE\"\
        ,\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n            ],\n            \"description\"\
        : \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast save, overwritten frequently (max 1
        version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\nMANUAL_SAVE: User-initiated named
        saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20 versions, rolling).\\nSTATE_SNAPSHOT:
        Full state captures for debugging (max 3 versions, rolling).\\n\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Query saves with filters\",\n    \"description\": \"Search and filter saves
        across slots. Supports filtering by owner,\\ncategory, date range, metadata, and more. Paginated results.\\n\",\n\
        \    \"tags\": [\n        \"Query\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"QuerySaves\"\n}"
  /save-load/copy:
    post:
      tags: [Transfer]
      operationId: CopySave
      summary: Copy save to different slot or owner
      description: |
        Copies a save version to a different slot or owner.
        Can copy to same owner (different slot) or different owner (with admin).
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CopySaveRequest'
      responses:
        '200':
          description: Save copied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SaveResponse'
        '404':
          description: Source slot or version not found
        '403':
          description: Not authorized to copy to target

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CopySaveRequest\"\
        ,\n    \"$defs\": {\n        \"CopySaveRequest\": {\n            \"type\": \"object\",\n            \"required\":
        [\n                \"sourceGameId\",\n                \"sourceOwnerId\",\n                \"sourceOwnerType\",\n \
        \               \"sourceSlotName\",\n                \"targetGameId\",\n                \"targetOwnerId\",\n     \
        \           \"targetOwnerType\",\n                \"targetSlotName\"\n            ],\n            \"properties\":
        {\n                \"sourceGameId\": {\n                    \"type\": \"string\"\n                },\n           \
        \     \"sourceOwnerId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\n\
        \                },\n                \"sourceOwnerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n\
        \                },\n                \"sourceSlotName\": {\n                    \"type\": \"string\"\n           \
        \     },\n                \"sourceVersion\": {\n                    \"type\": \"integer\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Version to copy (latest if null)\"\n                },\n\
        \                \"targetGameId\": {\n                    \"type\": \"string\"\n                },\n             \
        \   \"targetOwnerId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\n  \
        \              },\n                \"targetOwnerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n \
        \               },\n                \"targetSlotName\": {\n                    \"type\": \"string\"\n            \
        \    },\n                \"targetCategory\": {\n                    \"$ref\": \"#/$defs/SaveCategory\",\n        \
        \            \"description\": \"Category for new slot if auto-created\"\n                }\n            }\n      \
        \  },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\"\
        ,\n                \"CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n     \
        \       \"description\": \"Type of entity that owns this save slot\"\n        },\n        \"SaveCategory\": {\n  \
        \          \"type\": \"string\",\n            \"enum\": [\n                \"QUICK_SAVE\",\n                \"AUTO_SAVE\"\
        ,\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\",\n                \"STATE_SNAPSHOT\"\n       \
        \     ],\n            \"description\": \"Category of save with predefined behaviors.\\nQUICK_SAVE: Single-slot fast
        save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).\\
        nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\nCHECKPOINT: Progress markers (max 20
        versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max 3 versions, rolling).\\n\"\n        }\n\
        \    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveResponse\"\
        ,\n    \"$defs\": {\n        \"SaveResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"versionNumber\",\n                \"contentHash\",\n             \
        \   \"sizeBytes\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n               \
        \ \"slotId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n          \
        \          \"description\": \"Slot identifier\"\n                },\n                \"versionNumber\": {\n      \
        \              \"type\": \"integer\",\n                    \"description\": \"Assigned version number\"\n        \
        \        },\n                \"contentHash\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"SHA-256 hash of save data\"\n                },\n                \"sizeBytes\": {\n             \
        \       \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"\
        Size of save data in bytes\"\n                },\n                \"compressedSizeBytes\": {\n                   \
        \ \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Compressed
        size (if compression applied)\"\n                },\n                \"compressionRatio\": {\n                   \
        \ \"type\": \"number\",\n                    \"format\": \"double\",\n                    \"description\": \"Compression
        ratio (0-1)\"\n                },\n                \"pinned\": {\n                    \"type\": \"boolean\",\n   \
        \                 \"description\": \"Whether version was pinned\"\n                },\n                \"checkpointName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Checkpoint name if pinned\"\n                },\n                \"thumbnailUrl\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uri\",\n                    \"nullable\": true,\n               \
        \     \"description\": \"Pre-signed URL to retrieve thumbnail (if provided)\"\n                },\n              \
        \  \"conflictDetected\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if this save overwrote a version from a different device.\\nOnly relevant when deviceId is used for cloud sync.\\\
        n\"\n                },\n                \"conflictingDeviceId\": {\n                    \"type\": \"string\",\n \
        \                   \"nullable\": true,\n                    \"description\": \"Device ID of the overwritten version
        (if conflict)\"\n                },\n                \"conflictingVersion\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Version number that was overwritten
        (if conflict)\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"date-time\",\n                    \"description\": \"Save timestamp\"\n       \
        \         },\n                \"versionsCleanedUp\": {\n                    \"type\": \"integer\",\n             \
        \       \"description\": \"Number of old versions cleaned up by rolling policy\"\n                },\n           \
        \     \"uploadPending\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if async upload is enabled and data is queued for MinIO upload.\\nSave is immediately loadable from Redis cache, but
        not yet durable.\\n\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Copy save to different slot or owner\",\n    \"description\": \"Copies
        a save version to a different slot or owner.\\nCan copy to same owner (different slot) or different owner (with admin).\\\
        n\",\n    \"tags\": [\n        \"Transfer\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"CopySave\"\
        \n}"
  /save-load/export:
    post:
      tags: [Transfer]
      operationId: ExportSaves
      summary: Export saves for backup/portability
      description: |
        Exports one or more slots with all versions as a downloadable archive.
        Returns a pre-signed URL to download the export bundle.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExportSavesRequest'
      responses:
        '200':
          description: Export prepared
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportSavesResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ExportSavesRequest\"\
        ,\n    \"$defs\": {\n        \"ExportSavesRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\"\n            ],\n  \
        \          \"properties\": {\n                \"gameId\": {\n                    \"type\": \"string\"\n          \
        \      },\n                \"ownerId\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uuid\"\n                },\n                \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\
        \n                },\n                \"slotNames\": {\n                    \"type\": \"array\",\n               \
        \     \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"Specific slots to export (all if null)\"\n                }\n            }\n        },\n        \"OwnerType\"\
        : {\n            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"\
        CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\"\
        : \"Type of entity that owns this save slot\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ExportSavesResponse\"\
        ,\n    \"$defs\": {\n        \"ExportSavesResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"downloadUrl\",\n                \"expiresAt\",\n                \"sizeBytes\"\n           \
        \ ],\n            \"properties\": {\n                \"downloadUrl\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uri\",\n                    \"description\": \"Pre-signed URL to download export
        archive\"\n                },\n                \"expiresAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"When the download URL expires\"\
        \n                },\n                \"sizeBytes\": {\n                    \"type\": \"integer\",\n             \
        \       \"format\": \"int64\",\n                    \"description\": \"Archive size\"\n                }\n       \
        \     }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Export saves for backup/portability\",\n    \"description\": \"Exports
        one or more slots with all versions as a downloadable archive.\\nReturns a pre-signed URL to download the export bundle.\\\
        n\",\n    \"tags\": [\n        \"Transfer\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"ExportSaves\"\
        \n}"
  /save-load/import:
    post:
      tags: [Transfer]
      operationId: ImportSaves
      summary: Import saves from backup
      description: |
        Imports saves from a previously exported archive.
        Supports conflict resolution strategies for existing slots.
      x-permissions:
      - role: admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportSavesRequest'
      responses:
        '200':
          description: Import completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportSavesResponse'
        '400':
          description: Invalid archive format

  # ═══════════════════════════════════════════════════════════════════════════
  # INTEGRITY & VALIDATION
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ImportSavesRequest\"\
        ,\n    \"$defs\": {\n        \"ImportSavesRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"archiveAssetId\",\n                \"targetGameId\",\n                \"targetOwnerId\",\n\
        \                \"targetOwnerType\"\n            ],\n            \"properties\": {\n                \"archiveAssetId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"Asset ID of uploaded export archive\"\n                },\n                \"targetGameId\": {\n\
        \                    \"type\": \"string\"\n                },\n                \"targetOwnerId\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"uuid\"\n                },\n                \"targetOwnerType\"\
        : {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"conflictResolution\"\
        : {\n                    \"$ref\": \"#/$defs/ConflictResolution\",\n                    \"description\": \"How to
        handle existing slots\"\n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\"\
        : \"string\",\n            \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n           \
        \     \"SESSION\",\n                \"REALM\"\n            ],\n            \"description\": \"Type of entity that
        owns this save slot\"\n        },\n        \"ConflictResolution\": {\n            \"type\": \"string\",\n        \
        \    \"enum\": [\n                \"SKIP\",\n                \"OVERWRITE\",\n                \"RENAME\",\n       \
        \         \"FAIL\"\n            ],\n            \"description\": \"Strategy for handling conflicts during import\"\
        \n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ImportSavesResponse\"\
        ,\n    \"$defs\": {\n        \"ImportSavesResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"importedSlots\",\n                \"importedVersions\",\n                \"skippedSlots\"\n\
        \            ],\n            \"properties\": {\n                \"importedSlots\": {\n                    \"type\"\
        : \"integer\"\n                },\n                \"importedVersions\": {\n                    \"type\": \"integer\"\
        \n                },\n                \"skippedSlots\": {\n                    \"type\": \"integer\",\n          \
        \          \"description\": \"Slots skipped due to conflicts\"\n                },\n                \"conflicts\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"description\": \"Names of slots that had conflicts\"\n\
        \                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Import saves from backup\",\n    \"description\": \"Imports saves from
        a previously exported archive.\\nSupports conflict resolution strategies for existing slots.\\n\",\n    \"tags\":
        [\n        \"Transfer\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"ImportSaves\"\n}"
  /save-load/verify:
    post:
      tags: [Validation]
      operationId: VerifyIntegrity
      summary: Verify save data integrity
      description: |
        Verifies the integrity of stored save data by comparing content hash
        against the stored SHA-256 hash. Detects corruption or tampering.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VerifyIntegrityRequest'
      responses:
        '200':
          description: Verification result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerifyIntegrityResponse'
        '404':
          description: Slot or version not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/VerifyIntegrityRequest\"\
        ,\n    \"$defs\": {\n        \"VerifyIntegrityRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"\
        slotName\"\n            ],\n            \"properties\": {\n                \"gameId\": {\n                    \"type\"\
        : \"string\"\n                },\n                \"ownerId\": {\n                    \"type\": \"string\",\n    \
        \                \"format\": \"uuid\"\n                },\n                \"ownerType\": {\n                    \"\
        $ref\": \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"type\":
        \"string\"\n                },\n                \"versionNumber\": {\n                    \"type\": \"integer\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Version to verify (latest if null)\"\
        \n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n    \
        \        \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n\
        \                \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\
        \n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/VerifyIntegrityResponse\"\
        ,\n    \"$defs\": {\n        \"VerifyIntegrityResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"valid\",\n                \"versionNumber\"\n            ],\n            \"properties\": {\n\
        \                \"valid\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"\
        Whether integrity check passed\"\n                },\n                \"versionNumber\": {\n                    \"\
        type\": \"integer\",\n                    \"description\": \"Version that was verified\"\n                },\n   \
        \             \"expectedHash\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Expected SHA-256 hash\"\n                },\n                \"actualHash\": {\n                    \"type\":
        \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Actual hash (null if
        data unavailable)\"\n                },\n                \"errorMessage\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Error details if verification failed\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Verify save data integrity\",\n    \"description\": \"Verifies the integrity
        of stored save data by comparing content hash\\nagainst the stored SHA-256 hash. Detects corruption or tampering.\\\
        n\",\n    \"tags\": [\n        \"Validation\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"VerifyIntegrity\"\
        \n}"
  /save-load/version/promote:
    post:
      tags: [Versions]
      operationId: PromoteVersion
      summary: Promote old version to latest
      description: |
        Creates a new version from an existing older version, effectively
        "promoting" it to be the latest. Useful for rollback scenarios.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromoteVersionRequest'
      responses:
        '200':
          description: Version promoted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SaveResponse'
        '404':
          description: Slot or version not found

  # ═══════════════════════════════════════════════════════════════════════════
  # SCHEMA MIGRATION
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/PromoteVersionRequest\"\
        ,\n    \"$defs\": {\n        \"PromoteVersionRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"gameId\",\n                \"ownerId\",\n                \"ownerType\",\n                \"\
        slotName\",\n                \"versionNumber\"\n            ],\n            \"properties\": {\n                \"\
        gameId\": {\n                    \"type\": \"string\"\n                },\n                \"ownerId\": {\n      \
        \              \"type\": \"string\",\n                    \"format\": \"uuid\"\n                },\n             \
        \   \"ownerType\": {\n                    \"$ref\": \"#/$defs/OwnerType\"\n                },\n                \"\
        slotName\": {\n                    \"type\": \"string\"\n                },\n                \"versionNumber\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Old version to promote to latest\"\
        \n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"Display name for promoted version\"\n       \
        \         }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n          \
        \      \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveResponse\"\
        ,\n    \"$defs\": {\n        \"SaveResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"slotId\",\n                \"versionNumber\",\n                \"contentHash\",\n             \
        \   \"sizeBytes\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n               \
        \ \"slotId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n          \
        \          \"description\": \"Slot identifier\"\n                },\n                \"versionNumber\": {\n      \
        \              \"type\": \"integer\",\n                    \"description\": \"Assigned version number\"\n        \
        \        },\n                \"contentHash\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"SHA-256 hash of save data\"\n                },\n                \"sizeBytes\": {\n             \
        \       \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"\
        Size of save data in bytes\"\n                },\n                \"compressedSizeBytes\": {\n                   \
        \ \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Compressed
        size (if compression applied)\"\n                },\n                \"compressionRatio\": {\n                   \
        \ \"type\": \"number\",\n                    \"format\": \"double\",\n                    \"description\": \"Compression
        ratio (0-1)\"\n                },\n                \"pinned\": {\n                    \"type\": \"boolean\",\n   \
        \                 \"description\": \"Whether version was pinned\"\n                },\n                \"checkpointName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Checkpoint name if pinned\"\n                },\n                \"thumbnailUrl\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uri\",\n                    \"nullable\": true,\n               \
        \     \"description\": \"Pre-signed URL to retrieve thumbnail (if provided)\"\n                },\n              \
        \  \"conflictDetected\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if this save overwrote a version from a different device.\\nOnly relevant when deviceId is used for cloud sync.\\\
        n\"\n                },\n                \"conflictingDeviceId\": {\n                    \"type\": \"string\",\n \
        \                   \"nullable\": true,\n                    \"description\": \"Device ID of the overwritten version
        (if conflict)\"\n                },\n                \"conflictingVersion\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Version number that was overwritten
        (if conflict)\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"date-time\",\n                    \"description\": \"Save timestamp\"\n       \
        \         },\n                \"versionsCleanedUp\": {\n                    \"type\": \"integer\",\n             \
        \       \"description\": \"Number of old versions cleaned up by rolling policy\"\n                },\n           \
        \     \"uploadPending\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True
        if async upload is enabled and data is queued for MinIO upload.\\nSave is immediately loadable from Redis cache, but
        not yet durable.\\n\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Promote old version to latest\",\n    \"description\": \"Creates a new
        version from an existing older version, effectively\\n\\\"promoting\\\" it to be the latest. Useful for rollback scenarios.\\\
        n\",\n    \"tags\": [\n        \"Versions\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"PromoteVersion\"\
        \n}"
  /save-load/migrate:
    post:
      tags: [Migration]
      operationId: MigrateSave
      summary: Migrate save to new schema version
      description: |
        Applies migration handlers to upgrade a save from one schema version
        to another. Creates a new version with the migrated data.
      x-permissions:
      - role: developer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MigrateSaveRequest'
      responses:
        '200':
          description: Migration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MigrateSaveResponse'
        '400':
          description: Migration failed or no path exists
        '404':
          description: Save not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MigrateSaveRequest\"\
        ,\n    \"$defs\": {\n        \"MigrateSaveRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"ownerId\",\n                \"ownerType\",\n                \"slotName\",\n               \
        \ \"targetSchemaVersion\"\n            ],\n            \"properties\": {\n                \"ownerId\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"ID of the owning entity\"\n                },\n                \"ownerType\": {\n                    \"$ref\"\
        : \"#/$defs/OwnerType\"\n                },\n                \"slotName\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Slot name\"\n                },\n                \"versionNumber\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Specific version to migrate (defaults
        to latest)\"\n                },\n                \"targetSchemaVersion\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Target schema version to migrate to\"\n                },\n            \
        \    \"dryRun\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n        \
        \            \"description\": \"Validate migration without saving\"\n                }\n            }\n        },\n\
        \        \"OwnerType\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"ACCOUNT\"\
        ,\n                \"CHARACTER\",\n                \"SESSION\",\n                \"REALM\"\n            ],\n     \
        \       \"description\": \"Type of entity that owns this save slot\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MigrateSaveResponse\"\
        ,\n    \"$defs\": {\n        \"MigrateSaveResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"success\",\n                \"fromSchemaVersion\",\n                \"toSchemaVersion\"\n \
        \           ],\n            \"properties\": {\n                \"success\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether migration succeeded\"\n                },\n                \"fromSchemaVersion\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Original schema version\"\n\
        \                },\n                \"toSchemaVersion\": {\n                    \"type\": \"string\",\n         \
        \           \"description\": \"Target schema version\"\n                },\n                \"newVersionNumber\":
        {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"New version number (null if dry run)\"\n                },\n                \"migrationPath\": {\n           \
        \         \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n \
        \                   },\n                    \"description\": \"Migration path applied (list of versions)\"\n     \
        \           },\n                \"warnings\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"Non-fatal migration warnings\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Migrate save to new schema version\",\n    \"description\": \"Applies migration
        handlers to upgrade a save from one schema version\\nto another. Creates a new version with the migrated data.\\n\"\
        ,\n    \"tags\": [\n        \"Migration\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"MigrateSave\"\
        \n}"
  /save-load/schema/register:
    post:
      tags: [Migration]
      operationId: RegisterSchema
      summary: Register a save data schema
      description: |
        Registers a JSON schema for validation of save data.
        Optionally includes migration handlers from previous versions.
      x-permissions:
      - role: developer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterSchemaRequest'
      responses:
        '200':
          description: Schema registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RegisterSchemaRequest\"\
        ,\n    \"$defs\": {\n        \"RegisterSchemaRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"namespace\",\n                \"schemaVersion\",\n                \"schema\"\n            ],\n\
        \            \"properties\": {\n                \"namespace\": {\n                    \"type\": \"string\",\n    \
        \                \"description\": \"Schema namespace (e.g., game identifier)\"\n                },\n             \
        \   \"schemaVersion\": {\n                    \"type\": \"string\",\n                    \"description\": \"Schema
        version identifier\"\n                },\n                \"schema\": {\n                    \"type\": \"object\"\
        ,\n                    \"description\": \"JSON Schema definition for validation\"\n                },\n          \
        \      \"previousVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Previous version this migrates from\"\n                },\n              \
        \  \"migrationPatch\": {\n                    \"type\": \"array\",\n                    \"nullable\": true,\n    \
        \                \"items\": {\n                        \"$ref\": \"#/$defs/JsonPatchOperation\"\n                \
        \    },\n                    \"description\": \"JSON Patch (RFC 6902) operations to migrate from previousVersion.\\
        nUses JsonPatch.Net library (MIT licensed).\\n\"\n                }\n            }\n        },\n        \"JsonPatchOperation\"\
        : {\n            \"type\": \"object\",\n            \"required\": [\n                \"op\",\n                \"path\"\
        \n            ],\n            \"description\": \"JSON Patch operation per RFC 6902.\\nUses JsonPatch.Net library (MIT
        licensed).\\n\",\n            \"properties\": {\n                \"op\": {\n                    \"type\": \"string\"\
        ,\n                    \"enum\": [\n                        \"add\",\n                        \"remove\",\n      \
        \                  \"replace\",\n                        \"move\",\n                        \"copy\",\n          \
        \              \"test\"\n                    ],\n                    \"description\": \"Operation type\"\n       \
        \         },\n                \"path\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"JSON Pointer to target location\"\n                },\n                \"from\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Source path (for move/copy
        operations)\"\n                },\n                \"value\": {\n                    \"description\": \"Value to use
        (for add/replace/test operations)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SchemaResponse\"\
        ,\n    \"$defs\": {\n        \"SchemaResponse\": {\n            \"type\": \"object\",\n            \"required\": [\n\
        \                \"namespace\",\n                \"schemaVersion\",\n                \"createdAt\"\n            ],\n\
        \            \"properties\": {\n                \"namespace\": {\n                    \"type\": \"string\",\n    \
        \                \"description\": \"Schema namespace\"\n                },\n                \"schemaVersion\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Schema version\"\n            \
        \    },\n                \"schema\": {\n                    \"type\": \"object\",\n                    \"description\"\
        : \"JSON Schema definition\"\n                },\n                \"previousVersion\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Previous version\"\n\
        \                },\n                \"hasMigration\": {\n                    \"type\": \"boolean\",\n           \
        \         \"description\": \"Whether migration script is registered\"\n                },\n                \"createdAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Registration timestamp\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Register a save data schema\",\n    \"description\": \"Registers a JSON
        schema for validation of save data.\\nOptionally includes migration handlers from previous versions.\\n\",\n    \"\
        tags\": [\n        \"Migration\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"RegisterSchema\"\n}"
  /save-load/schema/list:
    post:
      tags: [Migration]
      operationId: ListSchemas
      summary: List registered schemas
      description: Returns all registered schemas for a game/namespace.
      x-permissions:
      - role: user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListSchemasRequest'
      responses:
        '200':
          description: Schemas listed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListSchemasResponse'

  # ═══════════════════════════════════════════════════════════════════════════
  # ADMIN OPERATIONS
  # ═══════════════════════════════════════════════════════════════════════════

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListSchemasRequest\"\
        ,\n    \"$defs\": {\n        \"ListSchemasRequest\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"namespace\"\n            ],\n            \"properties\": {\n                \"namespace\":
        {\n                    \"type\": \"string\",\n                    \"description\": \"Schema namespace to list\"\n\
        \                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListSchemasResponse\"\
        ,\n    \"$defs\": {\n        \"ListSchemasResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"schemas\"\n            ],\n            \"properties\": {\n                \"schemas\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"\
        #/$defs/SchemaResponse\"\n                    },\n                    \"description\": \"Registered schemas\"\n  \
        \              },\n                \"latestVersion\": {\n                    \"type\": \"string\",\n             \
        \       \"nullable\": true,\n                    \"description\": \"Latest schema version\"\n                }\n \
        \           }\n        },\n        \"SchemaResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"namespace\",\n                \"schemaVersion\",\n                \"createdAt\"\n         \
        \   ],\n            \"properties\": {\n                \"namespace\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Schema namespace\"\n                },\n                \"schemaVersion\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Schema version\"\n        \
        \        },\n                \"schema\": {\n                    \"type\": \"object\",\n                    \"description\"\
        : \"JSON Schema definition\"\n                },\n                \"previousVersion\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Previous version\"\n\
        \                },\n                \"hasMigration\": {\n                    \"type\": \"boolean\",\n           \
        \         \"description\": \"Whether migration script is registered\"\n                },\n                \"createdAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Registration timestamp\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List registered schemas\",\n    \"description\": \"Returns all registered
        schemas for a game/namespace.\",\n    \"tags\": [\n        \"Migration\"\n    ],\n    \"deprecated\": false,\n   \
        \ \"operationId\": \"ListSchemas\"\n}"
  /save-load/admin/cleanup:
    post:
      tags: [Admin]
      operationId: AdminCleanup
      summary: Run cleanup for expired/orphaned saves
      description: |
        Triggers cleanup of expired versions and orphaned assets.
        Normally runs automatically, but can be triggered manually.
      x-permissions:
      - role: admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminCleanupRequest'
      responses:
        '200':
          description: Cleanup completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminCleanupResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AdminCleanupRequest\"\
        ,\n    \"$defs\": {\n        \"AdminCleanupRequest\": {\n            \"type\": \"object\",\n            \"properties\"\
        : {\n                \"dryRun\": {\n                    \"type\": \"boolean\",\n                    \"default\": true,\n\
        \                    \"description\": \"Preview cleanup without executing\"\n                },\n                \"\
        olderThanDays\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Only cleanup
        versions older than N days\"\n                },\n                \"ownerType\": {\n                    \"$ref\":
        \"#/$defs/OwnerType\"\n                },\n                \"category\": {\n                    \"$ref\": \"#/$defs/SaveCategory\"\
        \n                }\n            }\n        },\n        \"OwnerType\": {\n            \"type\": \"string\",\n    \
        \        \"enum\": [\n                \"ACCOUNT\",\n                \"CHARACTER\",\n                \"SESSION\",\n\
        \                \"REALM\"\n            ],\n            \"description\": \"Type of entity that owns this save slot\"\
        \n        },\n        \"SaveCategory\": {\n            \"type\": \"string\",\n            \"enum\": [\n          \
        \      \"QUICK_SAVE\",\n                \"AUTO_SAVE\",\n                \"MANUAL_SAVE\",\n                \"CHECKPOINT\"\
        ,\n                \"STATE_SNAPSHOT\"\n            ],\n            \"description\": \"Category of save with predefined
        behaviors.\\nQUICK_SAVE: Single-slot fast save, overwritten frequently (max 1 version).\\nAUTO_SAVE: System-triggered
        periodic saves (max 5 versions, rolling).\\nMANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).\\
        nCHECKPOINT: Progress markers (max 20 versions, rolling).\\nSTATE_SNAPSHOT: Full state captures for debugging (max
        3 versions, rolling).\\n\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AdminCleanupResponse\"\
        ,\n    \"$defs\": {\n        \"AdminCleanupResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"versionsDeleted\",\n                \"bytesFreed\",\n                \"dryRun\"\n         \
        \   ],\n            \"properties\": {\n                \"versionsDeleted\": {\n                    \"type\": \"integer\"\
        ,\n                    \"description\": \"Number of versions deleted\"\n                },\n                \"slotsDeleted\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Number of empty slots deleted\"\
        \n                },\n                \"bytesFreed\": {\n                    \"type\": \"integer\",\n            \
        \        \"format\": \"int64\",\n                    \"description\": \"Storage freed in bytes\"\n               \
        \ },\n                \"dryRun\": {\n                    \"type\": \"boolean\",\n                    \"description\"\
        : \"Whether this was a preview\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Run cleanup for expired/orphaned saves\",\n    \"description\": \"Triggers
        cleanup of expired versions and orphaned assets.\\nNormally runs automatically, but can be triggered manually.\\n\"\
        ,\n    \"tags\": [\n        \"Admin\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"AdminCleanup\"\n\
        }"
  /save-load/admin/stats:
    post:
      tags: [Admin]
      operationId: AdminStats
      summary: Get storage statistics
      description: Returns storage usage statistics by owner, category, etc.
      x-permissions:
      - role: admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminStatsRequest'
      responses:
        '200':
          description: Statistics returned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminStatsResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AdminStatsRequest\"\
        ,\n    \"$defs\": {\n        \"AdminStatsRequest\": {\n            \"type\": \"object\",\n            \"properties\"\
        : {\n                \"groupBy\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n\
        \                        \"owner_type\",\n                        \"category\",\n                        \"schema_version\"\
        \n                    ],\n                    \"description\": \"Group statistics by field\"\n                }\n\
        \            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AdminStatsResponse\"\
        ,\n    \"$defs\": {\n        \"AdminStatsResponse\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"totalSlots\",\n                \"totalVersions\",\n                \"totalSizeBytes\"\n   \
        \         ],\n            \"properties\": {\n                \"totalSlots\": {\n                    \"type\": \"integer\"\
        ,\n                    \"description\": \"Total slot count\"\n                },\n                \"totalVersions\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Total version count\"\n  \
        \              },\n                \"totalSizeBytes\": {\n                    \"type\": \"integer\",\n           \
        \         \"format\": \"int64\",\n                    \"description\": \"Total storage used\"\n                },\n\
        \                \"pinnedVersions\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Number of pinned versions\"\n                },\n                \"breakdown\": {\n                    \"type\"\
        : \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/StatsBreakdown\"\n   \
        \                 },\n                    \"description\": \"Breakdown by groupBy field\"\n                }\n   \
        \         }\n        },\n        \"StatsBreakdown\": {\n            \"type\": \"object\",\n            \"required\"\
        : [\n                \"key\",\n                \"slots\",\n                \"versions\",\n                \"sizeBytes\"\
        \n            ],\n            \"properties\": {\n                \"key\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Group key\"\n                },\n                \"slots\": {\n        \
        \            \"type\": \"integer\",\n                    \"description\": \"Slot count\"\n                },\n   \
        \             \"versions\": {\n                    \"type\": \"integer\",\n                    \"description\": \"\
        Version count\"\n                },\n                \"sizeBytes\": {\n                    \"type\": \"integer\",\n\
        \                    \"format\": \"int64\",\n                    \"description\": \"Storage used\"\n             \
        \   }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get storage statistics\",\n    \"description\": \"Returns storage usage
        statistics by owner, category, etc.\",\n    \"tags\": [\n        \"Admin\"\n    ],\n    \"deprecated\": false,\n \
        \   \"operationId\": \"AdminStats\"\n}"
components:
  schemas:
    # ═══════════════════════════════════════════════════════════════════════════
    # ENUMS
    # ═══════════════════════════════════════════════════════════════════════════

    OwnerType:
      type: string
      enum: [ACCOUNT, CHARACTER, SESSION, REALM]
      description: Type of entity that owns this save slot

    SaveCategory:
      type: string
      enum: [QUICK_SAVE, AUTO_SAVE, MANUAL_SAVE, CHECKPOINT, STATE_SNAPSHOT]
      description: |
        Category of save with predefined behaviors.
        QUICK_SAVE: Single-slot fast save, overwritten frequently (max 1 version).
        AUTO_SAVE: System-triggered periodic saves (max 5 versions, rolling).
        MANUAL_SAVE: User-initiated named saves (max 10 versions, no auto-cleanup).
        CHECKPOINT: Progress markers (max 20 versions, rolling).
        STATE_SNAPSHOT: Full state captures for debugging (max 3 versions, rolling).

    CompressionType:
      type: string
      enum: [NONE, GZIP, BROTLI]
      description: Compression algorithm used for save data

    ConflictResolution:
      type: string
      enum: [SKIP, OVERWRITE, RENAME, FAIL]
      description: Strategy for handling conflicts during import

    JsonPatchOperation:
      type: object
      required: [op, path]
      description: |
        JSON Patch operation per RFC 6902.
        Uses JsonPatch.Net library (MIT licensed).
      properties:
        op:
          type: string
          enum: [add, remove, replace, move, copy, test]
          description: Operation type
        path:
          type: string
          description: JSON Pointer to target location
        from:
          type: string
          nullable: true
          description: Source path (for move/copy operations)
        value:
          description: Value to use (for add/replace/test operations)

    # ═══════════════════════════════════════════════════════════════════════════
    # SLOT MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    CreateSlotRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName, category]
      properties:
        gameId:
          type: string
          minLength: 1
          maxLength: 32
          pattern: '^[a-z][a-z0-9-]*$'
          description: Game identifier for namespace isolation (e.g., "arcadia", "fantasia")
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          minLength: 1
          maxLength: 64
          pattern: '^[a-z0-9]([a-z0-9-]*[a-z0-9])?$'
          description: Slot name (lowercase alphanumeric with hyphens, single char like "q" allowed)
        category:
          $ref: '#/components/schemas/SaveCategory'
        maxVersions:
          type: integer
          minimum: 1
          maximum: 100
          description: Override default max versions for this category
        retentionDays:
          type: integer
          minimum: 1
          description: Days to retain versions (null = indefinite)
        compressionType:
          $ref: '#/components/schemas/CompressionType'
        tags:
          type: array
          items:
            type: string
            maxLength: 32
          maxItems: 20
          description: Searchable tags for slot categorization (e.g., "boss-fight", "chapter-3")
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Custom key-value metadata for the slot

    GetSlotRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName]
      properties:
        gameId:
          type: string
          minLength: 1
          maxLength: 32
          pattern: "^[a-z][a-z0-9-]*$"
          description: Game identifier for namespace isolation
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name

    ListSlotsRequest:
      type: object
      required: [gameId, ownerId, ownerType]
      properties:
        gameId:
          type: string
          minLength: 1
          maxLength: 32
          pattern: "^[a-z][a-z0-9-]*$"
          description: Game identifier for namespace isolation
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        category:
          $ref: '#/components/schemas/SaveCategory'
        includeVersionCount:
          type: boolean
          default: true
          description: Include version count in response

    DeleteSlotRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName]
      properties:
        gameId:
          type: string
          minLength: 1
          maxLength: 32
          pattern: "^[a-z][a-z0-9-]*$"
          description: Game identifier for namespace isolation
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name

    SlotResponse:
      type: object
      required: [slotId, ownerId, ownerType, slotName, category, createdAt]
      properties:
        slotId:
          type: string
          format: uuid
          description: Unique slot identifier
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name
        category:
          $ref: '#/components/schemas/SaveCategory'
        maxVersions:
          type: integer
          description: Maximum versions to retain
        retentionDays:
          type: integer
          nullable: true
          description: Days to retain versions (null = indefinite)
        compressionType:
          $ref: '#/components/schemas/CompressionType'
        versionCount:
          type: integer
          description: Current number of versions in slot
        latestVersion:
          type: integer
          nullable: true
          description: Latest version number (null if empty)
        totalSizeBytes:
          type: integer
          format: int64
          description: Total storage used by all versions
        createdAt:
          type: string
          format: date-time
          description: Slot creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last modification timestamp
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Custom key-value metadata

    ListSlotsResponse:
      type: object
      required: [slots]
      properties:
        slots:
          type: array
          items:
            $ref: '#/components/schemas/SlotResponse'
          description: List of slots
        totalCount:
          type: integer
          description: Total number of slots for owner

    DeleteSlotResponse:
      type: object
      required: [deleted, versionsDeleted, bytesFreed]
      properties:
        deleted:
          type: boolean
          description: Whether slot was deleted
        versionsDeleted:
          type: integer
          description: Number of versions deleted
        bytesFreed:
          type: integer
          format: int64
          description: Storage freed in bytes

    # ═══════════════════════════════════════════════════════════════════════════
    # SAVE/LOAD MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    SaveRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName, data]
      properties:
        gameId:
          type: string
          description: Game identifier for namespace isolation
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name (auto-created if doesn't exist)
        category:
          $ref: '#/components/schemas/SaveCategory'
          description: Category for auto-created slots (defaults to MANUAL_SAVE)
        data:
          type: string
          format: byte
          description: Base64-encoded save data
        schemaVersion:
          type: string
          description: Schema version identifier for migration tracking
        displayName:
          type: string
          maxLength: 128
          description: Human-readable name for this save
        thumbnail:
          type: string
          format: byte
          nullable: true
          description: |
            Optional preview image (JPEG/WebP). Max size configurable
            (default 256KB). Used for save slot previews in game UI.
        deviceId:
          type: string
          maxLength: 64
          nullable: true
          description: |
            Optional device identifier for cloud save conflict detection.
            When provided, saves are prefixed/tagged with device info,
            enabling opt-in cross-device sync with collision awareness.
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Custom metadata (e.g., level, playtime, location)
        pinAsCheckpoint:
          type: string
          maxLength: 64
          description: If provided, pin this version with checkpoint name

    SaveResponse:
      type: object
      required: [slotId, versionNumber, contentHash, sizeBytes, createdAt]
      properties:
        slotId:
          type: string
          format: uuid
          description: Slot identifier
        versionNumber:
          type: integer
          description: Assigned version number
        contentHash:
          type: string
          description: SHA-256 hash of save data
        sizeBytes:
          type: integer
          format: int64
          description: Size of save data in bytes
        compressedSizeBytes:
          type: integer
          format: int64
          description: Compressed size (if compression applied)
        compressionRatio:
          type: number
          format: double
          description: Compression ratio (0-1)
        pinned:
          type: boolean
          description: Whether version was pinned
        checkpointName:
          type: string
          nullable: true
          description: Checkpoint name if pinned
        thumbnailUrl:
          type: string
          format: uri
          nullable: true
          description: Pre-signed URL to retrieve thumbnail (if provided)
        conflictDetected:
          type: boolean
          description: |
            True if this save overwrote a version from a different device.
            Only relevant when deviceId is used for cloud sync.
        conflictingDeviceId:
          type: string
          nullable: true
          description: Device ID of the overwritten version (if conflict)
        conflictingVersion:
          type: integer
          nullable: true
          description: Version number that was overwritten (if conflict)
        createdAt:
          type: string
          format: date-time
          description: Save timestamp
        versionsCleanedUp:
          type: integer
          description: Number of old versions cleaned up by rolling policy
        uploadPending:
          type: boolean
          description: |
            True if async upload is enabled and data is queued for MinIO upload.
            Save is immediately loadable from Redis cache, but not yet durable.

    LoadRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName]
      properties:
        gameId:
          type: string
          minLength: 1
          maxLength: 32
          pattern: "^[a-z][a-z0-9-]*$"
          description: Game identifier for namespace isolation
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name
        versionNumber:
          type: integer
          description: Specific version to load (defaults to latest)
        checkpointName:
          type: string
          description: Load by checkpoint name instead of version number
        includeMetadata:
          type: boolean
          default: true
          description: Include version metadata in response

    LoadResponse:
      type: object
      required: [slotId, versionNumber, data, contentHash]
      properties:
        slotId:
          type: string
          format: uuid
          description: Slot identifier
        versionNumber:
          type: integer
          description: Version number loaded
        data:
          type: string
          format: byte
          description: Base64-encoded save data (decompressed)
        contentHash:
          type: string
          description: SHA-256 hash for integrity verification
        schemaVersion:
          type: string
          nullable: true
          description: Schema version of this save
        displayName:
          type: string
          nullable: true
          description: Human-readable name
        pinned:
          type: boolean
          description: Whether this version is pinned
        checkpointName:
          type: string
          nullable: true
          description: Checkpoint name if pinned
        createdAt:
          type: string
          format: date-time
          description: Save timestamp
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Custom metadata

    # ═══════════════════════════════════════════════════════════════════════════
    # VERSION MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    ListVersionsRequest:
      type: object
      required: [ownerId, ownerType, slotName]
      properties:
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name
        offset:
          type: integer
          default: 0
          description: Pagination offset
        limit:
          type: integer
          default: 20
          maximum: 100
          description: Maximum results to return
        pinnedOnly:
          type: boolean
          default: false
          description: Only return pinned versions

    ListVersionsResponse:
      type: object
      required: [versions, totalCount]
      properties:
        versions:
          type: array
          items:
            $ref: '#/components/schemas/VersionResponse'
          description: List of versions
        totalCount:
          type: integer
          description: Total version count in slot

    VersionResponse:
      type: object
      required: [versionNumber, contentHash, sizeBytes, createdAt]
      properties:
        versionNumber:
          type: integer
          description: Version number
        assetId:
          type: string
          format: uuid
          description: Reference to asset in lib-asset
        contentHash:
          type: string
          description: SHA-256 hash
        sizeBytes:
          type: integer
          format: int64
          description: Size in bytes
        compressedSizeBytes:
          type: integer
          format: int64
          description: Compressed size if applicable
        schemaVersion:
          type: string
          nullable: true
          description: Schema version
        displayName:
          type: string
          nullable: true
          description: Human-readable name
        pinned:
          type: boolean
          description: Whether version is pinned
        checkpointName:
          type: string
          nullable: true
          description: Checkpoint name if pinned
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Custom metadata

    PinVersionRequest:
      type: object
      required: [ownerId, ownerType, slotName, versionNumber]
      properties:
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name
        versionNumber:
          type: integer
          description: Version to pin
        checkpointName:
          type: string
          maxLength: 64
          description: Optional checkpoint name for easy retrieval

    UnpinVersionRequest:
      type: object
      required: [ownerId, ownerType, slotName, versionNumber]
      properties:
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name
        versionNumber:
          type: integer
          description: Version to unpin

    DeleteVersionRequest:
      type: object
      required: [ownerId, ownerType, slotName, versionNumber]
      properties:
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name
        versionNumber:
          type: integer
          description: Version to delete

    DeleteVersionResponse:
      type: object
      required: [deleted, bytesFreed]
      properties:
        deleted:
          type: boolean
          description: Whether version was deleted
        bytesFreed:
          type: integer
          format: int64
          description: Storage freed in bytes

    # ═══════════════════════════════════════════════════════════════════════════
    # QUERY MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    QuerySavesRequest:
      type: object
      properties:
        ownerId:
          type: string
          format: uuid
          description: Filter by owner ID
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        category:
          $ref: '#/components/schemas/SaveCategory'
        createdAfter:
          type: string
          format: date-time
          description: Filter by creation date
        createdBefore:
          type: string
          format: date-time
          description: Filter by creation date
        pinnedOnly:
          type: boolean
          description: Only return pinned versions
        schemaVersion:
          type: string
          description: Filter by schema version
        metadataFilter:
          type: object
          additionalProperties:
            type: string
          description: Filter by metadata key-value pairs
        offset:
          type: integer
          default: 0
          description: Pagination offset
        limit:
          type: integer
          default: 20
          maximum: 100
          description: Maximum results
        sortBy:
          type: string
          enum: [created_at, size, version_number]
          default: created_at
          description: Sort field
        sortOrder:
          type: string
          enum: [asc, desc]
          default: desc
          description: Sort order

    QuerySavesResponse:
      type: object
      required: [results, totalCount]
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/QueryResultItem'
          description: Query results
        totalCount:
          type: integer
          description: Total matching results

    QueryResultItem:
      type: object
      required: [slotId, slotName, ownerId, ownerType, category, versionNumber, createdAt]
      properties:
        slotId:
          type: string
          format: uuid
          description: Slot identifier
        slotName:
          type: string
          description: Slot name
        ownerId:
          type: string
          format: uuid
          description: Owner ID
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        category:
          $ref: '#/components/schemas/SaveCategory'
        versionNumber:
          type: integer
          description: Version number
        sizeBytes:
          type: integer
          format: int64
          description: Size in bytes
        schemaVersion:
          type: string
          nullable: true
          description: Schema version
        displayName:
          type: string
          nullable: true
          description: Display name
        pinned:
          type: boolean
          description: Whether pinned
        checkpointName:
          type: string
          nullable: true
          description: Checkpoint name
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Custom metadata

    # ═══════════════════════════════════════════════════════════════════════════
    # MIGRATION MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    MigrateSaveRequest:
      type: object
      required: [ownerId, ownerType, slotName, targetSchemaVersion]
      properties:
        ownerId:
          type: string
          format: uuid
          description: ID of the owning entity
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Slot name
        versionNumber:
          type: integer
          description: Specific version to migrate (defaults to latest)
        targetSchemaVersion:
          type: string
          description: Target schema version to migrate to
        dryRun:
          type: boolean
          default: false
          description: Validate migration without saving

    MigrateSaveResponse:
      type: object
      required: [success, fromSchemaVersion, toSchemaVersion]
      properties:
        success:
          type: boolean
          description: Whether migration succeeded
        fromSchemaVersion:
          type: string
          description: Original schema version
        toSchemaVersion:
          type: string
          description: Target schema version
        newVersionNumber:
          type: integer
          nullable: true
          description: New version number (null if dry run)
        migrationPath:
          type: array
          items:
            type: string
          description: Migration path applied (list of versions)
        warnings:
          type: array
          items:
            type: string
          description: Non-fatal migration warnings

    RegisterSchemaRequest:
      type: object
      required: [namespace, schemaVersion, schema]
      properties:
        namespace:
          type: string
          description: Schema namespace (e.g., game identifier)
        schemaVersion:
          type: string
          description: Schema version identifier
        schema:
          type: object
          description: JSON Schema definition for validation
        previousVersion:
          type: string
          nullable: true
          description: Previous version this migrates from
        migrationPatch:
          type: array
          nullable: true
          items:
            $ref: '#/components/schemas/JsonPatchOperation'
          description: |
            JSON Patch (RFC 6902) operations to migrate from previousVersion.
            Uses JsonPatch.Net library (MIT licensed).

    SchemaResponse:
      type: object
      required: [namespace, schemaVersion, createdAt]
      properties:
        namespace:
          type: string
          description: Schema namespace
        schemaVersion:
          type: string
          description: Schema version
        schema:
          type: object
          description: JSON Schema definition
        previousVersion:
          type: string
          nullable: true
          description: Previous version
        hasMigration:
          type: boolean
          description: Whether migration script is registered
        createdAt:
          type: string
          format: date-time
          description: Registration timestamp

    ListSchemasRequest:
      type: object
      required: [namespace]
      properties:
        namespace:
          type: string
          description: Schema namespace to list

    ListSchemasResponse:
      type: object
      required: [schemas]
      properties:
        schemas:
          type: array
          items:
            $ref: '#/components/schemas/SchemaResponse'
          description: Registered schemas
        latestVersion:
          type: string
          nullable: true
          description: Latest schema version

    # ═══════════════════════════════════════════════════════════════════════════
    # ADMIN MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    AdminCleanupRequest:
      type: object
      properties:
        dryRun:
          type: boolean
          default: true
          description: Preview cleanup without executing
        olderThanDays:
          type: integer
          description: Only cleanup versions older than N days
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        category:
          $ref: '#/components/schemas/SaveCategory'

    AdminCleanupResponse:
      type: object
      required: [versionsDeleted, bytesFreed, dryRun]
      properties:
        versionsDeleted:
          type: integer
          description: Number of versions deleted
        slotsDeleted:
          type: integer
          description: Number of empty slots deleted
        bytesFreed:
          type: integer
          format: int64
          description: Storage freed in bytes
        dryRun:
          type: boolean
          description: Whether this was a preview

    AdminStatsRequest:
      type: object
      properties:
        groupBy:
          type: string
          enum: [owner_type, category, schema_version]
          description: Group statistics by field

    AdminStatsResponse:
      type: object
      required: [totalSlots, totalVersions, totalSizeBytes]
      properties:
        totalSlots:
          type: integer
          description: Total slot count
        totalVersions:
          type: integer
          description: Total version count
        totalSizeBytes:
          type: integer
          format: int64
          description: Total storage used
        pinnedVersions:
          type: integer
          description: Number of pinned versions
        breakdown:
          type: array
          items:
            $ref: '#/components/schemas/StatsBreakdown'
          description: Breakdown by groupBy field

    StatsBreakdown:
      type: object
      required: [key, slots, versions, sizeBytes]
      properties:
        key:
          type: string
          description: Group key
        slots:
          type: integer
          description: Slot count
        versions:
          type: integer
          description: Version count
        sizeBytes:
          type: integer
          format: int64
          description: Storage used

    # ═══════════════════════════════════════════════════════════════════════════
    # ADDITIONAL ENDPOINT MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    RenameSlotRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName, newSlotName]
      properties:
        gameId:
          type: string
          description: Game identifier
        ownerId:
          type: string
          format: uuid
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
          description: Current slot name
        newSlotName:
          type: string
          minLength: 1
          maxLength: 64
          pattern: '^[a-z0-9]([a-z0-9-]*[a-z0-9])?$'
          description: New slot name

    BulkDeleteSlotsRequest:
      type: object
      required: [gameId, slotIds]
      properties:
        gameId:
          type: string
          description: Game identifier
        slotIds:
          type: array
          items:
            type: string
            format: uuid
          description: Slot IDs to delete

    BulkDeleteSlotsResponse:
      type: object
      required: [deletedCount, bytesFreed]
      properties:
        deletedCount:
          type: integer
          description: Number of slots deleted
        bytesFreed:
          type: integer
          format: int64
          description: Total storage freed

    CopySaveRequest:
      type: object
      required: [sourceGameId, sourceOwnerId, sourceOwnerType, sourceSlotName, targetGameId, targetOwnerId, 
          targetOwnerType, targetSlotName]
      properties:
        sourceGameId:
          type: string
        sourceOwnerId:
          type: string
          format: uuid
        sourceOwnerType:
          $ref: '#/components/schemas/OwnerType'
        sourceSlotName:
          type: string
        sourceVersion:
          type: integer
          nullable: true
          description: Version to copy (latest if null)
        targetGameId:
          type: string
        targetOwnerId:
          type: string
          format: uuid
        targetOwnerType:
          $ref: '#/components/schemas/OwnerType'
        targetSlotName:
          type: string
        targetCategory:
          $ref: '#/components/schemas/SaveCategory'
          description: Category for new slot if auto-created

    ExportSavesRequest:
      type: object
      required: [gameId, ownerId, ownerType]
      properties:
        gameId:
          type: string
        ownerId:
          type: string
          format: uuid
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotNames:
          type: array
          items:
            type: string
          description: Specific slots to export (all if null)

    ExportSavesResponse:
      type: object
      required: [downloadUrl, expiresAt, sizeBytes]
      properties:
        downloadUrl:
          type: string
          format: uri
          description: Pre-signed URL to download export archive
        expiresAt:
          type: string
          format: date-time
          description: When the download URL expires
        sizeBytes:
          type: integer
          format: int64
          description: Archive size

    ImportSavesRequest:
      type: object
      required: [archiveAssetId, targetGameId, targetOwnerId, targetOwnerType]
      properties:
        archiveAssetId:
          type: string
          format: uuid
          description: Asset ID of uploaded export archive
        targetGameId:
          type: string
        targetOwnerId:
          type: string
          format: uuid
        targetOwnerType:
          $ref: '#/components/schemas/OwnerType'
        conflictResolution:
          $ref: '#/components/schemas/ConflictResolution'
          description: How to handle existing slots

    ImportSavesResponse:
      type: object
      required: [importedSlots, importedVersions, skippedSlots]
      properties:
        importedSlots:
          type: integer
        importedVersions:
          type: integer
        skippedSlots:
          type: integer
          description: Slots skipped due to conflicts
        conflicts:
          type: array
          items:
            type: string
          description: Names of slots that had conflicts

    VerifyIntegrityRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName]
      properties:
        gameId:
          type: string
        ownerId:
          type: string
          format: uuid
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
        versionNumber:
          type: integer
          nullable: true
          description: Version to verify (latest if null)

    VerifyIntegrityResponse:
      type: object
      required: [valid, versionNumber]
      properties:
        valid:
          type: boolean
          description: Whether integrity check passed
        versionNumber:
          type: integer
          description: Version that was verified
        expectedHash:
          type: string
          description: Expected SHA-256 hash
        actualHash:
          type: string
          nullable: true
          description: Actual hash (null if data unavailable)
        errorMessage:
          type: string
          nullable: true
          description: Error details if verification failed

    PromoteVersionRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName, versionNumber]
      properties:
        gameId:
          type: string
        ownerId:
          type: string
          format: uuid
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
        versionNumber:
          type: integer
          description: Old version to promote to latest
        displayName:
          type: string
          nullable: true
          description: Display name for promoted version

    # ═══════════════════════════════════════════════════════════════════════════
    # DELTA SAVE MODELS
    # ═══════════════════════════════════════════════════════════════════════════

    DeltaAlgorithm:
      type: string
      enum: [JSON_PATCH, BSDIFF, XDELTA]
      default: JSON_PATCH
      description: |
        Algorithm used for delta computation.
        JSON_PATCH: RFC 6902, best for structured JSON data
        BSDIFF: Binary diff, good for general binary data
        XDELTA: RFC 3284 VCDIFF, efficient for large binary files

    SaveDeltaRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName, baseVersion, delta]
      properties:
        gameId:
          type: string
          description: Game identifier
        ownerId:
          type: string
          format: uuid
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
        baseVersion:
          type: integer
          description: Version number this delta is based on
        delta:
          type: string
          format: byte
          description: |
            Base64-encoded delta/patch data.
            For JSON_PATCH: Array of RFC 6902 operations
            For BSDIFF/XDELTA: Binary patch data
        algorithm:
          $ref: '#/components/schemas/DeltaAlgorithm'
        schemaVersion:
          type: string
          nullable: true
        displayName:
          type: string
          nullable: true
        deviceId:
          type: string
          nullable: true
        metadata:
          type: object
          additionalProperties:
            type: string

    SaveDeltaResponse:
      type: object
      required: [slotId, versionNumber, baseVersion, deltaSizeBytes, estimatedFullSizeBytes, createdAt]
      properties:
        slotId:
          type: string
          format: uuid
        versionNumber:
          type: integer
          description: New version number
        baseVersion:
          type: integer
          description: Base version this delta is relative to
        deltaSizeBytes:
          type: integer
          format: int64
          description: Size of stored delta
        estimatedFullSizeBytes:
          type: integer
          format: int64
          description: Estimated size when reconstructed
        chainLength:
          type: integer
          description: Number of deltas in chain to base snapshot
        compressionSavings:
          type: number
          format: double
          description: Storage savings vs full snapshot (0-1)
        createdAt:
          type: string
          format: date-time

    CollapseDeltasRequest:
      type: object
      required: [gameId, ownerId, ownerType, slotName]
      properties:
        gameId:
          type: string
        ownerId:
          type: string
          format: uuid
        ownerType:
          $ref: '#/components/schemas/OwnerType'
        slotName:
          type: string
        versionNumber:
          type: integer
          nullable: true
          description: Version to collapse to (latest if null)
        deleteIntermediates:
          type: boolean
          default: true
          description: Delete intermediate delta versions after collapse
