openapi: 3.0.3
info:
  title: Account Service Configuration
  description: |
    Configuration schema for Account service.
    Properties are bound to environment variables with BANNOU_ prefix.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 1.0.0
paths: {}
x-service-configuration:
  properties:
    # Admin Configuration
    AdminEmails:
      type: string
      nullable: true  # NRT: Optional config MUST be nullable
      description: Comma-separated list of admin email addresses
      env: ACCOUNT_ADMIN_EMAILS
      example: "admin@example.com,devops@example.com"
    AdminEmailDomain:
      type: string
      nullable: true  # NRT: Optional config MUST be nullable
      description: Email domain that grants admin access (e.g., "@company.com")
      env: ACCOUNT_ADMIN_EMAIL_DOMAIN
      example: "@admin.example.com"

    # Pagination Configuration
    DefaultPageSize:
      type: integer
      description: Default page size for list operations when not specified
      env: ACCOUNT_DEFAULT_PAGE_SIZE
      default: 20
    MaxPageSize:
      type: integer
      description: Maximum allowed page size for list operations
      env: ACCOUNT_MAX_PAGE_SIZE
      default: 100

    # Batch Processing Configuration
    ListBatchSize:
      type: integer
      description: Number of accounts to process per batch in list operations
      env: ACCOUNT_LIST_BATCH_SIZE
      default: 100

    # Role Management Configuration
    AutoManageAnonymousRole:
      type: boolean
      description: When true, automatically manages the anonymous role. If removing roles would leave zero roles, anonymous is added automatically. If adding a non-anonymous role, anonymous is removed if present. This ensures accounts always have at least one role for permission resolution.
      env: ACCOUNT_AUTO_MANAGE_ANONYMOUS_ROLE
      default: true
