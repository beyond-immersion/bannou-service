openapi: 3.0.3
info:
  title: Subscriptions Service Events
  description: Event models for subscriptions service RabbitMQ pub/sub via Dapr
  version: 1.0.0

paths: {}  # Events don't have HTTP paths

components:
  schemas:
    SubscriptionUpdatedEvent:
      type: object
      description: |
        Published when a subscription changes state (created, updated, cancelled, expired).
        Auth service subscribes to this event to update session authorizations.
      required:
        - eventId
        - timestamp
        - subscriptionId
        - accountId
        - serviceId
        - stubName
        - action
        - isActive
      properties:
        eventId:
          type: string
          format: uuid
          description: Unique identifier for this event
        timestamp:
          type: string
          format: date-time
          description: When the event occurred
        subscriptionId:
          type: string
          format: uuid
          description: ID of the subscription that changed
        accountId:
          type: string
          format: uuid
          description: ID of the account that owns the subscription
        serviceId:
          type: string
          format: uuid
          description: ID of the service (game) the subscription is for
        stubName:
          type: string
          description: Stub name of the service (e.g., "arcadia")
        displayName:
          type: string
          description: Display name of the service
        action:
          type: string
          enum: [created, updated, cancelled, expired, renewed]
          description: What action triggered this event
        isActive:
          type: boolean
          description: Whether the subscription is currently active
        expirationDate:
          type: string
          format: date-time
          nullable: true
          description: When the subscription expires (if applicable)
        previousValues:
          type: object
          description: Previous values for updated fields (for update action)
        newValues:
          type: object
          description: New values for updated fields (for update action)
