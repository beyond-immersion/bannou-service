openapi: 3.0.0
info:
  title: Music Theory Engine API
  version: 1.0.0
  description: |
    Pure computation music generation using formal music theory rules.

    **POST-Only API Pattern**: This API uses POST for all operations to support zero-copy
    WebSocket routing. Path parameters are passed in request bodies instead of URLs.
    See docs/BANNOU_DESIGN.md for architectural rationale.

    This API handles:
    - Deterministic MIDI-JSON generation from style configurations
    - Chord progression generation using harmonic functions
    - Melody generation with voice leading rules
    - Style management for genre-specific parameters (Celtic, Jazz, Baroque, etc.)

    **NRT Compliance**: AI agents MUST review docs/NRT-SCHEMA-RULES.md before modifying this schema. Optional reference types require `nullable: true`.

servers:
- url: http://localhost:5012
  description: Bannou service endpoint (internal only)

paths:
  /music/generate:
    post:
      summary: Generate composition from style and constraints
      description: |
        Generates a complete musical composition using the specified style definition
        and compositional constraints. Returns MIDI-JSON format output.
      operationId: GenerateComposition
      tags:
      - Generation
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateCompositionRequest'
      responses:
        '200':
          description: Composition generated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateCompositionResponse'
        '400':
          description: Invalid request or generation constraints
        '404':
          description: Style not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GenerateCompositionRequest\"\
        ,\n    \"$defs\": {\n        \"GenerateCompositionRequest\": {\n            \"description\": \"Request to generate
        a complete musical composition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"styleId\"\n            ],\n            \"properties\": {\n       \
        \         \"styleId\": {\n                    \"type\": \"string\",\n                    \"description\": \"ID of
        the style to use for generation\",\n                    \"example\": \"celtic\"\n                },\n            \
        \    \"durationBars\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 4,\n      \
        \              \"maximum\": 256,\n                    \"default\": 32,\n                    \"description\": \"Target
        duration in bars\"\n                },\n                \"key\": {\n                    \"$ref\": \"#/$defs/KeySignature\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Key signature (random if not specified)\"\
        \n                },\n                \"tempo\": {\n                    \"type\": \"integer\",\n                 \
        \   \"minimum\": 40,\n                    \"maximum\": 240,\n                    \"description\": \"Tempo in BPM (uses
        style default if not specified)\"\n                },\n                \"mood\": {\n                    \"type\":
        \"string\",\n                    \"enum\": [\n                        \"bright\",\n                        \"dark\"\
        ,\n                        \"neutral\",\n                        \"melancholic\",\n                        \"triumphant\"\
        \n                    ],\n                    \"nullable\": true,\n                    \"description\": \"Mood constraint
        for generation\"\n                },\n                \"tuneType\": {\n                    \"type\": \"string\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Style-specific tune type (e.g., \\\
        \"reel\\\", \\\"jig\\\" for Celtic)\",\n                    \"example\": \"reel\"\n                },\n          \
        \      \"seed\": {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n        \
        \            \"description\": \"Random seed for reproducible generation\"\n                }\n            }\n    \
        \    },\n        \"KeySignature\": {\n            \"description\": \"A key signature with tonic and mode\",\n    \
        \        \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n      \
        \          \"tonic\",\n                \"mode\"\n            ],\n            \"properties\": {\n                \"\
        tonic\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\": \"Tonic pitch
        class\"\n                },\n                \"mode\": {\n                    \"type\": \"string\",\n            \
        \        \"enum\": [\n                        \"major\",\n                        \"minor\",\n                   \
        \     \"dorian\",\n                        \"phrygian\",\n                        \"lydian\",\n                  \
        \      \"mixolydian\",\n                        \"aeolian\",\n                        \"locrian\"\n              \
        \      ],\n                    \"description\": \"Mode/scale type\"\n                }\n            }\n        },\n\
        \        \"PitchClass\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\",\n\
        \            \"description\": \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n \
        \           \"enum\": [\n                \"C\",\n                \"Cs\",\n                \"D\",\n               \
        \ \"Ds\",\n                \"E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n     \
        \           \"Gs\",\n                \"A\",\n                \"As\",\n                \"B\"\n            ]\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GenerateCompositionResponse\"\
        ,\n    \"$defs\": {\n        \"GenerateCompositionResponse\": {\n            \"description\": \"Response containing
        the generated composition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n  \
        \          \"required\": [\n                \"compositionId\",\n                \"midiJson\"\n            ],\n   \
        \         \"properties\": {\n                \"compositionId\": {\n                    \"type\": \"string\",\n   \
        \                 \"description\": \"Unique identifier for the composition\"\n                },\n               \
        \ \"midiJson\": {\n                    \"$ref\": \"#/$defs/MidiJson\",\n                    \"description\": \"Generated
        MIDI-JSON output\"\n                },\n                \"metadata\": {\n                    \"$ref\": \"#/$defs/CompositionMetadata\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Metadata about the generation\"\
        \n                },\n                \"generationTimeMs\": {\n                    \"type\": \"integer\",\n      \
        \              \"description\": \"Time taken to generate in milliseconds\"\n                }\n            }\n   \
        \     },\n        \"MidiJson\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiJson\"\
        ,\n            \"description\": \"MIDI-JSON format representation of a musical piece\",\n            \"type\": \"\
        object\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"tracks\",\n\
        \                \"ticksPerBeat\"\n            ],\n            \"properties\": {\n                \"header\": {\n\
        \                    \"$ref\": \"#/$defs/MidiHeader\",\n                    \"nullable\": true,\n                \
        \    \"description\": \"MIDI header information\"\n                },\n                \"ticksPerBeat\": {\n     \
        \               \"type\": \"integer\",\n                    \"minimum\": 24,\n                    \"maximum\": 960,\n\
        \                    \"default\": 480,\n                    \"description\": \"Ticks per beat (PPQN)\"\n         \
        \       },\n                \"tracks\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"$ref\": \"#/$defs/MidiTrack\"\n                    },\n                    \"description\"\
        : \"MIDI tracks\"\n                }\n            }\n        },\n        \"MidiHeader\": {\n            \"x-sdk-type\"\
        : \"BeyondImmersion.Bannou.MusicTheory.Output.MidiHeader\",\n            \"description\": \"MIDI file header information\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"format\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n\
        \                    \"maximum\": 2,\n                    \"default\": 1,\n                    \"description\": \"\
        MIDI format type (0, 1, or 2)\"\n                },\n                \"name\": {\n                    \"type\": \"\
        string\",\n                    \"nullable\": true,\n                    \"description\": \"Composition name\"\n  \
        \              },\n                \"tempos\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"$ref\": \"#/$defs/TempoEvent\"\n                    },\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Tempo changes\"\n                },\n              \
        \  \"timeSignatures\": {\n                    \"type\": \"array\",\n                    \"items\": {\n           \
        \             \"$ref\": \"#/$defs/TimeSignatureEvent\"\n                    },\n                    \"nullable\":
        true,\n                    \"description\": \"Time signature changes\"\n                },\n                \"keySignatures\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/KeySignatureEvent\"\n                    },\n                    \"nullable\": true,\n               \
        \     \"description\": \"Key signature changes\"\n                }\n            }\n        },\n        \"TempoEvent\"\
        : {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.TempoEvent\",\n            \"description\"\
        : \"A tempo change event\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n   \
        \         \"required\": [\n                \"tick\",\n                \"bpm\"\n            ],\n            \"properties\"\
        : {\n                \"tick\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n\
        \                    \"description\": \"Tick position\"\n                },\n                \"bpm\": {\n        \
        \            \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 20,\n\
        \                    \"maximum\": 400,\n                    \"description\": \"Tempo in BPM\"\n                }\n\
        \            }\n        },\n        \"TimeSignatureEvent\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.TimeSignatureEvent\"\
        ,\n            \"description\": \"A time signature change event\",\n            \"type\": \"object\",\n          \
        \  \"additionalProperties\": false,\n            \"required\": [\n                \"tick\",\n                \"numerator\"\
        ,\n                \"denominator\"\n            ],\n            \"properties\": {\n                \"tick\": {\n \
        \                   \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\"\
        : \"Tick position\"\n                },\n                \"numerator\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beats per measure\"\n                },\n                \"denominator\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beat unit (4 = quarter, 8 = eighth)\"\n                }\n            }\n        },\n        \"KeySignatureEvent\"\
        : {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.KeySignatureEvent\",\n            \"\
        description\": \"A key signature change event\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"tick\",\n                \"tonic\",\n                \"mode\"\
        \n            ],\n            \"properties\": {\n                \"tick\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 0,\n                    \"description\": \"Tick position\"\n                },\n\
        \                \"tonic\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\"\
        : \"Tonic pitch class\"\n                },\n                \"mode\": {\n                    \"$ref\": \"#/$defs/ModeType\"\
        ,\n                    \"description\": \"Mode/scale type\"\n                }\n            }\n        },\n      \
        \  \"PitchClass\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\",\n     \
        \       \"description\": \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n      \
        \      \"enum\": [\n                \"C\",\n                \"Cs\",\n                \"D\",\n                \"Ds\"\
        ,\n                \"E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n             \
        \   \"Gs\",\n                \"A\",\n                \"As\",\n                \"B\"\n            ]\n        },\n \
        \       \"ModeType\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Collections.ModeType\",\n\
        \            \"description\": \"Musical mode/scale type\",\n            \"type\": \"string\",\n            \"enum\"\
        : [\n                \"Major\",\n                \"Minor\",\n                \"Dorian\",\n                \"Phrygian\"\
        ,\n                \"Lydian\",\n                \"Mixolydian\",\n                \"Aeolian\",\n                \"\
        Locrian\",\n                \"HarmonicMinor\",\n                \"MelodicMinor\",\n                \"MajorPentatonic\"\
        ,\n                \"MinorPentatonic\",\n                \"Blues\",\n                \"WholeTone\",\n            \
        \    \"Chromatic\"\n            ]\n        },\n        \"MidiTrack\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiTrack\"\
        ,\n            \"description\": \"A single MIDI track containing events\",\n            \"type\": \"object\",\n  \
        \          \"additionalProperties\": false,\n            \"required\": [\n                \"events\"\n           \
        \ ],\n            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n    \
        \                \"nullable\": true,\n                    \"description\": \"Track name\"\n                },\n  \
        \              \"channel\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n \
        \                   \"maximum\": 15,\n                    \"default\": 0,\n                    \"description\": \"\
        MIDI channel\"\n                },\n                \"instrument\": {\n                    \"type\": \"integer\",\n\
        \                    \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"nullable\": true,\n\
        \                    \"description\": \"GM instrument number\"\n                },\n                \"events\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"\
        #/$defs/MidiEvent\"\n                    },\n                    \"description\": \"Track events\"\n             \
        \   }\n            }\n        },\n        \"MidiEvent\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiEvent\"\
        ,\n            \"description\": \"A single MIDI event\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"tick\",\n                \"type\"\n            ],\n     \
        \       \"properties\": {\n                \"tick\": {\n                    \"type\": \"integer\",\n             \
        \       \"minimum\": 0,\n                    \"description\": \"Absolute tick position\"\n                },\n   \
        \             \"type\": {\n                    \"$ref\": \"#/$defs/MidiEventType\",\n                    \"description\"\
        : \"Event type\"\n                },\n                \"note\": {\n                    \"type\": \"integer\",\n  \
        \                  \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"nullable\": true,\n\
        \                    \"description\": \"MIDI note number (for note events)\"\n                },\n               \
        \ \"velocity\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n             \
        \       \"maximum\": 127,\n                    \"nullable\": true,\n                    \"description\": \"Note velocity
        (for note events)\"\n                },\n                \"duration\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Note duration in ticks (for noteOn with implicit noteOff)\"\n                },\n                \"program\":
        {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"maximum\"\
        : 127,\n                    \"nullable\": true,\n                    \"description\": \"Program number (for programChange)\"\
        \n                },\n                \"controller\": {\n                    \"type\": \"integer\",\n            \
        \        \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"nullable\": true,\n       \
        \             \"description\": \"Controller number (for controlChange)\"\n                },\n                \"value\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"maximum\"\
        : 127,\n                    \"nullable\": true,\n                    \"description\": \"Controller value (for controlChange)\"\
        \n                }\n            }\n        },\n        \"MidiEventType\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiEventType\"\
        ,\n            \"description\": \"MIDI event type\",\n            \"type\": \"string\",\n            \"enum\": [\n\
        \                \"NoteOn\",\n                \"NoteOff\",\n                \"ProgramChange\",\n                \"\
        ControlChange\"\n            ]\n        },\n        \"CompositionMetadata\": {\n            \"description\": \"Metadata
        about a generated composition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"properties\": {\n                \"styleId\": {\n                    \"type\": \"string\",\n      \
        \              \"nullable\": true,\n                    \"description\": \"Style used\"\n                },\n    \
        \            \"key\": {\n                    \"$ref\": \"#/$defs/KeySignature\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Key signature\"\n                },\n                \"tempo\": {\n\
        \                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Tempo in BPM\"\n                },\n                \"bars\": {\n                    \"type\": \"integer\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Number of bars\"\n              \
        \  },\n                \"tuneType\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Tune type if applicable\"\n                },\n                \"\
        seed\": {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n                 \
        \   \"description\": \"Random seed used\"\n                }\n            }\n        },\n        \"KeySignature\"\
        : {\n            \"description\": \"A key signature with tonic and mode\",\n            \"type\": \"object\",\n  \
        \          \"additionalProperties\": false,\n            \"required\": [\n                \"tonic\",\n           \
        \     \"mode\"\n            ],\n            \"properties\": {\n                \"tonic\": {\n                    \"\
        $ref\": \"#/$defs/PitchClass\",\n                    \"description\": \"Tonic pitch class\"\n                },\n\
        \                \"mode\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n       \
        \                 \"major\",\n                        \"minor\",\n                        \"dorian\",\n          \
        \              \"phrygian\",\n                        \"lydian\",\n                        \"mixolydian\",\n     \
        \                   \"aeolian\",\n                        \"locrian\"\n                    ],\n                  \
        \  \"description\": \"Mode/scale type\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Generate composition from style and constraints\",\n    \"description\"\
        : \"Generates a complete musical composition using the specified style definition\\nand compositional constraints.
        Returns MIDI-JSON format output.\\n\",\n    \"tags\": [\n        \"Generation\"\n    ],\n    \"deprecated\": false,\n\
        \    \"operationId\": \"GenerateComposition\"\n}"
  /music/validate:
    post:
      summary: Validate MIDI-JSON structure
      description: |
        Validates a MIDI-JSON structure for correctness including note ranges,
        timing, and format compliance.
      operationId: ValidateMidiJson
      tags:
      - Validation
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ValidateMidiJsonRequest'
      responses:
        '200':
          description: Validation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidateMidiJsonResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ValidateMidiJsonRequest\"\
        ,\n    \"$defs\": {\n        \"ValidateMidiJsonRequest\": {\n            \"description\": \"Request to validate MIDI-JSON
        structure\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"midiJson\"\n            ],\n            \"properties\": {\n                \"midiJson\": {\n\
        \                    \"$ref\": \"#/$defs/MidiJson\",\n                    \"description\": \"MIDI-JSON structure to
        validate\"\n                },\n                \"strictMode\": {\n                    \"type\": \"boolean\",\n  \
        \                  \"default\": false,\n                    \"description\": \"Enable strict validation with additional
        checks\"\n                }\n            }\n        },\n        \"MidiJson\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiJson\"\
        ,\n            \"description\": \"MIDI-JSON format representation of a musical piece\",\n            \"type\": \"\
        object\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"tracks\",\n\
        \                \"ticksPerBeat\"\n            ],\n            \"properties\": {\n                \"header\": {\n\
        \                    \"$ref\": \"#/$defs/MidiHeader\",\n                    \"nullable\": true,\n                \
        \    \"description\": \"MIDI header information\"\n                },\n                \"ticksPerBeat\": {\n     \
        \               \"type\": \"integer\",\n                    \"minimum\": 24,\n                    \"maximum\": 960,\n\
        \                    \"default\": 480,\n                    \"description\": \"Ticks per beat (PPQN)\"\n         \
        \       },\n                \"tracks\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"$ref\": \"#/$defs/MidiTrack\"\n                    },\n                    \"description\"\
        : \"MIDI tracks\"\n                }\n            }\n        },\n        \"MidiHeader\": {\n            \"x-sdk-type\"\
        : \"BeyondImmersion.Bannou.MusicTheory.Output.MidiHeader\",\n            \"description\": \"MIDI file header information\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"format\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n\
        \                    \"maximum\": 2,\n                    \"default\": 1,\n                    \"description\": \"\
        MIDI format type (0, 1, or 2)\"\n                },\n                \"name\": {\n                    \"type\": \"\
        string\",\n                    \"nullable\": true,\n                    \"description\": \"Composition name\"\n  \
        \              },\n                \"tempos\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"$ref\": \"#/$defs/TempoEvent\"\n                    },\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Tempo changes\"\n                },\n              \
        \  \"timeSignatures\": {\n                    \"type\": \"array\",\n                    \"items\": {\n           \
        \             \"$ref\": \"#/$defs/TimeSignatureEvent\"\n                    },\n                    \"nullable\":
        true,\n                    \"description\": \"Time signature changes\"\n                },\n                \"keySignatures\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/KeySignatureEvent\"\n                    },\n                    \"nullable\": true,\n               \
        \     \"description\": \"Key signature changes\"\n                }\n            }\n        },\n        \"TempoEvent\"\
        : {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.TempoEvent\",\n            \"description\"\
        : \"A tempo change event\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n   \
        \         \"required\": [\n                \"tick\",\n                \"bpm\"\n            ],\n            \"properties\"\
        : {\n                \"tick\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n\
        \                    \"description\": \"Tick position\"\n                },\n                \"bpm\": {\n        \
        \            \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 20,\n\
        \                    \"maximum\": 400,\n                    \"description\": \"Tempo in BPM\"\n                }\n\
        \            }\n        },\n        \"TimeSignatureEvent\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.TimeSignatureEvent\"\
        ,\n            \"description\": \"A time signature change event\",\n            \"type\": \"object\",\n          \
        \  \"additionalProperties\": false,\n            \"required\": [\n                \"tick\",\n                \"numerator\"\
        ,\n                \"denominator\"\n            ],\n            \"properties\": {\n                \"tick\": {\n \
        \                   \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\"\
        : \"Tick position\"\n                },\n                \"numerator\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beats per measure\"\n                },\n                \"denominator\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beat unit (4 = quarter, 8 = eighth)\"\n                }\n            }\n        },\n        \"KeySignatureEvent\"\
        : {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.KeySignatureEvent\",\n            \"\
        description\": \"A key signature change event\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"tick\",\n                \"tonic\",\n                \"mode\"\
        \n            ],\n            \"properties\": {\n                \"tick\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 0,\n                    \"description\": \"Tick position\"\n                },\n\
        \                \"tonic\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\"\
        : \"Tonic pitch class\"\n                },\n                \"mode\": {\n                    \"$ref\": \"#/$defs/ModeType\"\
        ,\n                    \"description\": \"Mode/scale type\"\n                }\n            }\n        },\n      \
        \  \"PitchClass\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\",\n     \
        \       \"description\": \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n      \
        \      \"enum\": [\n                \"C\",\n                \"Cs\",\n                \"D\",\n                \"Ds\"\
        ,\n                \"E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n             \
        \   \"Gs\",\n                \"A\",\n                \"As\",\n                \"B\"\n            ]\n        },\n \
        \       \"ModeType\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Collections.ModeType\",\n\
        \            \"description\": \"Musical mode/scale type\",\n            \"type\": \"string\",\n            \"enum\"\
        : [\n                \"Major\",\n                \"Minor\",\n                \"Dorian\",\n                \"Phrygian\"\
        ,\n                \"Lydian\",\n                \"Mixolydian\",\n                \"Aeolian\",\n                \"\
        Locrian\",\n                \"HarmonicMinor\",\n                \"MelodicMinor\",\n                \"MajorPentatonic\"\
        ,\n                \"MinorPentatonic\",\n                \"Blues\",\n                \"WholeTone\",\n            \
        \    \"Chromatic\"\n            ]\n        },\n        \"MidiTrack\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiTrack\"\
        ,\n            \"description\": \"A single MIDI track containing events\",\n            \"type\": \"object\",\n  \
        \          \"additionalProperties\": false,\n            \"required\": [\n                \"events\"\n           \
        \ ],\n            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n    \
        \                \"nullable\": true,\n                    \"description\": \"Track name\"\n                },\n  \
        \              \"channel\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n \
        \                   \"maximum\": 15,\n                    \"default\": 0,\n                    \"description\": \"\
        MIDI channel\"\n                },\n                \"instrument\": {\n                    \"type\": \"integer\",\n\
        \                    \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"nullable\": true,\n\
        \                    \"description\": \"GM instrument number\"\n                },\n                \"events\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"\
        #/$defs/MidiEvent\"\n                    },\n                    \"description\": \"Track events\"\n             \
        \   }\n            }\n        },\n        \"MidiEvent\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiEvent\"\
        ,\n            \"description\": \"A single MIDI event\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"tick\",\n                \"type\"\n            ],\n     \
        \       \"properties\": {\n                \"tick\": {\n                    \"type\": \"integer\",\n             \
        \       \"minimum\": 0,\n                    \"description\": \"Absolute tick position\"\n                },\n   \
        \             \"type\": {\n                    \"$ref\": \"#/$defs/MidiEventType\",\n                    \"description\"\
        : \"Event type\"\n                },\n                \"note\": {\n                    \"type\": \"integer\",\n  \
        \                  \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"nullable\": true,\n\
        \                    \"description\": \"MIDI note number (for note events)\"\n                },\n               \
        \ \"velocity\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n             \
        \       \"maximum\": 127,\n                    \"nullable\": true,\n                    \"description\": \"Note velocity
        (for note events)\"\n                },\n                \"duration\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Note duration in ticks (for noteOn with implicit noteOff)\"\n                },\n                \"program\":
        {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"maximum\"\
        : 127,\n                    \"nullable\": true,\n                    \"description\": \"Program number (for programChange)\"\
        \n                },\n                \"controller\": {\n                    \"type\": \"integer\",\n            \
        \        \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"nullable\": true,\n       \
        \             \"description\": \"Controller number (for controlChange)\"\n                },\n                \"value\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"maximum\"\
        : 127,\n                    \"nullable\": true,\n                    \"description\": \"Controller value (for controlChange)\"\
        \n                }\n            }\n        },\n        \"MidiEventType\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.MidiEventType\"\
        ,\n            \"description\": \"MIDI event type\",\n            \"type\": \"string\",\n            \"enum\": [\n\
        \                \"NoteOn\",\n                \"NoteOff\",\n                \"ProgramChange\",\n                \"\
        ControlChange\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ValidateMidiJsonResponse\"\
        ,\n    \"$defs\": {\n        \"ValidateMidiJsonResponse\": {\n            \"description\": \"Response containing validation
        results\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"isValid\"\n            ],\n            \"properties\": {\n                \"isValid\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"Whether the MIDI-JSON is valid\"\
        \n                },\n                \"errors\": {\n                    \"type\": \"array\",\n                  \
        \  \"items\": {\n                        \"$ref\": \"#/$defs/ValidationError\"\n                    },\n         \
        \           \"nullable\": true,\n                    \"description\": \"Validation errors if invalid\"\n         \
        \       },\n                \"warnings\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Non-fatal warnings\"\n                }\n            }\n        },\n     \
        \   \"ValidationError\": {\n            \"description\": \"A validation error\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"type\",\n        \
        \        \"message\"\n            ],\n            \"properties\": {\n                \"type\": {\n               \
        \     \"type\": \"string\",\n                    \"enum\": [\n                        \"structure\",\n           \
        \             \"range\",\n                        \"timing\",\n                        \"format\"\n              \
        \      ],\n                    \"description\": \"Error type\"\n                },\n                \"message\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Error message\"\n             \
        \   },\n                \"path\": {\n                    \"type\": \"string\",\n                    \"nullable\":
        true,\n                    \"description\": \"Path to problematic element\"\n                }\n            }\n  \
        \      }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Validate MIDI-JSON structure\",\n    \"description\": \"Validates a MIDI-JSON
        structure for correctness including note ranges,\\ntiming, and format compliance.\\n\",\n    \"tags\": [\n       \
        \ \"Validation\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"ValidateMidiJson\"\n}"
  /music/style/get:
    post:
      summary: Get style definition
      description: |
        Retrieves a style definition by ID or name. Styles define mode preferences,
        interval rules, form templates, and genre-specific parameters.
      operationId: GetStyle
      tags:
      - Styles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetStyleRequest'
      responses:
        '200':
          description: Style retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StyleDefinitionResponse'
        '404':
          description: Style not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetStyleRequest\"\
        ,\n    \"$defs\": {\n        \"GetStyleRequest\": {\n            \"description\": \"Request to get a style definition\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"styleId\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Style ID to retrieve\"\n                },\n                \"styleName\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Style name to retrieve (alternative to ID)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/StyleDefinitionResponse\"\
        ,\n    \"$defs\": {\n        \"StyleDefinitionResponse\": {\n            \"description\": \"Response containing a
        style definition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n           \
        \ \"required\": [\n                \"styleId\",\n                \"name\",\n                \"category\"\n       \
        \     ],\n            \"properties\": {\n                \"styleId\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Unique style identifier\"\n                },\n                \"name\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Style name\"\n            \
        \    },\n                \"category\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Style category\"\n                },\n                \"description\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Human-readable description\"\n\
        \                },\n                \"modeDistribution\": {\n                    \"$ref\": \"#/$defs/ModeDistribution\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Mode probability distribution\"\
        \n                },\n                \"intervalPreferences\": {\n                    \"$ref\": \"#/$defs/IntervalPreferences\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Interval preferences\"\n      \
        \          },\n                \"formTemplates\": {\n                    \"type\": \"array\",\n                  \
        \  \"items\": {\n                        \"$ref\": \"#/$defs/FormTemplate\"\n                    },\n            \
        \        \"nullable\": true,\n                    \"description\": \"Available forms\"\n                },\n     \
        \           \"tuneTypes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n       \
        \                 \"$ref\": \"#/$defs/TuneType\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Style-specific tune types\"\n                },\n                \"defaultTempo\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Default tempo\"\n        \
        \        },\n                \"harmonyStyle\": {\n                    \"$ref\": \"#/$defs/HarmonyStyle\",\n      \
        \              \"nullable\": true,\n                    \"description\": \"Harmony preferences\"\n               \
        \ }\n            }\n        },\n        \"ModeDistribution\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Style.ModeDistribution\"\
        ,\n            \"description\": \"Probability distribution over musical modes\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"major\": {\n   \
        \                 \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\"\
        : 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n                    \"description\"\
        : \"Probability of major mode\"\n                },\n                \"minor\": {\n                    \"type\": \"\
        number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                   \
        \ \"maximum\": 1.0,\n                    \"default\": 0.0,\n                    \"description\": \"Probability of
        natural minor\"\n                },\n                \"dorian\": {\n                    \"type\": \"number\",\n  \
        \                  \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.0,\n                    \"description\": \"Probability of dorian mode\"\
        \n                },\n                \"phrygian\": {\n                    \"type\": \"number\",\n               \
        \     \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n     \
        \               \"default\": 0.0,\n                    \"description\": \"Probability of phrygian mode\"\n       \
        \         },\n                \"lydian\": {\n                    \"type\": \"number\",\n                    \"format\"\
        : \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"\
        default\": 0.0,\n                    \"description\": \"Probability of lydian mode\"\n                },\n       \
        \         \"mixolydian\": {\n                    \"type\": \"number\",\n                    \"format\": \"float\"\
        ,\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\":
        0.0,\n                    \"description\": \"Probability of mixolydian mode\"\n                },\n              \
        \  \"aeolian\": {\n                    \"type\": \"number\",\n                    \"format\": \"float\",\n       \
        \             \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n  \
        \                  \"description\": \"Probability of aeolian mode\"\n                },\n                \"locrian\"\
        : {\n                    \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"\
        minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n                  \
        \  \"description\": \"Probability of locrian mode\"\n                }\n            }\n        },\n        \"IntervalPreferences\"\
        : {\n            \"description\": \"Melodic interval preference weights\",\n            \"type\": \"object\",\n  \
        \          \"additionalProperties\": false,\n            \"properties\": {\n                \"stepWeight\": {\n  \
        \                  \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\"\
        : 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.5,\n                    \"description\"\
        : \"Weight for stepwise motion (M2, m2)\"\n                },\n                \"thirdWeight\": {\n              \
        \      \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n\
        \                    \"maximum\": 1.0,\n                    \"default\": 0.25,\n                    \"description\"\
        : \"Weight for thirds (M3, m3)\"\n                },\n                \"leapWeight\": {\n                    \"type\"\
        : \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n               \
        \     \"maximum\": 1.0,\n                    \"default\": 0.15,\n                    \"description\": \"Weight for
        larger leaps (P4, P5)\"\n                },\n                \"largeLeapWeight\": {\n                    \"type\"\
        : \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n               \
        \     \"maximum\": 1.0,\n                    \"default\": 0.1,\n                    \"description\": \"Weight for
        leaps larger than P5\"\n                }\n            }\n        },\n        \"FormTemplate\": {\n            \"\
        description\": \"A musical form structure template\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"name\",\n                \"sections\"\n            ],\n \
        \           \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n          \
        \          \"description\": \"Form name (e.g., \\\"AABB\\\", \\\"verse-chorus\\\")\"\n                },\n       \
        \         \"sections\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"string\"\n                    },\n                    \"description\": \"Section sequence
        (e.g., [\\\"A\\\", \\\"A\\\", \\\"B\\\", \\\"B\\\"])\"\n                },\n                \"barsPerSection\": {\n\
        \                    \"type\": \"integer\",\n                    \"minimum\": 1,\n                    \"maximum\"\
        : 64,\n                    \"default\": 8,\n                    \"description\": \"Default bars per section\"\n  \
        \              }\n            }\n        },\n        \"TuneType\": {\n            \"description\": \"A style-specific
        tune type definition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n       \
        \     \"required\": [\n                \"name\",\n                \"meter\"\n            ],\n            \"properties\"\
        : {\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\":
        \"Tune type name (e.g., \\\"reel\\\", \\\"jig\\\")\"\n                },\n                \"meter\": {\n         \
        \           \"$ref\": \"#/$defs/TimeSignatureEvent\",\n                    \"description\": \"Time signature for this
        tune type\"\n                },\n                \"tempoRange\": {\n                    \"$ref\": \"#/$defs/TempoRange\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Typical tempo range\"\n       \
        \         },\n                \"defaultForm\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Default form for this tune type\"\n                },\n\
        \                \"rhythmPatterns\": {\n                    \"type\": \"array\",\n                    \"items\": {\n\
        \                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n \
        \                   \"description\": \"Rhythm pattern names to use\"\n                }\n            }\n        },\n\
        \        \"TimeSignatureEvent\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.TimeSignatureEvent\"\
        ,\n            \"description\": \"A time signature change event\",\n            \"type\": \"object\",\n          \
        \  \"additionalProperties\": false,\n            \"required\": [\n                \"tick\",\n                \"numerator\"\
        ,\n                \"denominator\"\n            ],\n            \"properties\": {\n                \"tick\": {\n \
        \                   \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\"\
        : \"Tick position\"\n                },\n                \"numerator\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beats per measure\"\n                },\n                \"denominator\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beat unit (4 = quarter, 8 = eighth)\"\n                }\n            }\n        },\n        \"TempoRange\": {\n\
        \            \"description\": \"A tempo range with min and max BPM\",\n            \"type\": \"object\",\n       \
        \     \"additionalProperties\": false,\n            \"required\": [\n                \"min\",\n                \"\
        max\"\n            ],\n            \"properties\": {\n                \"min\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 20,\n                    \"maximum\": 400,\n                    \"description\"\
        : \"Minimum tempo\"\n                },\n                \"max\": {\n                    \"type\": \"integer\",\n\
        \                    \"minimum\": 20,\n                    \"maximum\": 400,\n                    \"description\"\
        : \"Maximum tempo\"\n                }\n            }\n        },\n        \"HarmonyStyle\": {\n            \"description\"\
        : \"Harmonic progression style preferences\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"primaryCadence\": {\n                    \"type\": \"string\"\
        ,\n                    \"enum\": [\n                        \"authentic\",\n                        \"plagal\",\n\
        \                        \"half\",\n                        \"deceptive\"\n                    ],\n              \
        \      \"default\": \"authentic\",\n                    \"description\": \"Most common cadence type\"\n          \
        \      },\n                \"dominantPrepProbability\": {\n                    \"type\": \"number\",\n           \
        \         \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n \
        \                   \"default\": 0.6,\n                    \"description\": \"Probability of pre-dominant before dominant\"\
        \n                },\n                \"secondaryDominantProbability\": {\n                    \"type\": \"number\"\
        ,\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.3,\n                    \"description\": \"Probability of secondary dominants\"\
        \n                },\n                \"modalInterchangeProbability\": {\n                    \"type\": \"number\"\
        ,\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.1,\n                    \"description\": \"Probability of borrowed chords\"\
        \n                },\n                \"commonProgressions\": {\n                    \"type\": \"array\",\n      \
        \              \"items\": {\n                        \"type\": \"string\"\n                    },\n              \
        \      \"nullable\": true,\n                    \"description\": \"Common chord progressions as roman numeral strings\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get style definition\",\n    \"description\": \"Retrieves a style definition
        by ID or name. Styles define mode preferences,\\ninterval rules, form templates, and genre-specific parameters.\\\
        n\",\n    \"tags\": [\n        \"Styles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"GetStyle\"\n\
        }"
  /music/style/list:
    post:
      summary: List available styles
      description: |
        Lists all available style definitions with optional filtering by category.
      operationId: ListStyles
      tags:
      - Styles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListStylesRequest'
      responses:
        '200':
          description: Styles listed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListStylesResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListStylesRequest\"\
        ,\n    \"$defs\": {\n        \"ListStylesRequest\": {\n            \"description\": \"Request to list available styles\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"category\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Filter by category (e.g., \\\"folk\\\", \\\"classical\\\", \\\"jazz\\\")\"\
        \n                },\n                \"limit\": {\n                    \"type\": \"integer\",\n                 \
        \   \"minimum\": 1,\n                    \"maximum\": 100,\n                    \"default\": 50,\n               \
        \     \"description\": \"Maximum number of styles to return\"\n                },\n                \"offset\": {\n\
        \                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"default\"\
        : 0,\n                    \"description\": \"Pagination offset\"\n                }\n            }\n        }\n  \
        \  }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListStylesResponse\"\
        ,\n    \"$defs\": {\n        \"ListStylesResponse\": {\n            \"description\": \"Response containing a list
        of styles\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"styles\",\n                \"total\"\n            ],\n            \"properties\": {\n     \
        \           \"styles\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"$ref\": \"#/$defs/StyleSummary\"\n                    },\n                    \"description\": \"\
        Style summaries\"\n                },\n                \"total\": {\n                    \"type\": \"integer\",\n\
        \                    \"description\": \"Total number of styles matching filter\"\n                }\n            }\n\
        \        },\n        \"StyleSummary\": {\n            \"description\": \"Brief style summary for listing\",\n    \
        \        \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n      \
        \          \"styleId\",\n                \"name\",\n                \"category\"\n            ],\n            \"properties\"\
        : {\n                \"styleId\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Style identifier\"\n                },\n                \"name\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Style name\"\n                },\n                \"category\": {\n    \
        \                \"type\": \"string\",\n                    \"description\": \"Style category\"\n                },\n\
        \                \"description\": {\n                    \"type\": \"string\",\n                    \"nullable\":
        true,\n                    \"description\": \"Brief description\"\n                }\n            }\n        }\n \
        \   }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List available styles\",\n    \"description\": \"Lists all available style
        definitions with optional filtering by category.\\n\",\n    \"tags\": [\n        \"Styles\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"ListStyles\"\n}"
  /music/style/create:
    post:
      summary: Create new style definition
      description: |
        Creates a new style definition. Only accessible to admin users.
      operationId: CreateStyle
      tags:
      - Styles
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateStyleRequest'
      responses:
        '200':
          description: Style created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StyleDefinitionResponse'
        '400':
          description: Invalid style definition
        '409':
          description: Style with this name already exists

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateStyleRequest\"\
        ,\n    \"$defs\": {\n        \"CreateStyleRequest\": {\n            \"description\": \"Request to create a new style
        definition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"name\",\n                \"category\",\n                \"modeDistribution\"\n            ],\n\
        \            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n         \
        \           \"description\": \"Unique style name\",\n                    \"example\": \"celtic\"\n               \
        \ },\n                \"category\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Style category\",\n                    \"example\": \"folk\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Human-readable style description\"\n                },\n                \"modeDistribution\": {\n            \
        \        \"$ref\": \"#/$defs/ModeDistribution\",\n                    \"description\": \"Probability distribution
        over modes\"\n                },\n                \"intervalPreferences\": {\n                    \"$ref\": \"#/$defs/IntervalPreferences\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Preferred interval patterns\"\n\
        \                },\n                \"formTemplates\": {\n                    \"type\": \"array\",\n            \
        \        \"items\": {\n                        \"$ref\": \"#/$defs/FormTemplate\"\n                    },\n      \
        \              \"nullable\": true,\n                    \"description\": \"Available form structures\"\n         \
        \       },\n                \"rhythmPatterns\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"$ref\": \"#/$defs/RhythmPattern\"\n                    },\n                \
        \    \"nullable\": true,\n                    \"description\": \"Common rhythm patterns\"\n                },\n  \
        \              \"tuneTypes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n    \
        \                    \"$ref\": \"#/$defs/TuneType\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Style-specific tune types\"\n                },\n                \"defaultTempo\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 40,\n                    \"maximum\"\
        : 240,\n                    \"description\": \"Default tempo for this style\"\n                },\n              \
        \  \"harmonyStyle\": {\n                    \"$ref\": \"#/$defs/HarmonyStyle\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Harmonic progression preferences\"\n                }\n          \
        \  }\n        },\n        \"ModeDistribution\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Style.ModeDistribution\"\
        ,\n            \"description\": \"Probability distribution over musical modes\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"major\": {\n   \
        \                 \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\"\
        : 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n                    \"description\"\
        : \"Probability of major mode\"\n                },\n                \"minor\": {\n                    \"type\": \"\
        number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                   \
        \ \"maximum\": 1.0,\n                    \"default\": 0.0,\n                    \"description\": \"Probability of
        natural minor\"\n                },\n                \"dorian\": {\n                    \"type\": \"number\",\n  \
        \                  \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.0,\n                    \"description\": \"Probability of dorian mode\"\
        \n                },\n                \"phrygian\": {\n                    \"type\": \"number\",\n               \
        \     \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n     \
        \               \"default\": 0.0,\n                    \"description\": \"Probability of phrygian mode\"\n       \
        \         },\n                \"lydian\": {\n                    \"type\": \"number\",\n                    \"format\"\
        : \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"\
        default\": 0.0,\n                    \"description\": \"Probability of lydian mode\"\n                },\n       \
        \         \"mixolydian\": {\n                    \"type\": \"number\",\n                    \"format\": \"float\"\
        ,\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\":
        0.0,\n                    \"description\": \"Probability of mixolydian mode\"\n                },\n              \
        \  \"aeolian\": {\n                    \"type\": \"number\",\n                    \"format\": \"float\",\n       \
        \             \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n  \
        \                  \"description\": \"Probability of aeolian mode\"\n                },\n                \"locrian\"\
        : {\n                    \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"\
        minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n                  \
        \  \"description\": \"Probability of locrian mode\"\n                }\n            }\n        },\n        \"IntervalPreferences\"\
        : {\n            \"description\": \"Melodic interval preference weights\",\n            \"type\": \"object\",\n  \
        \          \"additionalProperties\": false,\n            \"properties\": {\n                \"stepWeight\": {\n  \
        \                  \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\"\
        : 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.5,\n                    \"description\"\
        : \"Weight for stepwise motion (M2, m2)\"\n                },\n                \"thirdWeight\": {\n              \
        \      \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n\
        \                    \"maximum\": 1.0,\n                    \"default\": 0.25,\n                    \"description\"\
        : \"Weight for thirds (M3, m3)\"\n                },\n                \"leapWeight\": {\n                    \"type\"\
        : \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n               \
        \     \"maximum\": 1.0,\n                    \"default\": 0.15,\n                    \"description\": \"Weight for
        larger leaps (P4, P5)\"\n                },\n                \"largeLeapWeight\": {\n                    \"type\"\
        : \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n               \
        \     \"maximum\": 1.0,\n                    \"default\": 0.1,\n                    \"description\": \"Weight for
        leaps larger than P5\"\n                }\n            }\n        },\n        \"FormTemplate\": {\n            \"\
        description\": \"A musical form structure template\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"name\",\n                \"sections\"\n            ],\n \
        \           \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n          \
        \          \"description\": \"Form name (e.g., \\\"AABB\\\", \\\"verse-chorus\\\")\"\n                },\n       \
        \         \"sections\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"string\"\n                    },\n                    \"description\": \"Section sequence
        (e.g., [\\\"A\\\", \\\"A\\\", \\\"B\\\", \\\"B\\\"])\"\n                },\n                \"barsPerSection\": {\n\
        \                    \"type\": \"integer\",\n                    \"minimum\": 1,\n                    \"maximum\"\
        : 64,\n                    \"default\": 8,\n                    \"description\": \"Default bars per section\"\n  \
        \              }\n            }\n        },\n        \"RhythmPattern\": {\n            \"description\": \"A rhythmic
        pattern with note durations\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"name\",\n                \"pattern\"\n            ],\n           \
        \ \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"Pattern name\"\n                },\n                \"pattern\": {\n                    \"type\"\
        : \"array\",\n                    \"items\": {\n                        \"type\": \"number\",\n                  \
        \      \"format\": \"float\"\n                    },\n                    \"description\": \"Relative durations (1.0
        = beat)\"\n                },\n                \"weight\": {\n                    \"type\": \"number\",\n        \
        \            \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n\
        \                    \"default\": 1.0,\n                    \"description\": \"Selection weight\"\n              \
        \  }\n            }\n        },\n        \"TuneType\": {\n            \"description\": \"A style-specific tune type
        definition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"name\",\n                \"meter\"\n            ],\n            \"properties\": {\n       \
        \         \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"Tune type
        name (e.g., \\\"reel\\\", \\\"jig\\\")\"\n                },\n                \"meter\": {\n                    \"\
        $ref\": \"#/$defs/TimeSignatureEvent\",\n                    \"description\": \"Time signature for this tune type\"\
        \n                },\n                \"tempoRange\": {\n                    \"$ref\": \"#/$defs/TempoRange\",\n \
        \                   \"nullable\": true,\n                    \"description\": \"Typical tempo range\"\n          \
        \      },\n                \"defaultForm\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Default form for this tune type\"\n                },\n          \
        \      \"rhythmPatterns\": {\n                    \"type\": \"array\",\n                    \"items\": {\n       \
        \                 \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n        \
        \            \"description\": \"Rhythm pattern names to use\"\n                }\n            }\n        },\n    \
        \    \"TimeSignatureEvent\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.TimeSignatureEvent\"\
        ,\n            \"description\": \"A time signature change event\",\n            \"type\": \"object\",\n          \
        \  \"additionalProperties\": false,\n            \"required\": [\n                \"tick\",\n                \"numerator\"\
        ,\n                \"denominator\"\n            ],\n            \"properties\": {\n                \"tick\": {\n \
        \                   \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\"\
        : \"Tick position\"\n                },\n                \"numerator\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beats per measure\"\n                },\n                \"denominator\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beat unit (4 = quarter, 8 = eighth)\"\n                }\n            }\n        },\n        \"TempoRange\": {\n\
        \            \"description\": \"A tempo range with min and max BPM\",\n            \"type\": \"object\",\n       \
        \     \"additionalProperties\": false,\n            \"required\": [\n                \"min\",\n                \"\
        max\"\n            ],\n            \"properties\": {\n                \"min\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 20,\n                    \"maximum\": 400,\n                    \"description\"\
        : \"Minimum tempo\"\n                },\n                \"max\": {\n                    \"type\": \"integer\",\n\
        \                    \"minimum\": 20,\n                    \"maximum\": 400,\n                    \"description\"\
        : \"Maximum tempo\"\n                }\n            }\n        },\n        \"HarmonyStyle\": {\n            \"description\"\
        : \"Harmonic progression style preferences\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"primaryCadence\": {\n                    \"type\": \"string\"\
        ,\n                    \"enum\": [\n                        \"authentic\",\n                        \"plagal\",\n\
        \                        \"half\",\n                        \"deceptive\"\n                    ],\n              \
        \      \"default\": \"authentic\",\n                    \"description\": \"Most common cadence type\"\n          \
        \      },\n                \"dominantPrepProbability\": {\n                    \"type\": \"number\",\n           \
        \         \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n \
        \                   \"default\": 0.6,\n                    \"description\": \"Probability of pre-dominant before dominant\"\
        \n                },\n                \"secondaryDominantProbability\": {\n                    \"type\": \"number\"\
        ,\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.3,\n                    \"description\": \"Probability of secondary dominants\"\
        \n                },\n                \"modalInterchangeProbability\": {\n                    \"type\": \"number\"\
        ,\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.1,\n                    \"description\": \"Probability of borrowed chords\"\
        \n                },\n                \"commonProgressions\": {\n                    \"type\": \"array\",\n      \
        \              \"items\": {\n                        \"type\": \"string\"\n                    },\n              \
        \      \"nullable\": true,\n                    \"description\": \"Common chord progressions as roman numeral strings\"\
        \n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/StyleDefinitionResponse\"\
        ,\n    \"$defs\": {\n        \"StyleDefinitionResponse\": {\n            \"description\": \"Response containing a
        style definition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n           \
        \ \"required\": [\n                \"styleId\",\n                \"name\",\n                \"category\"\n       \
        \     ],\n            \"properties\": {\n                \"styleId\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Unique style identifier\"\n                },\n                \"name\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Style name\"\n            \
        \    },\n                \"category\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Style category\"\n                },\n                \"description\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Human-readable description\"\n\
        \                },\n                \"modeDistribution\": {\n                    \"$ref\": \"#/$defs/ModeDistribution\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Mode probability distribution\"\
        \n                },\n                \"intervalPreferences\": {\n                    \"$ref\": \"#/$defs/IntervalPreferences\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Interval preferences\"\n      \
        \          },\n                \"formTemplates\": {\n                    \"type\": \"array\",\n                  \
        \  \"items\": {\n                        \"$ref\": \"#/$defs/FormTemplate\"\n                    },\n            \
        \        \"nullable\": true,\n                    \"description\": \"Available forms\"\n                },\n     \
        \           \"tuneTypes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n       \
        \                 \"$ref\": \"#/$defs/TuneType\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Style-specific tune types\"\n                },\n                \"defaultTempo\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Default tempo\"\n        \
        \        },\n                \"harmonyStyle\": {\n                    \"$ref\": \"#/$defs/HarmonyStyle\",\n      \
        \              \"nullable\": true,\n                    \"description\": \"Harmony preferences\"\n               \
        \ }\n            }\n        },\n        \"ModeDistribution\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Style.ModeDistribution\"\
        ,\n            \"description\": \"Probability distribution over musical modes\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"major\": {\n   \
        \                 \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\"\
        : 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n                    \"description\"\
        : \"Probability of major mode\"\n                },\n                \"minor\": {\n                    \"type\": \"\
        number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                   \
        \ \"maximum\": 1.0,\n                    \"default\": 0.0,\n                    \"description\": \"Probability of
        natural minor\"\n                },\n                \"dorian\": {\n                    \"type\": \"number\",\n  \
        \                  \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.0,\n                    \"description\": \"Probability of dorian mode\"\
        \n                },\n                \"phrygian\": {\n                    \"type\": \"number\",\n               \
        \     \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n     \
        \               \"default\": 0.0,\n                    \"description\": \"Probability of phrygian mode\"\n       \
        \         },\n                \"lydian\": {\n                    \"type\": \"number\",\n                    \"format\"\
        : \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"\
        default\": 0.0,\n                    \"description\": \"Probability of lydian mode\"\n                },\n       \
        \         \"mixolydian\": {\n                    \"type\": \"number\",\n                    \"format\": \"float\"\
        ,\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\":
        0.0,\n                    \"description\": \"Probability of mixolydian mode\"\n                },\n              \
        \  \"aeolian\": {\n                    \"type\": \"number\",\n                    \"format\": \"float\",\n       \
        \             \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n  \
        \                  \"description\": \"Probability of aeolian mode\"\n                },\n                \"locrian\"\
        : {\n                    \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"\
        minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.0,\n                  \
        \  \"description\": \"Probability of locrian mode\"\n                }\n            }\n        },\n        \"IntervalPreferences\"\
        : {\n            \"description\": \"Melodic interval preference weights\",\n            \"type\": \"object\",\n  \
        \          \"additionalProperties\": false,\n            \"properties\": {\n                \"stepWeight\": {\n  \
        \                  \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\"\
        : 0.0,\n                    \"maximum\": 1.0,\n                    \"default\": 0.5,\n                    \"description\"\
        : \"Weight for stepwise motion (M2, m2)\"\n                },\n                \"thirdWeight\": {\n              \
        \      \"type\": \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n\
        \                    \"maximum\": 1.0,\n                    \"default\": 0.25,\n                    \"description\"\
        : \"Weight for thirds (M3, m3)\"\n                },\n                \"leapWeight\": {\n                    \"type\"\
        : \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n               \
        \     \"maximum\": 1.0,\n                    \"default\": 0.15,\n                    \"description\": \"Weight for
        larger leaps (P4, P5)\"\n                },\n                \"largeLeapWeight\": {\n                    \"type\"\
        : \"number\",\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n               \
        \     \"maximum\": 1.0,\n                    \"default\": 0.1,\n                    \"description\": \"Weight for
        leaps larger than P5\"\n                }\n            }\n        },\n        \"FormTemplate\": {\n            \"\
        description\": \"A musical form structure template\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"name\",\n                \"sections\"\n            ],\n \
        \           \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n          \
        \          \"description\": \"Form name (e.g., \\\"AABB\\\", \\\"verse-chorus\\\")\"\n                },\n       \
        \         \"sections\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"string\"\n                    },\n                    \"description\": \"Section sequence
        (e.g., [\\\"A\\\", \\\"A\\\", \\\"B\\\", \\\"B\\\"])\"\n                },\n                \"barsPerSection\": {\n\
        \                    \"type\": \"integer\",\n                    \"minimum\": 1,\n                    \"maximum\"\
        : 64,\n                    \"default\": 8,\n                    \"description\": \"Default bars per section\"\n  \
        \              }\n            }\n        },\n        \"TuneType\": {\n            \"description\": \"A style-specific
        tune type definition\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n       \
        \     \"required\": [\n                \"name\",\n                \"meter\"\n            ],\n            \"properties\"\
        : {\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\":
        \"Tune type name (e.g., \\\"reel\\\", \\\"jig\\\")\"\n                },\n                \"meter\": {\n         \
        \           \"$ref\": \"#/$defs/TimeSignatureEvent\",\n                    \"description\": \"Time signature for this
        tune type\"\n                },\n                \"tempoRange\": {\n                    \"$ref\": \"#/$defs/TempoRange\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Typical tempo range\"\n       \
        \         },\n                \"defaultForm\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Default form for this tune type\"\n                },\n\
        \                \"rhythmPatterns\": {\n                    \"type\": \"array\",\n                    \"items\": {\n\
        \                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n \
        \                   \"description\": \"Rhythm pattern names to use\"\n                }\n            }\n        },\n\
        \        \"TimeSignatureEvent\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Output.TimeSignatureEvent\"\
        ,\n            \"description\": \"A time signature change event\",\n            \"type\": \"object\",\n          \
        \  \"additionalProperties\": false,\n            \"required\": [\n                \"tick\",\n                \"numerator\"\
        ,\n                \"denominator\"\n            ],\n            \"properties\": {\n                \"tick\": {\n \
        \                   \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\"\
        : \"Tick position\"\n                },\n                \"numerator\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beats per measure\"\n                },\n                \"denominator\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 1,\n                    \"maximum\": 32,\n                    \"description\"\
        : \"Beat unit (4 = quarter, 8 = eighth)\"\n                }\n            }\n        },\n        \"TempoRange\": {\n\
        \            \"description\": \"A tempo range with min and max BPM\",\n            \"type\": \"object\",\n       \
        \     \"additionalProperties\": false,\n            \"required\": [\n                \"min\",\n                \"\
        max\"\n            ],\n            \"properties\": {\n                \"min\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 20,\n                    \"maximum\": 400,\n                    \"description\"\
        : \"Minimum tempo\"\n                },\n                \"max\": {\n                    \"type\": \"integer\",\n\
        \                    \"minimum\": 20,\n                    \"maximum\": 400,\n                    \"description\"\
        : \"Maximum tempo\"\n                }\n            }\n        },\n        \"HarmonyStyle\": {\n            \"description\"\
        : \"Harmonic progression style preferences\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"primaryCadence\": {\n                    \"type\": \"string\"\
        ,\n                    \"enum\": [\n                        \"authentic\",\n                        \"plagal\",\n\
        \                        \"half\",\n                        \"deceptive\"\n                    ],\n              \
        \      \"default\": \"authentic\",\n                    \"description\": \"Most common cadence type\"\n          \
        \      },\n                \"dominantPrepProbability\": {\n                    \"type\": \"number\",\n           \
        \         \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n \
        \                   \"default\": 0.6,\n                    \"description\": \"Probability of pre-dominant before dominant\"\
        \n                },\n                \"secondaryDominantProbability\": {\n                    \"type\": \"number\"\
        ,\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.3,\n                    \"description\": \"Probability of secondary dominants\"\
        \n                },\n                \"modalInterchangeProbability\": {\n                    \"type\": \"number\"\
        ,\n                    \"format\": \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\"\
        : 1.0,\n                    \"default\": 0.1,\n                    \"description\": \"Probability of borrowed chords\"\
        \n                },\n                \"commonProgressions\": {\n                    \"type\": \"array\",\n      \
        \              \"items\": {\n                        \"type\": \"string\"\n                    },\n              \
        \      \"nullable\": true,\n                    \"description\": \"Common chord progressions as roman numeral strings\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Create new style definition\",\n    \"description\": \"Creates a new style
        definition. Only accessible to admin users.\\n\",\n    \"tags\": [\n        \"Styles\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"CreateStyle\"\n}"
  /music/theory/progression:
    post:
      summary: Generate chord progression
      description: |
        Generates a chord progression using harmonic function theory.
        Supports multiple harmonic styles including functional harmony,
        modal interchange, and jazz voicings.
      operationId: GenerateProgression
      tags:
      - Theory
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateProgressionRequest'
      responses:
        '200':
          description: Progression generated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateProgressionResponse'
        '400':
          description: Invalid request

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GenerateProgressionRequest\"\
        ,\n    \"$defs\": {\n        \"GenerateProgressionRequest\": {\n            \"description\": \"Request to generate
        a chord progression\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n        \
        \    \"required\": [\n                \"key\",\n                \"length\"\n            ],\n            \"properties\"\
        : {\n                \"key\": {\n                    \"$ref\": \"#/$defs/KeySignature\",\n                    \"description\"\
        : \"Key for the progression\"\n                },\n                \"length\": {\n                    \"type\": \"\
        integer\",\n                    \"minimum\": 2,\n                    \"maximum\": 64,\n                    \"description\"\
        : \"Number of chords in the progression\"\n                },\n                \"styleId\": {\n                  \
        \  \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Style to
        use for harmonic preferences\"\n                },\n                \"startChord\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Starting chord (roman
        numeral, e.g., \\\"I\\\")\"\n                },\n                \"endChord\": {\n                    \"type\": \"\
        string\",\n                    \"nullable\": true,\n                    \"description\": \"Ending chord (roman numeral,
        e.g., \\\"I\\\")\"\n                },\n                \"cadenceType\": {\n                    \"type\": \"string\"\
        ,\n                    \"enum\": [\n                        \"authentic\",\n                        \"half\",\n  \
        \                      \"plagal\",\n                        \"deceptive\"\n                    ],\n              \
        \      \"nullable\": true,\n                    \"description\": \"Cadence type for ending\"\n                },\n\
        \                \"allowSecondaryDominants\": {\n                    \"type\": \"boolean\",\n                    \"\
        default\": true,\n                    \"description\": \"Allow secondary dominant chords\"\n                },\n \
        \               \"allowModalInterchange\": {\n                    \"type\": \"boolean\",\n                    \"default\"\
        : false,\n                    \"description\": \"Allow borrowed chords from parallel modes\"\n                },\n\
        \                \"seed\": {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Random seed for reproducibility\"\n                }\n            }\n    \
        \    },\n        \"KeySignature\": {\n            \"description\": \"A key signature with tonic and mode\",\n    \
        \        \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n      \
        \          \"tonic\",\n                \"mode\"\n            ],\n            \"properties\": {\n                \"\
        tonic\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\": \"Tonic pitch
        class\"\n                },\n                \"mode\": {\n                    \"type\": \"string\",\n            \
        \        \"enum\": [\n                        \"major\",\n                        \"minor\",\n                   \
        \     \"dorian\",\n                        \"phrygian\",\n                        \"lydian\",\n                  \
        \      \"mixolydian\",\n                        \"aeolian\",\n                        \"locrian\"\n              \
        \      ],\n                    \"description\": \"Mode/scale type\"\n                }\n            }\n        },\n\
        \        \"PitchClass\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\",\n\
        \            \"description\": \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n \
        \           \"enum\": [\n                \"C\",\n                \"Cs\",\n                \"D\",\n               \
        \ \"Ds\",\n                \"E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n     \
        \           \"Gs\",\n                \"A\",\n                \"As\",\n                \"B\"\n            ]\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GenerateProgressionResponse\"\
        ,\n    \"$defs\": {\n        \"GenerateProgressionResponse\": {\n            \"description\": \"Response containing
        a generated chord progression\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"chords\"\n            ],\n            \"properties\": {\n        \
        \        \"chords\": {\n                    \"type\": \"array\",\n                    \"items\": {\n             \
        \           \"$ref\": \"#/$defs/ChordEvent\"\n                    },\n                    \"description\": \"Generated
        chord events\"\n                },\n                \"analysis\": {\n                    \"$ref\": \"#/$defs/ProgressionAnalysis\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Analysis of the progression\"\n\
        \                }\n            }\n        },\n        \"ChordEvent\": {\n            \"description\": \"A chord with
        timing information\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n         \
        \   \"required\": [\n                \"chord\",\n                \"startTick\",\n                \"durationTicks\"\
        \n            ],\n            \"properties\": {\n                \"chord\": {\n                    \"$ref\": \"#/$defs/ChordSymbol\"\
        ,\n                    \"description\": \"Chord symbol\"\n                },\n                \"startTick\": {\n \
        \                   \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\"\
        : \"Start position in ticks\"\n                },\n                \"durationTicks\": {\n                    \"type\"\
        : \"integer\",\n                    \"minimum\": 1,\n                    \"description\": \"Duration in ticks\"\n\
        \                },\n                \"romanNumeral\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"Roman numeral analysis (e.g., \\\"IV\\\", \\\"\
        V7\\\")\"\n                }\n            }\n        },\n        \"ChordSymbol\": {\n            \"description\":
        \"A chord symbol with root and quality\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"root\",\n                \"quality\"\n            ],\n  \
        \          \"properties\": {\n                \"root\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n\
        \                    \"description\": \"Chord root\"\n                },\n                \"quality\": {\n       \
        \             \"type\": \"string\",\n                    \"enum\": [\n                        \"major\",\n       \
        \                 \"minor\",\n                        \"diminished\",\n                        \"augmented\",\n  \
        \                      \"dominant7\",\n                        \"major7\",\n                        \"minor7\",\n\
        \                        \"diminished7\",\n                        \"halfDiminished7\",\n                        \"\
        augmented7\",\n                        \"sus2\",\n                        \"sus4\"\n                    ],\n     \
        \               \"description\": \"Chord quality\"\n                },\n                \"bass\": {\n            \
        \        \"$ref\": \"#/$defs/PitchClass\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Bass note (for inversions/slash chords)\"\n                },\n                \"extensions\": {\n           \
        \         \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n \
        \                   },\n                    \"nullable\": true,\n                    \"description\": \"Chord extensions
        (e.g., \\\"9\\\", \\\"11\\\", \\\"13\\\")\"\n                }\n            }\n        },\n        \"PitchClass\"\
        : {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\",\n            \"description\"\
        : \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n            \"enum\": [\n    \
        \            \"C\",\n                \"Cs\",\n                \"D\",\n                \"Ds\",\n                \"\
        E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n                \"Gs\",\n         \
        \       \"A\",\n                \"As\",\n                \"B\"\n            ]\n        },\n        \"ProgressionAnalysis\"\
        : {\n            \"description\": \"Analysis of a chord progression\",\n            \"type\": \"object\",\n      \
        \      \"additionalProperties\": false,\n            \"properties\": {\n                \"romanNumerals\": {\n   \
        \                 \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\
        \n                    },\n                    \"nullable\": true,\n                    \"description\": \"Roman numeral
        analysis\"\n                },\n                \"cadences\": {\n                    \"type\": \"array\",\n      \
        \              \"items\": {\n                        \"$ref\": \"#/$defs/CadenceInfo\"\n                    },\n \
        \                   \"nullable\": true,\n                    \"description\": \"Detected cadences\"\n            \
        \    },\n                \"functionalAnalysis\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\",\n                        \"enum\": [\n             \
        \               \"tonic\",\n                            \"subdominant\",\n                            \"dominant\"\
        ,\n                            \"predominant\"\n                        ]\n                    },\n              \
        \      \"nullable\": true,\n                    \"description\": \"Functional analysis per chord\"\n             \
        \   }\n            }\n        },\n        \"CadenceInfo\": {\n            \"description\": \"Information about a cadence\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"type\",\n                \"position\"\n            ],\n            \"properties\": {\n        \
        \        \"type\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n               \
        \         \"authentic\",\n                        \"half\",\n                        \"plagal\",\n               \
        \         \"deceptive\"\n                    ],\n                    \"description\": \"Cadence type\"\n         \
        \       },\n                \"position\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Chord index where cadence ends\"\n                },\n                \"strength\": {\n                    \"\
        type\": \"string\",\n                    \"enum\": [\n                        \"perfect\",\n                     \
        \   \"imperfect\"\n                    ],\n                    \"nullable\": true,\n                    \"description\"\
        : \"Cadence strength\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Generate chord progression\",\n    \"description\": \"Generates a chord
        progression using harmonic function theory.\\nSupports multiple harmonic styles including functional harmony,\\nmodal
        interchange, and jazz voicings.\\n\",\n    \"tags\": [\n        \"Theory\"\n    ],\n    \"deprecated\": false,\n \
        \   \"operationId\": \"GenerateProgression\"\n}"
  /music/theory/melody:
    post:
      summary: Generate melody over harmony
      description: |
        Generates a melodic line over a chord progression using contour rules,
        interval preferences, and rhythmic patterns from the specified style.
      operationId: GenerateMelody
      tags:
      - Theory
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateMelodyRequest'
      responses:
        '200':
          description: Melody generated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateMelodyResponse'
        '400':
          description: Invalid request

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GenerateMelodyRequest\"\
        ,\n    \"$defs\": {\n        \"GenerateMelodyRequest\": {\n            \"description\": \"Request to generate a melody
        over harmony\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"harmony\"\n            ],\n            \"properties\": {\n                \"harmony\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"\
        #/$defs/ChordEvent\"\n                    },\n                    \"description\": \"Chord progression to generate
        melody over\"\n                },\n                \"styleId\": {\n                    \"type\": \"string\",\n   \
        \                 \"nullable\": true,\n                    \"description\": \"Style for melodic preferences\"\n  \
        \              },\n                \"range\": {\n                    \"$ref\": \"#/$defs/PitchRange\",\n         \
        \           \"nullable\": true,\n                    \"description\": \"Pitch range for the melody\"\n           \
        \     },\n                \"contour\": {\n                    \"type\": \"string\",\n                    \"enum\"\
        : [\n                        \"arch\",\n                        \"wave\",\n                        \"ascending\",\n\
        \                        \"descending\",\n                        \"static\"\n                    ],\n           \
        \         \"nullable\": true,\n                    \"description\": \"Overall melodic contour\"\n                },\n\
        \                \"rhythmDensity\": {\n                    \"type\": \"number\",\n                    \"format\":
        \"float\",\n                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Note density (0=sparse, 1=dense)\"\n                },\n         \
        \       \"syncopation\": {\n                    \"type\": \"number\",\n                    \"format\": \"float\",\n\
        \                    \"minimum\": 0.0,\n                    \"maximum\": 1.0,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Amount of syncopation\"\n                },\n                \"seed\": {\n\
        \                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Random seed for reproducibility\"\n                }\n            }\n        },\n        \"ChordEvent\": {\n \
        \           \"description\": \"A chord with timing information\",\n            \"type\": \"object\",\n           \
        \ \"additionalProperties\": false,\n            \"required\": [\n                \"chord\",\n                \"startTick\"\
        ,\n                \"durationTicks\"\n            ],\n            \"properties\": {\n                \"chord\": {\n\
        \                    \"$ref\": \"#/$defs/ChordSymbol\",\n                    \"description\": \"Chord symbol\"\n \
        \               },\n                \"startTick\": {\n                    \"type\": \"integer\",\n               \
        \     \"minimum\": 0,\n                    \"description\": \"Start position in ticks\"\n                },\n    \
        \            \"durationTicks\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n\
        \                    \"description\": \"Duration in ticks\"\n                },\n                \"romanNumeral\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Roman numeral analysis (e.g., \\\"IV\\\", \\\"V7\\\")\"\n                }\n            }\n        },\n      \
        \  \"ChordSymbol\": {\n            \"description\": \"A chord symbol with root and quality\",\n            \"type\"\
        : \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"root\"\
        ,\n                \"quality\"\n            ],\n            \"properties\": {\n                \"root\": {\n     \
        \               \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\": \"Chord root\"\n         \
        \       },\n                \"quality\": {\n                    \"type\": \"string\",\n                    \"enum\"\
        : [\n                        \"major\",\n                        \"minor\",\n                        \"diminished\"\
        ,\n                        \"augmented\",\n                        \"dominant7\",\n                        \"major7\"\
        ,\n                        \"minor7\",\n                        \"diminished7\",\n                        \"halfDiminished7\"\
        ,\n                        \"augmented7\",\n                        \"sus2\",\n                        \"sus4\"\n\
        \                    ],\n                    \"description\": \"Chord quality\"\n                },\n            \
        \    \"bass\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Bass note (for inversions/slash chords)\"\n                },\n          \
        \      \"extensions\": {\n                    \"type\": \"array\",\n                    \"items\": {\n           \
        \             \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n            \
        \        \"description\": \"Chord extensions (e.g., \\\"9\\\", \\\"11\\\", \\\"13\\\")\"\n                }\n    \
        \        }\n        },\n        \"PitchClass\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\"\
        ,\n            \"description\": \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n\
        \            \"enum\": [\n                \"C\",\n                \"Cs\",\n                \"D\",\n              \
        \  \"Ds\",\n                \"E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n    \
        \            \"Gs\",\n                \"A\",\n                \"As\",\n                \"B\"\n            ]\n    \
        \    },\n        \"PitchRange\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchRange\"\
        ,\n            \"description\": \"A pitch range from low to high\",\n            \"type\": \"object\",\n         \
        \   \"additionalProperties\": false,\n            \"required\": [\n                \"low\",\n                \"high\"\
        \n            ],\n            \"properties\": {\n                \"low\": {\n                    \"$ref\": \"#/$defs/Pitch\"\
        ,\n                    \"description\": \"Lowest pitch (inclusive)\"\n                },\n                \"high\"\
        : {\n                    \"$ref\": \"#/$defs/Pitch\",\n                    \"description\": \"Highest pitch (inclusive)\"\
        \n                }\n            }\n        },\n        \"Pitch\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.Pitch\"\
        ,\n            \"description\": \"A specific pitch with pitch class and octave\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"pitchClass\",\n  \
        \              \"octave\"\n            ],\n            \"properties\": {\n                \"pitchClass\": {\n    \
        \                \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\": \"Pitch class (note name)\"\
        \n                },\n                \"octave\": {\n                    \"type\": \"integer\",\n                \
        \    \"minimum\": 0,\n                    \"maximum\": 9,\n                    \"description\": \"Octave number (middle
        C = C4)\"\n                },\n                \"midiNumber\": {\n                    \"type\": \"integer\",\n   \
        \                 \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"description\": \"\
        MIDI note number (computed if not provided)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GenerateMelodyResponse\"\
        ,\n    \"$defs\": {\n        \"GenerateMelodyResponse\": {\n            \"description\": \"Response containing a generated
        melody\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"notes\"\n            ],\n            \"properties\": {\n                \"notes\": {\n    \
        \                \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/NoteEvent\"\
        \n                    },\n                    \"description\": \"Generated note events\"\n                },\n   \
        \             \"analysis\": {\n                    \"$ref\": \"#/$defs/MelodyAnalysis\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Analysis of the melody\"\n                }\n            }\n     \
        \   },\n        \"NoteEvent\": {\n            \"description\": \"A musical note event with timing and pitch\",\n \
        \           \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n   \
        \             \"pitch\",\n                \"startTick\",\n                \"durationTicks\"\n            ],\n    \
        \        \"properties\": {\n                \"pitch\": {\n                    \"$ref\": \"#/$defs/Pitch\",\n     \
        \               \"description\": \"Note pitch\"\n                },\n                \"startTick\": {\n          \
        \          \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\": \"Start
        position in ticks\"\n                },\n                \"durationTicks\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"description\": \"Duration in ticks\"\n             \
        \   },\n                \"velocity\": {\n                    \"type\": \"integer\",\n                    \"minimum\"\
        : 1,\n                    \"maximum\": 127,\n                    \"default\": 80,\n                    \"description\"\
        : \"Note velocity\"\n                }\n            }\n        },\n        \"Pitch\": {\n            \"x-sdk-type\"\
        : \"BeyondImmersion.Bannou.MusicTheory.Pitch.Pitch\",\n            \"description\": \"A specific pitch with pitch
        class and octave\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n           \
        \ \"required\": [\n                \"pitchClass\",\n                \"octave\"\n            ],\n            \"properties\"\
        : {\n                \"pitchClass\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n                  \
        \  \"description\": \"Pitch class (note name)\"\n                },\n                \"octave\": {\n             \
        \       \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"maximum\": 9,\n       \
        \             \"description\": \"Octave number (middle C = C4)\"\n                },\n                \"midiNumber\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"maximum\"\
        : 127,\n                    \"description\": \"MIDI note number (computed if not provided)\"\n                }\n\
        \            }\n        },\n        \"PitchClass\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\"\
        ,\n            \"description\": \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n\
        \            \"enum\": [\n                \"C\",\n                \"Cs\",\n                \"D\",\n              \
        \  \"Ds\",\n                \"E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n    \
        \            \"Gs\",\n                \"A\",\n                \"As\",\n                \"B\"\n            ]\n    \
        \    },\n        \"MelodyAnalysis\": {\n            \"description\": \"Analysis of a melody\",\n            \"type\"\
        : \"object\",\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"range\"\
        : {\n                    \"$ref\": \"#/$defs/PitchRange\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"Pitch range used\"\n                },\n                \"intervalDistribution\": {\n\
        \                    \"type\": \"object\",\n                    \"additionalProperties\": {\n                    \
        \    \"type\": \"number\",\n                        \"format\": \"float\"\n                    },\n              \
        \      \"nullable\": true,\n                    \"description\": \"Distribution of interval sizes\"\n            \
        \    },\n                \"contour\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Detected contour shape\"\n                },\n                \"noteCount\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Total number of notes\"\n\
        \                },\n                \"averageNoteDuration\": {\n                    \"type\": \"number\",\n     \
        \               \"format\": \"float\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Average note duration in ticks\"\n                }\n            }\n        },\n        \"PitchRange\": {\n  \
        \          \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchRange\",\n            \"description\":
        \"A pitch range from low to high\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"low\",\n                \"high\"\n            ],\n            \"properties\"\
        : {\n                \"low\": {\n                    \"$ref\": \"#/$defs/Pitch\",\n                    \"description\"\
        : \"Lowest pitch (inclusive)\"\n                },\n                \"high\": {\n                    \"$ref\": \"\
        #/$defs/Pitch\",\n                    \"description\": \"Highest pitch (inclusive)\"\n                }\n        \
        \    }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Generate melody over harmony\",\n    \"description\": \"Generates a melodic
        line over a chord progression using contour rules,\\ninterval preferences, and rhythmic patterns from the specified
        style.\\n\",\n    \"tags\": [\n        \"Theory\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"GenerateMelody\"\
        \n}"
  /music/theory/voice-lead:
    post:
      summary: Apply voice leading to chords
      description: |
        Applies voice leading rules to a chord sequence, ensuring smooth
        part-writing according to traditional or style-specific rules.
      operationId: ApplyVoiceLeading
      tags:
      - Theory
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VoiceLeadRequest'
      responses:
        '200':
          description: Voice leading applied successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VoiceLeadResponse'
        '400':
          description: Invalid request

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/VoiceLeadRequest\"\
        ,\n    \"$defs\": {\n        \"VoiceLeadRequest\": {\n            \"description\": \"Request to apply voice leading
        to a chord sequence\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n        \
        \    \"required\": [\n                \"chords\",\n                \"voiceCount\"\n            ],\n            \"\
        properties\": {\n                \"chords\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"$ref\": \"#/$defs/ChordSymbol\"\n                    },\n                    \"description\"\
        : \"Chord symbols to voice\"\n                },\n                \"voiceCount\": {\n                    \"type\"\
        : \"integer\",\n                    \"minimum\": 2,\n                    \"maximum\": 8,\n                    \"description\"\
        : \"Number of voices\"\n                },\n                \"ranges\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/PitchRange\"\n                  \
        \  },\n                    \"nullable\": true,\n                    \"description\": \"Pitch range per voice (defaults
        based on voice count)\"\n                },\n                \"rules\": {\n                    \"$ref\": \"#/$defs/VoiceLeadingRules\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Voice leading rules to apply\"\n\
        \                }\n            }\n        },\n        \"ChordSymbol\": {\n            \"description\": \"A chord
        symbol with root and quality\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"root\",\n                \"quality\"\n            ],\n           \
        \ \"properties\": {\n                \"root\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n        \
        \            \"description\": \"Chord root\"\n                },\n                \"quality\": {\n               \
        \     \"type\": \"string\",\n                    \"enum\": [\n                        \"major\",\n               \
        \         \"minor\",\n                        \"diminished\",\n                        \"augmented\",\n          \
        \              \"dominant7\",\n                        \"major7\",\n                        \"minor7\",\n        \
        \                \"diminished7\",\n                        \"halfDiminished7\",\n                        \"augmented7\"\
        ,\n                        \"sus2\",\n                        \"sus4\"\n                    ],\n                 \
        \   \"description\": \"Chord quality\"\n                },\n                \"bass\": {\n                    \"$ref\"\
        : \"#/$defs/PitchClass\",\n                    \"nullable\": true,\n                    \"description\": \"Bass note
        (for inversions/slash chords)\"\n                },\n                \"extensions\": {\n                    \"type\"\
        : \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n                   \
        \ },\n                    \"nullable\": true,\n                    \"description\": \"Chord extensions (e.g., \\\"\
        9\\\", \\\"11\\\", \\\"13\\\")\"\n                }\n            }\n        },\n        \"PitchClass\": {\n      \
        \      \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\",\n            \"description\": \"A
        pitch class (note name without octave)\",\n            \"type\": \"string\",\n            \"enum\": [\n          \
        \      \"C\",\n                \"Cs\",\n                \"D\",\n                \"Ds\",\n                \"E\",\n\
        \                \"F\",\n                \"Fs\",\n                \"G\",\n                \"Gs\",\n              \
        \  \"A\",\n                \"As\",\n                \"B\"\n            ]\n        },\n        \"PitchRange\": {\n\
        \            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchRange\",\n            \"description\"\
        : \"A pitch range from low to high\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"low\",\n                \"high\"\n            ],\n            \"properties\"\
        : {\n                \"low\": {\n                    \"$ref\": \"#/$defs/Pitch\",\n                    \"description\"\
        : \"Lowest pitch (inclusive)\"\n                },\n                \"high\": {\n                    \"$ref\": \"\
        #/$defs/Pitch\",\n                    \"description\": \"Highest pitch (inclusive)\"\n                }\n        \
        \    }\n        },\n        \"Pitch\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.Pitch\"\
        ,\n            \"description\": \"A specific pitch with pitch class and octave\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"pitchClass\",\n  \
        \              \"octave\"\n            ],\n            \"properties\": {\n                \"pitchClass\": {\n    \
        \                \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\": \"Pitch class (note name)\"\
        \n                },\n                \"octave\": {\n                    \"type\": \"integer\",\n                \
        \    \"minimum\": 0,\n                    \"maximum\": 9,\n                    \"description\": \"Octave number (middle
        C = C4)\"\n                },\n                \"midiNumber\": {\n                    \"type\": \"integer\",\n   \
        \                 \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"description\": \"\
        MIDI note number (computed if not provided)\"\n                }\n            }\n        },\n        \"VoiceLeadingRules\"\
        : {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Harmony.VoiceLeadingRules\",\n            \"\
        description\": \"Rules for voice leading\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"avoidParallelFifths\": {\n                    \"type\"\
        : \"boolean\",\n                    \"default\": true,\n                    \"description\": \"Avoid parallel perfect
        fifths\"\n                },\n                \"avoidParallelOctaves\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"default\": true,\n                    \"description\": \"Avoid parallel octaves\"\n     \
        \           },\n                \"preferStepwiseMotion\": {\n                    \"type\": \"boolean\",\n        \
        \            \"default\": true,\n                    \"description\": \"Prefer stepwise voice motion\"\n         \
        \       },\n                \"avoidVoiceCrossing\": {\n                    \"type\": \"boolean\",\n              \
        \      \"default\": true,\n                    \"description\": \"Avoid voice crossing\"\n                },\n   \
        \             \"maxLeap\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n  \
        \                  \"maximum\": 12,\n                    \"default\": 7,\n                    \"description\": \"\
        Maximum leap in semitones\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/VoiceLeadResponse\"\
        ,\n    \"$defs\": {\n        \"VoiceLeadResponse\": {\n            \"description\": \"Response containing voiced chords\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"voicings\"\n            ],\n            \"properties\": {\n                \"voicings\": {\n  \
        \                  \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/VoicedChord\"\
        \n                    },\n                    \"description\": \"Voiced chord realizations\"\n                },\n\
        \                \"violations\": {\n                    \"type\": \"array\",\n                    \"items\": {\n \
        \                       \"$ref\": \"#/$defs/VoiceLeadingViolation\"\n                    },\n                    \"\
        nullable\": true,\n                    \"description\": \"Voice leading rule violations (warnings)\"\n           \
        \     }\n            }\n        },\n        \"VoicedChord\": {\n            \"description\": \"A chord with specific
        voice pitches\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"symbol\",\n                \"pitches\"\n            ],\n            \"properties\"\
        : {\n                \"symbol\": {\n                    \"$ref\": \"#/$defs/ChordSymbol\",\n                    \"\
        description\": \"Original chord symbol\"\n                },\n                \"pitches\": {\n                   \
        \ \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/Pitch\"\n  \
        \                  },\n                    \"description\": \"Pitches from lowest to highest voice\"\n           \
        \     }\n            }\n        },\n        \"ChordSymbol\": {\n            \"description\": \"A chord symbol with
        root and quality\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n           \
        \ \"required\": [\n                \"root\",\n                \"quality\"\n            ],\n            \"properties\"\
        : {\n                \"root\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\"\
        : \"Chord root\"\n                },\n                \"quality\": {\n                    \"type\": \"string\",\n\
        \                    \"enum\": [\n                        \"major\",\n                        \"minor\",\n       \
        \                 \"diminished\",\n                        \"augmented\",\n                        \"dominant7\",\n\
        \                        \"major7\",\n                        \"minor7\",\n                        \"diminished7\"\
        ,\n                        \"halfDiminished7\",\n                        \"augmented7\",\n                       \
        \ \"sus2\",\n                        \"sus4\"\n                    ],\n                    \"description\": \"Chord
        quality\"\n                },\n                \"bass\": {\n                    \"$ref\": \"#/$defs/PitchClass\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Bass note (for inversions/slash chords)\"\
        \n                },\n                \"extensions\": {\n                    \"type\": \"array\",\n              \
        \      \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"\
        nullable\": true,\n                    \"description\": \"Chord extensions (e.g., \\\"9\\\", \\\"11\\\", \\\"13\\\"\
        )\"\n                }\n            }\n        },\n        \"PitchClass\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass\"\
        ,\n            \"description\": \"A pitch class (note name without octave)\",\n            \"type\": \"string\",\n\
        \            \"enum\": [\n                \"C\",\n                \"Cs\",\n                \"D\",\n              \
        \  \"Ds\",\n                \"E\",\n                \"F\",\n                \"Fs\",\n                \"G\",\n    \
        \            \"Gs\",\n                \"A\",\n                \"As\",\n                \"B\"\n            ]\n    \
        \    },\n        \"Pitch\": {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Pitch.Pitch\",\n \
        \           \"description\": \"A specific pitch with pitch class and octave\",\n            \"type\": \"object\",\n\
        \            \"additionalProperties\": false,\n            \"required\": [\n                \"pitchClass\",\n    \
        \            \"octave\"\n            ],\n            \"properties\": {\n                \"pitchClass\": {\n      \
        \              \"$ref\": \"#/$defs/PitchClass\",\n                    \"description\": \"Pitch class (note name)\"\
        \n                },\n                \"octave\": {\n                    \"type\": \"integer\",\n                \
        \    \"minimum\": 0,\n                    \"maximum\": 9,\n                    \"description\": \"Octave number (middle
        C = C4)\"\n                },\n                \"midiNumber\": {\n                    \"type\": \"integer\",\n   \
        \                 \"minimum\": 0,\n                    \"maximum\": 127,\n                    \"description\": \"\
        MIDI note number (computed if not provided)\"\n                }\n            }\n        },\n        \"VoiceLeadingViolation\"\
        : {\n            \"x-sdk-type\": \"BeyondImmersion.Bannou.MusicTheory.Harmony.VoiceLeadingViolation\",\n         \
        \   \"description\": \"A voice leading rule violation\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"rule\",\n                \"position\",\n                \"\
        severity\"\n            ],\n            \"properties\": {\n                \"rule\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Rule that was violated\"\n                },\n             \
        \   \"position\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Chord position
        of violation\"\n                },\n                \"voices\": {\n                    \"type\": \"array\",\n    \
        \                \"items\": {\n                        \"type\": \"integer\"\n                    },\n           \
        \         \"nullable\": true,\n                    \"description\": \"Voice indices involved\"\n                },\n\
        \                \"severity\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n   \
        \                     \"warning\",\n                        \"error\"\n                    ],\n                  \
        \  \"description\": \"Violation severity\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Apply voice leading to chords\",\n    \"description\": \"Applies voice
        leading rules to a chord sequence, ensuring smooth\\npart-writing according to traditional or style-specific rules.\\\
        n\",\n    \"tags\": [\n        \"Theory\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"ApplyVoiceLeading\"\
        \n}"
components:
  schemas:
    # ============================================================================
    # Request Models
    # ============================================================================

    GenerateCompositionRequest:
      description: Request to generate a complete musical composition
      type: object
      additionalProperties: false
      required:
      - styleId
      properties:
        styleId:
          type: string
          description: ID of the style to use for generation
          example: "celtic"
        durationBars:
          type: integer
          minimum: 4
          maximum: 256
          default: 32
          description: Target duration in bars
        key:
          $ref: '#/components/schemas/KeySignature'
          nullable: true
          description: Key signature (random if not specified)
        tempo:
          type: integer
          minimum: 40
          maximum: 240
          description: Tempo in BPM (uses style default if not specified)
        mood:
          type: string
          enum: [bright, dark, neutral, melancholic, triumphant]
          nullable: true
          description: Mood constraint for generation
        tuneType:
          type: string
          nullable: true
          description: Style-specific tune type (e.g., "reel", "jig" for Celtic)
          example: "reel"
        seed:
          type: integer
          nullable: true
          description: Random seed for reproducible generation

    ValidateMidiJsonRequest:
      description: Request to validate MIDI-JSON structure
      type: object
      additionalProperties: false
      required:
      - midiJson
      properties:
        midiJson:
          $ref: '#/components/schemas/MidiJson'
          description: MIDI-JSON structure to validate
        strictMode:
          type: boolean
          default: false
          description: Enable strict validation with additional checks

    GetStyleRequest:
      description: Request to get a style definition
      type: object
      additionalProperties: false
      properties:
        styleId:
          type: string
          nullable: true
          description: Style ID to retrieve
        styleName:
          type: string
          nullable: true
          description: Style name to retrieve (alternative to ID)

    ListStylesRequest:
      description: Request to list available styles
      type: object
      additionalProperties: false
      properties:
        category:
          type: string
          nullable: true
          description: Filter by category (e.g., "folk", "classical", "jazz")
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 50
          description: Maximum number of styles to return
        offset:
          type: integer
          minimum: 0
          default: 0
          description: Pagination offset

    CreateStyleRequest:
      description: Request to create a new style definition
      type: object
      additionalProperties: false
      required:
      - name
      - category
      - modeDistribution
      properties:
        name:
          type: string
          description: Unique style name
          example: "celtic"
        category:
          type: string
          description: Style category
          example: "folk"
        description:
          type: string
          nullable: true
          description: Human-readable style description
        modeDistribution:
          $ref: '#/components/schemas/ModeDistribution'
          description: Probability distribution over modes
        intervalPreferences:
          $ref: '#/components/schemas/IntervalPreferences'
          nullable: true
          description: Preferred interval patterns
        formTemplates:
          type: array
          items:
            $ref: '#/components/schemas/FormTemplate'
          nullable: true
          description: Available form structures
        rhythmPatterns:
          type: array
          items:
            $ref: '#/components/schemas/RhythmPattern'
          nullable: true
          description: Common rhythm patterns
        tuneTypes:
          type: array
          items:
            $ref: '#/components/schemas/TuneType'
          nullable: true
          description: Style-specific tune types
        defaultTempo:
          type: integer
          minimum: 40
          maximum: 240
          description: Default tempo for this style
        harmonyStyle:
          $ref: '#/components/schemas/HarmonyStyle'
          nullable: true
          description: Harmonic progression preferences

    GenerateProgressionRequest:
      description: Request to generate a chord progression
      type: object
      additionalProperties: false
      required:
      - key
      - length
      properties:
        key:
          $ref: '#/components/schemas/KeySignature'
          description: Key for the progression
        length:
          type: integer
          minimum: 2
          maximum: 64
          description: Number of chords in the progression
        styleId:
          type: string
          nullable: true
          description: Style to use for harmonic preferences
        startChord:
          type: string
          nullable: true
          description: Starting chord (roman numeral, e.g., "I")
        endChord:
          type: string
          nullable: true
          description: Ending chord (roman numeral, e.g., "I")
        cadenceType:
          type: string
          enum: [authentic, half, plagal, deceptive]
          nullable: true
          description: Cadence type for ending
        allowSecondaryDominants:
          type: boolean
          default: true
          description: Allow secondary dominant chords
        allowModalInterchange:
          type: boolean
          default: false
          description: Allow borrowed chords from parallel modes
        seed:
          type: integer
          nullable: true
          description: Random seed for reproducibility

    GenerateMelodyRequest:
      description: Request to generate a melody over harmony
      type: object
      additionalProperties: false
      required:
      - harmony
      properties:
        harmony:
          type: array
          items:
            $ref: '#/components/schemas/ChordEvent'
          description: Chord progression to generate melody over
        styleId:
          type: string
          nullable: true
          description: Style for melodic preferences
        range:
          $ref: '#/components/schemas/PitchRange'
          nullable: true
          description: Pitch range for the melody
        contour:
          type: string
          enum: [arch, wave, ascending, descending, static]
          nullable: true
          description: Overall melodic contour
        rhythmDensity:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          nullable: true
          description: Note density (0=sparse, 1=dense)
        syncopation:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          nullable: true
          description: Amount of syncopation
        seed:
          type: integer
          nullable: true
          description: Random seed for reproducibility

    VoiceLeadRequest:
      description: Request to apply voice leading to a chord sequence
      type: object
      additionalProperties: false
      required:
      - chords
      - voiceCount
      properties:
        chords:
          type: array
          items:
            $ref: '#/components/schemas/ChordSymbol'
          description: Chord symbols to voice
        voiceCount:
          type: integer
          minimum: 2
          maximum: 8
          description: Number of voices
        ranges:
          type: array
          items:
            $ref: '#/components/schemas/PitchRange'
          nullable: true
          description: Pitch range per voice (defaults based on voice count)
        rules:
          $ref: '#/components/schemas/VoiceLeadingRules'
          nullable: true
          description: Voice leading rules to apply

    # ============================================================================
    # Response Models
    # ============================================================================

    GenerateCompositionResponse:
      description: Response containing the generated composition
      type: object
      additionalProperties: false
      required:
      - compositionId
      - midiJson
      properties:
        compositionId:
          type: string
          description: Unique identifier for the composition
        midiJson:
          $ref: '#/components/schemas/MidiJson'
          description: Generated MIDI-JSON output
        metadata:
          $ref: '#/components/schemas/CompositionMetadata'
          nullable: true
          description: Metadata about the generation
        generationTimeMs:
          type: integer
          description: Time taken to generate in milliseconds

    ValidateMidiJsonResponse:
      description: Response containing validation results
      type: object
      additionalProperties: false
      required:
      - isValid
      properties:
        isValid:
          type: boolean
          description: Whether the MIDI-JSON is valid
        errors:
          type: array
          items:
            $ref: '#/components/schemas/ValidationError'
          nullable: true
          description: Validation errors if invalid
        warnings:
          type: array
          items:
            type: string
          nullable: true
          description: Non-fatal warnings

    StyleDefinitionResponse:
      description: Response containing a style definition
      type: object
      additionalProperties: false
      required:
      - styleId
      - name
      - category
      properties:
        styleId:
          type: string
          description: Unique style identifier
        name:
          type: string
          description: Style name
        category:
          type: string
          description: Style category
        description:
          type: string
          nullable: true
          description: Human-readable description
        modeDistribution:
          $ref: '#/components/schemas/ModeDistribution'
          nullable: true
          description: Mode probability distribution
        intervalPreferences:
          $ref: '#/components/schemas/IntervalPreferences'
          nullable: true
          description: Interval preferences
        formTemplates:
          type: array
          items:
            $ref: '#/components/schemas/FormTemplate'
          nullable: true
          description: Available forms
        tuneTypes:
          type: array
          items:
            $ref: '#/components/schemas/TuneType'
          nullable: true
          description: Style-specific tune types
        defaultTempo:
          type: integer
          description: Default tempo
        harmonyStyle:
          $ref: '#/components/schemas/HarmonyStyle'
          nullable: true
          description: Harmony preferences

    ListStylesResponse:
      description: Response containing a list of styles
      type: object
      additionalProperties: false
      required:
      - styles
      - total
      properties:
        styles:
          type: array
          items:
            $ref: '#/components/schemas/StyleSummary'
          description: Style summaries
        total:
          type: integer
          description: Total number of styles matching filter

    GenerateProgressionResponse:
      description: Response containing a generated chord progression
      type: object
      additionalProperties: false
      required:
      - chords
      properties:
        chords:
          type: array
          items:
            $ref: '#/components/schemas/ChordEvent'
          description: Generated chord events
        analysis:
          $ref: '#/components/schemas/ProgressionAnalysis'
          nullable: true
          description: Analysis of the progression

    GenerateMelodyResponse:
      description: Response containing a generated melody
      type: object
      additionalProperties: false
      required:
      - notes
      properties:
        notes:
          type: array
          items:
            $ref: '#/components/schemas/NoteEvent'
          description: Generated note events
        analysis:
          $ref: '#/components/schemas/MelodyAnalysis'
          nullable: true
          description: Analysis of the melody

    VoiceLeadResponse:
      description: Response containing voiced chords
      type: object
      additionalProperties: false
      required:
      - voicings
      properties:
        voicings:
          type: array
          items:
            $ref: '#/components/schemas/VoicedChord'
          description: Voiced chord realizations
        violations:
          type: array
          items:
            $ref: '#/components/schemas/VoiceLeadingViolation'
          nullable: true
          description: Voice leading rule violations (warnings)

    # ============================================================================
    # Core Data Models
    # ============================================================================

    MidiJson:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.MidiJson
      description: MIDI-JSON format representation of a musical piece
      type: object
      additionalProperties: false
      required:
      - tracks
      - ticksPerBeat
      properties:
        header:
          $ref: '#/components/schemas/MidiHeader'
          nullable: true
          description: MIDI header information
        ticksPerBeat:
          type: integer
          minimum: 24
          maximum: 960
          default: 480
          description: Ticks per beat (PPQN)
        tracks:
          type: array
          items:
            $ref: '#/components/schemas/MidiTrack'
          description: MIDI tracks

    MidiHeader:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.MidiHeader
      description: MIDI file header information
      type: object
      additionalProperties: false
      properties:
        format:
          type: integer
          minimum: 0
          maximum: 2
          default: 1
          description: MIDI format type (0, 1, or 2)
        name:
          type: string
          nullable: true
          description: Composition name
        tempos:
          type: array
          items:
            $ref: '#/components/schemas/TempoEvent'
          nullable: true
          description: Tempo changes
        timeSignatures:
          type: array
          items:
            $ref: '#/components/schemas/TimeSignatureEvent'
          nullable: true
          description: Time signature changes
        keySignatures:
          type: array
          items:
            $ref: '#/components/schemas/KeySignatureEvent'
          nullable: true
          description: Key signature changes

    MidiTrack:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.MidiTrack
      description: A single MIDI track containing events
      type: object
      additionalProperties: false
      required:
      - events
      properties:
        name:
          type: string
          nullable: true
          description: Track name
        channel:
          type: integer
          minimum: 0
          maximum: 15
          default: 0
          description: MIDI channel
        instrument:
          type: integer
          minimum: 0
          maximum: 127
          nullable: true
          description: GM instrument number
        events:
          type: array
          items:
            $ref: '#/components/schemas/MidiEvent'
          description: Track events

    MidiEvent:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.MidiEvent
      description: A single MIDI event
      type: object
      additionalProperties: false
      required:
      - tick
      - type
      properties:
        tick:
          type: integer
          minimum: 0
          description: Absolute tick position
        type:
          $ref: '#/components/schemas/MidiEventType'
          description: Event type
        note:
          type: integer
          minimum: 0
          maximum: 127
          nullable: true
          description: MIDI note number (for note events)
        velocity:
          type: integer
          minimum: 0
          maximum: 127
          nullable: true
          description: Note velocity (for note events)
        duration:
          type: integer
          minimum: 1
          nullable: true
          description: Note duration in ticks (for noteOn with implicit noteOff)
        program:
          type: integer
          minimum: 0
          maximum: 127
          nullable: true
          description: Program number (for programChange)
        controller:
          type: integer
          minimum: 0
          maximum: 127
          nullable: true
          description: Controller number (for controlChange)
        value:
          type: integer
          minimum: 0
          maximum: 127
          nullable: true
          description: Controller value (for controlChange)

    NoteEvent:
      description: A musical note event with timing and pitch
      type: object
      additionalProperties: false
      required:
      - pitch
      - startTick
      - durationTicks
      properties:
        pitch:
          $ref: '#/components/schemas/Pitch'
          description: Note pitch
        startTick:
          type: integer
          minimum: 0
          description: Start position in ticks
        durationTicks:
          type: integer
          minimum: 1
          description: Duration in ticks
        velocity:
          type: integer
          minimum: 1
          maximum: 127
          default: 80
          description: Note velocity

    ChordEvent:
      description: A chord with timing information
      type: object
      additionalProperties: false
      required:
      - chord
      - startTick
      - durationTicks
      properties:
        chord:
          $ref: '#/components/schemas/ChordSymbol'
          description: Chord symbol
        startTick:
          type: integer
          minimum: 0
          description: Start position in ticks
        durationTicks:
          type: integer
          minimum: 1
          description: Duration in ticks
        romanNumeral:
          type: string
          nullable: true
          description: Roman numeral analysis (e.g., "IV", "V7")

    ChordSymbol:
      description: A chord symbol with root and quality
      type: object
      additionalProperties: false
      required:
      - root
      - quality
      properties:
        root:
          $ref: '#/components/schemas/PitchClass'
          description: Chord root
        quality:
          type: string
          enum: [major, minor, diminished, augmented, dominant7, major7, minor7, diminished7, halfDiminished7, 
              augmented7, sus2, sus4]
          description: Chord quality
        bass:
          $ref: '#/components/schemas/PitchClass'
          nullable: true
          description: Bass note (for inversions/slash chords)
        extensions:
          type: array
          items:
            type: string
          nullable: true
          description: Chord extensions (e.g., "9", "11", "13")

    VoicedChord:
      description: A chord with specific voice pitches
      type: object
      additionalProperties: false
      required:
      - symbol
      - pitches
      properties:
        symbol:
          $ref: '#/components/schemas/ChordSymbol'
          description: Original chord symbol
        pitches:
          type: array
          items:
            $ref: '#/components/schemas/Pitch'
          description: Pitches from lowest to highest voice

    Pitch:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Pitch.Pitch
      description: A specific pitch with pitch class and octave
      type: object
      additionalProperties: false
      required:
      - pitchClass
      - octave
      properties:
        pitchClass:
          $ref: '#/components/schemas/PitchClass'
          description: Pitch class (note name)
        octave:
          type: integer
          minimum: 0
          maximum: 9
          description: Octave number (middle C = C4)
        midiNumber:
          type: integer
          minimum: 0
          maximum: 127
          description: MIDI note number (computed if not provided)

    PitchClass:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Pitch.PitchClass
      description: A pitch class (note name without octave)
      type: string
      enum: [C, Cs, D, Ds, E, F, Fs, G, Gs, A, As, B]

    PitchRange:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Pitch.PitchRange
      description: A pitch range from low to high
      type: object
      additionalProperties: false
      required:
      - low
      - high
      properties:
        low:
          $ref: '#/components/schemas/Pitch'
          description: Lowest pitch (inclusive)
        high:
          $ref: '#/components/schemas/Pitch'
          description: Highest pitch (inclusive)

    KeySignature:
      description: A key signature with tonic and mode
      type: object
      additionalProperties: false
      required:
      - tonic
      - mode
      properties:
        tonic:
          $ref: '#/components/schemas/PitchClass'
          description: Tonic pitch class
        mode:
          type: string
          enum: [major, minor, dorian, phrygian, lydian, mixolydian, aeolian, locrian]
          description: Mode/scale type

    TempoEvent:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.TempoEvent
      description: A tempo change event
      type: object
      additionalProperties: false
      required:
      - tick
      - bpm
      properties:
        tick:
          type: integer
          minimum: 0
          description: Tick position
        bpm:
          type: number
          format: float
          minimum: 20
          maximum: 400
          description: Tempo in BPM

    TimeSignatureEvent:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.TimeSignatureEvent
      description: A time signature change event
      type: object
      additionalProperties: false
      required:
      - tick
      - numerator
      - denominator
      properties:
        tick:
          type: integer
          minimum: 0
          description: Tick position
        numerator:
          type: integer
          minimum: 1
          maximum: 32
          description: Beats per measure
        denominator:
          type: integer
          minimum: 1
          maximum: 32
          description: Beat unit (4 = quarter, 8 = eighth)

    KeySignatureEvent:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.KeySignatureEvent
      description: A key signature change event
      type: object
      additionalProperties: false
      required:
      - tick
      - tonic
      - mode
      properties:
        tick:
          type: integer
          minimum: 0
          description: Tick position
        tonic:
          $ref: '#/components/schemas/PitchClass'
          description: Tonic pitch class
        mode:
          $ref: '#/components/schemas/ModeType'
          description: Mode/scale type

    ModeType:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Collections.ModeType
      description: Musical mode/scale type
      type: string
      enum:
      - Major
      - Minor
      - Dorian
      - Phrygian
      - Lydian
      - Mixolydian
      - Aeolian
      - Locrian
      - HarmonicMinor
      - MelodicMinor
      - MajorPentatonic
      - MinorPentatonic
      - Blues
      - WholeTone
      - Chromatic

    MidiEventType:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Output.MidiEventType
      description: MIDI event type
      type: string
      enum:
      - NoteOn
      - NoteOff
      - ProgramChange
      - ControlChange

    # ============================================================================
    # Style Definition Models
    # ============================================================================

    ModeDistribution:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Style.ModeDistribution
      description: Probability distribution over musical modes
      type: object
      additionalProperties: false
      properties:
        major:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of major mode
        minor:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of natural minor
        dorian:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of dorian mode
        phrygian:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of phrygian mode
        lydian:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of lydian mode
        mixolydian:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of mixolydian mode
        aeolian:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of aeolian mode
        locrian:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Probability of locrian mode

    IntervalPreferences:
      description: Melodic interval preference weights
      type: object
      additionalProperties: false
      properties:
        stepWeight:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.5
          description: Weight for stepwise motion (M2, m2)
        thirdWeight:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.25
          description: Weight for thirds (M3, m3)
        leapWeight:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.15
          description: Weight for larger leaps (P4, P5)
        largeLeapWeight:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.1
          description: Weight for leaps larger than P5

    FormTemplate:
      description: A musical form structure template
      type: object
      additionalProperties: false
      required:
      - name
      - sections
      properties:
        name:
          type: string
          description: Form name (e.g., "AABB", "verse-chorus")
        sections:
          type: array
          items:
            type: string
          description: Section sequence (e.g., ["A", "A", "B", "B"])
        barsPerSection:
          type: integer
          minimum: 1
          maximum: 64
          default: 8
          description: Default bars per section

    RhythmPattern:
      description: A rhythmic pattern with note durations
      type: object
      additionalProperties: false
      required:
      - name
      - pattern
      properties:
        name:
          type: string
          description: Pattern name
        pattern:
          type: array
          items:
            type: number
            format: float
          description: Relative durations (1.0 = beat)
        weight:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 1.0
          description: Selection weight

    TuneType:
      description: A style-specific tune type definition
      type: object
      additionalProperties: false
      required:
      - name
      - meter
      properties:
        name:
          type: string
          description: Tune type name (e.g., "reel", "jig")
        meter:
          $ref: '#/components/schemas/TimeSignatureEvent'
          description: Time signature for this tune type
        tempoRange:
          $ref: '#/components/schemas/TempoRange'
          nullable: true
          description: Typical tempo range
        defaultForm:
          type: string
          nullable: true
          description: Default form for this tune type
        rhythmPatterns:
          type: array
          items:
            type: string
          nullable: true
          description: Rhythm pattern names to use

    TempoRange:
      description: A tempo range with min and max BPM
      type: object
      additionalProperties: false
      required:
      - min
      - max
      properties:
        min:
          type: integer
          minimum: 20
          maximum: 400
          description: Minimum tempo
        max:
          type: integer
          minimum: 20
          maximum: 400
          description: Maximum tempo

    HarmonyStyle:
      description: Harmonic progression style preferences
      type: object
      additionalProperties: false
      properties:
        primaryCadence:
          type: string
          enum: [authentic, plagal, half, deceptive]
          default: authentic
          description: Most common cadence type
        dominantPrepProbability:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.6
          description: Probability of pre-dominant before dominant
        secondaryDominantProbability:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.3
          description: Probability of secondary dominants
        modalInterchangeProbability:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.1
          description: Probability of borrowed chords
        commonProgressions:
          type: array
          items:
            type: string
          nullable: true
          description: Common chord progressions as roman numeral strings

    StyleSummary:
      description: Brief style summary for listing
      type: object
      additionalProperties: false
      required:
      - styleId
      - name
      - category
      properties:
        styleId:
          type: string
          description: Style identifier
        name:
          type: string
          description: Style name
        category:
          type: string
          description: Style category
        description:
          type: string
          nullable: true
          description: Brief description

    # ============================================================================
    # Analysis Models
    # ============================================================================

    ProgressionAnalysis:
      description: Analysis of a chord progression
      type: object
      additionalProperties: false
      properties:
        romanNumerals:
          type: array
          items:
            type: string
          nullable: true
          description: Roman numeral analysis
        cadences:
          type: array
          items:
            $ref: '#/components/schemas/CadenceInfo'
          nullable: true
          description: Detected cadences
        functionalAnalysis:
          type: array
          items:
            type: string
            enum: [tonic, subdominant, dominant, predominant]
          nullable: true
          description: Functional analysis per chord

    CadenceInfo:
      description: Information about a cadence
      type: object
      additionalProperties: false
      required:
      - type
      - position
      properties:
        type:
          type: string
          enum: [authentic, half, plagal, deceptive]
          description: Cadence type
        position:
          type: integer
          description: Chord index where cadence ends
        strength:
          type: string
          enum: [perfect, imperfect]
          nullable: true
          description: Cadence strength

    MelodyAnalysis:
      description: Analysis of a melody
      type: object
      additionalProperties: false
      properties:
        range:
          $ref: '#/components/schemas/PitchRange'
          nullable: true
          description: Pitch range used
        intervalDistribution:
          type: object
          additionalProperties:
            type: number
            format: float
          nullable: true
          description: Distribution of interval sizes
        contour:
          type: string
          nullable: true
          description: Detected contour shape
        noteCount:
          type: integer
          description: Total number of notes
        averageNoteDuration:
          type: number
          format: float
          nullable: true
          description: Average note duration in ticks

    # ============================================================================
    # Voice Leading Models
    # ============================================================================

    VoiceLeadingRules:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Harmony.VoiceLeadingRules
      description: Rules for voice leading
      type: object
      additionalProperties: false
      properties:
        avoidParallelFifths:
          type: boolean
          default: true
          description: Avoid parallel perfect fifths
        avoidParallelOctaves:
          type: boolean
          default: true
          description: Avoid parallel octaves
        preferStepwiseMotion:
          type: boolean
          default: true
          description: Prefer stepwise voice motion
        avoidVoiceCrossing:
          type: boolean
          default: true
          description: Avoid voice crossing
        maxLeap:
          type: integer
          minimum: 1
          maximum: 12
          default: 7
          description: Maximum leap in semitones

    VoiceLeadingViolation:
      x-sdk-type: BeyondImmersion.Bannou.MusicTheory.Harmony.VoiceLeadingViolation
      description: A voice leading rule violation
      type: object
      additionalProperties: false
      required:
      - rule
      - position
      - severity
      properties:
        rule:
          type: string
          description: Rule that was violated
        position:
          type: integer
          description: Chord position of violation
        voices:
          type: array
          items:
            type: integer
          nullable: true
          description: Voice indices involved
        severity:
          type: string
          enum: [warning, error]
          description: Violation severity

    # ============================================================================
    # Metadata Models
    # ============================================================================

    CompositionMetadata:
      description: Metadata about a generated composition
      type: object
      additionalProperties: false
      properties:
        styleId:
          type: string
          nullable: true
          description: Style used
        key:
          $ref: '#/components/schemas/KeySignature'
          nullable: true
          description: Key signature
        tempo:
          type: integer
          nullable: true
          description: Tempo in BPM
        bars:
          type: integer
          nullable: true
          description: Number of bars
        tuneType:
          type: string
          nullable: true
          description: Tune type if applicable
        seed:
          type: integer
          nullable: true
          description: Random seed used

    ValidationError:
      description: A validation error
      type: object
      additionalProperties: false
      required:
      - type
      - message
      properties:
        type:
          type: string
          enum: [structure, range, timing, format]
          description: Error type
        message:
          type: string
          description: Error message
        path:
          type: string
          nullable: true
          description: Path to problematic element

tags:
- name: Generation
  description: High-level composition generation
- name: Validation
  description: MIDI-JSON validation
- name: Styles
  description: Style definition management
- name: Theory
  description: Low-level music theory operations
