openapi: 3.0.0
info:
  title: Bannou Location Service API
  description: |
    Location management service for Arcadia game world.

    **POST-Only API Pattern**: This API uses POST for all operations to support zero-copy
    WebSocket routing. Path parameters are passed in request bodies instead of URLs.
    See docs/BANNOU_DESIGN.md for architectural rationale.

    Locations represent physical places in the game world. Each location belongs to
    exactly one realm and can optionally have a parent location for hierarchical organization.

    **Three-Level Hierarchy**:
    - Realm (top-level persistent world - separate Realm service)
    - Region (parentLocationId=null, locations within a realm)
    - Location (parentLocationId=regionId, specific places within regions)

    **Realm-Scoped**: Every location has a realmId, enabling realm-specific location queries.

    **Hierarchy Support**: Locations can nest within other locations via parentLocationId,
    enabling Region -> City -> District -> Building -> Room organization patterns.

    **Location Types**: Flexible locationType field (e.g., "REGION", "CITY", "BUILDING", "ROOM")
    allows domain-specific categorization without rigid schema constraints.

    **Deprecation System**: Locations can be deprecated instead of deleted directly.
    Deprecated locations remain queryable but prevent new entity placement.

    **Two-Step Deletion**:
    1. Deprecate the location (soft delete, prevents new usage)
    2. Optionally hard-delete the deprecated location after all references are removed
  version: 1.0.0
servers:
- url: http://localhost:3500/v1.0/invoke/bannou/method
  description: Dapr sidecar endpoint (internal only)

# NOTE: x-lifecycle moved to location-events.yaml

paths:
  /location/get:
    post:
      summary: Get location by ID
      operationId: getLocation
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetLocationRequest'
      responses:
        '200':
          description: Location retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '404':
          description: Location not found

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/GetLocationRequest\"\
        ,\n  \"$defs\": {\n    \"GetLocationRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        \n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"uuid\",\n          \"description\": \"Unique identifier of the location\"\n        }\n      }\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Get location by ID\",\n  \"description\": \"\",\n  \"tags\": [\n    \"Location\"\
        \n  ],\n  \"deprecated\": false,\n  \"operationId\": \"getLocation\"\n}"
  /location/get-by-code:
    post:
      summary: Get location by code and realm
      description: Retrieve a location using its unique code within a specific realm
      operationId: getLocationByCode
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetLocationByCodeRequest'
      responses:
        '200':
          description: Location retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '404':
          description: Location not found

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/GetLocationByCodeRequest\"\
        ,\n  \"$defs\": {\n    \"GetLocationByCodeRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n     \
        \   \"code\",\n        \"realmId\"\n      ],\n      \"properties\": {\n        \"code\": {\n          \"type\": \"\
        string\",\n          \"minLength\": 1,\n          \"maxLength\": 100,\n          \"pattern\": \"^[A-Z][A-Z0-9_]*$\"\
        ,\n          \"description\": \"Unique code for the location within the realm\"\n        },\n        \"realmId\":
        {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm ID to scope
        the code lookup\"\n        }\n      }\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Get location by code and realm\",\n  \"description\": \"Retrieve a location
        using its unique code within a specific realm\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\": false,\n\
        \  \"operationId\": \"getLocationByCode\"\n}"
  /location/list:
    post:
      summary: List locations with filtering
      description: Retrieve locations with optional realm, parent, and type filtering
      operationId: listLocations
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListLocationsRequest'
      responses:
        '200':
          description: Locations retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationListResponse'

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/ListLocationsRequest\"\
        ,\n  \"$defs\": {\n    \"ListLocationsRequest\": {\n      \"type\": \"object\",\n      \"properties\": {\n       \
        \ \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"nullable\": true,\n\
        \          \"description\": \"Filter by realm\"\n        },\n        \"locationType\": {\n          \"allOf\": [\n\
        \            {\n              \"$ref\": \"#/$defs/LocationType\"\n            }\n          ],\n          \"nullable\"\
        : true,\n          \"description\": \"Filter by location type\"\n        },\n        \"includeDeprecated\": {\n  \
        \        \"type\": \"boolean\",\n          \"default\": false,\n          \"description\": \"Whether to include deprecated
        locations in the response\"\n        },\n        \"page\": {\n          \"type\": \"integer\",\n          \"minimum\"\
        : 1,\n          \"default\": 1\n        },\n        \"pageSize\": {\n          \"type\": \"integer\",\n          \"\
        minimum\": 1,\n          \"maximum\": 100,\n          \"default\": 20\n        }\n      }\n    },\n    \"LocationType\"\
        : {\n      \"type\": \"string\",\n      \"description\": \"Type classification for locations\",\n      \"enum\": [\n\
        \        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n  \
        \      \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n\
        \    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationListResponse\"\
        ,\n  \"$defs\": {\n    \"LocationListResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locations\",\n        \"totalCount\",\n        \"page\",\n        \"pageSize\"\n      ],\n      \"properties\": {\n\
        \        \"locations\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/$defs/LocationResponse\"\
        \n          }\n        },\n        \"totalCount\": {\n          \"type\": \"integer\"\n        },\n        \"page\"\
        : {\n          \"type\": \"integer\"\n        },\n        \"pageSize\": {\n          \"type\": \"integer\"\n     \
        \   },\n        \"hasNextPage\": {\n          \"type\": \"boolean\"\n        },\n        \"hasPreviousPage\": {\n\
        \          \"type\": \"boolean\"\n        }\n      }\n    },\n    \"LocationResponse\": {\n      \"type\": \"object\"\
        ,\n      \"required\": [\n        \"locationId\",\n        \"realmId\",\n        \"code\",\n        \"name\",\n  \
        \      \"locationType\",\n        \"depth\",\n        \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\
        \n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"uuid\"\n        },\n        \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n\
        \          \"description\": \"Realm this location belongs to\"\n        },\n        \"code\": {\n          \"type\"\
        : \"string\"\n        },\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"nullable\": true\n        },\n        \"locationType\": {\n    \
        \      \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"nullable\": true,\n          \"description\": \"Parent location ID
        (null for root locations)\"\n        },\n        \"depth\": {\n          \"type\": \"integer\",\n          \"description\"\
        : \"Depth in hierarchy (0 for root locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\"\
        ,\n          \"description\": \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n      \
        \    \"description\": \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\":
        {\n          \"type\": \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for
        deprecation\"\n        },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\"\
        : true,\n          \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n   \
        \       \"format\": \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n       \
        \   \"format\": \"date-time\"\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n\
        \      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n      \
        \  \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"List locations with filtering\",\n  \"description\": \"Retrieve locations
        with optional realm, parent, and type filtering\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\": false,\n\
        \  \"operationId\": \"listLocations\"\n}"
  /location/list-by-realm:
    post:
      summary: List all locations in a realm (primary query pattern)
      description: |
        Returns all locations within a specific realm, optionally filtered by
        location type and parent. This is the primary access pattern for
        realm-scoped location queries.
      operationId: listLocationsByRealm
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListLocationsByRealmRequest'
      responses:
        '200':
          description: Locations retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationListResponse'

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/ListLocationsByRealmRequest\"\
        ,\n  \"$defs\": {\n    \"ListLocationsByRealmRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n  \
        \      \"realmId\"\n      ],\n      \"properties\": {\n        \"realmId\": {\n          \"type\": \"string\",\n \
        \         \"format\": \"uuid\",\n          \"description\": \"Realm ID to query\"\n        },\n        \"locationType\"\
        : {\n          \"allOf\": [\n            {\n              \"$ref\": \"#/$defs/LocationType\"\n            }\n    \
        \      ],\n          \"nullable\": true,\n          \"description\": \"Optional type filter\"\n        },\n      \
        \  \"includeDeprecated\": {\n          \"type\": \"boolean\",\n          \"default\": false\n        },\n        \"\
        page\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"default\": 1\n        },\n   \
        \     \"pageSize\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"maximum\": 100,\n\
        \          \"default\": 20\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n   \
        \   \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"\
        REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationListResponse\"\
        ,\n  \"$defs\": {\n    \"LocationListResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locations\",\n        \"totalCount\",\n        \"page\",\n        \"pageSize\"\n      ],\n      \"properties\": {\n\
        \        \"locations\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/$defs/LocationResponse\"\
        \n          }\n        },\n        \"totalCount\": {\n          \"type\": \"integer\"\n        },\n        \"page\"\
        : {\n          \"type\": \"integer\"\n        },\n        \"pageSize\": {\n          \"type\": \"integer\"\n     \
        \   },\n        \"hasNextPage\": {\n          \"type\": \"boolean\"\n        },\n        \"hasPreviousPage\": {\n\
        \          \"type\": \"boolean\"\n        }\n      }\n    },\n    \"LocationResponse\": {\n      \"type\": \"object\"\
        ,\n      \"required\": [\n        \"locationId\",\n        \"realmId\",\n        \"code\",\n        \"name\",\n  \
        \      \"locationType\",\n        \"depth\",\n        \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\
        \n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"uuid\"\n        },\n        \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n\
        \          \"description\": \"Realm this location belongs to\"\n        },\n        \"code\": {\n          \"type\"\
        : \"string\"\n        },\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"nullable\": true\n        },\n        \"locationType\": {\n    \
        \      \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"nullable\": true,\n          \"description\": \"Parent location ID
        (null for root locations)\"\n        },\n        \"depth\": {\n          \"type\": \"integer\",\n          \"description\"\
        : \"Depth in hierarchy (0 for root locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\"\
        ,\n          \"description\": \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n      \
        \    \"description\": \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\":
        {\n          \"type\": \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for
        deprecation\"\n        },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\"\
        : true,\n          \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n   \
        \       \"format\": \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n       \
        \   \"format\": \"date-time\"\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n\
        \      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n      \
        \  \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"List all locations in a realm (primary query pattern)\",\n  \"description\"\
        : \"Returns all locations within a specific realm, optionally filtered by\\nlocation type and parent. This is the
        primary access pattern for\\nrealm-scoped location queries.\\n\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\"\
        : false,\n  \"operationId\": \"listLocationsByRealm\"\n}"
  /location/list-by-parent:
    post:
      summary: Get child locations for a parent location
      description: |
        Retrieve all locations that have the specified location as their parent.
        Useful for getting all cities in a region, all buildings in a city, etc.
      operationId: listLocationsByParent
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListLocationsByParentRequest'
      responses:
        '200':
          description: Child locations retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationListResponse'
        '404':
          description: Parent location not found

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/ListLocationsByParentRequest\"\
        ,\n  \"$defs\": {\n    \"ListLocationsByParentRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n \
        \       \"parentLocationId\"\n      ],\n      \"properties\": {\n        \"parentLocationId\": {\n          \"type\"\
        : \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"ID of the parent location\"\n       \
        \ },\n        \"locationType\": {\n          \"allOf\": [\n            {\n              \"$ref\": \"#/$defs/LocationType\"\
        \n            }\n          ],\n          \"nullable\": true,\n          \"description\": \"Optional filter by location
        type\"\n        },\n        \"includeDeprecated\": {\n          \"type\": \"boolean\",\n          \"default\": false\n\
        \        },\n        \"page\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"default\"\
        : 1\n        },\n        \"pageSize\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"\
        maximum\": 100,\n          \"default\": 20\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"\
        string\",\n      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\"\
        ,\n        \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n     \
        \   \"LANDMARK\",\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationListResponse\"\
        ,\n  \"$defs\": {\n    \"LocationListResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locations\",\n        \"totalCount\",\n        \"page\",\n        \"pageSize\"\n      ],\n      \"properties\": {\n\
        \        \"locations\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/$defs/LocationResponse\"\
        \n          }\n        },\n        \"totalCount\": {\n          \"type\": \"integer\"\n        },\n        \"page\"\
        : {\n          \"type\": \"integer\"\n        },\n        \"pageSize\": {\n          \"type\": \"integer\"\n     \
        \   },\n        \"hasNextPage\": {\n          \"type\": \"boolean\"\n        },\n        \"hasPreviousPage\": {\n\
        \          \"type\": \"boolean\"\n        }\n      }\n    },\n    \"LocationResponse\": {\n      \"type\": \"object\"\
        ,\n      \"required\": [\n        \"locationId\",\n        \"realmId\",\n        \"code\",\n        \"name\",\n  \
        \      \"locationType\",\n        \"depth\",\n        \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\
        \n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"uuid\"\n        },\n        \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n\
        \          \"description\": \"Realm this location belongs to\"\n        },\n        \"code\": {\n          \"type\"\
        : \"string\"\n        },\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"nullable\": true\n        },\n        \"locationType\": {\n    \
        \      \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"nullable\": true,\n          \"description\": \"Parent location ID
        (null for root locations)\"\n        },\n        \"depth\": {\n          \"type\": \"integer\",\n          \"description\"\
        : \"Depth in hierarchy (0 for root locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\"\
        ,\n          \"description\": \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n      \
        \    \"description\": \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\":
        {\n          \"type\": \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for
        deprecation\"\n        },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\"\
        : true,\n          \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n   \
        \       \"format\": \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n       \
        \   \"format\": \"date-time\"\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n\
        \      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n      \
        \  \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Get child locations for a parent location\",\n  \"description\": \"Retrieve
        all locations that have the specified location as their parent.\\nUseful for getting all cities in a region, all buildings
        in a city, etc.\\n\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\": false,\n  \"operationId\": \"listLocationsByParent\"\
        \n}"
  /location/list-root:
    post:
      summary: Get root locations in a realm
      description: |
        Returns all top-level locations in a realm (locations with no parent).
        These are typically regions or major areas within the realm.
      operationId: listRootLocations
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListRootLocationsRequest'
      responses:
        '200':
          description: Root locations retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationListResponse'

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/ListRootLocationsRequest\"\
        ,\n  \"$defs\": {\n    \"ListRootLocationsRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n     \
        \   \"realmId\"\n      ],\n      \"properties\": {\n        \"realmId\": {\n          \"type\": \"string\",\n    \
        \      \"format\": \"uuid\",\n          \"description\": \"Realm ID to get root locations for\"\n        },\n    \
        \    \"locationType\": {\n          \"allOf\": [\n            {\n              \"$ref\": \"#/$defs/LocationType\"\n\
        \            }\n          ],\n          \"nullable\": true,\n          \"description\": \"Optional filter by location
        type\"\n        },\n        \"includeDeprecated\": {\n          \"type\": \"boolean\",\n          \"default\": false\n\
        \        },\n        \"page\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"default\"\
        : 1\n        },\n        \"pageSize\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"\
        maximum\": 100,\n          \"default\": 20\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"\
        string\",\n      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\"\
        ,\n        \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n     \
        \   \"LANDMARK\",\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationListResponse\"\
        ,\n  \"$defs\": {\n    \"LocationListResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locations\",\n        \"totalCount\",\n        \"page\",\n        \"pageSize\"\n      ],\n      \"properties\": {\n\
        \        \"locations\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/$defs/LocationResponse\"\
        \n          }\n        },\n        \"totalCount\": {\n          \"type\": \"integer\"\n        },\n        \"page\"\
        : {\n          \"type\": \"integer\"\n        },\n        \"pageSize\": {\n          \"type\": \"integer\"\n     \
        \   },\n        \"hasNextPage\": {\n          \"type\": \"boolean\"\n        },\n        \"hasPreviousPage\": {\n\
        \          \"type\": \"boolean\"\n        }\n      }\n    },\n    \"LocationResponse\": {\n      \"type\": \"object\"\
        ,\n      \"required\": [\n        \"locationId\",\n        \"realmId\",\n        \"code\",\n        \"name\",\n  \
        \      \"locationType\",\n        \"depth\",\n        \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\
        \n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"uuid\"\n        },\n        \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n\
        \          \"description\": \"Realm this location belongs to\"\n        },\n        \"code\": {\n          \"type\"\
        : \"string\"\n        },\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"nullable\": true\n        },\n        \"locationType\": {\n    \
        \      \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"nullable\": true,\n          \"description\": \"Parent location ID
        (null for root locations)\"\n        },\n        \"depth\": {\n          \"type\": \"integer\",\n          \"description\"\
        : \"Depth in hierarchy (0 for root locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\"\
        ,\n          \"description\": \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n      \
        \    \"description\": \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\":
        {\n          \"type\": \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for
        deprecation\"\n        },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\"\
        : true,\n          \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n   \
        \       \"format\": \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n       \
        \   \"format\": \"date-time\"\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n\
        \      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n      \
        \  \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Get root locations in a realm\",\n  \"description\": \"Returns all top-level
        locations in a realm (locations with no parent).\\nThese are typically regions or major areas within the realm.\\\
        n\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\": false,\n  \"operationId\": \"listRootLocations\"\n}"
  /location/get-ancestors:
    post:
      summary: Get all ancestors of a location
      description: |
        Returns the full ancestry chain from the specified location up to the
        root location (parentLocationId=null). For example, for a specific building
        might return [district, city, region].
      operationId: getLocationAncestors
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetLocationAncestorsRequest'
      responses:
        '200':
          description: Ancestors retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationListResponse'
        '404':
          description: Location not found

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/GetLocationAncestorsRequest\"\
        ,\n  \"$defs\": {\n    \"GetLocationAncestorsRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n  \
        \      \"locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"description\": \"The location to get ancestors for\"\n        }\n\
        \      }\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationListResponse\"\
        ,\n  \"$defs\": {\n    \"LocationListResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locations\",\n        \"totalCount\",\n        \"page\",\n        \"pageSize\"\n      ],\n      \"properties\": {\n\
        \        \"locations\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/$defs/LocationResponse\"\
        \n          }\n        },\n        \"totalCount\": {\n          \"type\": \"integer\"\n        },\n        \"page\"\
        : {\n          \"type\": \"integer\"\n        },\n        \"pageSize\": {\n          \"type\": \"integer\"\n     \
        \   },\n        \"hasNextPage\": {\n          \"type\": \"boolean\"\n        },\n        \"hasPreviousPage\": {\n\
        \          \"type\": \"boolean\"\n        }\n      }\n    },\n    \"LocationResponse\": {\n      \"type\": \"object\"\
        ,\n      \"required\": [\n        \"locationId\",\n        \"realmId\",\n        \"code\",\n        \"name\",\n  \
        \      \"locationType\",\n        \"depth\",\n        \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\
        \n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"uuid\"\n        },\n        \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n\
        \          \"description\": \"Realm this location belongs to\"\n        },\n        \"code\": {\n          \"type\"\
        : \"string\"\n        },\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"nullable\": true\n        },\n        \"locationType\": {\n    \
        \      \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"nullable\": true,\n          \"description\": \"Parent location ID
        (null for root locations)\"\n        },\n        \"depth\": {\n          \"type\": \"integer\",\n          \"description\"\
        : \"Depth in hierarchy (0 for root locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\"\
        ,\n          \"description\": \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n      \
        \    \"description\": \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\":
        {\n          \"type\": \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for
        deprecation\"\n        },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\"\
        : true,\n          \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n   \
        \       \"format\": \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n       \
        \   \"format\": \"date-time\"\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n\
        \      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n      \
        \  \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Get all ancestors of a location\",\n  \"description\": \"Returns the full
        ancestry chain from the specified location up to the\\nroot location (parentLocationId=null). For example, for a specific
        building\\nmight return [district, city, region].\\n\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\":
        false,\n  \"operationId\": \"getLocationAncestors\"\n}"
  /location/get-descendants:
    post:
      summary: Get all descendants of a location
      description: |
        Returns all locations that are descendants of the specified location
        (direct children, grandchildren, etc.). Useful for finding all places
        within a region or city.
      operationId: getLocationDescendants
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetLocationDescendantsRequest'
      responses:
        '200':
          description: Descendants retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationListResponse'
        '404':
          description: Location not found

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/GetLocationDescendantsRequest\"\
        ,\n  \"$defs\": {\n    \"GetLocationDescendantsRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n\
        \        \"locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"description\": \"The location to get descendants for\"\n        },\n\
        \        \"locationType\": {\n          \"allOf\": [\n            {\n              \"$ref\": \"#/$defs/LocationType\"\
        \n            }\n          ],\n          \"nullable\": true,\n          \"description\": \"Optional filter by location
        type\"\n        },\n        \"maxDepth\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n       \
        \   \"maximum\": 10,\n          \"nullable\": true,\n          \"description\": \"Maximum depth of descendants to
        return (null = all)\"\n        },\n        \"includeDeprecated\": {\n          \"type\": \"boolean\",\n          \"\
        default\": false\n        },\n        \"page\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n \
        \         \"default\": 1\n        },\n        \"pageSize\": {\n          \"type\": \"integer\",\n          \"minimum\"\
        : 1,\n          \"maximum\": 100,\n          \"default\": 20\n        }\n      }\n    },\n    \"LocationType\": {\n\
        \      \"type\": \"string\",\n      \"description\": \"Type classification for locations\",\n      \"enum\": [\n \
        \       \"CONTINENT\",\n        \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n   \
        \     \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n\
        \    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationListResponse\"\
        ,\n  \"$defs\": {\n    \"LocationListResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locations\",\n        \"totalCount\",\n        \"page\",\n        \"pageSize\"\n      ],\n      \"properties\": {\n\
        \        \"locations\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/$defs/LocationResponse\"\
        \n          }\n        },\n        \"totalCount\": {\n          \"type\": \"integer\"\n        },\n        \"page\"\
        : {\n          \"type\": \"integer\"\n        },\n        \"pageSize\": {\n          \"type\": \"integer\"\n     \
        \   },\n        \"hasNextPage\": {\n          \"type\": \"boolean\"\n        },\n        \"hasPreviousPage\": {\n\
        \          \"type\": \"boolean\"\n        }\n      }\n    },\n    \"LocationResponse\": {\n      \"type\": \"object\"\
        ,\n      \"required\": [\n        \"locationId\",\n        \"realmId\",\n        \"code\",\n        \"name\",\n  \
        \      \"locationType\",\n        \"depth\",\n        \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\
        \n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"uuid\"\n        },\n        \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n\
        \          \"description\": \"Realm this location belongs to\"\n        },\n        \"code\": {\n          \"type\"\
        : \"string\"\n        },\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"nullable\": true\n        },\n        \"locationType\": {\n    \
        \      \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"nullable\": true,\n          \"description\": \"Parent location ID
        (null for root locations)\"\n        },\n        \"depth\": {\n          \"type\": \"integer\",\n          \"description\"\
        : \"Depth in hierarchy (0 for root locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\"\
        ,\n          \"description\": \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n      \
        \    \"description\": \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\":
        {\n          \"type\": \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for
        deprecation\"\n        },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\"\
        : true,\n          \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n   \
        \       \"format\": \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n       \
        \   \"format\": \"date-time\"\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n\
        \      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n      \
        \  \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Get all descendants of a location\",\n  \"description\": \"Returns all locations
        that are descendants of the specified location\\n(direct children, grandchildren, etc.). Useful for finding all places\\
        nwithin a region or city.\\n\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\": false,\n  \"operationId\"\
        : \"getLocationDescendants\"\n}"
  /location/create:
    post:
      summary: Create new location
      operationId: createLocation
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLocationRequest'
      responses:
        '201':
          description: Location created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '400':
          description: Invalid location data or parent realm mismatch
        '409':
          description: Location with this code already exists in this realm

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/CreateLocationRequest\"\
        ,\n  \"$defs\": {\n    \"CreateLocationRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        code\",\n        \"name\",\n        \"realmId\",\n        \"locationType\"\n      ],\n      \"properties\": {\n  \
        \      \"code\": {\n          \"type\": \"string\",\n          \"minLength\": 1,\n          \"maxLength\": 100,\n\
        \          \"pattern\": \"^[A-Z][A-Z0-9_]*$\",\n          \"description\": \"Unique code for the location within the
        realm\"\n        },\n        \"name\": {\n          \"type\": \"string\",\n          \"minLength\": 1,\n         \
        \ \"maxLength\": 200,\n          \"description\": \"Display name for the location\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"maxLength\": 2000,\n          \"nullable\": true,\n          \"\
        description\": \"Description of the location\"\n        },\n        \"realmId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location belongs to\"\n        },\n  \
        \      \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"nullable\": true,\n          \"\
        description\": \"Parent location ID for hierarchy (null for root locations)\"\n        },\n        \"metadata\": {\n\
        \          \"type\": \"object\",\n          \"additionalProperties\": true,\n          \"nullable\": true,\n     \
        \     \"description\": \"Additional metadata for the location (JSON)\"\n        }\n      }\n    },\n    \"LocationType\"\
        : {\n      \"type\": \"string\",\n      \"description\": \"Type classification for locations\",\n      \"enum\": [\n\
        \        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n  \
        \      \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n\
        \    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Create new location\",\n  \"description\": \"\",\n  \"tags\": [\n    \"Location
        Admin\"\n  ],\n  \"deprecated\": false,\n  \"operationId\": \"createLocation\"\n}"
  /location/update:
    post:
      summary: Update location
      operationId: updateLocation
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateLocationRequest'
      responses:
        '200':
          description: Location updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '404':
          description: Location not found
        '400':
          description: Invalid update data

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/UpdateLocationRequest\"\
        ,\n  \"$defs\": {\n    \"UpdateLocationRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n    \
        \      \"format\": \"uuid\",\n          \"description\": \"ID of the location to update\"\n        },\n        \"\
        name\": {\n          \"type\": \"string\",\n          \"minLength\": 1,\n          \"maxLength\": 200,\n         \
        \ \"nullable\": true,\n          \"description\": \"Display name for the location\"\n        },\n        \"description\"\
        : {\n          \"type\": \"string\",\n          \"maxLength\": 2000,\n          \"nullable\": true,\n          \"\
        description\": \"Description of the location\"\n        },\n        \"locationType\": {\n          \"allOf\": [\n\
        \            {\n              \"$ref\": \"#/$defs/LocationType\"\n            }\n          ],\n          \"nullable\"\
        : true,\n          \"description\": \"Type of location\"\n        },\n        \"metadata\": {\n          \"type\"\
        : \"object\",\n          \"additionalProperties\": true,\n          \"nullable\": true,\n          \"description\"\
        : \"Additional metadata\"\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n    \
        \  \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"\
        REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Update location\",\n  \"description\": \"\",\n  \"tags\": [\n    \"Location
        Admin\"\n  ],\n  \"deprecated\": false,\n  \"operationId\": \"updateLocation\"\n}"
  /location/set-parent:
    post:
      summary: Set or change the parent of a location
      description: |
        Update a location's parent, moving it in the hierarchy.
        Validates that:
        - New parent exists and is in the same realm
        - No circular reference would be created
        - Updates depth for location and all descendants
      operationId: setLocationParent
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetLocationParentRequest'
      responses:
        '200':
          description: Parent updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '404':
          description: Location or parent not found
        '400':
          description: Invalid parent (different realm or circular reference)

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/SetLocationParentRequest\"\
        ,\n  \"$defs\": {\n    \"SetLocationParentRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n     \
        \   \"locationId\",\n        \"parentLocationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n\
        \          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"ID of the location
        to update\"\n        },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"\
        uuid\",\n          \"description\": \"ID of the new parent location (must be in same realm)\"\n        }\n      }\n\
        \    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Set or change the parent of a location\",\n  \"description\": \"Update a
        location's parent, moving it in the hierarchy.\\nValidates that:\\n- New parent exists and is in the same realm\\\
        n- No circular reference would be created\\n- Updates depth for location and all descendants\\n\",\n  \"tags\": [\n\
        \    \"Location Admin\"\n  ],\n  \"deprecated\": false,\n  \"operationId\": \"setLocationParent\"\n}"
  /location/remove-parent:
    post:
      summary: Remove parent from a location (make it a root location)
      description: |
        Remove the parent of a location, making it a top-level root location
        within its realm. Updates depth for location and all descendants.
      operationId: removeLocationParent
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RemoveLocationParentRequest'
      responses:
        '200':
          description: Parent removed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '404':
          description: Location not found

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/RemoveLocationParentRequest\"\
        ,\n  \"$defs\": {\n    \"RemoveLocationParentRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n  \
        \      \"locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"description\": \"ID of the location to make a root location\"\n  \
        \      }\n      }\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Remove parent from a location (make it a root location)\",\n  \"description\"\
        : \"Remove the parent of a location, making it a top-level root location\\nwithin its realm. Updates depth for location
        and all descendants.\\n\",\n  \"tags\": [\n    \"Location Admin\"\n  ],\n  \"deprecated\": false,\n  \"operationId\"\
        : \"removeLocationParent\"\n}"
  /location/delete:
    post:
      summary: Delete location
      description: |
        Hard delete a location. This will fail if the location:
        - Has child locations (must delete or reparent children first)
        - Is still referenced by other entities
        For safe removal, first deprecate the location, remove all children,
        then delete.
      operationId: deleteLocation
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteLocationRequest'
      responses:
        '204':
          description: Location deleted successfully
        '404':
          description: Location not found
        '409':
          description: Cannot delete - location has children or is in use

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/DeleteLocationRequest\"\
        ,\n  \"$defs\": {\n    \"DeleteLocationRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n    \
        \      \"format\": \"uuid\",\n          \"description\": \"ID of the location to delete\"\n        }\n      }\n  \
        \  }\n  }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n  \"summary\": \"Delete location\",\n  \"description\": \"Hard delete a location. This will
        fail if the location:\\n- Has child locations (must delete or reparent children first)\\n- Is still referenced by
        other entities\\nFor safe removal, first deprecate the location, remove all children,\\nthen delete.\\n\",\n  \"tags\"\
        : [\n    \"Location Admin\"\n  ],\n  \"deprecated\": false,\n  \"operationId\": \"deleteLocation\"\n}"
  /location/deprecate:
    post:
      summary: Deprecate a location
      description: |
        Soft-delete a location by marking it as deprecated.
        Deprecated locations:
        - Remain queryable for historical data
        - Cannot be used for placing new entities
        - Can be hard-deleted after all references are removed
      operationId: deprecateLocation
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeprecateLocationRequest'
      responses:
        '200':
          description: Location deprecated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '404':
          description: Location not found
        '409':
          description: Location is already deprecated

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/DeprecateLocationRequest\"\
        ,\n  \"$defs\": {\n    \"DeprecateLocationRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n     \
        \   \"locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n\
        \          \"format\": \"uuid\",\n          \"description\": \"ID of the location to deprecate\"\n        },\n   \
        \     \"reason\": {\n          \"type\": \"string\",\n          \"maxLength\": 500,\n          \"nullable\": true,\n\
        \          \"description\": \"Optional reason for deprecation (for audit purposes)\"\n        }\n      }\n    }\n\
        \  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Deprecate a location\",\n  \"description\": \"Soft-delete a location by marking
        it as deprecated.\\nDeprecated locations:\\n- Remain queryable for historical data\\n- Cannot be used for placing
        new entities\\n- Can be hard-deleted after all references are removed\\n\",\n  \"tags\": [\n    \"Location Admin\"\
        \n  ],\n  \"deprecated\": false,\n  \"operationId\": \"deprecateLocation\"\n}"
  /location/undeprecate:
    post:
      summary: Restore a deprecated location
      description: |
        Remove the deprecated status from a location, making it
        available for entity placement again.
      operationId: undeprecateLocation
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UndeprecateLocationRequest'
      responses:
        '200':
          description: Location restored successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationResponse'
        '404':
          description: Location not found
        '400':
          description: Location is not deprecated

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/UndeprecateLocationRequest\"\
        ,\n  \"$defs\": {\n    \"UndeprecateLocationRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n   \
        \     \"locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\"\
        ,\n          \"format\": \"uuid\",\n          \"description\": \"ID of the location to restore\"\n        }\n    \
        \  }\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationResponse\"\
        ,\n  \"$defs\": {\n    \"LocationResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"locationId\"\
        ,\n        \"realmId\",\n        \"code\",\n        \"name\",\n        \"locationType\",\n        \"depth\",\n   \
        \     \"isDeprecated\",\n        \"createdAt\",\n        \"updatedAt\"\n      ],\n      \"properties\": {\n      \
        \  \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"realmId\"\
        : {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"description\": \"Realm this location
        belongs to\"\n        },\n        \"code\": {\n          \"type\": \"string\"\n        },\n        \"name\": {\n \
        \         \"type\": \"string\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n        \
        \  \"nullable\": true\n        },\n        \"locationType\": {\n          \"$ref\": \"#/$defs/LocationType\"\n   \
        \     },\n        \"parentLocationId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n    \
        \      \"nullable\": true,\n          \"description\": \"Parent location ID (null for root locations)\"\n        },\n\
        \        \"depth\": {\n          \"type\": \"integer\",\n          \"description\": \"Depth in hierarchy (0 for root
        locations)\"\n        },\n        \"isDeprecated\": {\n          \"type\": \"boolean\",\n          \"description\"\
        : \"Whether this location is deprecated and cannot be used\"\n        },\n        \"deprecatedAt\": {\n          \"\
        type\": \"string\",\n          \"format\": \"date-time\",\n          \"nullable\": true,\n          \"description\"\
        : \"Timestamp when this location was deprecated\"\n        },\n        \"deprecationReason\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Optional reason for deprecation\"\n   \
        \     },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\": true,\n  \
        \        \"nullable\": true\n        },\n        \"createdAt\": {\n          \"type\": \"string\",\n          \"format\"\
        : \"date-time\"\n        },\n        \"updatedAt\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\
        \n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\",\n      \"description\": \"Type
        classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n        \"REGION\",\n        \"CITY\"\
        ,\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\",\n        \"WILDERNESS\"\
        ,\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Restore a deprecated location\",\n  \"description\": \"Remove the deprecated
        status from a location, making it\\navailable for entity placement again.\\n\",\n  \"tags\": [\n    \"Location Admin\"\
        \n  ],\n  \"deprecated\": false,\n  \"operationId\": \"undeprecateLocation\"\n}"
  /location/exists:
    post:
      summary: Check if location exists and is active
      description: |
        Fast validation endpoint for other services to check location validity.
        Returns true if location exists and is not deprecated, false otherwise.
      operationId: locationExists
      tags:
      - Location
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LocationExistsRequest'
      responses:
        '200':
          description: Validation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationExistsResponse'

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationExistsRequest\"\
        ,\n  \"$defs\": {\n    \"LocationExistsRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locationId\"\n      ],\n      \"properties\": {\n        \"locationId\": {\n          \"type\": \"string\",\n    \
        \      \"format\": \"uuid\",\n          \"description\": \"ID of the location to validate\"\n        }\n      }\n\
        \    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/LocationExistsResponse\"\
        ,\n  \"$defs\": {\n    \"LocationExistsResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n       \
        \ \"exists\",\n        \"isActive\"\n      ],\n      \"properties\": {\n        \"exists\": {\n          \"type\"\
        : \"boolean\",\n          \"description\": \"Whether the location exists\"\n        },\n        \"isActive\": {\n\
        \          \"type\": \"boolean\",\n          \"description\": \"Whether the location is active (false if deprecated
        or not found)\"\n        },\n        \"locationId\": {\n          \"type\": \"string\",\n          \"format\": \"\
        uuid\",\n          \"nullable\": true,\n          \"description\": \"The location ID if found\"\n        },\n    \
        \    \"realmId\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\",\n          \"nullable\": true,\n\
        \          \"description\": \"The realm ID if location found\"\n        }\n      }\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Check if location exists and is active\",\n  \"description\": \"Fast validation
        endpoint for other services to check location validity.\\nReturns true if location exists and is not deprecated, false
        otherwise.\\n\",\n  \"tags\": [\n    \"Location\"\n  ],\n  \"deprecated\": false,\n  \"operationId\": \"locationExists\"\
        \n}"
  /location/seed:
    post:
      summary: Seed locations from configuration
      description: |
        Idempotent operation to seed locations from provided data.
        Creates locations that don't exist, optionally updates existing locations.
        Processes locations in dependency order (parents before children).
        Typically called at service startup with YAML-defined location hierarchies.
      operationId: seedLocations
      tags:
      - Location Admin
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SeedLocationsRequest'
      responses:
        '200':
          description: Seed operation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SeedLocationsResponse'
        '400':
          description: Invalid seed data

      x-request-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/SeedLocationsRequest\"\
        ,\n  \"$defs\": {\n    \"SeedLocationsRequest\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        locations\"\n      ],\n      \"properties\": {\n        \"locations\": {\n          \"type\": \"array\",\n       \
        \   \"items\": {\n            \"$ref\": \"#/$defs/SeedLocation\"\n          },\n          \"description\": \"List
        of locations to seed (processed in dependency order)\"\n        },\n        \"updateExisting\": {\n          \"type\"\
        : \"boolean\",\n          \"default\": false,\n          \"description\": \"Whether to update locations that already
        exist\"\n        }\n      }\n    },\n    \"SeedLocation\": {\n      \"type\": \"object\",\n      \"required\": [\n\
        \        \"code\",\n        \"name\",\n        \"realmCode\",\n        \"locationType\"\n      ],\n      \"properties\"\
        : {\n        \"code\": {\n          \"type\": \"string\",\n          \"description\": \"Unique code for the location
        within realm\"\n        },\n        \"name\": {\n          \"type\": \"string\",\n          \"description\": \"Display
        name\"\n        },\n        \"description\": {\n          \"type\": \"string\",\n          \"nullable\": true,\n \
        \         \"description\": \"Description\"\n        },\n        \"realmCode\": {\n          \"type\": \"string\",\n\
        \          \"description\": \"Code of the realm (resolved during seeding)\"\n        },\n        \"locationType\"\
        : {\n          \"$ref\": \"#/$defs/LocationType\"\n        },\n        \"parentLocationCode\": {\n          \"type\"\
        : \"string\",\n          \"nullable\": true,\n          \"description\": \"Code of the parent location (resolved during
        seeding)\"\n        },\n        \"metadata\": {\n          \"type\": \"object\",\n          \"additionalProperties\"\
        : true,\n          \"nullable\": true\n        }\n      }\n    },\n    \"LocationType\": {\n      \"type\": \"string\"\
        ,\n      \"description\": \"Type classification for locations\",\n      \"enum\": [\n        \"CONTINENT\",\n    \
        \    \"REGION\",\n        \"CITY\",\n        \"DISTRICT\",\n        \"BUILDING\",\n        \"ROOM\",\n        \"LANDMARK\"\
        ,\n        \"WILDERNESS\",\n        \"DUNGEON\",\n        \"OTHER\"\n      ]\n    }\n  }\n}"
      x-response-schema-json: "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$ref\": \"#/$defs/SeedLocationsResponse\"\
        ,\n  \"$defs\": {\n    \"SeedLocationsResponse\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"\
        created\",\n        \"updated\",\n        \"skipped\",\n        \"errors\"\n      ],\n      \"properties\": {\n  \
        \      \"created\": {\n          \"type\": \"integer\",\n          \"description\": \"Number of new locations created\"\
        \n        },\n        \"updated\": {\n          \"type\": \"integer\",\n          \"description\": \"Number of existing
        locations updated\"\n        },\n        \"skipped\": {\n          \"type\": \"integer\",\n          \"description\"\
        : \"Number of locations skipped (already exist, updateExisting=false)\"\n        },\n        \"errors\": {\n     \
        \     \"type\": \"array\",\n          \"items\": {\n            \"type\": \"string\"\n          },\n          \"description\"\
        : \"List of error messages for locations that failed to seed\"\n        }\n      }\n    }\n  }\n}"
      x-endpoint-info-json: "{\n  \"summary\": \"Seed locations from configuration\",\n  \"description\": \"Idempotent operation
        to seed locations from provided data.\\nCreates locations that don't exist, optionally updates existing locations.\\
        nProcesses locations in dependency order (parents before children).\\nTypically called at service startup with YAML-defined
        location hierarchies.\\n\",\n  \"tags\": [\n    \"Location Admin\"\n  ],\n  \"deprecated\": false,\n  \"operationId\"\
        : \"seedLocations\"\n}"
components:
  schemas:
    LocationType:
      type: string
      description: Type classification for locations
      enum:
      - CONTINENT
      - REGION
      - CITY
      - DISTRICT
      - BUILDING
      - ROOM
      - LANDMARK
      - WILDERNESS
      - DUNGEON
      - OTHER

    GetLocationRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: Unique identifier of the location

    GetLocationByCodeRequest:
      type: object
      required:
      - code
      - realmId
      properties:
        code:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[A-Z][A-Z0-9_]*$'
          description: Unique code for the location within the realm
        realmId:
          type: string
          format: uuid
          description: Realm ID to scope the code lookup

    ListLocationsRequest:
      type: object
      properties:
        realmId:
          type: string
          format: uuid
          nullable: true
          description: Filter by realm
        locationType:
          allOf:
          - $ref: '#/components/schemas/LocationType'
          nullable: true
          description: Filter by location type
        includeDeprecated:
          type: boolean
          default: false
          description: Whether to include deprecated locations in the response
        page:
          type: integer
          minimum: 1
          default: 1
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          default: 20

    ListLocationsByRealmRequest:
      type: object
      required:
      - realmId
      properties:
        realmId:
          type: string
          format: uuid
          description: Realm ID to query
        locationType:
          allOf:
          - $ref: '#/components/schemas/LocationType'
          nullable: true
          description: Optional type filter
        includeDeprecated:
          type: boolean
          default: false
        page:
          type: integer
          minimum: 1
          default: 1
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          default: 20

    ListLocationsByParentRequest:
      type: object
      required:
      - parentLocationId
      properties:
        parentLocationId:
          type: string
          format: uuid
          description: ID of the parent location
        locationType:
          allOf:
          - $ref: '#/components/schemas/LocationType'
          nullable: true
          description: Optional filter by location type
        includeDeprecated:
          type: boolean
          default: false
        page:
          type: integer
          minimum: 1
          default: 1
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          default: 20

    ListRootLocationsRequest:
      type: object
      required:
      - realmId
      properties:
        realmId:
          type: string
          format: uuid
          description: Realm ID to get root locations for
        locationType:
          allOf:
          - $ref: '#/components/schemas/LocationType'
          nullable: true
          description: Optional filter by location type
        includeDeprecated:
          type: boolean
          default: false
        page:
          type: integer
          minimum: 1
          default: 1
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          default: 20

    GetLocationAncestorsRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: The location to get ancestors for

    GetLocationDescendantsRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: The location to get descendants for
        locationType:
          allOf:
          - $ref: '#/components/schemas/LocationType'
          nullable: true
          description: Optional filter by location type
        maxDepth:
          type: integer
          minimum: 1
          maximum: 10
          nullable: true
          description: Maximum depth of descendants to return (null = all)
        includeDeprecated:
          type: boolean
          default: false
        page:
          type: integer
          minimum: 1
          default: 1
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          default: 20

    CreateLocationRequest:
      type: object
      required:
      - code
      - name
      - realmId
      - locationType
      properties:
        code:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[A-Z][A-Z0-9_]*$'
          description: Unique code for the location within the realm
        name:
          type: string
          minLength: 1
          maxLength: 200
          description: Display name for the location
        description:
          type: string
          maxLength: 2000
          nullable: true
          description: Description of the location
        realmId:
          type: string
          format: uuid
          description: Realm this location belongs to
        locationType:
          $ref: '#/components/schemas/LocationType'
        parentLocationId:
          type: string
          format: uuid
          nullable: true
          description: Parent location ID for hierarchy (null for root locations)
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Additional metadata for the location (JSON)

    UpdateLocationRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: ID of the location to update
        name:
          type: string
          minLength: 1
          maxLength: 200
          nullable: true
          description: Display name for the location
        description:
          type: string
          maxLength: 2000
          nullable: true
          description: Description of the location
        locationType:
          allOf:
          - $ref: '#/components/schemas/LocationType'
          nullable: true
          description: Type of location
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Additional metadata

    SetLocationParentRequest:
      type: object
      required:
      - locationId
      - parentLocationId
      properties:
        locationId:
          type: string
          format: uuid
          description: ID of the location to update
        parentLocationId:
          type: string
          format: uuid
          description: ID of the new parent location (must be in same realm)

    RemoveLocationParentRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: ID of the location to make a root location

    DeleteLocationRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: ID of the location to delete

    DeprecateLocationRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: ID of the location to deprecate
        reason:
          type: string
          maxLength: 500
          nullable: true
          description: Optional reason for deprecation (for audit purposes)

    UndeprecateLocationRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: ID of the location to restore

    LocationExistsRequest:
      type: object
      required:
      - locationId
      properties:
        locationId:
          type: string
          format: uuid
          description: ID of the location to validate

    LocationExistsResponse:
      type: object
      required:
      - exists
      - isActive
      properties:
        exists:
          type: boolean
          description: Whether the location exists
        isActive:
          type: boolean
          description: Whether the location is active (false if deprecated or not found)
        locationId:
          type: string
          format: uuid
          nullable: true
          description: The location ID if found
        realmId:
          type: string
          format: uuid
          nullable: true
          description: The realm ID if location found

    SeedLocationsRequest:
      type: object
      required:
      - locations
      properties:
        locations:
          type: array
          items:
            $ref: '#/components/schemas/SeedLocation'
          description: List of locations to seed (processed in dependency order)
        updateExisting:
          type: boolean
          default: false
          description: Whether to update locations that already exist

    SeedLocation:
      type: object
      required:
      - code
      - name
      - realmCode
      - locationType
      properties:
        code:
          type: string
          description: Unique code for the location within realm
        name:
          type: string
          description: Display name
        description:
          type: string
          nullable: true
          description: Description
        realmCode:
          type: string
          description: Code of the realm (resolved during seeding)
        locationType:
          $ref: '#/components/schemas/LocationType'
        parentLocationCode:
          type: string
          nullable: true
          description: Code of the parent location (resolved during seeding)
        metadata:
          type: object
          additionalProperties: true
          nullable: true

    LocationResponse:
      type: object
      required:
      - locationId
      - realmId
      - code
      - name
      - locationType
      - depth
      - isDeprecated
      - createdAt
      - updatedAt
      properties:
        locationId:
          type: string
          format: uuid
        realmId:
          type: string
          format: uuid
          description: Realm this location belongs to
        code:
          type: string
        name:
          type: string
        description:
          type: string
          nullable: true
        locationType:
          $ref: '#/components/schemas/LocationType'
        parentLocationId:
          type: string
          format: uuid
          nullable: true
          description: Parent location ID (null for root locations)
        depth:
          type: integer
          description: Depth in hierarchy (0 for root locations)
        isDeprecated:
          type: boolean
          description: Whether this location is deprecated and cannot be used
        deprecatedAt:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when this location was deprecated
        deprecationReason:
          type: string
          nullable: true
          description: Optional reason for deprecation
        metadata:
          type: object
          additionalProperties: true
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    LocationListResponse:
      type: object
      required:
      - locations
      - totalCount
      - page
      - pageSize
      properties:
        locations:
          type: array
          items:
            $ref: '#/components/schemas/LocationResponse'
        totalCount:
          type: integer
        page:
          type: integer
        pageSize:
          type: integer
        hasNextPage:
          type: boolean
        hasPreviousPage:
          type: boolean

    SeedLocationsResponse:
      type: object
      required:
      - created
      - updated
      - skipped
      - errors
      properties:
        created:
          type: integer
          description: Number of new locations created
        updated:
          type: integer
          description: Number of existing locations updated
        skipped:
          type: integer
          description: Number of locations skipped (already exist, updateExisting=false)
        errors:
          type: array
          items:
            type: string
          description: List of error messages for locations that failed to seed

