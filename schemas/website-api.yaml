openapi: 3.0.0
info:
  title: Bannou Website Service API
  description: |
    Public-facing website service for registration, information, and account management.

    **NRT Compliance**: AI agents MUST review docs/NRT-SCHEMA-RULES.md before modifying this schema. Optional reference types require `nullable: true`.
  version: 1.0.0
servers:
- url: http://localhost:5012
  description: Bannou service endpoint

paths:
  /website/status:
    get:
      summary: Get website status and version
      operationId: getStatus
      tags:
      - Status
      x-permissions:
      - role: anonymous
        states: {}
      responses:
        '200':
          description: Website service status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'

  /website/content/{slug}:
    get:
      summary: Get dynamic page content from CMS
      operationId: getPageContent
      tags:
      - Content
      x-permissions:
      - role: anonymous
        states: {}
      parameters:
      - name: slug
        in: path
        required: true
        schema:
          type: string
          pattern: "^[a-z0-9-]+$"
        description: Page slug identifier
      responses:
        '200':
          description: Page content retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageContent'
        '404':
          description: Page not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /website/news:
    get:
      summary: Get latest news and announcements
      operationId: getNews
      tags:
      - Content
      x-permissions:
      - role: anonymous
        states: {}
      parameters:
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 50
          default: 10
        description: Number of news items to return
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
        description: Pagination offset
      responses:
        '200':
          description: News items retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewsResponse'

  /website/server-status:
    get:
      summary: Get game server status for all realms
      operationId: getServerStatus
      tags:
      - Status
      x-permissions:
      - role: anonymous
        states: {}
      responses:
        '200':
          description: Server status information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerStatusResponse'

  /website/downloads:
    get:
      summary: Get download links for game clients
      operationId: getDownloads
      tags:
      - Downloads
      x-permissions:
      - role: anonymous
        states: {}
      parameters:
      - name: platform
        in: query
        schema:
          type: string
          enum: [windows, macos, linux]
        description: Filter by platform
      responses:
        '200':
          description: Download links retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DownloadsResponse'

  /website/contact:
    post:
      summary: Submit contact form
      operationId: submitContact
      tags:
      - Contact
      x-permissions:
      - role: anonymous
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContactRequest'
      responses:
        '200':
          description: Contact form submitted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContactResponse'
        '400':
          description: Invalid form data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /website/account/profile:
    get:
      summary: Get account profile for logged-in user
      operationId: getAccountProfile
      tags:
      - Account
      x-permissions:
      - role: user
        states: {}
      security:
      - BearerAuth: []
      responses:
        '200':
          description: Account profile retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountProfile'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /website/account/characters:
    get:
      summary: Get character list for logged-in user
      operationId: getAccountCharacters
      tags:
      - Account
      x-permissions:
      - role: user
        states: {}
      security:
      - BearerAuth: []
      responses:
        '200':
          description: Character list retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CharacterListResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /website/cms/pages:
    get:
      summary: List all CMS pages
      operationId: listPages
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      security:
      - BearerAuth: []
      parameters:
      - name: includeUnpublished
        in: query
        schema:
          type: boolean
          default: false
      responses:
        '200':
          description: Page list retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PageMetadata'
    post:
      summary: Create new CMS page
      operationId: createPage
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PageContent'
      responses:
        '200':
          description: Page created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageContent'

  /website/cms/pages/{slug}:
    put:
      summary: Update CMS page
      operationId: updatePage
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      security:
      - BearerAuth: []
      parameters:
      - name: slug
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PageContent'
      responses:
        '200':
          description: Page updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageContent'
    delete:
      summary: Delete CMS page
      operationId: deletePage
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      security:
      - BearerAuth: []
      parameters:
      - name: slug
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Page deleted

  /website/cms/site-settings:
    get:
      summary: Get site configuration
      operationId: getSiteSettings
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      responses:
        '200':
          description: Site settings retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SiteSettings'
    put:
      summary: Update site configuration
      operationId: updateSiteSettings
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SiteSettings'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SiteSettings'

  /website/cms/theme:
    get:
      summary: Get current theme configuration
      operationId: getTheme
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      responses:
        '200':
          description: Theme configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThemeConfig'
    put:
      summary: Update theme configuration
      operationId: updateTheme
      tags:
      - CMS
      x-permissions:
      - role: developer
        states: {}
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ThemeConfig'
      responses:
        '200':
          description: Theme updated

  /website/account/subscription:
    get:
      summary: Get subscription status
      operationId: getSubscription
      tags:
      - Account
      x-permissions:
      - role: user
        states: {}
      security:
      - BearerAuth: []
      responses:
        '200':
          description: Subscription information retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    StatusResponse:
      description: Health and version status information for the website service
      type: object
      additionalProperties: false
      required:
      - status
      - version
      - uptime
      properties:
        status:
          type: string
          enum: [healthy, degraded, maintenance]
          description: Current health status of the website service
        version:
          type: string
          example: "1.0.0"
          description: Current version of the website service
        uptime:
          type: integer
          description: Uptime in seconds
        maintenanceMessage:
          type: string
          nullable: true
          description: Message displayed during maintenance mode

    PageContent:
      description: Full content and metadata for a CMS-managed page
      type: object
      additionalProperties: false
      required:
      - slug
      - title
      - content
      - contentType
      - published
      properties:
        slug:
          type: string
          pattern: "^[a-z0-9-]+$"
          description: URL-friendly identifier for the page
        title:
          type: string
          description: Display title of the page
        content:
          type: string
          description: HTML, Markdown, or custom template content
        contentType:
          type: string
          enum: [html, markdown, blazor]
          description: Format of the page content
        template:
          type: string
          nullable: true
          description: Template name for custom layouts
        published:
          type: boolean
          description: Whether the page is publicly visible
        publishedAt:
          type: string
          format: date-time
          nullable: true
          description: Date and time when the page was published
        lastModified:
          type: string
          format: date-time
          description: Date and time of the last modification
        author:
          type: string
          nullable: true
          description: Name or identifier of the page author
        metadata:
          type: object
          additionalProperties: true
          description: Custom metadata for the page
        seo:
          $ref: '#/components/schemas/SEOMetadata'
          description: Search engine optimization settings for the page

    PageMetadata:
      description: Summary metadata for a CMS page without full content
      type: object
      additionalProperties: false
      required:
      - slug
      - title
      - published
      properties:
        slug:
          type: string
          description: URL-friendly identifier for the page
        title:
          type: string
          description: Display title of the page
        published:
          type: boolean
          description: Whether the page is publicly visible
        publishedAt:
          type: string
          format: date-time
          nullable: true
          description: Date and time when the page was published
        lastModified:
          type: string
          format: date-time
          description: Date and time of the last modification
        author:
          type: string
          nullable: true
          description: Name or identifier of the page author

    SEOMetadata:
      description: Search engine optimization and social media sharing metadata
      type: object
      additionalProperties: false
      properties:
        description:
          type: string
          nullable: true
          description: Meta description for search engines
        keywords:
          type: array
          items:
            type: string
          description: Keywords for search engine indexing
        ogTitle:
          type: string
          nullable: true
          description: Open Graph title for social media sharing
        ogDescription:
          type: string
          nullable: true
          description: Open Graph description for social media sharing
        ogImage:
          type: string
          format: uri
          nullable: true
          description: Open Graph image URL for social media sharing

    Analytics:
      description: Analytics and tracking configuration for website visitor metrics
      type: object
      additionalProperties: false
      properties:
        googleAnalyticsId:
          type: string
          nullable: true
          description: Google Analytics tracking ID
        otherTrackers:
          type: object
          additionalProperties: true
          description: Configuration for other analytics trackers

    CustomScripts:
      description: Custom script injection configuration for adding JavaScript to pages
      type: object
      additionalProperties: false
      properties:
        head:
          type: string
          nullable: true
          description: Custom scripts to inject in the HTML head
        bodyStart:
          type: string
          nullable: true
          description: Custom scripts to inject at the start of the body
        bodyEnd:
          type: string
          nullable: true
          description: Custom scripts to inject at the end of the body

    Logo:
      description: Site logo configuration including image URL and accessibility text
      type: object
      additionalProperties: false
      properties:
        url:
          type: string
          format: uri
          description: URL of the site logo image
        alt:
          type: string
          description: Alt text for the logo image

    SiteSettings:
      description: Global website configuration including branding, languages, and integrations
      type: object
      additionalProperties: false
      required:
      - siteName
      - siteUrl
      - defaultLanguage
      properties:
        siteName:
          type: string
          description: Display name of the website
        siteUrl:
          type: string
          format: uri
          description: Base URL of the website
        tagline:
          type: string
          nullable: true
          description: Short slogan or description of the site
        defaultLanguage:
          type: string
          default: "en"
          description: Default language code for the website
        supportedLanguages:
          type: array
          items:
            type: string
          description: List of supported language codes
        maintenanceMode:
          type: boolean
          default: false
          description: Whether the site is in maintenance mode
        maintenanceMessage:
          type: string
          nullable: true
          description: Message displayed during maintenance mode
        contactEmail:
          type: string
          format: email
          description: Primary contact email address for the site
        socialLinks:
          type: object
          additionalProperties:
            type: string
            format: uri
          description: Map of social media platform names to profile URLs
        analytics:
          description: Analytics and tracking service configuration
          $ref: '#/components/schemas/Analytics'
        customScripts:
          description: Custom JavaScript scripts to inject into pages
          $ref: '#/components/schemas/CustomScripts'

    ThemeConfig:
      description: Visual theme configuration including colors, fonts, and navigation
      type: object
      additionalProperties: false
      required:
      - themeName
      - primaryColor
      properties:
        themeName:
          type: string
          description: Name of the active theme
        primaryColor:
          type: string
          pattern: "^#[0-9A-Fa-f]{6}$"
          description: Primary brand color in hex format
        secondaryColor:
          type: string
          pattern: "^#[0-9A-Fa-f]{6}$"
          description: Secondary brand color in hex format
        backgroundColor:
          type: string
          pattern: "^#[0-9A-Fa-f]{6}$"
          description: Default background color in hex format
        textColor:
          type: string
          pattern: "^#[0-9A-Fa-f]{6}$"
          description: Default text color in hex format
        fontFamily:
          type: string
          description: Primary font family for the site
        customCSS:
          type: string
          nullable: true
          description: Additional custom CSS styles
        logo:
          description: Site logo configuration for branding
          $ref: '#/components/schemas/Logo'
        favicon:
          type: string
          format: uri
          nullable: true
          description: URL of the site favicon
        navigation:
          type: array
          items:
            $ref: '#/components/schemas/NavigationItem'
          description: Main navigation menu items

    NavigationItem:
      description: A navigation menu entry with optional nested children for dropdowns
      type: object
      additionalProperties: false
      required:
      - label
      - url
      - order
      properties:
        label:
          type: string
          description: Display text for the navigation link
        url:
          type: string
          description: Target URL or path for the navigation link
        order:
          type: integer
          description: Sort order for the navigation item
        target:
          type: string
          enum: [_self, _blank]
          default: _self
          description: Link target attribute for opening behavior
        children:
          type: array
          items:
            $ref: '#/components/schemas/NavigationItem'
          description: Nested child navigation items for dropdowns

    NewsResponse:
      description: Paginated list of news items with total count
      type: object
      additionalProperties: false
      required:
      - items
      - total
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/NewsItem'
          description: List of news items for the current page
        total:
          type: integer
          description: Total number of news items available
        hasMore:
          type: boolean
          description: Whether more news items are available beyond this page

    NewsItem:
      description: A single news article or announcement entry
      type: object
      additionalProperties: false
      required:
      - id
      - title
      - summary
      - publishedAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the news item
        title:
          type: string
          description: Headline of the news item
        summary:
          type: string
          description: Brief summary or excerpt of the news content
        content:
          type: string
          nullable: true
          description: Full content body of the news item
        author:
          type: string
          description: Name of the news item author
        publishedAt:
          type: string
          format: date-time
          description: Date and time when the news was published
        tags:
          type: array
          items:
            type: string
          description: Category tags associated with the news item
        imageUrl:
          type: string
          format: uri
          nullable: true
          description: URL of the featured image for the news item

    ServerStatusResponse:
      description: Aggregated status of all game server realms
      type: object
      additionalProperties: false
      required:
      - realms
      - globalStatus
      properties:
        globalStatus:
          type: string
          enum: [online, partial, offline, maintenance]
          description: Overall status across all game realms
        realms:
          type: array
          items:
            $ref: '#/components/schemas/RealmStatus'
          description: Status information for each game realm

    RealmStatus:
      description: Status and population information for a single game realm
      type: object
      additionalProperties: false
      required:
      - realmId
      - name
      - status
      - population
      properties:
        realmId:
          type: string
          format: uuid
          description: Unique identifier for the game realm
        name:
          type: string
          description: Display name of the game realm
        status:
          type: string
          enum: [online, offline, maintenance, full]
          description: Current operational status of the realm
        population:
          type: string
          enum: [low, medium, high, full]
          description: Current player population level
        playerCount:
          type: integer
          nullable: true
          description: Current number of players online
        ping:
          type: integer
          description: Latency in milliseconds
          nullable: true

    DownloadsResponse:
      description: Collection of available game client downloads by platform
      type: object
      additionalProperties: false
      required:
      - clients
      properties:
        clients:
          type: array
          items:
            $ref: '#/components/schemas/DownloadInfo'
          description: Available game client downloads

    DownloadInfo:
      description: Download details for a specific game client version and platform
      type: object
      additionalProperties: false
      required:
      - platform
      - version
      - url
      - size
      - checksum
      properties:
        platform:
          type: string
          enum: [windows, macos, linux]
          description: Target operating system platform
        version:
          type: string
          description: Version number of the game client
        url:
          type: string
          format: uri
          description: Download URL for the game client
        size:
          type: integer
          description: File size in bytes
        checksum:
          type: string
          description: SHA256 checksum
        releaseNotes:
          type: string
          nullable: true
          description: Release notes or changelog for this version
        minimumRequirements:
          type: object
          additionalProperties: true
          description: Minimum system requirements for the client

    ContactRequest:
      description: User-submitted contact form data
      type: object
      additionalProperties: false
      required:
      - email
      - subject
      - message
      properties:
        email:
          type: string
          format: email
          description: Sender email address for replies
        name:
          type: string
          nullable: true
          description: Name of the person submitting the form
        subject:
          type: string
          minLength: 5
          maxLength: 200
          description: Subject line of the contact message
        message:
          type: string
          minLength: 10
          maxLength: 2000
          description: Body content of the contact message
        category:
          type: string
          enum: [general, support, bug, feedback, business]
          default: general
          description: Category to route the contact request

    ContactResponse:
      description: Confirmation response after submitting a contact form
      type: object
      additionalProperties: false
      required:
      - ticketId
      - message
      properties:
        ticketId:
          type: string
          format: uuid
          description: Unique identifier for the created support ticket
        message:
          type: string
          default: "Thank you for contacting us. We will respond within 24-48 hours."
          description: Confirmation message displayed to the user

    AccountProfile:
      description: User account information displayed on the website profile page
      type: object
      additionalProperties: false
      required:
      - accountId
      - email
      - createdAt
      properties:
        accountId:
          type: string
          format: uuid
          description: Unique identifier for the account
        email:
          type: string
          format: email
          description: Email address associated with the account
        displayName:
          type: string
          nullable: true
          description: User-chosen display name
        createdAt:
          type: string
          format: date-time
          description: Date and time when the account was created
        lastLogin:
          type: string
          format: date-time
          nullable: true
          description: Date and time of the last successful login
        characterSlots:
          type: integer
          description: Total number of character slots available
        usedSlots:
          type: integer
          description: Number of character slots currently in use

    CharacterListResponse:
      description: List of all characters belonging to an account
      type: object
      additionalProperties: false
      required:
      - characters
      properties:
        characters:
          type: array
          items:
            $ref: '#/components/schemas/CharacterSummary'
          description: List of characters owned by the account

    CharacterSummary:
      description: Brief overview of a character for display in character lists
      type: object
      additionalProperties: false
      required:
      - characterId
      - name
      - realm
      - level
      properties:
        characterId:
          type: string
          format: uuid
          description: Unique identifier for the character
        name:
          type: string
          description: Name of the character
        realm:
          type: string
          description: Name of the realm the character belongs to
        level:
          type: integer
          description: Current level of the character
        class:
          type: string
          nullable: true
          description: Character class or profession
        lastPlayed:
          type: string
          format: date-time
          nullable: true
          description: Date and time of last gameplay session

    SubscriptionResponse:
      description: Current subscription status and plan details for an account
      type: object
      additionalProperties: false
      required:
      - status
      - type
      properties:
        status:
          type: string
          enum: [active, inactive, trial, expired]
          description: Current state of the subscription
        type:
          type: string
          enum: [free, basic, premium, lifetime]
          description: Subscription tier or plan type
        expiresAt:
          type: string
          format: date-time
          nullable: true
          description: Date and time when the subscription expires
        autoRenew:
          type: boolean
          description: Whether automatic renewal is enabled
        benefits:
          type: array
          items:
            type: string
          description: List of benefits included in the subscription

    ErrorResponse:
      description: Standard error response with code and message
      type: object
      additionalProperties: false
      required:
      - error
      - message
      properties:
        error:
          type: string
          description: Error code identifying the type of error
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          additionalProperties: true
          nullable: true
          description: Additional error details or context
