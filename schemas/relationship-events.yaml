openapi: 3.0.3
info:
  title: Relationship Service Events
  description: |
    Event models for Relationship service RabbitMQ pub/sub via MassTransit.
    Lifecycle events are auto-generated from x-lifecycle definition.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 1.0.0
  x-event-subscriptions: []  # Relationship service doesn't subscribe to external events
  x-event-publications:
    # Relationship lifecycle events (auto-generated from x-lifecycle)
    - topic: relationship.created
      event: RelationshipCreatedEvent
      description: Published when a new relationship is created
    - topic: relationship.updated
      event: RelationshipUpdatedEvent
      description: Published when a relationship is updated
    - topic: relationship.deleted
      event: RelationshipDeletedEvent
      description: Published when a relationship is soft-deleted

# Lifecycle events auto-generated from this definition
# Output: schemas/Generated/relationship-lifecycle-events.yaml
x-lifecycle:
  Relationship:
    model:
      relationshipId: { type: string, format: uuid, primary: true, required: true, description: "Unique identifier for the relationship" }
      entity1Id: { type: string, format: uuid, required: true, description: "Unique identifier of the first entity in the relationship" }
      entity1Type: { $ref: 'common-api.yaml#/components/schemas/EntityType', required: true, description: "Type classification of the first entity" }
      entity2Id: { type: string, format: uuid, required: true, description: "Unique identifier of the second entity in the relationship" }
      entity2Type: { $ref: 'common-api.yaml#/components/schemas/EntityType', required: true, description: "Type classification of the second entity" }
      relationshipTypeId: { type: string, format: uuid, required: true, description: "Reference to the relationship type definition" }
      startedAt: { type: string, format: date-time, required: true, description: "Timestamp when the relationship began" }
      endedAt: { type: string, format: date-time, description: "Timestamp when the relationship ended, if applicable" }
      metadata: { type: object, additionalProperties: true, description: "Additional custom key-value data associated with the relationship" }
      createdAt: { type: string, format: date-time, required: true, description: "Timestamp when the relationship record was created" }
      updatedAt: { type: string, format: date-time, description: "Timestamp when the relationship record was last updated" }

paths: {}  # Events don't have HTTP paths

# NOTE: No components/schemas - lifecycle events are auto-generated to schemas/Generated/
