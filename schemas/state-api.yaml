openapi: 3.0.3
info:
  title: Bannou State Service API
  version: 1.0.0
  description: |
    Repository pattern state management with Redis and MySQL backends.

    NOTE: This is an INTERNAL service API. No x-permissions are defined because
    these endpoints are NOT exposed to WebSocket clients. Service-to-service
    calls within the cluster are always permitted (per FOUNDATION TENETS).

    All endpoints use POST-only pattern per FOUNDATION TENETS to enable
    zero-copy WebSocket routing with static endpoint GUIDs.

servers:
- url: http://localhost:5012

paths:
  /state/get:
    post:
      operationId: getState
      summary: Get state value by key
      tags:
      - State
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetStateRequest'
      responses:
        '200':
          description: State value retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetStateResponse'
        '404':
          description: Key not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetStateRequest\"\
        ,\n    \"$defs\": {\n        \"GetStateRequest\": {\n            \"description\": \"Request to retrieve a single state
        value by key from a state store\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"storeName\",\n                \"key\"\n            ],\n          \
        \  \"properties\": {\n                \"storeName\": {\n                    \"type\": \"string\",\n              \
        \      \"description\": \"Name of the state store\"\n                },\n                \"key\": {\n            \
        \        \"type\": \"string\",\n                    \"description\": \"Key to retrieve\"\n                }\n    \
        \        }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetStateResponse\"\
        ,\n    \"$defs\": {\n        \"GetStateResponse\": {\n            \"description\": \"Response containing a retrieved
        state value with its metadata and ETag\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"value\": {\n                    \"type\": \"object\",\n\
        \                    \"additionalProperties\": false,\n                    \"nullable\": true,\n                 \
        \   \"description\": \"The stored value (null if not found)\"\n                },\n                \"etag\": {\n \
        \                   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"ETag for optimistic concurrency\"\n                },\n                \"metadata\": {\n                    \"\
        $ref\": \"#/$defs/StateMetadata\",\n                    \"description\": \"Metadata about the state entry including
        timestamps and version\"\n                }\n            }\n        },\n        \"StateMetadata\": {\n           \
        \ \"description\": \"Metadata associated with a state entry including creation time, last update time, and version\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When the state was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        When the state was last updated\"\n                },\n                \"version\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Version number for optimistic concurrency\"\n             \
        \   }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get state value by key\",\n    \"description\": \"\",\n    \"tags\": [\n\
        \        \"State\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getState\"\n}"
  /state/save:
    post:
      operationId: saveState
      summary: Save state value
      tags:
      - State
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SaveStateRequest'
      responses:
        '200':
          description: State saved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SaveStateResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveStateRequest\"\
        ,\n    \"$defs\": {\n        \"SaveStateRequest\": {\n            \"description\": \"Request to save a state value
        to a state store with optional TTL and consistency settings\",\n            \"type\": \"object\",\n            \"\
        additionalProperties\": false,\n            \"required\": [\n                \"storeName\",\n                \"key\"\
        ,\n                \"value\"\n            ],\n            \"properties\": {\n                \"storeName\": {\n  \
        \                  \"type\": \"string\",\n                    \"description\": \"Name of the state store\"\n     \
        \           },\n                \"key\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Key to save\"\n                },\n                \"value\": {\n                    \"type\": \"object\",\n \
        \                   \"additionalProperties\": false,\n                    \"description\": \"Value to store\"\n  \
        \              },\n                \"options\": {\n                    \"$ref\": \"#/$defs/StateOptions\",\n     \
        \               \"description\": \"Optional settings for the save operation including TTL and consistency\"\n    \
        \            }\n            }\n        },\n        \"StateOptions\": {\n            \"description\": \"Configuration
        options for state save operations including TTL, consistency level, and optimistic concurrency\",\n            \"\
        type\": \"object\",\n            \"additionalProperties\": false,\n            \"properties\": {\n               \
        \ \"ttl\": {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"TTL in seconds (Redis only)\"\n                },\n                \"consistency\": {\n\
        \                    \"type\": \"string\",\n                    \"enum\": [\n                        \"strong\",\n\
        \                        \"eventual\"\n                    ],\n                    \"default\": \"strong\",\n    \
        \                \"description\": \"Consistency level\"\n                },\n                \"etag\": {\n       \
        \             \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Optimistic concurrency check - save fails if ETag mismatch\"\n                }\n            }\n        }\n  \
        \  }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SaveStateResponse\"\
        ,\n    \"$defs\": {\n        \"SaveStateResponse\": {\n            \"description\": \"Response from a save operation
        containing the new ETag and success status\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"etag\": {\n                    \"type\": \"string\",\n\
        \                    \"description\": \"New ETag after save\"\n                },\n                \"success\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"Whether the save succeeded\"\n\
        \                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Save state value\",\n    \"description\": \"\",\n    \"tags\": [\n    \
        \    \"State\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"saveState\"\n}"
  /state/delete:
    post:
      operationId: deleteState
      summary: Delete state value
      tags:
      - State
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteStateRequest'
      responses:
        '200':
          description: State deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteStateResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteStateRequest\"\
        ,\n    \"$defs\": {\n        \"DeleteStateRequest\": {\n            \"description\": \"Request to delete a state value
        by key from a state store\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n  \
        \          \"required\": [\n                \"storeName\",\n                \"key\"\n            ],\n            \"\
        properties\": {\n                \"storeName\": {\n                    \"type\": \"string\",\n                   \
        \ \"description\": \"Name of the state store\"\n                },\n                \"key\": {\n                 \
        \   \"type\": \"string\",\n                    \"description\": \"Key to delete\"\n                }\n           \
        \ }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteStateResponse\"\
        ,\n    \"$defs\": {\n        \"DeleteStateResponse\": {\n            \"description\": \"Response from a delete operation
        indicating whether the key was removed\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"deleted\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether the key was deleted (false if not found)\"\n                }\n\
        \            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Delete state value\",\n    \"description\": \"\",\n    \"tags\": [\n  \
        \      \"State\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"deleteState\"\n}"
  /state/query:
    post:
      operationId: queryState
      summary: Query state (MySQL JSON queries or Redis with search enabled)
      tags:
      - State
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryStateRequest'
      responses:
        '200':
          description: Query results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryStateResponse'
        '400':
          description: Query not supported (Redis store without search enabled)
        '404':
          description: Store not found

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryStateRequest\"\
        ,\n    \"$defs\": {\n        \"QueryStateRequest\": {\n            \"description\": \"Request to query state entries
        with filtering, sorting, and pagination support for MySQL and Redis backends\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"storeName\"\n    \
        \        ],\n            \"properties\": {\n                \"storeName\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Name of the state store (MySQL or Redis with search enabled)\"\n       \
        \         },\n                \"filter\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : false,\n                    \"nullable\": true,\n                    \"description\": \"Filter expression. Format
        depends on backend:\\n\\n**MySQL JSON queries** - structured conditions:\\n```json\\n{\\n  \\\"conditions\\\": [\\\
        n    { \\\"path\\\": \\\"$.name\\\", \\\"operator\\\": \\\"equals\\\", \\\"value\\\": \\\"John\\\" },\\n    { \\\"\
        path\\\": \\\"$.age\\\", \\\"operator\\\": \\\"gte\\\", \\\"value\\\": 18 }\\n  ]\\n}\\n```\\n\\n**MySQL simple equality**
        - flat object format:\\n```json\\n{ \\\"$.name\\\": \\\"John\\\", \\\"$.status\\\": \\\"active\\\" }\\n```\\n\\n**Redis
        search** - use indexName and query properties instead\\n\"\n                },\n                \"indexName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Redis search index name. Defaults to \\\"{storeName}-idx\\\".\\nOnly used for Redis stores with search enabled.\\\
        n\"\n                },\n                \"query\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"RedisSearch query string (e.g., \\\"@name:John\\\
        \", \\\"@age:[18 +inf]\\\", \\\"*\\\").\\nDefaults to \\\"*\\\" (match all). Only used for Redis stores with search
        enabled.\\n\"\n                },\n                \"sort\": {\n                    \"type\": \"array\",\n       \
        \             \"items\": {\n                        \"$ref\": \"#/$defs/SortField\"\n                    },\n    \
        \                \"nullable\": true,\n                    \"description\": \"Sort order (first field only is used)
        (null for default ordering)\"\n                },\n                \"page\": {\n                    \"type\": \"integer\"\
        ,\n                    \"default\": 0,\n                    \"description\": \"Page number (0-indexed)\"\n       \
        \         },\n                \"pageSize\": {\n                    \"type\": \"integer\",\n                    \"\
        default\": 100,\n                    \"description\": \"Items per page (max 1000)\"\n                }\n         \
        \   }\n        },\n        \"SortField\": {\n            \"description\": \"Specifies a field and direction for sorting
        query results\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"\
        properties\": {\n                \"field\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Field name to sort by (JSON path for MySQL, field name for Redis)\"\n                },\n                \"order\"\
        : {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"asc\",\n\
        \                        \"desc\"\n                    ],\n                    \"default\": \"asc\",\n           \
        \         \"description\": \"Sort direction\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryStateResponse\"\
        ,\n    \"$defs\": {\n        \"QueryStateResponse\": {\n            \"description\": \"Response containing paginated
        query results with total count information\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"results\": {\n                    \"type\": \"array\",\n\
        \                    \"items\": {\n                        \"type\": \"object\",\n                        \"additionalProperties\"\
        : false\n                    },\n                    \"description\": \"Query results\"\n                },\n    \
        \            \"totalCount\": {\n                    \"type\": \"integer\",\n                    \"description\": \"\
        Total matching items (for pagination)\"\n                },\n                \"page\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Current page number\"\n                },\n               \
        \ \"pageSize\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Items per page\"\
        \n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Query state (MySQL JSON queries or Redis with search enabled)\",\n    \"\
        description\": \"\",\n    \"tags\": [\n        \"State\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"queryState\"\n}"
  /state/bulk-get:
    post:
      operationId: bulkGetState
      summary: Bulk get multiple keys
      tags:
      - State
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkGetStateRequest'
      responses:
        '200':
          description: Bulk results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkGetStateResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkGetStateRequest\"\
        ,\n    \"$defs\": {\n        \"BulkGetStateRequest\": {\n            \"description\": \"Request to retrieve multiple
        state values by key in a single operation\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"storeName\",\n                \"keys\"\n            ],\n\
        \            \"properties\": {\n                \"storeName\": {\n                    \"type\": \"string\",\n    \
        \                \"description\": \"Name of the state store\"\n                },\n                \"keys\": {\n \
        \                   \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\
        \n                    },\n                    \"description\": \"Keys to retrieve\"\n                }\n         \
        \   }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkGetStateResponse\"\
        ,\n    \"$defs\": {\n        \"BulkGetStateResponse\": {\n            \"description\": \"Response containing the results
        of a bulk get operation for multiple keys\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"items\": {\n                    \"type\": \"array\",\n\
        \                    \"items\": {\n                        \"$ref\": \"#/$defs/BulkStateItem\"\n                 \
        \   },\n                    \"description\": \"Results for each key\"\n                }\n            }\n        },\n\
        \        \"BulkStateItem\": {\n            \"description\": \"A single item result from a bulk get operation including
        the key, value, ETag, and found status\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"key\": {\n                    \"type\": \"string\",\n \
        \                   \"description\": \"The key\"\n                },\n                \"value\": {\n             \
        \       \"type\": \"object\",\n                    \"additionalProperties\": false,\n                    \"nullable\"\
        : true,\n                    \"description\": \"The value (null if not found)\"\n                },\n            \
        \    \"etag\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n           \
        \         \"description\": \"ETag for this item\"\n                },\n                \"found\": {\n            \
        \        \"type\": \"boolean\",\n                    \"description\": \"Whether the key was found\"\n            \
        \    }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Bulk get multiple keys\",\n    \"description\": \"\",\n    \"tags\": [\n\
        \        \"State\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"bulkGetState\"\n}"
  /state/list-stores:
    post:
      operationId: listStores
      summary: List configured state stores
      tags:
      - State
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListStoresRequest'
      responses:
        '200':
          description: List of stores
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListStoresResponse'

      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListStoresRequest\"\
        ,\n    \"$defs\": {\n        \"ListStoresRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Optional filters for store listing (empty object returns all)\",\n      \
        \      \"properties\": {\n                \"backendFilter\": {\n                    \"type\": \"string\",\n      \
        \              \"enum\": [\n                        \"redis\",\n                        \"mysql\"\n              \
        \      ],\n                    \"nullable\": true,\n                    \"description\": \"Filter stores by backend
        type\"\n                },\n                \"includeStats\": {\n                    \"type\": \"boolean\",\n    \
        \                \"default\": false,\n                    \"description\": \"Include key counts (may be slow for large
        stores)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListStoresResponse\"\
        ,\n    \"$defs\": {\n        \"ListStoresResponse\": {\n            \"description\": \"Response containing the list
        of configured state stores\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n \
        \           \"properties\": {\n                \"stores\": {\n                    \"type\": \"array\",\n         \
        \           \"items\": {\n                        \"$ref\": \"#/$defs/StoreInfo\"\n                    },\n      \
        \              \"description\": \"List of configured stores\"\n                }\n            }\n        },\n    \
        \    \"StoreInfo\": {\n            \"description\": \"Information about a configured state store including its name,
        backend type, and optional key count\",\n            \"type\": \"object\",\n            \"additionalProperties\":
        false,\n            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n  \
        \                  \"description\": \"Store name\"\n                },\n                \"backend\": {\n         \
        \           \"type\": \"string\",\n                    \"enum\": [\n                        \"redis\",\n         \
        \               \"mysql\"\n                    ],\n                    \"description\": \"Backend type\"\n       \
        \         },\n                \"keyCount\": {\n                    \"type\": \"integer\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Number of keys (only if includeStats=true)\"\n         \
        \       }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List configured state stores\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"State\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"listStores\"\n}"
components:
  schemas:
    GetStateRequest:
      description: Request to retrieve a single state value by key from a state store
      type: object
      additionalProperties: false
      required:
      - storeName
      - key
      properties:
        storeName:
          type: string
          description: Name of the state store
        key:
          type: string
          description: Key to retrieve

    GetStateResponse:
      description: Response containing a retrieved state value with its metadata and ETag
      type: object
      additionalProperties: false
      properties:
        value:
          type: object
          additionalProperties: false
          nullable: true
          description: The stored value (null if not found)
        etag:
          type: string
          nullable: true
          description: ETag for optimistic concurrency
        metadata:
          $ref: '#/components/schemas/StateMetadata'
          description: Metadata about the state entry including timestamps and version

    SaveStateRequest:
      description: Request to save a state value to a state store with optional TTL and consistency settings
      type: object
      additionalProperties: false
      required:
      - storeName
      - key
      - value
      properties:
        storeName:
          type: string
          description: Name of the state store
        key:
          type: string
          description: Key to save
        value:
          type: object
          additionalProperties: false
          description: Value to store
        options:
          $ref: '#/components/schemas/StateOptions'
          description: Optional settings for the save operation including TTL and consistency

    SaveStateResponse:
      description: Response from a save operation containing the new ETag and success status
      type: object
      additionalProperties: false
      properties:
        etag:
          type: string
          description: New ETag after save
        success:
          type: boolean
          description: Whether the save succeeded

    DeleteStateRequest:
      description: Request to delete a state value by key from a state store
      type: object
      additionalProperties: false
      required:
      - storeName
      - key
      properties:
        storeName:
          type: string
          description: Name of the state store
        key:
          type: string
          description: Key to delete

    DeleteStateResponse:
      description: Response from a delete operation indicating whether the key was removed
      type: object
      additionalProperties: false
      properties:
        deleted:
          type: boolean
          description: Whether the key was deleted (false if not found)

    StateOptions:
      description: Configuration options for state save operations including TTL, consistency level, and optimistic 
        concurrency
      type: object
      additionalProperties: false
      properties:
        ttl:
          type: integer
          nullable: true
          description: TTL in seconds (Redis only)
        consistency:
          type: string
          enum:
          - strong
          - eventual
          default: strong
          description: Consistency level
        etag:
          type: string
          nullable: true
          description: Optimistic concurrency check - save fails if ETag mismatch

    StateMetadata:
      description: Metadata associated with a state entry including creation time, last update time, and version
      type: object
      additionalProperties: false
      properties:
        createdAt:
          type: string
          format: date-time
          nullable: true
          description: When the state was created
        updatedAt:
          type: string
          format: date-time
          nullable: true
          description: When the state was last updated
        version:
          type: integer
          description: Version number for optimistic concurrency

    QueryStateRequest:
      description: Request to query state entries with filtering, sorting, and pagination support for MySQL and Redis 
        backends
      type: object
      additionalProperties: false
      required:
      - storeName
      properties:
        storeName:
          type: string
          description: Name of the state store (MySQL or Redis with search enabled)
        filter:
          type: object
          additionalProperties: false
          nullable: true
          description: |
            Filter expression. Format depends on backend:

            **MySQL JSON queries** - structured conditions:
            ```json
            {
              "conditions": [
                { "path": "$.name", "operator": "equals", "value": "John" },
                { "path": "$.age", "operator": "gte", "value": 18 }
              ]
            }
            ```

            **MySQL simple equality** - flat object format:
            ```json
            { "$.name": "John", "$.status": "active" }
            ```

            **Redis search** - use indexName and query properties instead
        indexName:
          type: string
          nullable: true
          description: |
            Redis search index name. Defaults to "{storeName}-idx".
            Only used for Redis stores with search enabled.
        query:
          type: string
          nullable: true
          description: |
            RedisSearch query string (e.g., "@name:John", "@age:[18 +inf]", "*").
            Defaults to "*" (match all). Only used for Redis stores with search enabled.
        sort:
          type: array
          items:
            $ref: '#/components/schemas/SortField'
          nullable: true
          description: Sort order (first field only is used) (null for default ordering)
        page:
          type: integer
          default: 0
          description: Page number (0-indexed)
        pageSize:
          type: integer
          default: 100
          description: Items per page (max 1000)

    SortField:
      description: Specifies a field and direction for sorting query results
      type: object
      additionalProperties: false
      properties:
        field:
          type: string
          description: Field name to sort by (JSON path for MySQL, field name for Redis)
        order:
          type: string
          enum:
          - asc
          - desc
          default: asc
          description: Sort direction

    QueryCondition:
      type: object
      additionalProperties: false
      description: A single query condition for MySQL JSON queries
      required:
      - path
      properties:
        path:
          type: string
          description: JSON path to query (e.g., "$.name", "$.address.city", "$.tags[0]")
        operator:
          $ref: '#/components/schemas/QueryOperator'
          description: Comparison operator to use for the condition
        value:
          description: Value to compare against. Not required for exists/notExists operators.

    QueryOperator:
      type: string
      description: Comparison operator for query conditions
      enum:
      - equals
      - notEquals
      - greaterThan
      - greaterThanOrEqual
      - lessThan
      - lessThanOrEqual
      - contains
      - startsWith
      - endsWith
      - in
      - exists
      - notExists
      - fullText
      default: equals

    QueryStateResponse:
      description: Response containing paginated query results with total count information
      type: object
      additionalProperties: false
      properties:
        results:
          type: array
          items:
            type: object
            additionalProperties: false
          description: Query results
        totalCount:
          type: integer
          description: Total matching items (for pagination)
        page:
          type: integer
          description: Current page number
        pageSize:
          type: integer
          description: Items per page

    BulkGetStateRequest:
      description: Request to retrieve multiple state values by key in a single operation
      type: object
      additionalProperties: false
      required:
      - storeName
      - keys
      properties:
        storeName:
          type: string
          description: Name of the state store
        keys:
          type: array
          items:
            type: string
          description: Keys to retrieve

    BulkGetStateResponse:
      description: Response containing the results of a bulk get operation for multiple keys
      type: object
      additionalProperties: false
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/BulkStateItem'
          description: Results for each key

    BulkStateItem:
      description: A single item result from a bulk get operation including the key, value, ETag, and found status
      type: object
      additionalProperties: false
      properties:
        key:
          type: string
          description: The key
        value:
          type: object
          additionalProperties: false
          nullable: true
          description: The value (null if not found)
        etag:
          type: string
          nullable: true
          description: ETag for this item
        found:
          type: boolean
          description: Whether the key was found

    ListStoresRequest:
      type: object
      additionalProperties: false
      description: Optional filters for store listing (empty object returns all)
      properties:
        backendFilter:
          type: string
          enum:
          - redis
          - mysql
          nullable: true
          description: Filter stores by backend type
        includeStats:
          type: boolean
          default: false
          description: Include key counts (may be slow for large stores)

    ListStoresResponse:
      description: Response containing the list of configured state stores
      type: object
      additionalProperties: false
      properties:
        stores:
          type: array
          items:
            $ref: '#/components/schemas/StoreInfo'
          description: List of configured stores

    StoreInfo:
      description: Information about a configured state store including its name, backend type, and optional key count
      type: object
      additionalProperties: false
      properties:
        name:
          type: string
          description: Store name
        backend:
          type: string
          enum:
          - redis
          - mysql
          description: Backend type
        keyCount:
          type: integer
          nullable: true
          description: Number of keys (only if includeStats=true)
