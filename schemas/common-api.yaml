openapi: 3.0.3
info:
  title: Common API Types
  description: |
    Shared type definitions used across multiple Bannou services.
    These types are not owned by any specific plugin and provide
    system-wide consistency for cross-service concepts.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 1.0.0

# No paths - this schema only defines shared types
paths: {}

components:
  schemas:
    # ==========================================================================
    # Shared Enums
    # ==========================================================================

    EntityType:
      type: string
      description: |
        Universal entity type identifier used across Bannou services.
        Provides first-class support for various kinds of entities in analytics,
        achievements, leaderboards, contracts, relationships, and other systems.
      enum:
        - system
        - account
        - character
        - actor
        - guild
        - organization
        - government
        - faction
        - location
        - realm
        - item
        - monster
        - custom
        - other

    # ==========================================================================
    # Archive Base Types
    # ==========================================================================

    ResourceArchiveBase:
      type: object
      description: |
        Base schema for all resource archives that can be stored in
        the resource service's archive bundles and consumed by the
        storyline SDK's ArchiveExtractor.

        Archives implementing this base schema are marked with
        x-archive-type: true and are automatically collected by
        the archive generation script for SDK model generation.
      required:
        - resourceId
        - resourceType
        - archivedAt
        - schemaVersion
      properties:
        resourceId:
          type: string
          format: uuid
          description: Unique identifier of the archived resource
        resourceType:
          type: string
          description: Type identifier (e.g., "character", "character-personality", "realm-history")
        archivedAt:
          type: string
          format: date-time
          description: When this archive was created
        schemaVersion:
          type: integer
          minimum: 1
          description: Schema version for forward compatibility migration
        nestedArchives:
          type: array
          description: Child archives from dependent resources (populated by lib-resource compression)
          items:
            $ref: '#/components/schemas/ResourceArchiveBase'
