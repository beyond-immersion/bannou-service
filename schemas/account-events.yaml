openapi: 3.0.3
info:
  title: Account Service Events
  description: |
    Event models for Accounts service RabbitMQ pub/sub via MassTransit.
    Lifecycle events are auto-generated from x-lifecycle definition.

    **NRT Compliance**: AI agents MUST review docs/NRT-SCHEMA-RULES.md before
    modifying this schema. Optional reference types require `nullable: true`.
  version: 1.0.0
  x-event-subscriptions: []  # Accounts service doesn't subscribe to external events
  x-event-publications:
    # Account lifecycle events (auto-generated from x-lifecycle)
    - topic: account.created
      event: AccountCreatedEvent
      description: Published when a new account is created
    - topic: account.updated
      event: AccountUpdatedEvent
      description: Published when an account is updated
    - topic: account.deleted
      event: AccountDeletedEvent
      description: Published when an account is soft-deleted

# Lifecycle events auto-generated from this definition
# Output: schemas/Generated/accounts-lifecycle-events.yaml
x-lifecycle:
  Account:
    model:
      accountId: { type: string, format: uuid, primary: true, required: true, description: "Unique identifier for the account" }
      email: { type: string, format: email, required: true, description: "Email address associated with the account" }
      displayName: { type: string, nullable: true, description: "User-chosen display name for the account" }
      emailVerified: { type: boolean, required: true, description: "Whether the email address has been verified" }
      roles: { type: array, items: { type: string }, nullable: true, description: "List of roles assigned to the account" }  # NRT: Optional array MUST be nullable
      createdAt: { type: string, format: date-time, required: true, description: "Timestamp when the account was created" }
      updatedAt: { type: string, format: date-time, nullable: true, description: "Timestamp when the account was last updated" }  # NRT: Optional property MUST be nullable
      metadata: { type: object, additionalProperties: true, nullable: true, description: "Additional metadata associated with the account" }  # NRT: Optional object MUST be nullable
    sensitive: [passwordHash]

paths: {}  # Events don't have HTTP paths

# Note: AccountCreatedEvent, AccountUpdatedEvent, AccountDeletedEvent are auto-generated
# from the x-lifecycle definition above. Do not define them manually here.
# See: schemas/Generated/accounts-lifecycle-events.yaml for the generated events.

components:
  schemas: {}  # All account events are auto-generated from x-lifecycle
