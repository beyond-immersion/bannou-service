openapi: 3.0.3
info:
  title: Documentation Service Configuration
  description: |
    Configuration schema for Documentation service.
    Properties are bound to environment variables with DOCUMENTATION_ prefix.

    **NRT Compliance**: AI agents MUST review docs/NRT-SCHEMA-RULES.md before
    modifying this schema. Optional reference types require `nullable: true`.
  version: 1.0.0
paths: {}
x-service-configuration:
  properties:
    # Search Index Configuration
    SearchIndexRebuildOnStartup:
      type: boolean
      description: Whether to rebuild search index on service startup
      env: DOCUMENTATION_SEARCH_INDEX_REBUILD_ON_STARTUP
      default: true

    # Session Configuration
    SessionTtlSeconds:
      type: integer
      description: TTL for informal session tracking (24 hours default)
      env: DOCUMENTATION_SESSION_TTL_SECONDS
      default: 86400

    # Content Size Limits
    MaxContentSizeBytes:
      type: integer
      description: Maximum document content size in bytes (500KB default)
      env: DOCUMENTATION_MAX_CONTENT_SIZE_BYTES
      default: 524288

    # Trashcan Configuration
    TrashcanTtlDays:
      type: integer
      description: Days before trashcan items are auto-purged
      env: DOCUMENTATION_TRASHCAN_TTL_DAYS
      default: 7

    # Voice Summary Configuration
    VoiceSummaryMaxLength:
      type: integer
      description: Maximum characters for voice summaries
      env: DOCUMENTATION_VOICE_SUMMARY_MAX_LENGTH
      default: 200

    # Search Configuration
    SearchCacheTtlSeconds:
      type: integer
      description: TTL for search result caching
      env: DOCUMENTATION_SEARCH_CACHE_TTL_SECONDS
      default: 300
    MinRelevanceScore:
      type: number
      description: Default minimum relevance score for search results
      env: DOCUMENTATION_MIN_RELEVANCE_SCORE
      default: 0.3
    MaxSearchResults:
      type: integer
      description: Maximum search results to return
      env: DOCUMENTATION_MAX_SEARCH_RESULTS
      default: 20

    # Import Configuration
    MaxImportDocuments:
      type: integer
      description: Maximum documents per import (0 = unlimited)
      env: DOCUMENTATION_MAX_IMPORT_DOCUMENTS
      default: 0

    # AI Enhancement Configuration (disabled by default)
    AiEnhancementsEnabled:
      type: boolean
      description: Enable AI-powered semantic search (future feature)
      env: DOCUMENTATION_AI_ENHANCEMENTS_ENABLED
      default: false
    AiEmbeddingsModel:
      type: string
      nullable: true  # NRT: Optional config MUST be nullable (only used when AI enabled)
      description: Model for generating embeddings (when AI enabled)
      env: DOCUMENTATION_AI_EMBEDDINGS_MODEL

    # Git Repository Binding Configuration
    GitStoragePath:
      type: string
      description: Local path for cloned git repositories
      env: DOCUMENTATION_GIT_STORAGE_PATH
      default: "/tmp/bannou-git-repos"
    GitStorageCleanupHours:
      type: integer
      description: Hours before inactive repos are cleaned up
      env: DOCUMENTATION_GIT_STORAGE_CLEANUP_HOURS
      default: 24
    GitCloneTimeoutSeconds:
      type: integer
      description: Clone/pull operation timeout in seconds
      env: DOCUMENTATION_GIT_CLONE_TIMEOUT_SECONDS
      default: 300
    SyncSchedulerEnabled:
      type: boolean
      description: Enable background sync scheduler
      env: DOCUMENTATION_SYNC_SCHEDULER_ENABLED
      default: true
    SyncSchedulerCheckIntervalMinutes:
      type: integer
      description: How often to check for repos needing sync
      env: DOCUMENTATION_SYNC_SCHEDULER_CHECK_INTERVAL_MINUTES
      default: 5
    MaxConcurrentSyncs:
      type: integer
      description: Maximum concurrent sync operations
      env: DOCUMENTATION_MAX_CONCURRENT_SYNCS
      default: 3
    MaxDocumentsPerSync:
      type: integer
      description: Maximum documents per sync operation
      env: DOCUMENTATION_MAX_DOCUMENTS_PER_SYNC
      default: 1000

    # Background Service Configuration
    RepositorySyncCheckIntervalSeconds:
      type: integer
      description: Interval in seconds between repository sync opportunity checks
      env: DOCUMENTATION_REPOSITORY_SYNC_CHECK_INTERVAL_SECONDS
      default: 30
    # Bulk Operation Limits
    BulkOperationBatchSize:
      type: integer
      description: Maximum documents processed per bulk operation
      env: DOCUMENTATION_BULK_OPERATION_BATCH_SIZE
      default: 10
