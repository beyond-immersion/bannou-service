openapi: 3.0.3
info:
  title: Item Service Configuration
  description: |
    Configuration schema for Item service.
    Properties are bound to environment variables with BANNOU_ prefix.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 1.0.0
paths: {}
x-service-configuration:
  properties:
    defaultMaxStackSize:
      type: integer
      env: ITEM_DEFAULT_MAX_STACK_SIZE
      default: 99
      description: Default max stack size for new templates when not specified
    defaultWeightPrecision:
      $ref: 'item-api.yaml#/components/schemas/WeightPrecision'
      env: ITEM_DEFAULT_WEIGHT_PRECISION
      default: decimal_2
      description: Default weight precision for new templates
    templateCacheTtlSeconds:
      type: integer
      env: ITEM_TEMPLATE_CACHE_TTL_SECONDS
      default: 3600
      description: TTL for template cache entries in seconds (templates change infrequently)
    instanceCacheTtlSeconds:
      type: integer
      env: ITEM_INSTANCE_CACHE_TTL_SECONDS
      default: 900
      description: TTL for instance cache entries in seconds (15 minutes for active gameplay)
    maxInstancesPerQuery:
      type: integer
      env: ITEM_MAX_INSTANCES_PER_QUERY
      default: 1000
      description: Maximum item instances returned in a single query
    bindingAllowAdminOverride:
      type: boolean
      env: ITEM_BINDING_ALLOW_ADMIN_OVERRIDE
      default: true
      description: Whether admins can unbind soulbound items
    defaultRarity:
      $ref: 'item-api.yaml#/components/schemas/ItemRarity'
      env: ITEM_DEFAULT_RARITY
      default: common
      description: Default rarity for new templates when not specified
    defaultSoulboundType:
      $ref: 'item-api.yaml#/components/schemas/SoulboundType'
      env: ITEM_DEFAULT_SOULBOUND_TYPE
      default: none
      description: Default soulbound type for new templates

    # List Operation Configuration
    listOperationMaxRetries:
      type: integer
      env: ITEM_LIST_OPERATION_MAX_RETRIES
      default: 3
      description: Maximum retry attempts for optimistic concurrency on list operations

    # Locking Configuration
    lockTimeoutSeconds:
      type: integer
      env: ITEM_LOCK_TIMEOUT_SECONDS
      default: 30
      description: Timeout in seconds for distributed locks on item instance modifications
