openapi: 3.0.0
info:
  title: Contract Service API
  version: 1.0.0
  description: |
    Binding agreements between entities with milestone-based progression.

    lib-contract provides a generic system for binding agreements between entities.
    While lib-escrow handles the mechanics of holding assets during exchanges,
    lib-contract represents the ongoing obligations and rights that may result from,
    accompany, or exist independently of asset exchanges.

    **Key Design Principle**: Contracts are reactive, not proactive. External systems
    tell contracts when conditions are met/failed via API calls. Contracts store state,
    emit events, and execute prebound APIs on state transitions.

    **POST-Only API Pattern**: This API uses POST for all operations to support
    zero-copy WebSocket routing. Path parameters are passed in request bodies.

    **Polymorphic Parties**: Any entity type can enter contracts (characters, NPCs,
    guilds, companies, governments, locations).

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
x-service-layer: AppFoundation
servers:
- url: http://localhost:5012
  description: Bannou service endpoint (internal only)
paths:
  /contract/template/create:
    post:
      operationId: createContractTemplate
      tags:
      - Templates
      summary: Create a contract template
      description: |
        Creates a new contract template that defines a type of agreement.
        Templates specify party roles, default terms, milestones, and prebound APIs.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateContractTemplateRequest'
      responses:
        '200':
          description: Template created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractTemplateResponse'
        '400':
          description: Invalid request (validation error)
        '409':
          description: Template with this code already exists
      x-permissions:
      - role: admin
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateContractTemplateRequest\"\
        ,\n    \"$defs\": {\n        \"CreateContractTemplateRequest\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Request to create a new contract template\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"code\",\n                \"name\",\n                \"minParties\"\
        ,\n                \"maxParties\",\n                \"partyRoles\"\n            ],\n            \"properties\": {\n\
        \                \"code\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 64,\n\
        \                    \"pattern\": \"^[a-z0-9_]+$\",\n                    \"description\": \"Unique code for this template
        (lowercase, underscores)\"\n                },\n                \"name\": {\n                    \"type\": \"string\"\
        ,\n                    \"maxLength\": 200,\n                    \"description\": \"Human-readable template name\"\n\
        \                },\n                \"description\": {\n                    \"type\": \"string\",\n             \
        \       \"maxLength\": 2000,\n                    \"nullable\": true,\n                    \"description\": \"Detailed
        description of this contract type\"\n                },\n                \"realmId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"Realm ID if template is realm-specific (null for cross-realm)\"\n                },\n  \
        \              \"minParties\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 2,\n\
        \                    \"description\": \"Minimum number of parties required\"\n                },\n               \
        \ \"maxParties\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 2,\n           \
        \         \"maximum\": 20,\n                    \"description\": \"Maximum number of parties allowed\"\n         \
        \       },\n                \"partyRoles\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"$ref\": \"#/$defs/PartyRoleDefinition\"\n                    },\n                 \
        \   \"minItems\": 1,\n                    \"description\": \"Role definitions for parties in this contract\"\n   \
        \             },\n                \"defaultTerms\": {\n                    \"$ref\": \"#/$defs/ContractTerms\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Default terms for instances of this
        template\"\n                },\n                \"milestones\": {\n                    \"type\": \"array\",\n    \
        \                \"items\": {\n                        \"$ref\": \"#/$defs/MilestoneDefinition\"\n               \
        \     },\n                    \"nullable\": true,\n                    \"description\": \"Milestone definitions for
        this contract type\"\n                },\n                \"defaultEnforcementMode\": {\n                    \"$ref\"\
        : \"#/$defs/EnforcementMode\",\n                    \"description\": \"Default enforcement mode for instances\"\n\
        \                },\n                \"transferable\": {\n                    \"type\": \"boolean\",\n           \
        \         \"default\": false,\n                    \"description\": \"Whether contracts can be transferred to other
        parties\"\n                },\n                \"gameMetadata\": {\n                    \"type\": \"object\",\n  \
        \                  \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"\
        description\": \"Template-level game-specific metadata\"\n                }\n            }\n        },\n        \"\
        PartyRoleDefinition\": {\n            \"type\": \"object\",\n            \"description\": \"Definition of a party
        role in a contract template\",\n            \"additionalProperties\": false,\n            \"required\": [\n      \
        \          \"role\",\n                \"minCount\",\n                \"maxCount\"\n            ],\n            \"\
        properties\": {\n                \"role\": {\n                    \"type\": \"string\",\n                    \"maxLength\"\
        : 64,\n                    \"description\": \"Role identifier (employer, employee, buyer, seller, etc.)\"\n      \
        \          },\n                \"minCount\": {\n                    \"type\": \"integer\",\n                    \"\
        minimum\": 0,\n                    \"description\": \"Minimum entities required in this role\"\n                },\n\
        \                \"maxCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n\
        \                    \"description\": \"Maximum entities allowed in this role\"\n                },\n            \
        \    \"allowedEntityTypes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n     \
        \                   \"type\": \"object\"\n                    },\n                    \"nullable\": true,\n      \
        \              \"description\": \"Which entity types can fill this role (null for any)\"\n                }\n    \
        \        }\n        },\n        \"ContractTerms\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Configurable contract terms\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"duration\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Contract duration (ISO 8601 duration, null for perpetual)\"\n            \
        \    },\n                \"paymentSchedule\": {\n                    \"$ref\": \"#/$defs/PaymentSchedule\",\n    \
        \                \"nullable\": true,\n                    \"description\": \"When payments occur\"\n             \
        \   },\n                \"paymentFrequency\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Recurring payment frequency (ISO 8601 duration)\"\n    \
        \            },\n                \"terminationPolicy\": {\n                    \"$ref\": \"#/$defs/TerminationPolicy\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"How contract can be terminated\"\
        \n                },\n                \"terminationNoticePeriod\": {\n                    \"type\": \"string\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Required notice for termination (ISO
        8601 duration)\"\n                },\n                \"breachThreshold\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 0,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Breaches before auto-termination (0 for no auto)\"\n                },\n                \"gracePeriodForCure\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Time to cure breach (ISO 8601 duration)\"\n                },\n                \"customTerms\": {\n          \
        \          \"type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Game-specific custom terms\"\n                }\n            }\n \
        \       },\n        \"PaymentSchedule\": {\n            \"type\": \"string\",\n            \"description\": \"When
        payments occur\",\n            \"enum\": [\n                \"one_time\",\n                \"recurring\",\n      \
        \          \"milestone_based\"\n            ]\n        },\n        \"TerminationPolicy\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"How the contract can be terminated\",\n            \"enum\": [\n   \
        \             \"mutual_consent\",\n                \"unilateral_with_notice\",\n                \"unilateral_immediate\"\
        ,\n                \"non_terminable\"\n            ]\n        },\n        \"MilestoneDefinition\": {\n           \
        \ \"type\": \"object\",\n            \"description\": \"Milestone definition in a template\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"code\",\n                \"name\",\n                \"sequence\"\
        ,\n                \"required\"\n            ],\n            \"properties\": {\n                \"code\": {\n    \
        \                \"type\": \"string\",\n                    \"maxLength\": 64,\n                    \"description\"\
        : \"Unique milestone code within template\"\n                },\n                \"name\": {\n                   \
        \ \"type\": \"string\",\n                    \"maxLength\": 200,\n                    \"description\": \"Human-readable
        name\"\n                },\n                \"description\": {\n                    \"type\": \"string\",\n      \
        \              \"maxLength\": 1000,\n                    \"nullable\": true,\n                    \"description\"\
        : \"What this milestone represents\"\n                },\n                \"sequence\": {\n                    \"\
        type\": \"integer\",\n                    \"minimum\": 0,\n                    \"description\": \"Order in the contract
        flow\"\n                },\n                \"required\": {\n                    \"type\": \"boolean\",\n        \
        \            \"description\": \"Whether milestone must be completed\"\n                },\n                \"deadline\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Relative deadline (ISO 8601 duration)\"\n                },\n                \"deadlineBehavior\": {\n       \
        \             \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\",\n                    \"nullable\": true,\n        \
        \            \"description\": \"Behavior when deadline passes for optional milestones (default skip). Required milestones
        always trigger breach.\"\n                },\n                \"onComplete\": {\n                    \"type\": \"\
        array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/PreboundApi\"\n          \
        \          },\n                    \"nullable\": true,\n                    \"description\": \"APIs to call on completion\"\
        \n                },\n                \"onExpire\": {\n                    \"type\": \"array\",\n                \
        \    \"items\": {\n                        \"$ref\": \"#/$defs/PreboundApi\"\n                    },\n           \
        \         \"nullable\": true,\n                    \"description\": \"APIs to call if deadline passes\"\n        \
        \        }\n            }\n        },\n        \"MilestoneDeadlineBehavior\": {\n            \"type\": \"string\"\
        ,\n            \"description\": \"Behavior when optional milestone deadline passes\",\n            \"enum\": [\n \
        \               \"skip\",\n                \"warn\",\n                \"breach\"\n            ]\n        },\n    \
        \    \"PreboundApi\": {\n            \"type\": \"object\",\n            \"description\": \"Pre-configured API call
        to execute on contract events\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"serviceName\",\n                \"endpoint\",\n                \"payloadTemplate\"\n            ],\n\
        \            \"properties\": {\n                \"serviceName\": {\n                    \"type\": \"string\",\n  \
        \                  \"description\": \"Target service name\"\n                },\n                \"endpoint\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Target endpoint path\"\n      \
        \          },\n                \"payloadTemplate\": {\n                    \"type\": \"string\",\n               \
        \     \"description\": \"JSON payload with variable placeholders\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Human-readable description\"\n                },\n                \"executionMode\": {\n                    \"\
        type\": \"string\",\n                    \"enum\": [\n                        \"sync\",\n                        \"\
        async\",\n                        \"fire_and_forget\"\n                    ],\n                    \"default\": \"\
        sync\",\n                    \"description\": \"How to execute the API call\"\n                },\n              \
        \  \"responseValidation\": {\n                    \"$ref\": \"#/$defs/ResponseValidation\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Optional validation rules for the response\"\n         \
        \       }\n            }\n        },\n        \"ResponseValidation\": {\n            \"type\": \"object\",\n     \
        \       \"description\": \"Validation rules for API responses with three-outcome model.\\nUsed by lib-contract to
        validate clause conditions without\\nunderstanding the specific API semantics.\\n\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"successConditions\": {\n                    \"type\": \"\
        array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/ValidationCondition\"\n  \
        \                  },\n                    \"description\": \"Conditions that must ALL pass for success.\\nIf any
        fail, checks permanent failure conditions.\\n\"\n                },\n                \"permanentFailureConditions\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/ValidationCondition\"\n                    },\n                    \"description\": \"Conditions that
        indicate permanent failure (clause violated).\\nChecked when success conditions fail.\\n\"\n                },\n \
        \               \"transientFailureStatusCodes\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"integer\"\n                    },\n                    \"description\"\
        : \"HTTP status codes that indicate transient failure (retry later).\\nDefault: [408, 429, 502, 503, 504]\\n\"\n \
        \               }\n            }\n        },\n        \"ValidationCondition\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"A single condition to check against an API response\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"type\"\n            ],\n            \"properties\": {\n \
        \               \"type\": {\n                    \"allOf\": [\n                        {\n                       \
        \     \"$ref\": \"#/$defs/ValidationConditionType\"\n                        }\n                    ],\n         \
        \           \"description\": \"The type of validation condition to check\"\n                },\n                \"\
        jsonPath\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"JsonPath expression to extract value from response.\\nRequired for jsonPathEquals, jsonPathExists,
        jsonPathNotExists.\\nExample: \\\"$.balance\\\", \\\"$.items[0].status\\\"\\n\"\n                },\n            \
        \    \"expectedValue\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n  \
        \                  \"description\": \"Expected value for comparison conditions.\\nType coercion applied: \\\"true\\\
        \"/\\\"false\\\" for booleans, numeric strings for numbers.\\n\"\n                },\n                \"operator\"\
        : {\n                    \"$ref\": \"#/$defs/ComparisonOperator\",\n                    \"nullable\": true,\n    \
        \                \"description\": \"Comparison operator for numeric comparisons\"\n                },\n          \
        \      \"statusCodes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"integer\"\n                    },\n                    \"description\": \"HTTP status codes
        for statusCodeIn condition\"\n                }\n            }\n        },\n        \"ValidationConditionType\": {\n\
        \            \"type\": \"string\",\n            \"description\": \"Type of validation condition\",\n            \"\
        enum\": [\n                \"statusCodeIn\",\n                \"jsonPathEquals\",\n                \"jsonPathNotEquals\"\
        ,\n                \"jsonPathExists\",\n                \"jsonPathNotExists\",\n                \"jsonPathGreaterThan\"\
        ,\n                \"jsonPathLessThan\",\n                \"jsonPathContains\"\n            ]\n        },\n      \
        \  \"ComparisonOperator\": {\n            \"type\": \"string\",\n            \"description\": \"Comparison operators
        for numeric conditions\",\n            \"enum\": [\n                \"eq\",\n                \"ne\",\n           \
        \     \"gt\",\n                \"gte\",\n                \"lt\",\n                \"lte\"\n            ]\n       \
        \ },\n        \"EnforcementMode\": {\n            \"type\": \"string\",\n            \"description\": \"How contract
        breaches are handled\",\n            \"enum\": [\n                \"advisory\",\n                \"event_only\",\n\
        \                \"consequence_based\",\n                \"community\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractTemplateResponse\"\
        ,\n    \"$defs\": {\n        \"ContractTemplateResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract template details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"templateId\",\n                \"code\",\n                \"name\",\n                \"minParties\"\
        ,\n                \"maxParties\",\n                \"partyRoles\",\n                \"defaultEnforcementMode\",\n\
        \                \"isActive\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n   \
        \             \"templateId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Unique template identifier\"\n                },\n                \"code\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Unique template code\"\n  \
        \              },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"Human-readable name\"\n                },\n                \"description\": {\n                 \
        \   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Detailed
        description\"\n                },\n                \"realmId\": {\n                    \"type\": \"string\",\n   \
        \                 \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Realm ID if realm-specific\"\n                },\n                \"minParties\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Minimum parties required\"\n                },\n          \
        \      \"maxParties\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Maximum
        parties allowed\"\n                },\n                \"partyRoles\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/PartyRoleDefinition\"\n         \
        \           },\n                    \"description\": \"Party role definitions\"\n                },\n            \
        \    \"defaultTerms\": {\n                    \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Default contract terms\"\n                },\n                \"milestones\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/MilestoneDefinition\"\n                    },\n                    \"nullable\": true,\n             \
        \       \"description\": \"Milestone definitions\"\n                },\n                \"defaultEnforcementMode\"\
        : {\n                    \"$ref\": \"#/$defs/EnforcementMode\",\n                    \"description\": \"Default enforcement
        mode\"\n                },\n                \"transferable\": {\n                    \"type\": \"boolean\",\n    \
        \                \"description\": \"Whether contracts can be transferred\"\n                },\n                \"\
        gameMetadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n\
        \                    \"nullable\": true,\n                    \"description\": \"Game-specific metadata\"\n      \
        \          },\n                \"isActive\": {\n                    \"type\": \"boolean\",\n                    \"\
        description\": \"Whether template is active\"\n                },\n                \"createdAt\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"Last update timestamp\"\n                }\n            }\n        },\n        \"PartyRoleDefinition\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Definition of a party role in a contract template\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"role\",\n        \
        \        \"minCount\",\n                \"maxCount\"\n            ],\n            \"properties\": {\n            \
        \    \"role\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 64,\n            \
        \        \"description\": \"Role identifier (employer, employee, buyer, seller, etc.)\"\n                },\n    \
        \            \"minCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n  \
        \                  \"description\": \"Minimum entities required in this role\"\n                },\n             \
        \   \"maxCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n           \
        \         \"description\": \"Maximum entities allowed in this role\"\n                },\n                \"allowedEntityTypes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"object\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"Which entity types can fill this role (null for any)\"\n                }\n            }\n        },\n       \
        \ \"ContractTerms\": {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Contract duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\"\
        : {\n                    \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\":
        {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneDefinition\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone definition
        in a template\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"code\"\
        ,\n                \"name\",\n                \"sequence\",\n                \"required\"\n            ],\n      \
        \      \"properties\": {\n                \"code\": {\n                    \"type\": \"string\",\n               \
        \     \"maxLength\": 64,\n                    \"description\": \"Unique milestone code within template\"\n       \
        \         },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"maxLength\"\
        : 200,\n                    \"description\": \"Human-readable name\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"maxLength\": 1000,\n                    \"nullable\"\
        : true,\n                    \"description\": \"What this milestone represents\"\n                },\n           \
        \     \"sequence\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n         \
        \           \"description\": \"Order in the contract flow\"\n                },\n                \"required\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"Whether milestone must be completed\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"Relative deadline (ISO 8601 duration)\"\n      \
        \          },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones (default skip). Required milestones always trigger breach.\"\n                },\n           \
        \     \"onComplete\": {\n                    \"type\": \"array\",\n                    \"items\": {\n            \
        \            \"$ref\": \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"APIs to call on completion\"\n                },\n                \"onExpire\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n                    \"\
        description\": \"APIs to call if deadline passes\"\n                }\n            }\n        },\n        \"MilestoneDeadlineBehavior\"\
        : {\n            \"type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\"\
        ,\n            \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n   \
        \         ]\n        },\n        \"PreboundApi\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Pre-configured API call to execute on contract events\",\n            \"additionalProperties\": false,\n     \
        \       \"required\": [\n                \"serviceName\",\n                \"endpoint\",\n                \"payloadTemplate\"\
        \n            ],\n            \"properties\": {\n                \"serviceName\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Target service name\"\n                },\n                \"\
        endpoint\": {\n                    \"type\": \"string\",\n                    \"description\": \"Target endpoint path\"\
        \n                },\n                \"payloadTemplate\": {\n                    \"type\": \"string\",\n        \
        \            \"description\": \"JSON payload with variable placeholders\"\n                },\n                \"\
        description\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n           \
        \         \"description\": \"Human-readable description\"\n                },\n                \"executionMode\":
        {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"sync\",\n\
        \                        \"async\",\n                        \"fire_and_forget\"\n                    ],\n       \
        \             \"default\": \"sync\",\n                    \"description\": \"How to execute the API call\"\n     \
        \           },\n                \"responseValidation\": {\n                    \"$ref\": \"#/$defs/ResponseValidation\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Optional validation rules for the
        response\"\n                }\n            }\n        },\n        \"ResponseValidation\": {\n            \"type\"\
        : \"object\",\n            \"description\": \"Validation rules for API responses with three-outcome model.\\nUsed
        by lib-contract to validate clause conditions without\\nunderstanding the specific API semantics.\\n\",\n        \
        \    \"additionalProperties\": false,\n            \"properties\": {\n                \"successConditions\": {\n \
        \                   \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/ValidationCondition\"\
        \n                    },\n                    \"description\": \"Conditions that must ALL pass for success.\\nIf any
        fail, checks permanent failure conditions.\\n\"\n                },\n                \"permanentFailureConditions\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/ValidationCondition\"\n                    },\n                    \"description\": \"Conditions that
        indicate permanent failure (clause violated).\\nChecked when success conditions fail.\\n\"\n                },\n \
        \               \"transientFailureStatusCodes\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"integer\"\n                    },\n                    \"description\"\
        : \"HTTP status codes that indicate transient failure (retry later).\\nDefault: [408, 429, 502, 503, 504]\\n\"\n \
        \               }\n            }\n        },\n        \"ValidationCondition\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"A single condition to check against an API response\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"type\"\n            ],\n            \"properties\": {\n \
        \               \"type\": {\n                    \"allOf\": [\n                        {\n                       \
        \     \"$ref\": \"#/$defs/ValidationConditionType\"\n                        }\n                    ],\n         \
        \           \"description\": \"The type of validation condition to check\"\n                },\n                \"\
        jsonPath\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"JsonPath expression to extract value from response.\\nRequired for jsonPathEquals, jsonPathExists,
        jsonPathNotExists.\\nExample: \\\"$.balance\\\", \\\"$.items[0].status\\\"\\n\"\n                },\n            \
        \    \"expectedValue\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n  \
        \                  \"description\": \"Expected value for comparison conditions.\\nType coercion applied: \\\"true\\\
        \"/\\\"false\\\" for booleans, numeric strings for numbers.\\n\"\n                },\n                \"operator\"\
        : {\n                    \"$ref\": \"#/$defs/ComparisonOperator\",\n                    \"nullable\": true,\n    \
        \                \"description\": \"Comparison operator for numeric comparisons\"\n                },\n          \
        \      \"statusCodes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"integer\"\n                    },\n                    \"description\": \"HTTP status codes
        for statusCodeIn condition\"\n                }\n            }\n        },\n        \"ValidationConditionType\": {\n\
        \            \"type\": \"string\",\n            \"description\": \"Type of validation condition\",\n            \"\
        enum\": [\n                \"statusCodeIn\",\n                \"jsonPathEquals\",\n                \"jsonPathNotEquals\"\
        ,\n                \"jsonPathExists\",\n                \"jsonPathNotExists\",\n                \"jsonPathGreaterThan\"\
        ,\n                \"jsonPathLessThan\",\n                \"jsonPathContains\"\n            ]\n        },\n      \
        \  \"ComparisonOperator\": {\n            \"type\": \"string\",\n            \"description\": \"Comparison operators
        for numeric conditions\",\n            \"enum\": [\n                \"eq\",\n                \"ne\",\n           \
        \     \"gt\",\n                \"gte\",\n                \"lt\",\n                \"lte\"\n            ]\n       \
        \ },\n        \"EnforcementMode\": {\n            \"type\": \"string\",\n            \"description\": \"How contract
        breaches are handled\",\n            \"enum\": [\n                \"advisory\",\n                \"event_only\",\n\
        \                \"consequence_based\",\n                \"community\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Create a contract template\",\n    \"description\": \"Creates a new contract
        template that defines a type of agreement.\\nTemplates specify party roles, default terms, milestones, and prebound
        APIs.\\n\",\n    \"tags\": [\n        \"Templates\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"createContractTemplate\"\
        \n}"
  /contract/template/get:
    post:
      operationId: getContractTemplate
      tags:
      - Templates
      summary: Get template by ID or code
      description: |
        Retrieves a contract template by its unique ID or code.
        At least one of templateId or code must be provided.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetContractTemplateRequest'
      responses:
        '200':
          description: Template retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractTemplateResponse'
        '400':
          description: Neither templateId nor code provided
        '404':
          description: Template not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetContractTemplateRequest\"\
        ,\n    \"$defs\": {\n        \"GetContractTemplateRequest\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Request to get a contract template\",\n            \"additionalProperties\": false,\n           \
        \ \"properties\": {\n                \"templateId\": {\n                    \"type\": \"string\",\n              \
        \      \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\": \"Template
        ID (provide this or code)\"\n                },\n                \"code\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Template code (provide this or
        templateId)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractTemplateResponse\"\
        ,\n    \"$defs\": {\n        \"ContractTemplateResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract template details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"templateId\",\n                \"code\",\n                \"name\",\n                \"minParties\"\
        ,\n                \"maxParties\",\n                \"partyRoles\",\n                \"defaultEnforcementMode\",\n\
        \                \"isActive\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n   \
        \             \"templateId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Unique template identifier\"\n                },\n                \"code\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Unique template code\"\n  \
        \              },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"Human-readable name\"\n                },\n                \"description\": {\n                 \
        \   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Detailed
        description\"\n                },\n                \"realmId\": {\n                    \"type\": \"string\",\n   \
        \                 \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Realm ID if realm-specific\"\n                },\n                \"minParties\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Minimum parties required\"\n                },\n          \
        \      \"maxParties\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Maximum
        parties allowed\"\n                },\n                \"partyRoles\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/PartyRoleDefinition\"\n         \
        \           },\n                    \"description\": \"Party role definitions\"\n                },\n            \
        \    \"defaultTerms\": {\n                    \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Default contract terms\"\n                },\n                \"milestones\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/MilestoneDefinition\"\n                    },\n                    \"nullable\": true,\n             \
        \       \"description\": \"Milestone definitions\"\n                },\n                \"defaultEnforcementMode\"\
        : {\n                    \"$ref\": \"#/$defs/EnforcementMode\",\n                    \"description\": \"Default enforcement
        mode\"\n                },\n                \"transferable\": {\n                    \"type\": \"boolean\",\n    \
        \                \"description\": \"Whether contracts can be transferred\"\n                },\n                \"\
        gameMetadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n\
        \                    \"nullable\": true,\n                    \"description\": \"Game-specific metadata\"\n      \
        \          },\n                \"isActive\": {\n                    \"type\": \"boolean\",\n                    \"\
        description\": \"Whether template is active\"\n                },\n                \"createdAt\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"Last update timestamp\"\n                }\n            }\n        },\n        \"PartyRoleDefinition\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Definition of a party role in a contract template\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"role\",\n        \
        \        \"minCount\",\n                \"maxCount\"\n            ],\n            \"properties\": {\n            \
        \    \"role\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 64,\n            \
        \        \"description\": \"Role identifier (employer, employee, buyer, seller, etc.)\"\n                },\n    \
        \            \"minCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n  \
        \                  \"description\": \"Minimum entities required in this role\"\n                },\n             \
        \   \"maxCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n           \
        \         \"description\": \"Maximum entities allowed in this role\"\n                },\n                \"allowedEntityTypes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"object\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"Which entity types can fill this role (null for any)\"\n                }\n            }\n        },\n       \
        \ \"ContractTerms\": {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Contract duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\"\
        : {\n                    \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\":
        {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneDefinition\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone definition
        in a template\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"code\"\
        ,\n                \"name\",\n                \"sequence\",\n                \"required\"\n            ],\n      \
        \      \"properties\": {\n                \"code\": {\n                    \"type\": \"string\",\n               \
        \     \"maxLength\": 64,\n                    \"description\": \"Unique milestone code within template\"\n       \
        \         },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"maxLength\"\
        : 200,\n                    \"description\": \"Human-readable name\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"maxLength\": 1000,\n                    \"nullable\"\
        : true,\n                    \"description\": \"What this milestone represents\"\n                },\n           \
        \     \"sequence\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n         \
        \           \"description\": \"Order in the contract flow\"\n                },\n                \"required\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"Whether milestone must be completed\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"Relative deadline (ISO 8601 duration)\"\n      \
        \          },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones (default skip). Required milestones always trigger breach.\"\n                },\n           \
        \     \"onComplete\": {\n                    \"type\": \"array\",\n                    \"items\": {\n            \
        \            \"$ref\": \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"APIs to call on completion\"\n                },\n                \"onExpire\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n                    \"\
        description\": \"APIs to call if deadline passes\"\n                }\n            }\n        },\n        \"MilestoneDeadlineBehavior\"\
        : {\n            \"type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\"\
        ,\n            \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n   \
        \         ]\n        },\n        \"PreboundApi\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Pre-configured API call to execute on contract events\",\n            \"additionalProperties\": false,\n     \
        \       \"required\": [\n                \"serviceName\",\n                \"endpoint\",\n                \"payloadTemplate\"\
        \n            ],\n            \"properties\": {\n                \"serviceName\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Target service name\"\n                },\n                \"\
        endpoint\": {\n                    \"type\": \"string\",\n                    \"description\": \"Target endpoint path\"\
        \n                },\n                \"payloadTemplate\": {\n                    \"type\": \"string\",\n        \
        \            \"description\": \"JSON payload with variable placeholders\"\n                },\n                \"\
        description\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n           \
        \         \"description\": \"Human-readable description\"\n                },\n                \"executionMode\":
        {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"sync\",\n\
        \                        \"async\",\n                        \"fire_and_forget\"\n                    ],\n       \
        \             \"default\": \"sync\",\n                    \"description\": \"How to execute the API call\"\n     \
        \           },\n                \"responseValidation\": {\n                    \"$ref\": \"#/$defs/ResponseValidation\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Optional validation rules for the
        response\"\n                }\n            }\n        },\n        \"ResponseValidation\": {\n            \"type\"\
        : \"object\",\n            \"description\": \"Validation rules for API responses with three-outcome model.\\nUsed
        by lib-contract to validate clause conditions without\\nunderstanding the specific API semantics.\\n\",\n        \
        \    \"additionalProperties\": false,\n            \"properties\": {\n                \"successConditions\": {\n \
        \                   \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/ValidationCondition\"\
        \n                    },\n                    \"description\": \"Conditions that must ALL pass for success.\\nIf any
        fail, checks permanent failure conditions.\\n\"\n                },\n                \"permanentFailureConditions\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/ValidationCondition\"\n                    },\n                    \"description\": \"Conditions that
        indicate permanent failure (clause violated).\\nChecked when success conditions fail.\\n\"\n                },\n \
        \               \"transientFailureStatusCodes\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"integer\"\n                    },\n                    \"description\"\
        : \"HTTP status codes that indicate transient failure (retry later).\\nDefault: [408, 429, 502, 503, 504]\\n\"\n \
        \               }\n            }\n        },\n        \"ValidationCondition\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"A single condition to check against an API response\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"type\"\n            ],\n            \"properties\": {\n \
        \               \"type\": {\n                    \"allOf\": [\n                        {\n                       \
        \     \"$ref\": \"#/$defs/ValidationConditionType\"\n                        }\n                    ],\n         \
        \           \"description\": \"The type of validation condition to check\"\n                },\n                \"\
        jsonPath\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"JsonPath expression to extract value from response.\\nRequired for jsonPathEquals, jsonPathExists,
        jsonPathNotExists.\\nExample: \\\"$.balance\\\", \\\"$.items[0].status\\\"\\n\"\n                },\n            \
        \    \"expectedValue\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n  \
        \                  \"description\": \"Expected value for comparison conditions.\\nType coercion applied: \\\"true\\\
        \"/\\\"false\\\" for booleans, numeric strings for numbers.\\n\"\n                },\n                \"operator\"\
        : {\n                    \"$ref\": \"#/$defs/ComparisonOperator\",\n                    \"nullable\": true,\n    \
        \                \"description\": \"Comparison operator for numeric comparisons\"\n                },\n          \
        \      \"statusCodes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"integer\"\n                    },\n                    \"description\": \"HTTP status codes
        for statusCodeIn condition\"\n                }\n            }\n        },\n        \"ValidationConditionType\": {\n\
        \            \"type\": \"string\",\n            \"description\": \"Type of validation condition\",\n            \"\
        enum\": [\n                \"statusCodeIn\",\n                \"jsonPathEquals\",\n                \"jsonPathNotEquals\"\
        ,\n                \"jsonPathExists\",\n                \"jsonPathNotExists\",\n                \"jsonPathGreaterThan\"\
        ,\n                \"jsonPathLessThan\",\n                \"jsonPathContains\"\n            ]\n        },\n      \
        \  \"ComparisonOperator\": {\n            \"type\": \"string\",\n            \"description\": \"Comparison operators
        for numeric conditions\",\n            \"enum\": [\n                \"eq\",\n                \"ne\",\n           \
        \     \"gt\",\n                \"gte\",\n                \"lt\",\n                \"lte\"\n            ]\n       \
        \ },\n        \"EnforcementMode\": {\n            \"type\": \"string\",\n            \"description\": \"How contract
        breaches are handled\",\n            \"enum\": [\n                \"advisory\",\n                \"event_only\",\n\
        \                \"consequence_based\",\n                \"community\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get template by ID or code\",\n    \"description\": \"Retrieves a contract
        template by its unique ID or code.\\nAt least one of templateId or code must be provided.\\n\",\n    \"tags\": [\n\
        \        \"Templates\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getContractTemplate\"\n}"
  /contract/template/list:
    post:
      operationId: listContractTemplates
      tags:
      - Templates
      summary: List templates with filters
      description: |
        Lists contract templates with optional filtering by realm, active status,
        and search term.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListContractTemplatesRequest'
      responses:
        '200':
          description: Templates retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListContractTemplatesResponse'
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListContractTemplatesRequest\"\
        ,\n    \"$defs\": {\n        \"ListContractTemplatesRequest\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Request to list contract templates with cursor-based pagination.\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"realmId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Filter by realm (null includes cross-realm templates).\"\n                },\n                \"isActive\": {\n\
        \                    \"type\": \"boolean\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Filter by active status.\"\n                },\n                \"searchTerm\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Search in name and
        description.\"\n                },\n                \"cursor\": {\n                    \"type\": \"string\",\n   \
        \                 \"nullable\": true,\n                    \"description\": \"Opaque cursor from previous response.
        Null for first page.\"\n                },\n                \"pageSize\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"maximum\": 100,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Number of items per page. Uses service default if not specified.\"\n     \
        \           }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListContractTemplatesResponse\"\
        ,\n    \"$defs\": {\n        \"ListContractTemplatesResponse\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Paginated list of contract templates.\",\n            \"additionalProperties\": false,\n    \
        \        \"required\": [\n                \"templates\",\n                \"hasMore\"\n            ],\n          \
        \  \"properties\": {\n                \"templates\": {\n                    \"type\": \"array\",\n               \
        \     \"items\": {\n                        \"$ref\": \"#/$defs/ContractTemplateResponse\"\n                    },\n\
        \                    \"description\": \"Templates in this page.\"\n                },\n                \"nextCursor\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Cursor for next page. Null if no more results.\"\n                },\n                \"hasMore\": {\n       \
        \             \"type\": \"boolean\",\n                    \"description\": \"Whether more results exist beyond this
        page.\"\n                }\n            }\n        },\n        \"ContractTemplateResponse\": {\n            \"type\"\
        : \"object\",\n            \"description\": \"Contract template details\",\n            \"additionalProperties\":
        false,\n            \"required\": [\n                \"templateId\",\n                \"code\",\n                \"\
        name\",\n                \"minParties\",\n                \"maxParties\",\n                \"partyRoles\",\n     \
        \           \"defaultEnforcementMode\",\n                \"isActive\",\n                \"createdAt\"\n          \
        \  ],\n            \"properties\": {\n                \"templateId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Unique template identifier\"\n\
        \                },\n                \"code\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"Unique template code\"\n                },\n                \"name\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Human-readable name\"\n                },\n                \"\
        description\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n           \
        \         \"description\": \"Detailed description\"\n                },\n                \"realmId\": {\n        \
        \            \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Realm ID if realm-specific\"\n                },\n                \"minParties\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Minimum parties required\"\
        \n                },\n                \"maxParties\": {\n                    \"type\": \"integer\",\n            \
        \        \"description\": \"Maximum parties allowed\"\n                },\n                \"partyRoles\": {\n   \
        \                 \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/PartyRoleDefinition\"\
        \n                    },\n                    \"description\": \"Party role definitions\"\n                },\n  \
        \              \"defaultTerms\": {\n                    \"$ref\": \"#/$defs/ContractTerms\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Default contract terms\"\n                },\n     \
        \           \"milestones\": {\n                    \"type\": \"array\",\n                    \"items\": {\n      \
        \                  \"$ref\": \"#/$defs/MilestoneDefinition\"\n                    },\n                    \"nullable\"\
        : true,\n                    \"description\": \"Milestone definitions\"\n                },\n                \"defaultEnforcementMode\"\
        : {\n                    \"$ref\": \"#/$defs/EnforcementMode\",\n                    \"description\": \"Default enforcement
        mode\"\n                },\n                \"transferable\": {\n                    \"type\": \"boolean\",\n    \
        \                \"description\": \"Whether contracts can be transferred\"\n                },\n                \"\
        gameMetadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n\
        \                    \"nullable\": true,\n                    \"description\": \"Game-specific metadata\"\n      \
        \          },\n                \"isActive\": {\n                    \"type\": \"boolean\",\n                    \"\
        description\": \"Whether template is active\"\n                },\n                \"createdAt\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"Last update timestamp\"\n                }\n            }\n        },\n        \"PartyRoleDefinition\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Definition of a party role in a contract template\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"role\",\n        \
        \        \"minCount\",\n                \"maxCount\"\n            ],\n            \"properties\": {\n            \
        \    \"role\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 64,\n            \
        \        \"description\": \"Role identifier (employer, employee, buyer, seller, etc.)\"\n                },\n    \
        \            \"minCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n  \
        \                  \"description\": \"Minimum entities required in this role\"\n                },\n             \
        \   \"maxCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n           \
        \         \"description\": \"Maximum entities allowed in this role\"\n                },\n                \"allowedEntityTypes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"object\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"Which entity types can fill this role (null for any)\"\n                }\n            }\n        },\n       \
        \ \"ContractTerms\": {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Contract duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\"\
        : {\n                    \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\":
        {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneDefinition\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone definition
        in a template\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"code\"\
        ,\n                \"name\",\n                \"sequence\",\n                \"required\"\n            ],\n      \
        \      \"properties\": {\n                \"code\": {\n                    \"type\": \"string\",\n               \
        \     \"maxLength\": 64,\n                    \"description\": \"Unique milestone code within template\"\n       \
        \         },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"maxLength\"\
        : 200,\n                    \"description\": \"Human-readable name\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"maxLength\": 1000,\n                    \"nullable\"\
        : true,\n                    \"description\": \"What this milestone represents\"\n                },\n           \
        \     \"sequence\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n         \
        \           \"description\": \"Order in the contract flow\"\n                },\n                \"required\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"Whether milestone must be completed\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"Relative deadline (ISO 8601 duration)\"\n      \
        \          },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones (default skip). Required milestones always trigger breach.\"\n                },\n           \
        \     \"onComplete\": {\n                    \"type\": \"array\",\n                    \"items\": {\n            \
        \            \"$ref\": \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"APIs to call on completion\"\n                },\n                \"onExpire\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n                    \"\
        description\": \"APIs to call if deadline passes\"\n                }\n            }\n        },\n        \"MilestoneDeadlineBehavior\"\
        : {\n            \"type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\"\
        ,\n            \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n   \
        \         ]\n        },\n        \"PreboundApi\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Pre-configured API call to execute on contract events\",\n            \"additionalProperties\": false,\n     \
        \       \"required\": [\n                \"serviceName\",\n                \"endpoint\",\n                \"payloadTemplate\"\
        \n            ],\n            \"properties\": {\n                \"serviceName\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Target service name\"\n                },\n                \"\
        endpoint\": {\n                    \"type\": \"string\",\n                    \"description\": \"Target endpoint path\"\
        \n                },\n                \"payloadTemplate\": {\n                    \"type\": \"string\",\n        \
        \            \"description\": \"JSON payload with variable placeholders\"\n                },\n                \"\
        description\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n           \
        \         \"description\": \"Human-readable description\"\n                },\n                \"executionMode\":
        {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"sync\",\n\
        \                        \"async\",\n                        \"fire_and_forget\"\n                    ],\n       \
        \             \"default\": \"sync\",\n                    \"description\": \"How to execute the API call\"\n     \
        \           },\n                \"responseValidation\": {\n                    \"$ref\": \"#/$defs/ResponseValidation\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Optional validation rules for the
        response\"\n                }\n            }\n        },\n        \"ResponseValidation\": {\n            \"type\"\
        : \"object\",\n            \"description\": \"Validation rules for API responses with three-outcome model.\\nUsed
        by lib-contract to validate clause conditions without\\nunderstanding the specific API semantics.\\n\",\n        \
        \    \"additionalProperties\": false,\n            \"properties\": {\n                \"successConditions\": {\n \
        \                   \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/ValidationCondition\"\
        \n                    },\n                    \"description\": \"Conditions that must ALL pass for success.\\nIf any
        fail, checks permanent failure conditions.\\n\"\n                },\n                \"permanentFailureConditions\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/ValidationCondition\"\n                    },\n                    \"description\": \"Conditions that
        indicate permanent failure (clause violated).\\nChecked when success conditions fail.\\n\"\n                },\n \
        \               \"transientFailureStatusCodes\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"integer\"\n                    },\n                    \"description\"\
        : \"HTTP status codes that indicate transient failure (retry later).\\nDefault: [408, 429, 502, 503, 504]\\n\"\n \
        \               }\n            }\n        },\n        \"ValidationCondition\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"A single condition to check against an API response\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"type\"\n            ],\n            \"properties\": {\n \
        \               \"type\": {\n                    \"allOf\": [\n                        {\n                       \
        \     \"$ref\": \"#/$defs/ValidationConditionType\"\n                        }\n                    ],\n         \
        \           \"description\": \"The type of validation condition to check\"\n                },\n                \"\
        jsonPath\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"JsonPath expression to extract value from response.\\nRequired for jsonPathEquals, jsonPathExists,
        jsonPathNotExists.\\nExample: \\\"$.balance\\\", \\\"$.items[0].status\\\"\\n\"\n                },\n            \
        \    \"expectedValue\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n  \
        \                  \"description\": \"Expected value for comparison conditions.\\nType coercion applied: \\\"true\\\
        \"/\\\"false\\\" for booleans, numeric strings for numbers.\\n\"\n                },\n                \"operator\"\
        : {\n                    \"$ref\": \"#/$defs/ComparisonOperator\",\n                    \"nullable\": true,\n    \
        \                \"description\": \"Comparison operator for numeric comparisons\"\n                },\n          \
        \      \"statusCodes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"integer\"\n                    },\n                    \"description\": \"HTTP status codes
        for statusCodeIn condition\"\n                }\n            }\n        },\n        \"ValidationConditionType\": {\n\
        \            \"type\": \"string\",\n            \"description\": \"Type of validation condition\",\n            \"\
        enum\": [\n                \"statusCodeIn\",\n                \"jsonPathEquals\",\n                \"jsonPathNotEquals\"\
        ,\n                \"jsonPathExists\",\n                \"jsonPathNotExists\",\n                \"jsonPathGreaterThan\"\
        ,\n                \"jsonPathLessThan\",\n                \"jsonPathContains\"\n            ]\n        },\n      \
        \  \"ComparisonOperator\": {\n            \"type\": \"string\",\n            \"description\": \"Comparison operators
        for numeric conditions\",\n            \"enum\": [\n                \"eq\",\n                \"ne\",\n           \
        \     \"gt\",\n                \"gte\",\n                \"lt\",\n                \"lte\"\n            ]\n       \
        \ },\n        \"EnforcementMode\": {\n            \"type\": \"string\",\n            \"description\": \"How contract
        breaches are handled\",\n            \"enum\": [\n                \"advisory\",\n                \"event_only\",\n\
        \                \"consequence_based\",\n                \"community\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List templates with filters\",\n    \"description\": \"Lists contract templates
        with optional filtering by realm, active status,\\nand search term.\\n\",\n    \"tags\": [\n        \"Templates\"\n\
        \    ],\n    \"deprecated\": false,\n    \"operationId\": \"listContractTemplates\"\n}"
  /contract/template/update:
    post:
      operationId: updateContractTemplate
      tags:
      - Templates
      summary: Update template (not instances)
      description: |
        Updates an existing contract template. Does not affect existing instances.
        Only certain fields can be updated after creation.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateContractTemplateRequest'
      responses:
        '200':
          description: Template updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractTemplateResponse'
        '404':
          description: Template not found
      x-permissions:
      - role: admin
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateContractTemplateRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateContractTemplateRequest\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Request to update a contract template\",\n            \"additionalProperties\": false,\n    \
        \        \"required\": [\n                \"templateId\"\n            ],\n            \"properties\": {\n        \
        \        \"templateId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n\
        \                    \"description\": \"Template ID to update\"\n                },\n                \"name\": {\n\
        \                    \"type\": \"string\",\n                    \"maxLength\": 200,\n                    \"nullable\"\
        : true,\n                    \"description\": \"New template name\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"maxLength\": 2000,\n                    \"nullable\"\
        : true,\n                    \"description\": \"New description\"\n                },\n                \"isActive\"\
        : {\n                    \"type\": \"boolean\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Active status\"\n                },\n                \"gameMetadata\": {\n                    \"type\": \"object\"\
        ,\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n                \
        \    \"description\": \"Updated game metadata\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractTemplateResponse\"\
        ,\n    \"$defs\": {\n        \"ContractTemplateResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract template details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"templateId\",\n                \"code\",\n                \"name\",\n                \"minParties\"\
        ,\n                \"maxParties\",\n                \"partyRoles\",\n                \"defaultEnforcementMode\",\n\
        \                \"isActive\",\n                \"createdAt\"\n            ],\n            \"properties\": {\n   \
        \             \"templateId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Unique template identifier\"\n                },\n                \"code\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Unique template code\"\n  \
        \              },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"Human-readable name\"\n                },\n                \"description\": {\n                 \
        \   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Detailed
        description\"\n                },\n                \"realmId\": {\n                    \"type\": \"string\",\n   \
        \                 \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Realm ID if realm-specific\"\n                },\n                \"minParties\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Minimum parties required\"\n                },\n          \
        \      \"maxParties\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Maximum
        parties allowed\"\n                },\n                \"partyRoles\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/PartyRoleDefinition\"\n         \
        \           },\n                    \"description\": \"Party role definitions\"\n                },\n            \
        \    \"defaultTerms\": {\n                    \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Default contract terms\"\n                },\n                \"milestones\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/MilestoneDefinition\"\n                    },\n                    \"nullable\": true,\n             \
        \       \"description\": \"Milestone definitions\"\n                },\n                \"defaultEnforcementMode\"\
        : {\n                    \"$ref\": \"#/$defs/EnforcementMode\",\n                    \"description\": \"Default enforcement
        mode\"\n                },\n                \"transferable\": {\n                    \"type\": \"boolean\",\n    \
        \                \"description\": \"Whether contracts can be transferred\"\n                },\n                \"\
        gameMetadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n\
        \                    \"nullable\": true,\n                    \"description\": \"Game-specific metadata\"\n      \
        \          },\n                \"isActive\": {\n                    \"type\": \"boolean\",\n                    \"\
        description\": \"Whether template is active\"\n                },\n                \"createdAt\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"Last update timestamp\"\n                }\n            }\n        },\n        \"PartyRoleDefinition\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Definition of a party role in a contract template\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"role\",\n        \
        \        \"minCount\",\n                \"maxCount\"\n            ],\n            \"properties\": {\n            \
        \    \"role\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 64,\n            \
        \        \"description\": \"Role identifier (employer, employee, buyer, seller, etc.)\"\n                },\n    \
        \            \"minCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n  \
        \                  \"description\": \"Minimum entities required in this role\"\n                },\n             \
        \   \"maxCount\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n           \
        \         \"description\": \"Maximum entities allowed in this role\"\n                },\n                \"allowedEntityTypes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"object\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"Which entity types can fill this role (null for any)\"\n                }\n            }\n        },\n       \
        \ \"ContractTerms\": {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Contract duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\"\
        : {\n                    \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\":
        {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneDefinition\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone definition
        in a template\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"code\"\
        ,\n                \"name\",\n                \"sequence\",\n                \"required\"\n            ],\n      \
        \      \"properties\": {\n                \"code\": {\n                    \"type\": \"string\",\n               \
        \     \"maxLength\": 64,\n                    \"description\": \"Unique milestone code within template\"\n       \
        \         },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"maxLength\"\
        : 200,\n                    \"description\": \"Human-readable name\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"maxLength\": 1000,\n                    \"nullable\"\
        : true,\n                    \"description\": \"What this milestone represents\"\n                },\n           \
        \     \"sequence\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n         \
        \           \"description\": \"Order in the contract flow\"\n                },\n                \"required\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"Whether milestone must be completed\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"Relative deadline (ISO 8601 duration)\"\n      \
        \          },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones (default skip). Required milestones always trigger breach.\"\n                },\n           \
        \     \"onComplete\": {\n                    \"type\": \"array\",\n                    \"items\": {\n            \
        \            \"$ref\": \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"APIs to call on completion\"\n                },\n                \"onExpire\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/PreboundApi\"\n                    },\n                    \"nullable\": true,\n                    \"\
        description\": \"APIs to call if deadline passes\"\n                }\n            }\n        },\n        \"MilestoneDeadlineBehavior\"\
        : {\n            \"type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\"\
        ,\n            \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n   \
        \         ]\n        },\n        \"PreboundApi\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Pre-configured API call to execute on contract events\",\n            \"additionalProperties\": false,\n     \
        \       \"required\": [\n                \"serviceName\",\n                \"endpoint\",\n                \"payloadTemplate\"\
        \n            ],\n            \"properties\": {\n                \"serviceName\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Target service name\"\n                },\n                \"\
        endpoint\": {\n                    \"type\": \"string\",\n                    \"description\": \"Target endpoint path\"\
        \n                },\n                \"payloadTemplate\": {\n                    \"type\": \"string\",\n        \
        \            \"description\": \"JSON payload with variable placeholders\"\n                },\n                \"\
        description\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n           \
        \         \"description\": \"Human-readable description\"\n                },\n                \"executionMode\":
        {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"sync\",\n\
        \                        \"async\",\n                        \"fire_and_forget\"\n                    ],\n       \
        \             \"default\": \"sync\",\n                    \"description\": \"How to execute the API call\"\n     \
        \           },\n                \"responseValidation\": {\n                    \"$ref\": \"#/$defs/ResponseValidation\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Optional validation rules for the
        response\"\n                }\n            }\n        },\n        \"ResponseValidation\": {\n            \"type\"\
        : \"object\",\n            \"description\": \"Validation rules for API responses with three-outcome model.\\nUsed
        by lib-contract to validate clause conditions without\\nunderstanding the specific API semantics.\\n\",\n        \
        \    \"additionalProperties\": false,\n            \"properties\": {\n                \"successConditions\": {\n \
        \                   \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/ValidationCondition\"\
        \n                    },\n                    \"description\": \"Conditions that must ALL pass for success.\\nIf any
        fail, checks permanent failure conditions.\\n\"\n                },\n                \"permanentFailureConditions\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/ValidationCondition\"\n                    },\n                    \"description\": \"Conditions that
        indicate permanent failure (clause violated).\\nChecked when success conditions fail.\\n\"\n                },\n \
        \               \"transientFailureStatusCodes\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"integer\"\n                    },\n                    \"description\"\
        : \"HTTP status codes that indicate transient failure (retry later).\\nDefault: [408, 429, 502, 503, 504]\\n\"\n \
        \               }\n            }\n        },\n        \"ValidationCondition\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"A single condition to check against an API response\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"type\"\n            ],\n            \"properties\": {\n \
        \               \"type\": {\n                    \"allOf\": [\n                        {\n                       \
        \     \"$ref\": \"#/$defs/ValidationConditionType\"\n                        }\n                    ],\n         \
        \           \"description\": \"The type of validation condition to check\"\n                },\n                \"\
        jsonPath\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"JsonPath expression to extract value from response.\\nRequired for jsonPathEquals, jsonPathExists,
        jsonPathNotExists.\\nExample: \\\"$.balance\\\", \\\"$.items[0].status\\\"\\n\"\n                },\n            \
        \    \"expectedValue\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n  \
        \                  \"description\": \"Expected value for comparison conditions.\\nType coercion applied: \\\"true\\\
        \"/\\\"false\\\" for booleans, numeric strings for numbers.\\n\"\n                },\n                \"operator\"\
        : {\n                    \"$ref\": \"#/$defs/ComparisonOperator\",\n                    \"nullable\": true,\n    \
        \                \"description\": \"Comparison operator for numeric comparisons\"\n                },\n          \
        \      \"statusCodes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n          \
        \              \"type\": \"integer\"\n                    },\n                    \"description\": \"HTTP status codes
        for statusCodeIn condition\"\n                }\n            }\n        },\n        \"ValidationConditionType\": {\n\
        \            \"type\": \"string\",\n            \"description\": \"Type of validation condition\",\n            \"\
        enum\": [\n                \"statusCodeIn\",\n                \"jsonPathEquals\",\n                \"jsonPathNotEquals\"\
        ,\n                \"jsonPathExists\",\n                \"jsonPathNotExists\",\n                \"jsonPathGreaterThan\"\
        ,\n                \"jsonPathLessThan\",\n                \"jsonPathContains\"\n            ]\n        },\n      \
        \  \"ComparisonOperator\": {\n            \"type\": \"string\",\n            \"description\": \"Comparison operators
        for numeric conditions\",\n            \"enum\": [\n                \"eq\",\n                \"ne\",\n           \
        \     \"gt\",\n                \"gte\",\n                \"lt\",\n                \"lte\"\n            ]\n       \
        \ },\n        \"EnforcementMode\": {\n            \"type\": \"string\",\n            \"description\": \"How contract
        breaches are handled\",\n            \"enum\": [\n                \"advisory\",\n                \"event_only\",\n\
        \                \"consequence_based\",\n                \"community\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Update template (not instances)\",\n    \"description\": \"Updates an existing
        contract template. Does not affect existing instances.\\nOnly certain fields can be updated after creation.\\n\",\n\
        \    \"tags\": [\n        \"Templates\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updateContractTemplate\"\
        \n}"
  /contract/template/delete:
    post:
      operationId: deleteContractTemplate
      tags:
      - Templates
      summary: Soft-delete template
      description: |
        Soft-deletes a contract template. Existing instances continue to function
        but no new instances can be created from this template.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteContractTemplateRequest'
      responses:
        '200':
          description: Template deleted successfully
        '404':
          description: Template not found
        '409':
          description: Template has active instances and cannot be deleted
      x-permissions:
      - role: admin
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteContractTemplateRequest\"\
        ,\n    \"$defs\": {\n        \"DeleteContractTemplateRequest\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Request to delete a contract template\",\n            \"additionalProperties\": false,\n    \
        \        \"required\": [\n                \"templateId\"\n            ],\n            \"properties\": {\n        \
        \        \"templateId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n\
        \                    \"description\": \"Template ID to delete\"\n                }\n            }\n        }\n   \
        \ }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Soft-delete template\",\n    \"description\": \"Soft-deletes a contract
        template. Existing instances continue to function\\nbut no new instances can be created from this template.\\n\",\n\
        \    \"tags\": [\n        \"Templates\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"deleteContractTemplate\"\
        \n}"
  /contract/instance/create:
    post:
      operationId: createContractInstance
      tags:
      - Instances
      summary: Create contract instance from template
      description: |
        Creates a new contract instance from a template. The instance starts
        in 'draft' status and must be proposed to parties before activation.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateContractInstanceRequest'
      responses:
        '200':
          description: Instance created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractInstanceResponse'
        '400':
          description: Invalid request (missing required parties, invalid terms)
        '404':
          description: Template not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateContractInstanceRequest\"\
        ,\n    \"$defs\": {\n        \"CreateContractInstanceRequest\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Request to create a contract instance\",\n            \"additionalProperties\": false,\n    \
        \        \"required\": [\n                \"templateId\",\n                \"parties\"\n            ],\n         \
        \   \"properties\": {\n                \"templateId\": {\n                    \"type\": \"string\",\n            \
        \        \"format\": \"uuid\",\n                    \"description\": \"Template to create instance from\"\n      \
        \          },\n                \"parties\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"$ref\": \"#/$defs/ContractPartyInput\"\n                    },\n                  \
        \  \"minItems\": 2,\n                    \"description\": \"Parties to this contract\"\n                },\n     \
        \           \"terms\": {\n                    \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Terms overriding template defaults\"\n                },\n       \
        \         \"effectiveFrom\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When contract becomes active (null
        for immediate)\"\n                },\n                \"effectiveUntil\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"When contract expires (null for perpetual)\"\n                },\n                \"escrowIds\":
        {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"\
        string\",\n                        \"format\": \"uuid\"\n                    },\n                    \"nullable\"\
        : true,\n                    \"description\": \"Related escrow IDs\"\n                },\n                \"gameMetadata\"\
        : {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n            \
        \        \"nullable\": true,\n                    \"description\": \"Instance-level game metadata\"\n            \
        \    }\n            }\n        },\n        \"ContractPartyInput\": {\n            \"type\": \"object\",\n        \
        \    \"description\": \"Party input for contract creation\",\n            \"additionalProperties\": false,\n     \
        \       \"required\": [\n                \"entityId\",\n                \"entityType\",\n                \"role\"\n\
        \            ],\n            \"properties\": {\n                \"entityId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Entity ID\"\n       \
        \         },\n                \"entityType\": {\n                    \"type\": \"object\",\n                    \"\
        description\": \"Entity type\"\n                },\n                \"role\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Role from template\"\n                }\n            }\n       \
        \ },\n        \"ContractTerms\": {\n            \"type\": \"object\",\n            \"description\": \"Configurable
        contract terms\",\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"\
        duration\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"Contract duration (ISO 8601 duration, null for perpetual)\"\n                },\n      \
        \          \"paymentSchedule\": {\n                    \"$ref\": \"#/$defs/PaymentSchedule\",\n                  \
        \  \"nullable\": true,\n                    \"description\": \"When payments occur\"\n                },\n       \
        \         \"paymentFrequency\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n  \
        \              \"terminationPolicy\": {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n          \
        \          \"nullable\": true,\n                    \"description\": \"How contract can be terminated\"\n        \
        \        },\n                \"terminationNoticePeriod\": {\n                    \"type\": \"string\",\n         \
        \           \"nullable\": true,\n                    \"description\": \"Required notice for termination (ISO 8601
        duration)\"\n                },\n                \"breachThreshold\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 0,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Breaches before auto-termination (0 for no auto)\"\n                },\n                \"gracePeriodForCure\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Time to cure breach (ISO 8601 duration)\"\n                },\n                \"customTerms\": {\n          \
        \          \"type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Game-specific custom terms\"\n                }\n            }\n \
        \       },\n        \"PaymentSchedule\": {\n            \"type\": \"string\",\n            \"description\": \"When
        payments occur\",\n            \"enum\": [\n                \"one_time\",\n                \"recurring\",\n      \
        \          \"milestone_based\"\n            ]\n        },\n        \"TerminationPolicy\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"How the contract can be terminated\",\n            \"enum\": [\n   \
        \             \"mutual_consent\",\n                \"unilateral_with_notice\",\n                \"unilateral_immediate\"\
        ,\n                \"non_terminable\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractInstanceResponse\"\
        ,\n    \"$defs\": {\n        \"ContractInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract instance details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"contractId\",\n                \"templateId\",\n                \"status\",\n                \"parties\"\
        ,\n                \"createdAt\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Unique contract identifier\"\n                },\n                \"templateId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Source template ID\"\
        \n                },\n                \"templateCode\": {\n                    \"type\": \"string\",\n           \
        \         \"description\": \"Source template code\"\n                },\n                \"status\": {\n         \
        \           \"$ref\": \"#/$defs/ContractStatus\",\n                    \"description\": \"Current contract status\"\
        \n                },\n                \"parties\": {\n                    \"type\": \"array\",\n                 \
        \   \"items\": {\n                        \"$ref\": \"#/$defs/ContractPartyResponse\"\n                    },\n  \
        \                  \"description\": \"Contract parties\"\n                },\n                \"terms\": {\n     \
        \               \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\": true,\n                  \
        \  \"description\": \"Contract terms\"\n                },\n                \"milestones\": {\n                  \
        \  \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/MilestoneInstanceResponse\"\
        \n                    },\n                    \"nullable\": true,\n                    \"description\": \"Milestone
        progress\"\n                },\n                \"currentMilestoneIndex\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Index of current milestone\"\n\
        \                },\n                \"escrowIds\": {\n                    \"type\": \"array\",\n                \
        \    \"items\": {\n                        \"type\": \"string\",\n                        \"format\": \"uuid\"\n \
        \                   },\n                    \"nullable\": true,\n                    \"description\": \"Related escrow
        IDs\"\n                },\n                \"proposedAt\": {\n                    \"type\": \"string\",\n        \
        \            \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was proposed\"\n                },\n                \"acceptedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When all parties consented\"\n                },\n                \"effectiveFrom\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When contract became active\"\n                },\n\
        \                \"effectiveUntil\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When contract expires\"\
        \n                },\n                \"terminatedAt\": {\n                    \"type\": \"string\",\n           \
        \         \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was terminated\"\n                },\n                \"gameMetadata\": {\n                    \"\
        type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Game-specific metadata\"\n                },\n                \"createdAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n              \
        \      \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Last update timestamp\"\n                }\n            }\n        },\n  \
        \      \"ContractStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of
        a contract instance\",\n            \"enum\": [\n                \"draft\",\n                \"proposed\",\n     \
        \           \"pending\",\n                \"active\",\n                \"fulfilled\",\n                \"expired\"\
        ,\n                \"terminated\",\n                \"breached\",\n                \"suspended\",\n              \
        \  \"disputed\",\n                \"declined\"\n            ]\n        },\n        \"ContractPartyResponse\": {\n\
        \            \"type\": \"object\",\n            \"description\": \"Contract party details\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"entityId\",\n                \"entityType\",\n          \
        \      \"role\",\n                \"consentStatus\"\n            ],\n            \"properties\": {\n             \
        \   \"entityId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n      \
        \              \"description\": \"Entity ID\"\n                },\n                \"entityType\": {\n           \
        \         \"type\": \"object\",\n                    \"description\": \"Entity type\"\n                },\n      \
        \          \"role\": {\n                    \"type\": \"string\",\n                    \"description\": \"Role in
        contract\"\n                },\n                \"consentStatus\": {\n                    \"$ref\": \"#/$defs/ConsentStatus\"\
        ,\n                    \"description\": \"Consent status\"\n                },\n                \"consentedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When consent was given\"\n                }\n          \
        \  }\n        },\n        \"ConsentStatus\": {\n            \"type\": \"string\",\n            \"description\": \"\
        Party's consent status\",\n            \"enum\": [\n                \"pending\",\n                \"consented\",\n\
        \                \"declined\",\n                \"implicit\"\n            ]\n        },\n        \"ContractTerms\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\",\n          \
        \  \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n            \
        \        \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Contract
        duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\": {\n \
        \                   \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\": {\n \
        \                   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone
        instance status\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"\
        code\",\n                \"name\",\n                \"sequence\",\n                \"required\",\n               \
        \ \"status\"\n            ],\n            \"properties\": {\n                \"code\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Milestone code\"\n                },\n                \"name\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone name\"\n        \
        \        },\n                \"sequence\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Order in flow\"\n                },\n                \"required\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether required\"\n                },\n                \"status\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneStatus\",\n                    \"description\": \"Current status\"\
        \n                },\n                \"completedAt\": {\n                    \"type\": \"string\",\n            \
        \        \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When completed\"\n                },\n                \"failedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"When failed\"\n                },\n                \"activatedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When this milestone became active\"\n                },\n                \"deadline\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"Absolute deadline (computed from activatedAt + duration)\"\
        \n                },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones\"\n                }\n            }\n        },\n        \"MilestoneStatus\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Current status of a milestone\",\n            \"enum\": [\n  \
        \              \"pending\",\n                \"active\",\n                \"completed\",\n                \"failed\"\
        ,\n                \"skipped\"\n            ]\n        },\n        \"MilestoneDeadlineBehavior\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\",\n        \
        \    \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n            ]\n\
        \        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Create contract instance from template\",\n    \"description\": \"Creates
        a new contract instance from a template. The instance starts\\nin 'draft' status and must be proposed to parties before
        activation.\\n\",\n    \"tags\": [\n        \"Instances\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"createContractInstance\"\n}"
  /contract/instance/propose:
    post:
      operationId: proposeContractInstance
      tags:
      - Instances
      summary: Propose contract to parties (starts consent flow)
      description: |
        Moves a draft contract to 'proposed' status and notifies parties.
        Parties must consent before the contract becomes active.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProposeContractInstanceRequest'
      responses:
        '200':
          description: Contract proposed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractInstanceResponse'
        '400':
          description: Contract not in draft status
        '404':
          description: Contract not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ProposeContractInstanceRequest\"\
        ,\n    \"$defs\": {\n        \"ProposeContractInstanceRequest\": {\n            \"type\": \"object\",\n          \
        \  \"description\": \"Request to propose a contract to parties\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"contractId\"\n            ],\n            \"properties\": {\n    \
        \            \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Contract instance to propose\"\n                }\n            }\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractInstanceResponse\"\
        ,\n    \"$defs\": {\n        \"ContractInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract instance details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"contractId\",\n                \"templateId\",\n                \"status\",\n                \"parties\"\
        ,\n                \"createdAt\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Unique contract identifier\"\n                },\n                \"templateId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Source template ID\"\
        \n                },\n                \"templateCode\": {\n                    \"type\": \"string\",\n           \
        \         \"description\": \"Source template code\"\n                },\n                \"status\": {\n         \
        \           \"$ref\": \"#/$defs/ContractStatus\",\n                    \"description\": \"Current contract status\"\
        \n                },\n                \"parties\": {\n                    \"type\": \"array\",\n                 \
        \   \"items\": {\n                        \"$ref\": \"#/$defs/ContractPartyResponse\"\n                    },\n  \
        \                  \"description\": \"Contract parties\"\n                },\n                \"terms\": {\n     \
        \               \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\": true,\n                  \
        \  \"description\": \"Contract terms\"\n                },\n                \"milestones\": {\n                  \
        \  \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/MilestoneInstanceResponse\"\
        \n                    },\n                    \"nullable\": true,\n                    \"description\": \"Milestone
        progress\"\n                },\n                \"currentMilestoneIndex\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Index of current milestone\"\n\
        \                },\n                \"escrowIds\": {\n                    \"type\": \"array\",\n                \
        \    \"items\": {\n                        \"type\": \"string\",\n                        \"format\": \"uuid\"\n \
        \                   },\n                    \"nullable\": true,\n                    \"description\": \"Related escrow
        IDs\"\n                },\n                \"proposedAt\": {\n                    \"type\": \"string\",\n        \
        \            \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was proposed\"\n                },\n                \"acceptedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When all parties consented\"\n                },\n                \"effectiveFrom\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When contract became active\"\n                },\n\
        \                \"effectiveUntil\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When contract expires\"\
        \n                },\n                \"terminatedAt\": {\n                    \"type\": \"string\",\n           \
        \         \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was terminated\"\n                },\n                \"gameMetadata\": {\n                    \"\
        type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Game-specific metadata\"\n                },\n                \"createdAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n              \
        \      \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Last update timestamp\"\n                }\n            }\n        },\n  \
        \      \"ContractStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of
        a contract instance\",\n            \"enum\": [\n                \"draft\",\n                \"proposed\",\n     \
        \           \"pending\",\n                \"active\",\n                \"fulfilled\",\n                \"expired\"\
        ,\n                \"terminated\",\n                \"breached\",\n                \"suspended\",\n              \
        \  \"disputed\",\n                \"declined\"\n            ]\n        },\n        \"ContractPartyResponse\": {\n\
        \            \"type\": \"object\",\n            \"description\": \"Contract party details\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"entityId\",\n                \"entityType\",\n          \
        \      \"role\",\n                \"consentStatus\"\n            ],\n            \"properties\": {\n             \
        \   \"entityId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n      \
        \              \"description\": \"Entity ID\"\n                },\n                \"entityType\": {\n           \
        \         \"type\": \"object\",\n                    \"description\": \"Entity type\"\n                },\n      \
        \          \"role\": {\n                    \"type\": \"string\",\n                    \"description\": \"Role in
        contract\"\n                },\n                \"consentStatus\": {\n                    \"$ref\": \"#/$defs/ConsentStatus\"\
        ,\n                    \"description\": \"Consent status\"\n                },\n                \"consentedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When consent was given\"\n                }\n          \
        \  }\n        },\n        \"ConsentStatus\": {\n            \"type\": \"string\",\n            \"description\": \"\
        Party's consent status\",\n            \"enum\": [\n                \"pending\",\n                \"consented\",\n\
        \                \"declined\",\n                \"implicit\"\n            ]\n        },\n        \"ContractTerms\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\",\n          \
        \  \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n            \
        \        \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Contract
        duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\": {\n \
        \                   \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\": {\n \
        \                   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone
        instance status\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"\
        code\",\n                \"name\",\n                \"sequence\",\n                \"required\",\n               \
        \ \"status\"\n            ],\n            \"properties\": {\n                \"code\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Milestone code\"\n                },\n                \"name\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone name\"\n        \
        \        },\n                \"sequence\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Order in flow\"\n                },\n                \"required\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether required\"\n                },\n                \"status\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneStatus\",\n                    \"description\": \"Current status\"\
        \n                },\n                \"completedAt\": {\n                    \"type\": \"string\",\n            \
        \        \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When completed\"\n                },\n                \"failedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"When failed\"\n                },\n                \"activatedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When this milestone became active\"\n                },\n                \"deadline\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"Absolute deadline (computed from activatedAt + duration)\"\
        \n                },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones\"\n                }\n            }\n        },\n        \"MilestoneStatus\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Current status of a milestone\",\n            \"enum\": [\n  \
        \              \"pending\",\n                \"active\",\n                \"completed\",\n                \"failed\"\
        ,\n                \"skipped\"\n            ]\n        },\n        \"MilestoneDeadlineBehavior\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\",\n        \
        \    \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n            ]\n\
        \        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Propose contract to parties (starts consent flow)\",\n    \"description\"\
        : \"Moves a draft contract to 'proposed' status and notifies parties.\\nParties must consent before the contract becomes
        active.\\n\",\n    \"tags\": [\n        \"Instances\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"\
        proposeContractInstance\"\n}"
  /contract/instance/consent:
    post:
      operationId: consentToContract
      tags:
      - Instances
      summary: Party consents to contract
      description: |
        Records a party's consent to a proposed contract. When all required
        parties consent, the contract moves to 'accepted' then 'active' status.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConsentToContractRequest'
      responses:
        '200':
          description: Consent recorded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractInstanceResponse'
        '400':
          description: Party not part of this contract or already consented
        '404':
          description: Contract not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ConsentToContractRequest\"\
        ,\n    \"$defs\": {\n        \"ConsentToContractRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to consent to a contract\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"contractId\",\n                \"partyEntityId\",\n                \"partyEntityType\"\n      \
        \      ],\n            \"properties\": {\n                \"contractId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Contract to consent to\"\n  \
        \              },\n                \"partyEntityId\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uuid\",\n                    \"description\": \"Entity ID of consenting party\"\n          \
        \      },\n                \"partyEntityType\": {\n                    \"type\": \"object\",\n                   \
        \ \"description\": \"Entity type of consenting party\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractInstanceResponse\"\
        ,\n    \"$defs\": {\n        \"ContractInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract instance details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"contractId\",\n                \"templateId\",\n                \"status\",\n                \"parties\"\
        ,\n                \"createdAt\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Unique contract identifier\"\n                },\n                \"templateId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Source template ID\"\
        \n                },\n                \"templateCode\": {\n                    \"type\": \"string\",\n           \
        \         \"description\": \"Source template code\"\n                },\n                \"status\": {\n         \
        \           \"$ref\": \"#/$defs/ContractStatus\",\n                    \"description\": \"Current contract status\"\
        \n                },\n                \"parties\": {\n                    \"type\": \"array\",\n                 \
        \   \"items\": {\n                        \"$ref\": \"#/$defs/ContractPartyResponse\"\n                    },\n  \
        \                  \"description\": \"Contract parties\"\n                },\n                \"terms\": {\n     \
        \               \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\": true,\n                  \
        \  \"description\": \"Contract terms\"\n                },\n                \"milestones\": {\n                  \
        \  \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/MilestoneInstanceResponse\"\
        \n                    },\n                    \"nullable\": true,\n                    \"description\": \"Milestone
        progress\"\n                },\n                \"currentMilestoneIndex\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Index of current milestone\"\n\
        \                },\n                \"escrowIds\": {\n                    \"type\": \"array\",\n                \
        \    \"items\": {\n                        \"type\": \"string\",\n                        \"format\": \"uuid\"\n \
        \                   },\n                    \"nullable\": true,\n                    \"description\": \"Related escrow
        IDs\"\n                },\n                \"proposedAt\": {\n                    \"type\": \"string\",\n        \
        \            \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was proposed\"\n                },\n                \"acceptedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When all parties consented\"\n                },\n                \"effectiveFrom\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When contract became active\"\n                },\n\
        \                \"effectiveUntil\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When contract expires\"\
        \n                },\n                \"terminatedAt\": {\n                    \"type\": \"string\",\n           \
        \         \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was terminated\"\n                },\n                \"gameMetadata\": {\n                    \"\
        type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Game-specific metadata\"\n                },\n                \"createdAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n              \
        \      \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Last update timestamp\"\n                }\n            }\n        },\n  \
        \      \"ContractStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of
        a contract instance\",\n            \"enum\": [\n                \"draft\",\n                \"proposed\",\n     \
        \           \"pending\",\n                \"active\",\n                \"fulfilled\",\n                \"expired\"\
        ,\n                \"terminated\",\n                \"breached\",\n                \"suspended\",\n              \
        \  \"disputed\",\n                \"declined\"\n            ]\n        },\n        \"ContractPartyResponse\": {\n\
        \            \"type\": \"object\",\n            \"description\": \"Contract party details\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"entityId\",\n                \"entityType\",\n          \
        \      \"role\",\n                \"consentStatus\"\n            ],\n            \"properties\": {\n             \
        \   \"entityId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n      \
        \              \"description\": \"Entity ID\"\n                },\n                \"entityType\": {\n           \
        \         \"type\": \"object\",\n                    \"description\": \"Entity type\"\n                },\n      \
        \          \"role\": {\n                    \"type\": \"string\",\n                    \"description\": \"Role in
        contract\"\n                },\n                \"consentStatus\": {\n                    \"$ref\": \"#/$defs/ConsentStatus\"\
        ,\n                    \"description\": \"Consent status\"\n                },\n                \"consentedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When consent was given\"\n                }\n          \
        \  }\n        },\n        \"ConsentStatus\": {\n            \"type\": \"string\",\n            \"description\": \"\
        Party's consent status\",\n            \"enum\": [\n                \"pending\",\n                \"consented\",\n\
        \                \"declined\",\n                \"implicit\"\n            ]\n        },\n        \"ContractTerms\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\",\n          \
        \  \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n            \
        \        \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Contract
        duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\": {\n \
        \                   \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\": {\n \
        \                   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone
        instance status\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"\
        code\",\n                \"name\",\n                \"sequence\",\n                \"required\",\n               \
        \ \"status\"\n            ],\n            \"properties\": {\n                \"code\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Milestone code\"\n                },\n                \"name\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone name\"\n        \
        \        },\n                \"sequence\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Order in flow\"\n                },\n                \"required\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether required\"\n                },\n                \"status\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneStatus\",\n                    \"description\": \"Current status\"\
        \n                },\n                \"completedAt\": {\n                    \"type\": \"string\",\n            \
        \        \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When completed\"\n                },\n                \"failedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"When failed\"\n                },\n                \"activatedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When this milestone became active\"\n                },\n                \"deadline\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"Absolute deadline (computed from activatedAt + duration)\"\
        \n                },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones\"\n                }\n            }\n        },\n        \"MilestoneStatus\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Current status of a milestone\",\n            \"enum\": [\n  \
        \              \"pending\",\n                \"active\",\n                \"completed\",\n                \"failed\"\
        ,\n                \"skipped\"\n            ]\n        },\n        \"MilestoneDeadlineBehavior\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\",\n        \
        \    \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n            ]\n\
        \        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Party consents to contract\",\n    \"description\": \"Records a party's
        consent to a proposed contract. When all required\\nparties consent, the contract moves to 'accepted' then 'active'
        status.\\n\",\n    \"tags\": [\n        \"Instances\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"\
        consentToContract\"\n}"
  /contract/instance/get:
    post:
      operationId: getContractInstance
      tags:
      - Instances
      summary: Get instance by ID
      description: Retrieves a contract instance by its unique ID.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetContractInstanceRequest'
      responses:
        '200':
          description: Instance retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractInstanceResponse'
        '404':
          description: Instance not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetContractInstanceRequest\"\
        ,\n    \"$defs\": {\n        \"GetContractInstanceRequest\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Request to get a contract instance\",\n            \"additionalProperties\": false,\n           \
        \ \"required\": [\n                \"contractId\"\n            ],\n            \"properties\": {\n               \
        \ \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n      \
        \              \"description\": \"Contract instance ID\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractInstanceResponse\"\
        ,\n    \"$defs\": {\n        \"ContractInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract instance details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"contractId\",\n                \"templateId\",\n                \"status\",\n                \"parties\"\
        ,\n                \"createdAt\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Unique contract identifier\"\n                },\n                \"templateId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Source template ID\"\
        \n                },\n                \"templateCode\": {\n                    \"type\": \"string\",\n           \
        \         \"description\": \"Source template code\"\n                },\n                \"status\": {\n         \
        \           \"$ref\": \"#/$defs/ContractStatus\",\n                    \"description\": \"Current contract status\"\
        \n                },\n                \"parties\": {\n                    \"type\": \"array\",\n                 \
        \   \"items\": {\n                        \"$ref\": \"#/$defs/ContractPartyResponse\"\n                    },\n  \
        \                  \"description\": \"Contract parties\"\n                },\n                \"terms\": {\n     \
        \               \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\": true,\n                  \
        \  \"description\": \"Contract terms\"\n                },\n                \"milestones\": {\n                  \
        \  \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/MilestoneInstanceResponse\"\
        \n                    },\n                    \"nullable\": true,\n                    \"description\": \"Milestone
        progress\"\n                },\n                \"currentMilestoneIndex\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Index of current milestone\"\n\
        \                },\n                \"escrowIds\": {\n                    \"type\": \"array\",\n                \
        \    \"items\": {\n                        \"type\": \"string\",\n                        \"format\": \"uuid\"\n \
        \                   },\n                    \"nullable\": true,\n                    \"description\": \"Related escrow
        IDs\"\n                },\n                \"proposedAt\": {\n                    \"type\": \"string\",\n        \
        \            \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was proposed\"\n                },\n                \"acceptedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When all parties consented\"\n                },\n                \"effectiveFrom\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When contract became active\"\n                },\n\
        \                \"effectiveUntil\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When contract expires\"\
        \n                },\n                \"terminatedAt\": {\n                    \"type\": \"string\",\n           \
        \         \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was terminated\"\n                },\n                \"gameMetadata\": {\n                    \"\
        type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Game-specific metadata\"\n                },\n                \"createdAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n              \
        \      \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Last update timestamp\"\n                }\n            }\n        },\n  \
        \      \"ContractStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of
        a contract instance\",\n            \"enum\": [\n                \"draft\",\n                \"proposed\",\n     \
        \           \"pending\",\n                \"active\",\n                \"fulfilled\",\n                \"expired\"\
        ,\n                \"terminated\",\n                \"breached\",\n                \"suspended\",\n              \
        \  \"disputed\",\n                \"declined\"\n            ]\n        },\n        \"ContractPartyResponse\": {\n\
        \            \"type\": \"object\",\n            \"description\": \"Contract party details\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"entityId\",\n                \"entityType\",\n          \
        \      \"role\",\n                \"consentStatus\"\n            ],\n            \"properties\": {\n             \
        \   \"entityId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n      \
        \              \"description\": \"Entity ID\"\n                },\n                \"entityType\": {\n           \
        \         \"type\": \"object\",\n                    \"description\": \"Entity type\"\n                },\n      \
        \          \"role\": {\n                    \"type\": \"string\",\n                    \"description\": \"Role in
        contract\"\n                },\n                \"consentStatus\": {\n                    \"$ref\": \"#/$defs/ConsentStatus\"\
        ,\n                    \"description\": \"Consent status\"\n                },\n                \"consentedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When consent was given\"\n                }\n          \
        \  }\n        },\n        \"ConsentStatus\": {\n            \"type\": \"string\",\n            \"description\": \"\
        Party's consent status\",\n            \"enum\": [\n                \"pending\",\n                \"consented\",\n\
        \                \"declined\",\n                \"implicit\"\n            ]\n        },\n        \"ContractTerms\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\",\n          \
        \  \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n            \
        \        \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Contract
        duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\": {\n \
        \                   \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\": {\n \
        \                   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone
        instance status\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"\
        code\",\n                \"name\",\n                \"sequence\",\n                \"required\",\n               \
        \ \"status\"\n            ],\n            \"properties\": {\n                \"code\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Milestone code\"\n                },\n                \"name\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone name\"\n        \
        \        },\n                \"sequence\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Order in flow\"\n                },\n                \"required\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether required\"\n                },\n                \"status\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneStatus\",\n                    \"description\": \"Current status\"\
        \n                },\n                \"completedAt\": {\n                    \"type\": \"string\",\n            \
        \        \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When completed\"\n                },\n                \"failedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"When failed\"\n                },\n                \"activatedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When this milestone became active\"\n                },\n                \"deadline\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"Absolute deadline (computed from activatedAt + duration)\"\
        \n                },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones\"\n                }\n            }\n        },\n        \"MilestoneStatus\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Current status of a milestone\",\n            \"enum\": [\n  \
        \              \"pending\",\n                \"active\",\n                \"completed\",\n                \"failed\"\
        ,\n                \"skipped\"\n            ]\n        },\n        \"MilestoneDeadlineBehavior\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\",\n        \
        \    \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n            ]\n\
        \        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get instance by ID\",\n    \"description\": \"Retrieves a contract instance
        by its unique ID.\",\n    \"tags\": [\n        \"Instances\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"getContractInstance\"\n}"
  /contract/instance/query:
    post:
      operationId: queryContractInstances
      tags:
      - Instances
      summary: Query instances by party, template, status
      description: |
        Queries contract instances with various filters. At least one filter
        must be provided.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryContractInstancesRequest'
      responses:
        '200':
          description: Instances retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryContractInstancesResponse'
        '400':
          description: No filter criteria provided
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryContractInstancesRequest\"\
        ,\n    \"$defs\": {\n        \"QueryContractInstancesRequest\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Request to query contract instances with cursor-based pagination.\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"partyEntityId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Filter by party entity ID.\"\n                },\n                \"partyEntityType\": {\n                   \
        \ \"type\": \"object\",\n                    \"nullable\": true,\n                    \"description\": \"Filter by
        party entity type.\"\n                },\n                \"templateId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Filter by template.\"\n                },\n                \"statuses\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/ContractStatus\"\n              \
        \      },\n                    \"nullable\": true,\n                    \"description\": \"Filter by statuses.\"\n\
        \                },\n                \"cursor\": {\n                    \"type\": \"string\",\n                  \
        \  \"nullable\": true,\n                    \"description\": \"Opaque cursor from previous response. Null for first
        page.\"\n                },\n                \"pageSize\": {\n                    \"type\": \"integer\",\n       \
        \             \"minimum\": 1,\n                    \"maximum\": 100,\n                    \"nullable\": true,\n  \
        \                  \"description\": \"Number of items per page. Uses service default if not specified.\"\n       \
        \         }\n            }\n        },\n        \"ContractStatus\": {\n            \"type\": \"string\",\n       \
        \     \"description\": \"Current status of a contract instance\",\n            \"enum\": [\n                \"draft\"\
        ,\n                \"proposed\",\n                \"pending\",\n                \"active\",\n                \"fulfilled\"\
        ,\n                \"expired\",\n                \"terminated\",\n                \"breached\",\n                \"\
        suspended\",\n                \"disputed\",\n                \"declined\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryContractInstancesResponse\"\
        ,\n    \"$defs\": {\n        \"QueryContractInstancesResponse\": {\n            \"type\": \"object\",\n          \
        \  \"description\": \"Paginated list of contract instances.\",\n            \"additionalProperties\": false,\n   \
        \         \"required\": [\n                \"contracts\",\n                \"hasMore\"\n            ],\n         \
        \   \"properties\": {\n                \"contracts\": {\n                    \"type\": \"array\",\n              \
        \      \"items\": {\n                        \"$ref\": \"#/$defs/ContractInstanceResponse\"\n                    },\n\
        \                    \"description\": \"Contracts in this page.\"\n                },\n                \"nextCursor\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Cursor for next page. Null if no more results.\"\n                },\n                \"hasMore\": {\n       \
        \             \"type\": \"boolean\",\n                    \"description\": \"Whether more results exist beyond this
        page.\"\n                }\n            }\n        },\n        \"ContractInstanceResponse\": {\n            \"type\"\
        : \"object\",\n            \"description\": \"Contract instance details\",\n            \"additionalProperties\":
        false,\n            \"required\": [\n                \"contractId\",\n                \"templateId\",\n          \
        \      \"status\",\n                \"parties\",\n                \"createdAt\"\n            ],\n            \"properties\"\
        : {\n                \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uuid\",\n                    \"description\": \"Unique contract identifier\"\n                },\n           \
        \     \"templateId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n  \
        \                  \"description\": \"Source template ID\"\n                },\n                \"templateCode\":
        {\n                    \"type\": \"string\",\n                    \"description\": \"Source template code\"\n    \
        \            },\n                \"status\": {\n                    \"$ref\": \"#/$defs/ContractStatus\",\n      \
        \              \"description\": \"Current contract status\"\n                },\n                \"parties\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"\
        #/$defs/ContractPartyResponse\"\n                    },\n                    \"description\": \"Contract parties\"\
        \n                },\n                \"terms\": {\n                    \"$ref\": \"#/$defs/ContractTerms\",\n   \
        \                 \"nullable\": true,\n                    \"description\": \"Contract terms\"\n                },\n\
        \                \"milestones\": {\n                    \"type\": \"array\",\n                    \"items\": {\n \
        \                       \"$ref\": \"#/$defs/MilestoneInstanceResponse\"\n                    },\n                \
        \    \"nullable\": true,\n                    \"description\": \"Milestone progress\"\n                },\n      \
        \          \"currentMilestoneIndex\": {\n                    \"type\": \"integer\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Index of current milestone\"\n                },\n               \
        \ \"escrowIds\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                 \
        \       \"type\": \"string\",\n                        \"format\": \"uuid\"\n                    },\n            \
        \        \"nullable\": true,\n                    \"description\": \"Related escrow IDs\"\n                },\n  \
        \              \"proposedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When contract was proposed\"\n\
        \                },\n                \"acceptedAt\": {\n                    \"type\": \"string\",\n              \
        \      \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        When all parties consented\"\n                },\n                \"effectiveFrom\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When contract became active\"\n                },\n                \"effectiveUntil\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When contract expires\"\n                },\n    \
        \            \"terminatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When contract was terminated\"\n\
        \                },\n                \"gameMetadata\": {\n                    \"type\": \"object\",\n            \
        \        \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Game-specific metadata\"\n                },\n                \"createdAt\": {\n                    \"type\":
        \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Creation timestamp\"\
        \n                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n              \
        \      \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Last update timestamp\"\n                }\n            }\n        },\n        \"ContractStatus\": {\n           \
        \ \"type\": \"string\",\n            \"description\": \"Current status of a contract instance\",\n            \"enum\"\
        : [\n                \"draft\",\n                \"proposed\",\n                \"pending\",\n                \"active\"\
        ,\n                \"fulfilled\",\n                \"expired\",\n                \"terminated\",\n               \
        \ \"breached\",\n                \"suspended\",\n                \"disputed\",\n                \"declined\"\n   \
        \         ]\n        },\n        \"ContractPartyResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract party details\",\n            \"additionalProperties\": false,\n            \"required\": [\n       \
        \         \"entityId\",\n                \"entityType\",\n                \"role\",\n                \"consentStatus\"\
        \n            ],\n            \"properties\": {\n                \"entityId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Entity ID\"\n       \
        \         },\n                \"entityType\": {\n                    \"type\": \"object\",\n                    \"\
        description\": \"Entity type\"\n                },\n                \"role\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Role in contract\"\n                },\n                \"consentStatus\"\
        : {\n                    \"$ref\": \"#/$defs/ConsentStatus\",\n                    \"description\": \"Consent status\"\
        \n                },\n                \"consentedAt\": {\n                    \"type\": \"string\",\n            \
        \        \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When consent was given\"\n                }\n            }\n        },\n        \"ConsentStatus\": {\n       \
        \     \"type\": \"string\",\n            \"description\": \"Party's consent status\",\n            \"enum\": [\n \
        \               \"pending\",\n                \"consented\",\n                \"declined\",\n                \"implicit\"\
        \n            ]\n        },\n        \"ContractTerms\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Configurable contract terms\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"duration\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Contract duration (ISO 8601 duration, null for perpetual)\"\n            \
        \    },\n                \"paymentSchedule\": {\n                    \"$ref\": \"#/$defs/PaymentSchedule\",\n    \
        \                \"nullable\": true,\n                    \"description\": \"When payments occur\"\n             \
        \   },\n                \"paymentFrequency\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Recurring payment frequency (ISO 8601 duration)\"\n    \
        \            },\n                \"terminationPolicy\": {\n                    \"$ref\": \"#/$defs/TerminationPolicy\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"How contract can be terminated\"\
        \n                },\n                \"terminationNoticePeriod\": {\n                    \"type\": \"string\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Required notice for termination (ISO
        8601 duration)\"\n                },\n                \"breachThreshold\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 0,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Breaches before auto-termination (0 for no auto)\"\n                },\n                \"gracePeriodForCure\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Time to cure breach (ISO 8601 duration)\"\n                },\n                \"customTerms\": {\n          \
        \          \"type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Game-specific custom terms\"\n                }\n            }\n \
        \       },\n        \"PaymentSchedule\": {\n            \"type\": \"string\",\n            \"description\": \"When
        payments occur\",\n            \"enum\": [\n                \"one_time\",\n                \"recurring\",\n      \
        \          \"milestone_based\"\n            ]\n        },\n        \"TerminationPolicy\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"How the contract can be terminated\",\n            \"enum\": [\n   \
        \             \"mutual_consent\",\n                \"unilateral_with_notice\",\n                \"unilateral_immediate\"\
        ,\n                \"non_terminable\"\n            ]\n        },\n        \"MilestoneInstanceResponse\": {\n     \
        \       \"type\": \"object\",\n            \"description\": \"Milestone instance status\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"code\",\n                \"name\",\n                \"sequence\"\
        ,\n                \"required\",\n                \"status\"\n            ],\n            \"properties\": {\n    \
        \            \"code\": {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone
        code\"\n                },\n                \"name\": {\n                    \"type\": \"string\",\n             \
        \       \"description\": \"Milestone name\"\n                },\n                \"sequence\": {\n               \
        \     \"type\": \"integer\",\n                    \"description\": \"Order in flow\"\n                },\n       \
        \         \"required\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether
        required\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/MilestoneStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"completedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When completed\"\n                },\n                \"\
        failedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"When failed\"\n                },\n    \
        \            \"activatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When this milestone became active\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Absolute deadline (computed from activatedAt + duration)\"\n                },\n                \"deadlineBehavior\"\
        : {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Behavior when deadline passes for optional milestones\"\n                }\n\
        \            }\n        },\n        \"MilestoneStatus\": {\n            \"type\": \"string\",\n            \"description\"\
        : \"Current status of a milestone\",\n            \"enum\": [\n                \"pending\",\n                \"active\"\
        ,\n                \"completed\",\n                \"failed\",\n                \"skipped\"\n            ]\n     \
        \   },\n        \"MilestoneDeadlineBehavior\": {\n            \"type\": \"string\",\n            \"description\":
        \"Behavior when optional milestone deadline passes\",\n            \"enum\": [\n                \"skip\",\n      \
        \          \"warn\",\n                \"breach\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Query instances by party, template, status\",\n    \"description\": \"\
        Queries contract instances with various filters. At least one filter\\nmust be provided.\\n\",\n    \"tags\": [\n\
        \        \"Instances\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"queryContractInstances\"\n}"
  /contract/instance/terminate:
    post:
      operationId: terminateContractInstance
      tags:
      - Instances
      summary: Request early termination
      description: |
        Requests early termination of an active contract. Depending on the
        contract's termination policy, this may require mutual consent or
        incur penalties.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TerminateContractInstanceRequest'
      responses:
        '200':
          description: Termination processed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractInstanceResponse'
        '400':
          description: Contract cannot be terminated (policy violation)
        '404':
          description: Contract not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/TerminateContractInstanceRequest\"\
        ,\n    \"$defs\": {\n        \"TerminateContractInstanceRequest\": {\n            \"type\": \"object\",\n        \
        \    \"description\": \"Request to terminate a contract\",\n            \"additionalProperties\": false,\n       \
        \     \"required\": [\n                \"contractId\",\n                \"requestingEntityId\",\n                \"\
        requestingEntityType\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Contract to terminate\"\n                },\n                \"requestingEntityId\": {\n                    \"\
        type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Entity requesting
        termination\"\n                },\n                \"requestingEntityType\": {\n                    \"type\": \"object\"\
        ,\n                    \"description\": \"Type of requesting entity\"\n                },\n                \"reason\"\
        : {\n                    \"type\": \"string\",\n                    \"maxLength\": 1000,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Reason for termination\"\n                }\n            }\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractInstanceResponse\"\
        ,\n    \"$defs\": {\n        \"ContractInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract instance details\",\n            \"additionalProperties\": false,\n            \"required\": [\n    \
        \            \"contractId\",\n                \"templateId\",\n                \"status\",\n                \"parties\"\
        ,\n                \"createdAt\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Unique contract identifier\"\n                },\n                \"templateId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Source template ID\"\
        \n                },\n                \"templateCode\": {\n                    \"type\": \"string\",\n           \
        \         \"description\": \"Source template code\"\n                },\n                \"status\": {\n         \
        \           \"$ref\": \"#/$defs/ContractStatus\",\n                    \"description\": \"Current contract status\"\
        \n                },\n                \"parties\": {\n                    \"type\": \"array\",\n                 \
        \   \"items\": {\n                        \"$ref\": \"#/$defs/ContractPartyResponse\"\n                    },\n  \
        \                  \"description\": \"Contract parties\"\n                },\n                \"terms\": {\n     \
        \               \"$ref\": \"#/$defs/ContractTerms\",\n                    \"nullable\": true,\n                  \
        \  \"description\": \"Contract terms\"\n                },\n                \"milestones\": {\n                  \
        \  \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/MilestoneInstanceResponse\"\
        \n                    },\n                    \"nullable\": true,\n                    \"description\": \"Milestone
        progress\"\n                },\n                \"currentMilestoneIndex\": {\n                    \"type\": \"integer\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Index of current milestone\"\n\
        \                },\n                \"escrowIds\": {\n                    \"type\": \"array\",\n                \
        \    \"items\": {\n                        \"type\": \"string\",\n                        \"format\": \"uuid\"\n \
        \                   },\n                    \"nullable\": true,\n                    \"description\": \"Related escrow
        IDs\"\n                },\n                \"proposedAt\": {\n                    \"type\": \"string\",\n        \
        \            \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was proposed\"\n                },\n                \"acceptedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When all parties consented\"\n                },\n                \"effectiveFrom\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When contract became active\"\n                },\n\
        \                \"effectiveUntil\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When contract expires\"\
        \n                },\n                \"terminatedAt\": {\n                    \"type\": \"string\",\n           \
        \         \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When contract was terminated\"\n                },\n                \"gameMetadata\": {\n                    \"\
        type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Game-specific metadata\"\n                },\n                \"createdAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Creation timestamp\"\n                },\n                \"updatedAt\": {\n              \
        \      \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Last update timestamp\"\n                }\n            }\n        },\n  \
        \      \"ContractStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of
        a contract instance\",\n            \"enum\": [\n                \"draft\",\n                \"proposed\",\n     \
        \           \"pending\",\n                \"active\",\n                \"fulfilled\",\n                \"expired\"\
        ,\n                \"terminated\",\n                \"breached\",\n                \"suspended\",\n              \
        \  \"disputed\",\n                \"declined\"\n            ]\n        },\n        \"ContractPartyResponse\": {\n\
        \            \"type\": \"object\",\n            \"description\": \"Contract party details\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"entityId\",\n                \"entityType\",\n          \
        \      \"role\",\n                \"consentStatus\"\n            ],\n            \"properties\": {\n             \
        \   \"entityId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n      \
        \              \"description\": \"Entity ID\"\n                },\n                \"entityType\": {\n           \
        \         \"type\": \"object\",\n                    \"description\": \"Entity type\"\n                },\n      \
        \          \"role\": {\n                    \"type\": \"string\",\n                    \"description\": \"Role in
        contract\"\n                },\n                \"consentStatus\": {\n                    \"$ref\": \"#/$defs/ConsentStatus\"\
        ,\n                    \"description\": \"Consent status\"\n                },\n                \"consentedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When consent was given\"\n                }\n          \
        \  }\n        },\n        \"ConsentStatus\": {\n            \"type\": \"string\",\n            \"description\": \"\
        Party's consent status\",\n            \"enum\": [\n                \"pending\",\n                \"consented\",\n\
        \                \"declined\",\n                \"implicit\"\n            ]\n        },\n        \"ContractTerms\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Configurable contract terms\",\n          \
        \  \"additionalProperties\": false,\n            \"properties\": {\n                \"duration\": {\n            \
        \        \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Contract
        duration (ISO 8601 duration, null for perpetual)\"\n                },\n                \"paymentSchedule\": {\n \
        \                   \"$ref\": \"#/$defs/PaymentSchedule\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"When payments occur\"\n                },\n                \"paymentFrequency\": {\n \
        \                   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Recurring payment frequency (ISO 8601 duration)\"\n                },\n                \"terminationPolicy\":
        {\n                    \"$ref\": \"#/$defs/TerminationPolicy\",\n                    \"nullable\": true,\n       \
        \             \"description\": \"How contract can be terminated\"\n                },\n                \"terminationNoticePeriod\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Required notice for termination (ISO 8601 duration)\"\n                },\n                \"breachThreshold\"\
        : {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"nullable\"\
        : true,\n                    \"description\": \"Breaches before auto-termination (0 for no auto)\"\n             \
        \   },\n                \"gracePeriodForCure\": {\n                    \"type\": \"string\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"Time to cure breach (ISO 8601 duration)\"\n        \
        \        },\n                \"customTerms\": {\n                    \"type\": \"object\",\n                    \"\
        additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\": \"Game-specific
        custom terms\"\n                }\n            }\n        },\n        \"PaymentSchedule\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"When payments occur\",\n            \"enum\": [\n                \"\
        one_time\",\n                \"recurring\",\n                \"milestone_based\"\n            ]\n        },\n    \
        \    \"TerminationPolicy\": {\n            \"type\": \"string\",\n            \"description\": \"How the contract
        can be terminated\",\n            \"enum\": [\n                \"mutual_consent\",\n                \"unilateral_with_notice\"\
        ,\n                \"unilateral_immediate\",\n                \"non_terminable\"\n            ]\n        },\n    \
        \    \"MilestoneInstanceResponse\": {\n            \"type\": \"object\",\n            \"description\": \"Milestone
        instance status\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"\
        code\",\n                \"name\",\n                \"sequence\",\n                \"required\",\n               \
        \ \"status\"\n            ],\n            \"properties\": {\n                \"code\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Milestone code\"\n                },\n                \"name\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone name\"\n        \
        \        },\n                \"sequence\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Order in flow\"\n                },\n                \"required\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether required\"\n                },\n                \"status\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneStatus\",\n                    \"description\": \"Current status\"\
        \n                },\n                \"completedAt\": {\n                    \"type\": \"string\",\n            \
        \        \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When completed\"\n                },\n                \"failedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"\
        description\": \"When failed\"\n                },\n                \"activatedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When this milestone became active\"\n                },\n                \"deadline\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"Absolute deadline (computed from activatedAt + duration)\"\
        \n                },\n                \"deadlineBehavior\": {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Behavior when deadline passes for
        optional milestones\"\n                }\n            }\n        },\n        \"MilestoneStatus\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Current status of a milestone\",\n            \"enum\": [\n  \
        \              \"pending\",\n                \"active\",\n                \"completed\",\n                \"failed\"\
        ,\n                \"skipped\"\n            ]\n        },\n        \"MilestoneDeadlineBehavior\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Behavior when optional milestone deadline passes\",\n        \
        \    \"enum\": [\n                \"skip\",\n                \"warn\",\n                \"breach\"\n            ]\n\
        \        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Request early termination\",\n    \"description\": \"Requests early termination
        of an active contract. Depending on the\\ncontract's termination policy, this may require mutual consent or\\nincur
        penalties.\\n\",\n    \"tags\": [\n        \"Instances\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"terminateContractInstance\"\n}"
  /contract/instance/get-status:
    post:
      operationId: getContractInstanceStatus
      tags:
      - Instances
      summary: Get current status and milestone progress
      description: |
        Gets the current status of a contract including milestone progress,
        pending consents, and any active breaches.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetContractInstanceStatusRequest'
      responses:
        '200':
          description: Status retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractInstanceStatusResponse'
        '404':
          description: Contract not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetContractInstanceStatusRequest\"\
        ,\n    \"$defs\": {\n        \"GetContractInstanceStatusRequest\": {\n            \"type\": \"object\",\n        \
        \    \"description\": \"Request to get contract status\",\n            \"additionalProperties\": false,\n        \
        \    \"required\": [\n                \"contractId\"\n            ],\n            \"properties\": {\n            \
        \    \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n   \
        \                 \"description\": \"Contract instance ID\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractInstanceStatusResponse\"\
        ,\n    \"$defs\": {\n        \"ContractInstanceStatusResponse\": {\n            \"type\": \"object\",\n          \
        \  \"description\": \"Contract status summary\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"contractId\",\n                \"status\",\n                \"milestoneProgress\"\n       \
        \     ],\n            \"properties\": {\n                \"contractId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Contract instance ID\"\n    \
        \            },\n                \"status\": {\n                    \"$ref\": \"#/$defs/ContractStatus\",\n      \
        \              \"description\": \"Current status\"\n                },\n                \"milestoneProgress\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"\
        #/$defs/MilestoneProgressSummary\"\n                    },\n                    \"description\": \"Milestone progress
        summary\"\n                },\n                \"pendingConsents\": {\n                    \"type\": \"array\",\n\
        \                    \"items\": {\n                        \"$ref\": \"#/$defs/PendingConsentSummary\"\n         \
        \           },\n                    \"nullable\": true,\n                    \"description\": \"Parties who haven't
        consented\"\n                },\n                \"activeBreaches\": {\n                    \"type\": \"array\",\n\
        \                    \"items\": {\n                        \"$ref\": \"#/$defs/BreachSummary\"\n                 \
        \   },\n                    \"nullable\": true,\n                    \"description\": \"Active breach records\"\n\
        \                },\n                \"daysUntilExpiration\": {\n                    \"type\": \"integer\",\n    \
        \                \"nullable\": true,\n                    \"description\": \"Days until natural expiration\"\n   \
        \             }\n            }\n        },\n        \"ContractStatus\": {\n            \"type\": \"string\",\n   \
        \         \"description\": \"Current status of a contract instance\",\n            \"enum\": [\n                \"\
        draft\",\n                \"proposed\",\n                \"pending\",\n                \"active\",\n             \
        \   \"fulfilled\",\n                \"expired\",\n                \"terminated\",\n                \"breached\",\n\
        \                \"suspended\",\n                \"disputed\",\n                \"declined\"\n            ]\n    \
        \    },\n        \"MilestoneProgressSummary\": {\n            \"type\": \"object\",\n            \"description\":
        \"Brief milestone progress\",\n            \"additionalProperties\": false,\n            \"required\": [\n       \
        \         \"code\",\n                \"status\"\n            ],\n            \"properties\": {\n                \"\
        code\": {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone code\"\n  \
        \              },\n                \"status\": {\n                    \"$ref\": \"#/$defs/MilestoneStatus\",\n   \
        \                 \"description\": \"Current status\"\n                }\n            }\n        },\n        \"MilestoneStatus\"\
        : {\n            \"type\": \"string\",\n            \"description\": \"Current status of a milestone\",\n        \
        \    \"enum\": [\n                \"pending\",\n                \"active\",\n                \"completed\",\n    \
        \            \"failed\",\n                \"skipped\"\n            ]\n        },\n        \"PendingConsentSummary\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Summary of pending consent\",\n           \
        \ \"additionalProperties\": false,\n            \"required\": [\n                \"entityId\",\n                \"\
        entityType\",\n                \"role\"\n            ],\n            \"properties\": {\n                \"entityId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"Entity ID\"\n                },\n                \"entityType\": {\n                    \"type\"\
        : \"object\",\n                    \"description\": \"Entity type\"\n                },\n                \"role\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Role in contract\"\n      \
        \          }\n            }\n        },\n        \"BreachSummary\": {\n            \"type\": \"object\",\n       \
        \     \"description\": \"Brief breach information\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"breachId\",\n                \"breachType\",\n                \"status\"\n      \
        \      ],\n            \"properties\": {\n                \"breachId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Breach ID\"\n               \
        \ },\n                \"breachType\": {\n                    \"$ref\": \"#/$defs/BreachType\",\n                 \
        \   \"description\": \"Type of breach\"\n                },\n                \"status\": {\n                    \"\
        $ref\": \"#/$defs/BreachStatus\",\n                    \"description\": \"Current status\"\n                }\n  \
        \          }\n        },\n        \"BreachType\": {\n            \"type\": \"string\",\n            \"description\"\
        : \"Type of contract breach\",\n            \"enum\": [\n                \"term_violation\",\n                \"milestone_missed\"\
        ,\n                \"milestone_deadline\",\n                \"unauthorized_action\",\n                \"non_payment\"\
        \n            ]\n        },\n        \"BreachStatus\": {\n            \"type\": \"string\",\n            \"description\"\
        : \"Current status of a breach record\",\n            \"enum\": [\n                \"detected\",\n               \
        \ \"cure_period\",\n                \"cured\",\n                \"consequences_applied\",\n                \"disputed\"\
        ,\n                \"forgiven\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get current status and milestone progress\",\n    \"description\": \"Gets
        the current status of a contract including milestone progress,\\npending consents, and any active breaches.\\n\",\n\
        \    \"tags\": [\n        \"Instances\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getContractInstanceStatus\"\
        \n}"
  /contract/milestone/complete:
    post:
      operationId: completeMilestone
      tags:
      - Milestones
      summary: External system reports milestone completed
      description: |
        Called by external systems to report that a milestone's conditions
        have been met. Triggers onComplete prebound APIs and may advance
        contract status.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompleteMilestoneRequest'
      responses:
        '200':
          description: Milestone completed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MilestoneResponse'
        '400':
          description: Milestone not in valid state for completion
        '404':
          description: Contract or milestone not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CompleteMilestoneRequest\"\
        ,\n    \"$defs\": {\n        \"CompleteMilestoneRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to complete a milestone\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"contractId\",\n                \"milestoneCode\"\n            ],\n            \"properties\": {\n\
        \                \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"\
        uuid\",\n                    \"description\": \"Contract instance ID\"\n                },\n                \"milestoneCode\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone to complete\"\n \
        \               },\n                \"evidence\": {\n                    \"type\": \"object\",\n                 \
        \   \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Evidence of completion\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MilestoneResponse\"\
        ,\n    \"$defs\": {\n        \"MilestoneResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Milestone details\",\n            \"additionalProperties\": false,\n            \"required\": [\n            \
        \    \"contractId\",\n                \"milestone\"\n            ],\n            \"properties\": {\n             \
        \   \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n    \
        \                \"description\": \"Contract instance ID\"\n                },\n                \"milestone\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneInstanceResponse\",\n                    \"description\": \"Milestone
        details\"\n                }\n            }\n        },\n        \"MilestoneInstanceResponse\": {\n            \"\
        type\": \"object\",\n            \"description\": \"Milestone instance status\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"code\",\n                \"name\",\n                \"sequence\"\
        ,\n                \"required\",\n                \"status\"\n            ],\n            \"properties\": {\n    \
        \            \"code\": {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone
        code\"\n                },\n                \"name\": {\n                    \"type\": \"string\",\n             \
        \       \"description\": \"Milestone name\"\n                },\n                \"sequence\": {\n               \
        \     \"type\": \"integer\",\n                    \"description\": \"Order in flow\"\n                },\n       \
        \         \"required\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether
        required\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/MilestoneStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"completedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When completed\"\n                },\n                \"\
        failedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"When failed\"\n                },\n    \
        \            \"activatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When this milestone became active\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Absolute deadline (computed from activatedAt + duration)\"\n                },\n                \"deadlineBehavior\"\
        : {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Behavior when deadline passes for optional milestones\"\n                }\n\
        \            }\n        },\n        \"MilestoneStatus\": {\n            \"type\": \"string\",\n            \"description\"\
        : \"Current status of a milestone\",\n            \"enum\": [\n                \"pending\",\n                \"active\"\
        ,\n                \"completed\",\n                \"failed\",\n                \"skipped\"\n            ]\n     \
        \   },\n        \"MilestoneDeadlineBehavior\": {\n            \"type\": \"string\",\n            \"description\":
        \"Behavior when optional milestone deadline passes\",\n            \"enum\": [\n                \"skip\",\n      \
        \          \"warn\",\n                \"breach\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"External system reports milestone completed\",\n    \"description\": \"\
        Called by external systems to report that a milestone's conditions\\nhave been met. Triggers onComplete prebound APIs
        and may advance\\ncontract status.\\n\",\n    \"tags\": [\n        \"Milestones\"\n    ],\n    \"deprecated\": false,\n\
        \    \"operationId\": \"completeMilestone\"\n}"
  /contract/milestone/fail:
    post:
      operationId: failMilestone
      tags:
      - Milestones
      summary: External system reports milestone failed
      description: |
        Called by external systems to report that a milestone has failed
        (e.g., deadline passed, conditions cannot be met). Triggers onExpire
        prebound APIs and may record a breach.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FailMilestoneRequest'
      responses:
        '200':
          description: Milestone failure recorded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MilestoneResponse'
        '400':
          description: Milestone not in valid state for failure
        '404':
          description: Contract or milestone not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/FailMilestoneRequest\"\
        ,\n    \"$defs\": {\n        \"FailMilestoneRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to fail a milestone\",\n            \"additionalProperties\": false,\n            \"required\": [\n  \
        \              \"contractId\",\n                \"milestoneCode\"\n            ],\n            \"properties\": {\n\
        \                \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"\
        uuid\",\n                    \"description\": \"Contract instance ID\"\n                },\n                \"milestoneCode\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone that failed\"\n \
        \               },\n                \"reason\": {\n                    \"type\": \"string\",\n                   \
        \ \"maxLength\": 1000,\n                    \"nullable\": true,\n                    \"description\": \"Reason for
        failure\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MilestoneResponse\"\
        ,\n    \"$defs\": {\n        \"MilestoneResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Milestone details\",\n            \"additionalProperties\": false,\n            \"required\": [\n            \
        \    \"contractId\",\n                \"milestone\"\n            ],\n            \"properties\": {\n             \
        \   \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n    \
        \                \"description\": \"Contract instance ID\"\n                },\n                \"milestone\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneInstanceResponse\",\n                    \"description\": \"Milestone
        details\"\n                }\n            }\n        },\n        \"MilestoneInstanceResponse\": {\n            \"\
        type\": \"object\",\n            \"description\": \"Milestone instance status\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"code\",\n                \"name\",\n                \"sequence\"\
        ,\n                \"required\",\n                \"status\"\n            ],\n            \"properties\": {\n    \
        \            \"code\": {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone
        code\"\n                },\n                \"name\": {\n                    \"type\": \"string\",\n             \
        \       \"description\": \"Milestone name\"\n                },\n                \"sequence\": {\n               \
        \     \"type\": \"integer\",\n                    \"description\": \"Order in flow\"\n                },\n       \
        \         \"required\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether
        required\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/MilestoneStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"completedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When completed\"\n                },\n                \"\
        failedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"When failed\"\n                },\n    \
        \            \"activatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When this milestone became active\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Absolute deadline (computed from activatedAt + duration)\"\n                },\n                \"deadlineBehavior\"\
        : {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Behavior when deadline passes for optional milestones\"\n                }\n\
        \            }\n        },\n        \"MilestoneStatus\": {\n            \"type\": \"string\",\n            \"description\"\
        : \"Current status of a milestone\",\n            \"enum\": [\n                \"pending\",\n                \"active\"\
        ,\n                \"completed\",\n                \"failed\",\n                \"skipped\"\n            ]\n     \
        \   },\n        \"MilestoneDeadlineBehavior\": {\n            \"type\": \"string\",\n            \"description\":
        \"Behavior when optional milestone deadline passes\",\n            \"enum\": [\n                \"skip\",\n      \
        \          \"warn\",\n                \"breach\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"External system reports milestone failed\",\n    \"description\": \"Called
        by external systems to report that a milestone has failed\\n(e.g., deadline passed, conditions cannot be met). Triggers
        onExpire\\nprebound APIs and may record a breach.\\n\",\n    \"tags\": [\n        \"Milestones\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"failMilestone\"\n}"
  /contract/milestone/get:
    post:
      operationId: getMilestone
      tags:
      - Milestones
      summary: Get milestone details and status
      description: Gets the current state of a specific milestone.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetMilestoneRequest'
      responses:
        '200':
          description: Milestone retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MilestoneResponse'
        '404':
          description: Contract or milestone not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetMilestoneRequest\"\
        ,\n    \"$defs\": {\n        \"GetMilestoneRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to get milestone details\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"contractId\",\n                \"milestoneCode\"\n            ],\n            \"properties\": {\n\
        \                \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"\
        uuid\",\n                    \"description\": \"Contract instance ID\"\n                },\n                \"milestoneCode\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone code\"\n        \
        \        }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MilestoneResponse\"\
        ,\n    \"$defs\": {\n        \"MilestoneResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Milestone details\",\n            \"additionalProperties\": false,\n            \"required\": [\n            \
        \    \"contractId\",\n                \"milestone\"\n            ],\n            \"properties\": {\n             \
        \   \"contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n    \
        \                \"description\": \"Contract instance ID\"\n                },\n                \"milestone\": {\n\
        \                    \"$ref\": \"#/$defs/MilestoneInstanceResponse\",\n                    \"description\": \"Milestone
        details\"\n                }\n            }\n        },\n        \"MilestoneInstanceResponse\": {\n            \"\
        type\": \"object\",\n            \"description\": \"Milestone instance status\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"code\",\n                \"name\",\n                \"sequence\"\
        ,\n                \"required\",\n                \"status\"\n            ],\n            \"properties\": {\n    \
        \            \"code\": {\n                    \"type\": \"string\",\n                    \"description\": \"Milestone
        code\"\n                },\n                \"name\": {\n                    \"type\": \"string\",\n             \
        \       \"description\": \"Milestone name\"\n                },\n                \"sequence\": {\n               \
        \     \"type\": \"integer\",\n                    \"description\": \"Order in flow\"\n                },\n       \
        \         \"required\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether
        required\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/MilestoneStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"completedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        nullable\": true,\n                    \"description\": \"When completed\"\n                },\n                \"\
        failedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"When failed\"\n                },\n    \
        \            \"activatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When this milestone became active\"\
        \n                },\n                \"deadline\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Absolute deadline (computed from activatedAt + duration)\"\n                },\n                \"deadlineBehavior\"\
        : {\n                    \"$ref\": \"#/$defs/MilestoneDeadlineBehavior\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Behavior when deadline passes for optional milestones\"\n                }\n\
        \            }\n        },\n        \"MilestoneStatus\": {\n            \"type\": \"string\",\n            \"description\"\
        : \"Current status of a milestone\",\n            \"enum\": [\n                \"pending\",\n                \"active\"\
        ,\n                \"completed\",\n                \"failed\",\n                \"skipped\"\n            ]\n     \
        \   },\n        \"MilestoneDeadlineBehavior\": {\n            \"type\": \"string\",\n            \"description\":
        \"Behavior when optional milestone deadline passes\",\n            \"enum\": [\n                \"skip\",\n      \
        \          \"warn\",\n                \"breach\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get milestone details and status\",\n    \"description\": \"Gets the current
        state of a specific milestone.\",\n    \"tags\": [\n        \"Milestones\"\n    ],\n    \"deprecated\": false,\n \
        \   \"operationId\": \"getMilestone\"\n}"
  /contract/breach/report:
    post:
      operationId: reportBreach
      tags:
      - Breaches
      summary: Report a contract breach
      description: |
        Reports a breach of contract terms. This can be called by parties
        or external systems. The breach enters a grace period for cure
        if configured.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReportBreachRequest'
      responses:
        '200':
          description: Breach reported successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BreachResponse'
        '400':
          description: Invalid breach report
        '404':
          description: Contract not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ReportBreachRequest\"\
        ,\n    \"$defs\": {\n        \"ReportBreachRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to report a breach\",\n            \"additionalProperties\": false,\n            \"required\": [\n   \
        \             \"contractId\",\n                \"breachingEntityId\",\n                \"breachingEntityType\",\n\
        \                \"breachType\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Contract that was breached\"\n                },\n                \"breachingEntityId\": {\n                 \
        \   \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Entity
        that breached\"\n                },\n                \"breachingEntityType\": {\n                    \"type\": \"\
        object\",\n                    \"description\": \"Type of breaching entity\"\n                },\n               \
        \ \"breachType\": {\n                    \"$ref\": \"#/$defs/BreachType\",\n                    \"description\": \"\
        Type of breach\"\n                },\n                \"breachedTermOrMilestone\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Code of breached term
        or milestone\"\n                },\n                \"description\": {\n                    \"type\": \"string\",\n\
        \                    \"maxLength\": 2000,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Breach description\"\n                }\n            }\n        },\n        \"BreachType\": {\n            \"\
        type\": \"string\",\n            \"description\": \"Type of contract breach\",\n            \"enum\": [\n        \
        \        \"term_violation\",\n                \"milestone_missed\",\n                \"milestone_deadline\",\n   \
        \             \"unauthorized_action\",\n                \"non_payment\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BreachResponse\"\
        ,\n    \"$defs\": {\n        \"BreachResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Breach record details\",\n            \"additionalProperties\": false,\n            \"required\": [\n        \
        \        \"breachId\",\n                \"contractId\",\n                \"breachingEntityId\",\n                \"\
        breachingEntityType\",\n                \"breachType\",\n                \"status\",\n                \"detectedAt\"\
        \n            ],\n            \"properties\": {\n                \"breachId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Unique breach identifier\"\
        \n                },\n                \"contractId\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uuid\",\n                    \"description\": \"Contract that was breached\"\n             \
        \   },\n                \"breachingEntityId\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uuid\",\n                    \"description\": \"Entity that breached\"\n                },\n         \
        \       \"breachingEntityType\": {\n                    \"type\": \"object\",\n                    \"description\"\
        : \"Type of breaching entity\"\n                },\n                \"breachType\": {\n                    \"$ref\"\
        : \"#/$defs/BreachType\",\n                    \"description\": \"Type of breach\"\n                },\n         \
        \       \"breachedTermOrMilestone\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"What was breached\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Breach description\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/BreachStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"detectedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        description\": \"When breach was detected\"\n                },\n                \"cureDeadline\": {\n           \
        \         \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Deadline to cure breach\"\n                },\n                \"\
        curedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n        \
        \            \"nullable\": true,\n                    \"description\": \"When breach was cured\"\n               \
        \ },\n                \"consequencesAppliedAt\": {\n                    \"type\": \"string\",\n                  \
        \  \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When
        consequences were applied\"\n                }\n            }\n        },\n        \"BreachType\": {\n           \
        \ \"type\": \"string\",\n            \"description\": \"Type of contract breach\",\n            \"enum\": [\n    \
        \            \"term_violation\",\n                \"milestone_missed\",\n                \"milestone_deadline\",\n\
        \                \"unauthorized_action\",\n                \"non_payment\"\n            ]\n        },\n        \"\
        BreachStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of a breach record\"\
        ,\n            \"enum\": [\n                \"detected\",\n                \"cure_period\",\n                \"cured\"\
        ,\n                \"consequences_applied\",\n                \"disputed\",\n                \"forgiven\"\n      \
        \      ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Report a contract breach\",\n    \"description\": \"Reports a breach of
        contract terms. This can be called by parties\\nor external systems. The breach enters a grace period for cure\\nif
        configured.\\n\",\n    \"tags\": [\n        \"Breaches\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"reportBreach\"\n}"
  /contract/breach/cure:
    post:
      operationId: cureBreach
      tags:
      - Breaches
      summary: Mark breach as cured (system/admin action)
      description: |
        Marks a breach as cured within the grace period. This prevents
        consequences from being applied. Called by systems that verify
        the breach has been remedied.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CureBreachRequest'
      responses:
        '200':
          description: Breach cured successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BreachResponse'
        '400':
          description: Breach not in curable state
        '404':
          description: Breach not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CureBreachRequest\"\
        ,\n    \"$defs\": {\n        \"CureBreachRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to cure a breach\",\n            \"additionalProperties\": false,\n            \"required\": [\n     \
        \           \"breachId\"\n            ],\n            \"properties\": {\n                \"breachId\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Breach to cure\"\n                },\n                \"cureEvidence\": {\n                    \"type\": \"string\"\
        ,\n                    \"maxLength\": 2000,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Evidence of cure\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BreachResponse\"\
        ,\n    \"$defs\": {\n        \"BreachResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Breach record details\",\n            \"additionalProperties\": false,\n            \"required\": [\n        \
        \        \"breachId\",\n                \"contractId\",\n                \"breachingEntityId\",\n                \"\
        breachingEntityType\",\n                \"breachType\",\n                \"status\",\n                \"detectedAt\"\
        \n            ],\n            \"properties\": {\n                \"breachId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Unique breach identifier\"\
        \n                },\n                \"contractId\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uuid\",\n                    \"description\": \"Contract that was breached\"\n             \
        \   },\n                \"breachingEntityId\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uuid\",\n                    \"description\": \"Entity that breached\"\n                },\n         \
        \       \"breachingEntityType\": {\n                    \"type\": \"object\",\n                    \"description\"\
        : \"Type of breaching entity\"\n                },\n                \"breachType\": {\n                    \"$ref\"\
        : \"#/$defs/BreachType\",\n                    \"description\": \"Type of breach\"\n                },\n         \
        \       \"breachedTermOrMilestone\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"What was breached\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Breach description\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/BreachStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"detectedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        description\": \"When breach was detected\"\n                },\n                \"cureDeadline\": {\n           \
        \         \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Deadline to cure breach\"\n                },\n                \"\
        curedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n        \
        \            \"nullable\": true,\n                    \"description\": \"When breach was cured\"\n               \
        \ },\n                \"consequencesAppliedAt\": {\n                    \"type\": \"string\",\n                  \
        \  \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When
        consequences were applied\"\n                }\n            }\n        },\n        \"BreachType\": {\n           \
        \ \"type\": \"string\",\n            \"description\": \"Type of contract breach\",\n            \"enum\": [\n    \
        \            \"term_violation\",\n                \"milestone_missed\",\n                \"milestone_deadline\",\n\
        \                \"unauthorized_action\",\n                \"non_payment\"\n            ]\n        },\n        \"\
        BreachStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of a breach record\"\
        ,\n            \"enum\": [\n                \"detected\",\n                \"cure_period\",\n                \"cured\"\
        ,\n                \"consequences_applied\",\n                \"disputed\",\n                \"forgiven\"\n      \
        \      ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Mark breach as cured (system/admin action)\",\n    \"description\": \"\
        Marks a breach as cured within the grace period. This prevents\\nconsequences from being applied. Called by systems
        that verify\\nthe breach has been remedied.\\n\",\n    \"tags\": [\n        \"Breaches\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"cureBreach\"\n}"
  /contract/breach/get:
    post:
      operationId: getBreach
      tags:
      - Breaches
      summary: Get breach details
      description: Retrieves details of a specific breach record.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetBreachRequest'
      responses:
        '200':
          description: Breach retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BreachResponse'
        '404':
          description: Breach not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetBreachRequest\"\
        ,\n    \"$defs\": {\n        \"GetBreachRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to get breach details\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"breachId\"\n            ],\n            \"properties\": {\n                \"breachId\": {\n  \
        \                  \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Breach ID\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BreachResponse\"\
        ,\n    \"$defs\": {\n        \"BreachResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Breach record details\",\n            \"additionalProperties\": false,\n            \"required\": [\n        \
        \        \"breachId\",\n                \"contractId\",\n                \"breachingEntityId\",\n                \"\
        breachingEntityType\",\n                \"breachType\",\n                \"status\",\n                \"detectedAt\"\
        \n            ],\n            \"properties\": {\n                \"breachId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Unique breach identifier\"\
        \n                },\n                \"contractId\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uuid\",\n                    \"description\": \"Contract that was breached\"\n             \
        \   },\n                \"breachingEntityId\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uuid\",\n                    \"description\": \"Entity that breached\"\n                },\n         \
        \       \"breachingEntityType\": {\n                    \"type\": \"object\",\n                    \"description\"\
        : \"Type of breaching entity\"\n                },\n                \"breachType\": {\n                    \"$ref\"\
        : \"#/$defs/BreachType\",\n                    \"description\": \"Type of breach\"\n                },\n         \
        \       \"breachedTermOrMilestone\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"What was breached\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Breach description\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/BreachStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"detectedAt\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"\
        description\": \"When breach was detected\"\n                },\n                \"cureDeadline\": {\n           \
        \         \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Deadline to cure breach\"\n                },\n                \"\
        curedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n        \
        \            \"nullable\": true,\n                    \"description\": \"When breach was cured\"\n               \
        \ },\n                \"consequencesAppliedAt\": {\n                    \"type\": \"string\",\n                  \
        \  \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When
        consequences were applied\"\n                }\n            }\n        },\n        \"BreachType\": {\n           \
        \ \"type\": \"string\",\n            \"description\": \"Type of contract breach\",\n            \"enum\": [\n    \
        \            \"term_violation\",\n                \"milestone_missed\",\n                \"milestone_deadline\",\n\
        \                \"unauthorized_action\",\n                \"non_payment\"\n            ]\n        },\n        \"\
        BreachStatus\": {\n            \"type\": \"string\",\n            \"description\": \"Current status of a breach record\"\
        ,\n            \"enum\": [\n                \"detected\",\n                \"cure_period\",\n                \"cured\"\
        ,\n                \"consequences_applied\",\n                \"disputed\",\n                \"forgiven\"\n      \
        \      ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get breach details\",\n    \"description\": \"Retrieves details of a specific
        breach record.\",\n    \"tags\": [\n        \"Breaches\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"getBreach\"\n}"
  /contract/metadata/update:
    post:
      operationId: updateContractMetadata
      tags:
      - Metadata
      summary: Update game metadata on instance
      description: |
        Updates game-specific metadata on a contract instance without
        touching contract state. Used by higher-level systems (quests, etc.)
        to store additional context.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateContractMetadataRequest'
      responses:
        '200':
          description: Metadata updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractMetadataResponse'
        '404':
          description: Contract not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateContractMetadataRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateContractMetadataRequest\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Request to update contract metadata\",\n            \"additionalProperties\": false,\n      \
        \      \"required\": [\n                \"contractId\",\n                \"metadataType\",\n                \"data\"\
        \n            ],\n            \"properties\": {\n                \"contractId\": {\n                    \"type\":
        \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Contract instance ID\"\
        \n                },\n                \"metadataType\": {\n                    \"$ref\": \"#/$defs/MetadataType\"\
        ,\n                    \"description\": \"Which metadata to update\"\n                },\n                \"data\"\
        : {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n            \
        \        \"description\": \"Metadata to set or merge\"\n                }\n            }\n        },\n        \"MetadataType\"\
        : {\n            \"type\": \"string\",\n            \"description\": \"Type of metadata to update\",\n           \
        \ \"enum\": [\n                \"instance_data\",\n                \"runtime_state\"\n            ]\n        }\n \
        \   }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractMetadataResponse\"\
        ,\n    \"$defs\": {\n        \"ContractMetadataResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract metadata\",\n            \"additionalProperties\": false,\n            \"required\": [\n            \
        \    \"contractId\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n          \
        \          \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\":
        \"Contract instance ID\"\n                },\n                \"instanceData\": {\n                    \"type\": \"\
        object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n        \
        \            \"description\": \"Instance-level metadata\"\n                },\n                \"runtimeState\": {\n\
        \                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n                \
        \    \"nullable\": true,\n                    \"description\": \"Runtime state metadata\"\n                }\n   \
        \         }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Update game metadata on instance\",\n    \"description\": \"Updates game-specific
        metadata on a contract instance without\\ntouching contract state. Used by higher-level systems (quests, etc.)\\nto
        store additional context.\\n\",\n    \"tags\": [\n        \"Metadata\"\n    ],\n    \"deprecated\": false,\n    \"\
        operationId\": \"updateContractMetadata\"\n}"
  /contract/metadata/get:
    post:
      operationId: getContractMetadata
      tags:
      - Metadata
      summary: Get game metadata
      description: Retrieves game-specific metadata from a contract instance.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetContractMetadataRequest'
      responses:
        '200':
          description: Metadata retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContractMetadataResponse'
        '404':
          description: Contract not found
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetContractMetadataRequest\"\
        ,\n    \"$defs\": {\n        \"GetContractMetadataRequest\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Request to get contract metadata\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"contractId\"\n            ],\n            \"properties\": {\n                \"contractId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"Contract instance ID\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ContractMetadataResponse\"\
        ,\n    \"$defs\": {\n        \"ContractMetadataResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Contract metadata\",\n            \"additionalProperties\": false,\n            \"required\": [\n            \
        \    \"contractId\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n          \
        \          \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\":
        \"Contract instance ID\"\n                },\n                \"instanceData\": {\n                    \"type\": \"\
        object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n        \
        \            \"description\": \"Instance-level metadata\"\n                },\n                \"runtimeState\": {\n\
        \                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n                \
        \    \"nullable\": true,\n                    \"description\": \"Runtime state metadata\"\n                }\n   \
        \         }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get game metadata\",\n    \"description\": \"Retrieves game-specific metadata
        from a contract instance.\",\n    \"tags\": [\n        \"Metadata\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"getContractMetadata\"\n}"
  /contract/check-constraint:
    post:
      operationId: checkContractConstraint
      tags:
      - Constraints
      summary: Check if entity can take action given contracts
      description: |
        Checks whether an entity's proposed action would violate any
        active contract constraints (exclusivity, non-compete, territory, etc.).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckConstraintRequest'
      responses:
        '200':
          description: Constraint check completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckConstraintResponse'
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CheckConstraintRequest\"\
        ,\n    \"$defs\": {\n        \"CheckConstraintRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to check constraint\",\n            \"additionalProperties\": false,\n            \"required\": [\n  \
        \              \"entityId\",\n                \"entityType\",\n                \"constraintType\"\n            ],\n\
        \            \"properties\": {\n                \"entityId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"description\": \"Entity to check\"\n                },\n\
        \                \"entityType\": {\n                    \"type\": \"object\",\n                    \"description\"\
        : \"Entity type\"\n                },\n                \"constraintType\": {\n                    \"$ref\": \"#/$defs/ConstraintType\"\
        ,\n                    \"description\": \"Type of constraint to check\"\n                },\n                \"proposedAction\"\
        : {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n            \
        \        \"nullable\": true,\n                    \"description\": \"What the entity wants to do\"\n             \
        \   }\n            }\n        },\n        \"ConstraintType\": {\n            \"type\": \"string\",\n            \"\
        description\": \"Type of constraint to check\",\n            \"enum\": [\n                \"exclusivity\",\n     \
        \           \"non_compete\",\n                \"time_commitment\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CheckConstraintResponse\"\
        ,\n    \"$defs\": {\n        \"CheckConstraintResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Constraint check result\",\n            \"additionalProperties\": false,\n            \"required\": [\n      \
        \          \"allowed\"\n            ],\n            \"properties\": {\n                \"allowed\": {\n          \
        \          \"type\": \"boolean\",\n                    \"description\": \"Whether action is allowed\"\n          \
        \      },\n                \"conflictingContracts\": {\n                    \"type\": \"array\",\n               \
        \     \"items\": {\n                        \"$ref\": \"#/$defs/ContractSummary\"\n                    },\n      \
        \              \"nullable\": true,\n                    \"description\": \"Contracts that would be violated\"\n  \
        \              },\n                \"reason\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Explanation if not allowed\"\n                }\n      \
        \      }\n        },\n        \"ContractSummary\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Brief contract information\",\n            \"additionalProperties\": false,\n            \"required\": [\n   \
        \             \"contractId\",\n                \"templateCode\",\n                \"status\",\n                \"\
        role\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Contract ID\"\n \
        \               },\n                \"templateCode\": {\n                    \"type\": \"string\",\n             \
        \       \"description\": \"Template code\"\n                },\n                \"templateName\": {\n            \
        \        \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Template
        name\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/ContractStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"role\": {\n    \
        \                \"type\": \"string\",\n                    \"description\": \"Entity's role in contract\"\n     \
        \           },\n                \"effectiveUntil\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        When contract expires\"\n                }\n            }\n        },\n        \"ContractStatus\": {\n           \
        \ \"type\": \"string\",\n            \"description\": \"Current status of a contract instance\",\n            \"enum\"\
        : [\n                \"draft\",\n                \"proposed\",\n                \"pending\",\n                \"active\"\
        ,\n                \"fulfilled\",\n                \"expired\",\n                \"terminated\",\n               \
        \ \"breached\",\n                \"suspended\",\n                \"disputed\",\n                \"declined\"\n   \
        \         ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Check if entity can take action given contracts\",\n    \"description\"\
        : \"Checks whether an entity's proposed action would violate any\\nactive contract constraints (exclusivity, non-compete,
        territory, etc.).\\n\",\n    \"tags\": [\n        \"Constraints\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"checkContractConstraint\"\n}"
  /contract/query-active:
    post:
      operationId: queryActiveContracts
      tags:
      - Constraints
      summary: Query active contracts for entity
      description: |
        Returns all active contracts where the specified entity is a party.
        Useful for displaying current obligations in UI.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryActiveContractsRequest'
      responses:
        '200':
          description: Active contracts retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryActiveContractsResponse'
      x-permissions:
      - role: user
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryActiveContractsRequest\"\
        ,\n    \"$defs\": {\n        \"QueryActiveContractsRequest\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Request to query active contracts\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"entityId\",\n                \"entityType\"\n            ],\n            \"properties\"\
        : {\n                \"entityId\": {\n                    \"type\": \"string\",\n                    \"format\": \"\
        uuid\",\n                    \"description\": \"Entity to query\"\n                },\n                \"entityType\"\
        : {\n                    \"type\": \"object\",\n                    \"description\": \"Entity type\"\n           \
        \     },\n                \"templateCodes\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Filter by template codes\"\n                }\n            }\n        }\n\
        \    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryActiveContractsResponse\"\
        ,\n    \"$defs\": {\n        \"QueryActiveContractsResponse\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Active contracts for entity\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"contracts\"\n            ],\n            \"properties\": {\n                \"contracts\":
        {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"\
        #/$defs/ContractSummary\"\n                    },\n                    \"description\": \"Active contracts\"\n   \
        \             }\n            }\n        },\n        \"ContractSummary\": {\n            \"type\": \"object\",\n  \
        \          \"description\": \"Brief contract information\",\n            \"additionalProperties\": false,\n      \
        \      \"required\": [\n                \"contractId\",\n                \"templateCode\",\n                \"status\"\
        ,\n                \"role\"\n            ],\n            \"properties\": {\n                \"contractId\": {\n  \
        \                  \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Contract ID\"\n                },\n                \"templateCode\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Template code\"\n                },\n                \"templateName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Template name\"\n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/ContractStatus\"\
        ,\n                    \"description\": \"Current status\"\n                },\n                \"role\": {\n    \
        \                \"type\": \"string\",\n                    \"description\": \"Entity's role in contract\"\n     \
        \           },\n                \"effectiveUntil\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        When contract expires\"\n                }\n            }\n        },\n        \"ContractStatus\": {\n           \
        \ \"type\": \"string\",\n            \"description\": \"Current status of a contract instance\",\n            \"enum\"\
        : [\n                \"draft\",\n                \"proposed\",\n                \"pending\",\n                \"active\"\
        ,\n                \"fulfilled\",\n                \"expired\",\n                \"terminated\",\n               \
        \ \"breached\",\n                \"suspended\",\n                \"disputed\",\n                \"declined\"\n   \
        \         ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Query active contracts for entity\",\n    \"description\": \"Returns all
        active contracts where the specified entity is a party.\\nUseful for displaying current obligations in UI.\\n\",\n\
        \    \"tags\": [\n        \"Constraints\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"queryActiveContracts\"\
        \n}"
  /contract/lock:
    post:
      operationId: lockContract
      tags:
      - Guardian
      summary: Lock contract under guardian custody
      description: |
        Locks a contract under guardian custody (e.g., escrow). A locked contract
        cannot be modified, terminated, or have parties transferred except by the
        guardian. Requires the contract template to have `transferable: true`.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LockContractRequest'
      responses:
        '200':
          description: Contract locked successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LockContractResponse'
        '400':
          description: Contract not transferable
        '404':
          description: Contract not found
        '409':
          description: Contract already locked
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LockContractRequest\"\
        ,\n    \"$defs\": {\n        \"LockContractRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to lock a contract under guardian custody\",\n            \"additionalProperties\": false,\n         \
        \   \"required\": [\n                \"contractInstanceId\",\n                \"guardianId\",\n                \"\
        guardianType\"\n            ],\n            \"properties\": {\n                \"contractInstanceId\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Contract instance ID to lock\"\n                },\n                \"guardianId\": {\n                    \"\
        type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Guardian entity
        ID (e.g., escrow agreement ID)\"\n                },\n                \"guardianType\": {\n                    \"\
        type\": \"string\",\n                    \"maxLength\": 64,\n                    \"description\": \"Guardian entity
        type (e.g., \\\"escrow\\\")\"\n                },\n                \"idempotencyKey\": {\n                    \"type\"\
        : \"string\",\n                    \"maxLength\": 64,\n                    \"nullable\": true,\n                 \
        \   \"description\": \"Optional idempotency key for the operation\"\n                }\n            }\n        }\n\
        \    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LockContractResponse\"\
        ,\n    \"$defs\": {\n        \"LockContractResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response from locking a contract\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"locked\",\n                \"contractId\"\n            ],\n            \"properties\": {\n    \
        \            \"locked\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether
        the contract was locked\"\n                },\n                \"contractId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Contract instance ID\"\
        \n                },\n                \"guardianId\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uuid\",\n                    \"description\": \"Guardian entity ID\"\n                },\n \
        \               \"lockedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"description\": \"When the contract was locked\"\n                }\n            }\n     \
        \   }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Lock contract under guardian custody\",\n    \"description\": \"Locks a
        contract under guardian custody (e.g., escrow). A locked contract\\ncannot be modified, terminated, or have parties
        transferred except by the\\nguardian. Requires the contract template to have `transferable: true`.\\n\",\n    \"tags\"\
        : [\n        \"Guardian\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"lockContract\"\n}"
  /contract/unlock:
    post:
      operationId: unlockContract
      tags:
      - Guardian
      summary: Unlock contract from guardian custody
      description: |
        Unlocks a contract from guardian custody. Only the current guardian can
        unlock a contract. Called on escrow refund to restore contract to original state.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UnlockContractRequest'
      responses:
        '200':
          description: Contract unlocked successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnlockContractResponse'
        '403':
          description: Not the current guardian
        '404':
          description: Contract not found or not locked
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UnlockContractRequest\"\
        ,\n    \"$defs\": {\n        \"UnlockContractRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to unlock a contract from guardian custody\",\n            \"additionalProperties\": false,\n        \
        \    \"required\": [\n                \"contractInstanceId\",\n                \"guardianId\",\n                \"\
        guardianType\"\n            ],\n            \"properties\": {\n                \"contractInstanceId\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Contract instance ID to unlock\"\n                },\n                \"guardianId\": {\n                    \"\
        type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Guardian entity
        ID (must match current guardian)\"\n                },\n                \"guardianType\": {\n                    \"\
        type\": \"string\",\n                    \"maxLength\": 64,\n                    \"description\": \"Guardian entity
        type\"\n                },\n                \"idempotencyKey\": {\n                    \"type\": \"string\",\n   \
        \                 \"maxLength\": 64,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Optional idempotency key for the operation\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UnlockContractResponse\"\
        ,\n    \"$defs\": {\n        \"UnlockContractResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response from unlocking a contract\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"unlocked\",\n                \"contractId\"\n            ],\n            \"properties\": {\n\
        \                \"unlocked\": {\n                    \"type\": \"boolean\",\n                    \"description\"\
        : \"Whether the contract was unlocked\"\n                },\n                \"contractId\": {\n                 \
        \   \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Contract
        instance ID\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Unlock contract from guardian custody\",\n    \"description\": \"Unlocks
        a contract from guardian custody. Only the current guardian can\\nunlock a contract. Called on escrow refund to restore
        contract to original state.\\n\",\n    \"tags\": [\n        \"Guardian\"\n    ],\n    \"deprecated\": false,\n   \
        \ \"operationId\": \"unlockContract\"\n}"
  /contract/transfer-party:
    post:
      operationId: transferContractParty
      tags:
      - Guardian
      summary: Transfer party role to new entity
      description: |
        Transfers a party role to a new entity. Used by escrow to reassign contract
        roles on release (e.g., transfer landlord role to new property owner).
        Contract must be locked and caller must be the guardian.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TransferContractPartyRequest'
      responses:
        '200':
          description: Party transferred successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransferContractPartyResponse'
        '400':
          description: Party not found in contract
        '403':
          description: Not the current guardian or contract not locked
        '404':
          description: Contract not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/TransferContractPartyRequest\"\
        ,\n    \"$defs\": {\n        \"TransferContractPartyRequest\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Request to transfer a party role to a new entity\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"contractInstanceId\",\n                \"fromEntityId\",\n       \
        \         \"fromEntityType\",\n                \"toEntityId\",\n                \"toEntityType\",\n              \
        \  \"guardianId\",\n                \"guardianType\"\n            ],\n            \"properties\": {\n            \
        \    \"contractInstanceId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Contract instance ID\"\n                },\n                \"fromEntityId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"Current party entity ID\"\n                },\n                \"fromEntityType\": {\n          \
        \          \"type\": \"object\",\n                    \"description\": \"Current party entity type\"\n           \
        \     },\n                \"toEntityId\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uuid\",\n                    \"description\": \"New entity ID to receive the role\"\n                },\n    \
        \            \"toEntityType\": {\n                    \"type\": \"object\",\n                    \"description\":
        \"New entity type\"\n                },\n                \"guardianId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Guardian entity ID (must be current
        guardian)\"\n                },\n                \"guardianType\": {\n                    \"type\": \"string\",\n\
        \                    \"maxLength\": 64,\n                    \"description\": \"Guardian entity type\"\n         \
        \       },\n                \"idempotencyKey\": {\n                    \"type\": \"string\",\n                   \
        \ \"maxLength\": 64,\n                    \"nullable\": true,\n                    \"description\": \"Optional idempotency
        key for the operation\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/TransferContractPartyResponse\"\
        ,\n    \"$defs\": {\n        \"TransferContractPartyResponse\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Response from transferring a party role\",\n            \"additionalProperties\": false,\n  \
        \          \"required\": [\n                \"transferred\",\n                \"contractId\"\n            ],\n   \
        \         \"properties\": {\n                \"transferred\": {\n                    \"type\": \"boolean\",\n    \
        \                \"description\": \"Whether the transfer was successful\"\n                },\n                \"\
        contractId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n          \
        \          \"description\": \"Contract instance ID\"\n                },\n                \"role\": {\n          \
        \          \"type\": \"string\",\n                    \"description\": \"Role that was transferred\"\n           \
        \     },\n                \"fromEntityId\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uuid\",\n                    \"description\": \"Previous party entity ID\"\n                },\n             \
        \   \"toEntityId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n    \
        \                \"description\": \"New party entity ID\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Transfer party role to new entity\",\n    \"description\": \"Transfers
        a party role to a new entity. Used by escrow to reassign contract\\nroles on release (e.g., transfer landlord role
        to new property owner).\\nContract must be locked and caller must be the guardian.\\n\",\n    \"tags\": [\n      \
        \  \"Guardian\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"transferContractParty\"\n}"
  /contract/clause-type/register:
    post:
      operationId: registerClauseType
      tags:
      - ClauseTypes
      summary: Register a new clause type
      description: |
        Registers a new clause type with validation and/or execution handlers.
        Clause types are registered globally (plugin-level, admin operation) and
        referenced by contract templates via typeCode. Built-in types
        (asset_requirement, currency_transfer, item_transfer) are pre-registered.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterClauseTypeRequest'
      responses:
        '200':
          description: Clause type registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterClauseTypeResponse'
        '409':
          description: Clause type code already exists
      x-permissions:
      - role: admin
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RegisterClauseTypeRequest\"\
        ,\n    \"$defs\": {\n        \"RegisterClauseTypeRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to register a new clause type\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"typeCode\",\n                \"description\",\n                \"category\"\n            ],\n\
        \            \"properties\": {\n                \"typeCode\": {\n                    \"type\": \"string\",\n     \
        \               \"maxLength\": 64,\n                    \"pattern\": \"^[a-z0-9_]+$\",\n                    \"description\"\
        : \"Unique identifier for this clause type\"\n                },\n                \"description\": {\n           \
        \         \"type\": \"string\",\n                    \"maxLength\": 500,\n                    \"description\": \"\
        Human-readable description\"\n                },\n                \"category\": {\n                    \"$ref\": \"\
        #/$defs/ClauseCategory\",\n                    \"description\": \"Whether this is a validation, execution, or both
        type of clause\"\n                },\n                \"validationHandler\": {\n                    \"$ref\": \"#/$defs/ClauseHandlerDefinition\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Handler called during check-asset-requirements\"\
        \n                },\n                \"executionHandler\": {\n                    \"$ref\": \"#/$defs/ClauseHandlerDefinition\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Handler called during execute\"\
        \n                }\n            }\n        },\n        \"ClauseCategory\": {\n            \"type\": \"string\",\n\
        \            \"description\": \"Category of clause type\",\n            \"enum\": [\n                \"validation\"\
        ,\n                \"execution\",\n                \"both\"\n            ]\n        },\n        \"ClauseHandlerDefinition\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Handler definition for clause type operations\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"service\",\n     \
        \           \"endpoint\"\n            ],\n            \"properties\": {\n                \"service\": {\n        \
        \            \"type\": \"string\",\n                    \"description\": \"Target service name\"\n               \
        \ },\n                \"endpoint\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Target endpoint path\"\n                },\n                \"requestMapping\": {\n                    \"type\"\
        : \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n    \
        \                \"description\": \"Template variable to request field mapping\"\n                },\n           \
        \     \"responseMapping\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : true,\n                    \"nullable\": true,\n                    \"description\": \"Response field to result
        mapping\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RegisterClauseTypeResponse\"\
        ,\n    \"$defs\": {\n        \"RegisterClauseTypeResponse\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Response from registering a clause type\",\n            \"additionalProperties\": false,\n      \
        \      \"required\": [\n                \"registered\",\n                \"typeCode\"\n            ],\n          \
        \  \"properties\": {\n                \"registered\": {\n                    \"type\": \"boolean\",\n            \
        \        \"description\": \"Whether the type was registered\"\n                },\n                \"typeCode\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"The registered type code\"\n  \
        \              }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Register a new clause type\",\n    \"description\": \"Registers a new clause
        type with validation and/or execution handlers.\\nClause types are registered globally (plugin-level, admin operation)
        and\\nreferenced by contract templates via typeCode. Built-in types\\n(asset_requirement, currency_transfer, item_transfer)
        are pre-registered.\\n\",\n    \"tags\": [\n        \"ClauseTypes\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"registerClauseType\"\n}"
  /contract/clause-type/list:
    post:
      operationId: listClauseTypes
      tags:
      - ClauseTypes
      summary: List all registered clause types
      description: |
        Lists all registered clause types including built-in types and
        custom-registered types.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListClauseTypesRequest'
      responses:
        '200':
          description: Clause types listed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListClauseTypesResponse'
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListClauseTypesRequest\"\
        ,\n    \"$defs\": {\n        \"ListClauseTypesRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to list clause types\",\n            \"additionalProperties\": false,\n            \"properties\": {\n\
        \                \"category\": {\n                    \"$ref\": \"#/$defs/ClauseCategory\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Filter by category\"\n                },\n             \
        \   \"includeBuiltIn\": {\n                    \"type\": \"boolean\",\n                    \"default\": true,\n  \
        \                  \"description\": \"Include built-in types in response\"\n                }\n            }\n   \
        \     },\n        \"ClauseCategory\": {\n            \"type\": \"string\",\n            \"description\": \"Category
        of clause type\",\n            \"enum\": [\n                \"validation\",\n                \"execution\",\n    \
        \            \"both\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListClauseTypesResponse\"\
        ,\n    \"$defs\": {\n        \"ListClauseTypesResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response containing list of clause types\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"clauseTypes\"\n            ],\n            \"properties\": {\n                \"clauseTypes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/ClauseTypeSummary\"\n                    },\n                    \"description\": \"List of registered
        clause types\"\n                }\n            }\n        },\n        \"ClauseTypeSummary\": {\n            \"type\"\
        : \"object\",\n            \"description\": \"Summary of a clause type\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"typeCode\",\n                \"description\",\n                \"\
        category\",\n                \"hasValidationHandler\",\n                \"hasExecutionHandler\",\n               \
        \ \"isBuiltIn\"\n            ],\n            \"properties\": {\n                \"typeCode\": {\n                \
        \    \"type\": \"string\",\n                    \"description\": \"Unique identifier\"\n                },\n     \
        \           \"description\": {\n                    \"type\": \"string\",\n                    \"description\": \"\
        Human-readable description\"\n                },\n                \"category\": {\n                    \"$ref\": \"\
        #/$defs/ClauseCategory\",\n                    \"description\": \"Clause category\"\n                },\n        \
        \        \"hasValidationHandler\": {\n                    \"type\": \"boolean\",\n                    \"description\"\
        : \"Whether a validation handler is registered\"\n                },\n                \"hasExecutionHandler\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"Whether an execution handler is
        registered\"\n                },\n                \"isBuiltIn\": {\n                    \"type\": \"boolean\",\n \
        \                   \"description\": \"Whether this is a built-in type\"\n                }\n            }\n     \
        \   },\n        \"ClauseCategory\": {\n            \"type\": \"string\",\n            \"description\": \"Category
        of clause type\",\n            \"enum\": [\n                \"validation\",\n                \"execution\",\n    \
        \            \"both\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List all registered clause types\",\n    \"description\": \"Lists all registered
        clause types including built-in types and\\ncustom-registered types.\\n\",\n    \"tags\": [\n        \"ClauseTypes\"\
        \n    ],\n    \"deprecated\": false,\n    \"operationId\": \"listClauseTypes\"\n}"
  /contract/instance/set-template-values:
    post:
      operationId: setContractTemplateValues
      tags:
      - Execution
      summary: Set template values on contract instance
      description: |
        Sets template values on a contract instance. Called by escrow when binding
        a contract to an escrow agreement. Template values are used for variable
        substitution in clause handlers (e.g., wallet IDs, container IDs).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetTemplateValuesRequest'
      responses:
        '200':
          description: Template values set successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SetTemplateValuesResponse'
        '400':
          description: Invalid template key format
        '404':
          description: Contract not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SetTemplateValuesRequest\"\
        ,\n    \"$defs\": {\n        \"SetTemplateValuesRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to set template values on a contract\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"contractInstanceId\",\n                \"templateValues\"\n            ],\n     \
        \       \"properties\": {\n                \"contractInstanceId\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"uuid\",\n                    \"description\": \"Contract instance ID\"\n      \
        \          },\n                \"templateValues\": {\n                    \"type\": \"object\",\n                \
        \    \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n         \
        \           \"description\": \"Key-value pairs for template substitution.\\nKeys should follow pattern: EscrowId,
        PartyA_EscrowWalletId, etc.\\n\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SetTemplateValuesResponse\"\
        ,\n    \"$defs\": {\n        \"SetTemplateValuesResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response from setting template values\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"updated\",\n                \"contractId\"\n            ],\n            \"properties\": {\n\
        \                \"updated\": {\n                    \"type\": \"boolean\",\n                    \"description\":
        \"Whether values were updated\"\n                },\n                \"contractId\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Contract instance
        ID\"\n                },\n                \"valueCount\": {\n                    \"type\": \"integer\",\n        \
        \            \"description\": \"Number of template values set\"\n                }\n            }\n        }\n   \
        \ }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Set template values on contract instance\",\n    \"description\": \"Sets
        template values on a contract instance. Called by escrow when binding\\na contract to an escrow agreement. Template
        values are used for variable\\nsubstitution in clause handlers (e.g., wallet IDs, container IDs).\\n\",\n    \"tags\"\
        : [\n        \"Execution\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"setContractTemplateValues\"\
        \n}"
  /contract/instance/check-asset-requirements:
    post:
      operationId: checkAssetRequirements
      tags:
      - Execution
      summary: Check if asset requirement clauses are satisfied
      description: |
        Checks if all asset requirement clauses are satisfied. Uses template values
        (e.g., PartyA_EscrowWalletId) to query actual balances in escrow wallets/containers
        via the registered clause type handlers.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckAssetRequirementsRequest'
      responses:
        '200':
          description: Asset requirements checked
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckAssetRequirementsResponse'
        '400':
          description: Template values not set
        '404':
          description: Contract not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CheckAssetRequirementsRequest\"\
        ,\n    \"$defs\": {\n        \"CheckAssetRequirementsRequest\": {\n            \"type\": \"object\",\n           \
        \ \"description\": \"Request to check asset requirement clauses\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"contractInstanceId\"\n            ],\n            \"properties\":
        {\n                \"contractInstanceId\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uuid\",\n                    \"description\": \"Contract instance ID\"\n                }\n            }\n   \
        \     }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CheckAssetRequirementsResponse\"\
        ,\n    \"$defs\": {\n        \"CheckAssetRequirementsResponse\": {\n            \"type\": \"object\",\n          \
        \  \"description\": \"Response from checking asset requirements\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"allSatisfied\",\n                \"byParty\"\n            ],\n   \
        \         \"properties\": {\n                \"allSatisfied\": {\n                    \"type\": \"boolean\",\n   \
        \                 \"description\": \"Whether all requirements across all parties are satisfied\"\n               \
        \ },\n                \"byParty\": {\n                    \"type\": \"array\",\n                    \"items\": {\n\
        \                        \"$ref\": \"#/$defs/PartyAssetRequirementStatus\"\n                    },\n             \
        \       \"description\": \"Status broken down by party\"\n                }\n            }\n        },\n        \"\
        PartyAssetRequirementStatus\": {\n            \"type\": \"object\",\n            \"description\": \"Asset requirement
        status for a single party\",\n            \"additionalProperties\": false,\n            \"required\": [\n        \
        \        \"partyRole\",\n                \"satisfied\",\n                \"clauses\"\n            ],\n           \
        \ \"properties\": {\n                \"partyRole\": {\n                    \"type\": \"string\",\n               \
        \     \"description\": \"Party role (e.g., party_a, party_b)\"\n                },\n                \"satisfied\"\
        : {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether all party's requirements
        are satisfied\"\n                },\n                \"clauses\": {\n                    \"type\": \"array\",\n  \
        \                  \"items\": {\n                        \"$ref\": \"#/$defs/ClauseAssetStatus\"\n               \
        \     },\n                    \"description\": \"Status of each clause for this party\"\n                }\n     \
        \       }\n        },\n        \"ClauseAssetStatus\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Status of a single clause's asset requirements\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"clauseId\",\n                \"satisfied\",\n                \"required\",\n    \
        \            \"current\",\n                \"missing\"\n            ],\n            \"properties\": {\n          \
        \      \"clauseId\": {\n                    \"type\": \"string\",\n                    \"description\": \"Clause identifier\"\
        \n                },\n                \"satisfied\": {\n                    \"type\": \"boolean\",\n             \
        \       \"description\": \"Whether requirement is satisfied\"\n                },\n                \"required\": {\n\
        \                    \"$ref\": \"#/$defs/AssetRequirementInfo\",\n                    \"description\": \"What the
        clause requires\"\n                },\n                \"current\": {\n                    \"type\": \"number\",\n\
        \                    \"description\": \"Current amount present\"\n                },\n                \"missing\"\
        : {\n                    \"type\": \"number\",\n                    \"description\": \"Amount still needed (0 if satisfied)\"\
        \n                }\n            }\n        },\n        \"AssetRequirementInfo\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"Information about a required asset\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"type\",\n                \"code\",\n                \"amount\"\n \
        \           ],\n            \"properties\": {\n                \"type\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Asset type (currency, item, item_stack)\"\n                },\n        \
        \        \"code\": {\n                    \"type\": \"string\",\n                    \"description\": \"Currency code
        or item template code\"\n                },\n                \"amount\": {\n                    \"type\": \"number\"\
        ,\n                    \"description\": \"Amount or quantity required\"\n                }\n            }\n      \
        \  }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Check if asset requirement clauses are satisfied\",\n    \"description\"\
        : \"Checks if all asset requirement clauses are satisfied. Uses template values\\n(e.g., PartyA_EscrowWalletId) to
        query actual balances in escrow wallets/containers\\nvia the registered clause type handlers.\\n\",\n    \"tags\"\
        : [\n        \"Execution\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"checkAssetRequirements\"\n}"
  /contract/instance/execute:
    post:
      operationId: executeContract
      tags:
      - Execution
      summary: Execute all contract clauses (idempotent)
      description: |
        Executes all contract distribution clauses - distribute assets per clauses,
        collect fees, mark contract as executed. This is idempotent - calling twice
        returns the same result without re-executing. Contract must be in fulfilled
        status and all template values must be set.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteContractRequest'
      responses:
        '200':
          description: Contract executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExecuteContractResponse'
        '400':
          description: Contract not in fulfilled status or template values missing
        '404':
          description: Contract not found
      x-permissions:
      - role: developer
        states: {}
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ExecuteContractRequest\"\
        ,\n    \"$defs\": {\n        \"ExecuteContractRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to execute contract clauses\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"contractInstanceId\"\n            ],\n            \"properties\": {\n                \"contractInstanceId\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"\
        description\": \"Contract instance ID\"\n                },\n                \"idempotencyKey\": {\n             \
        \       \"type\": \"string\",\n                    \"maxLength\": 64,\n                    \"nullable\": true,\n \
        \                   \"description\": \"Idempotency key for the execution\"\n                }\n            }\n   \
        \     }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ExecuteContractResponse\"\
        ,\n    \"$defs\": {\n        \"ExecuteContractResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response from executing a contract\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"executed\",\n                \"alreadyExecuted\"\n            ],\n            \"properties\"\
        : {\n                \"executed\": {\n                    \"type\": \"boolean\",\n                    \"description\"\
        : \"Whether execution was successful\"\n                },\n                \"alreadyExecuted\": {\n             \
        \       \"type\": \"boolean\",\n                    \"description\": \"True if this was a repeat call (idempotency)\"\
        \n                },\n                \"contractId\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uuid\",\n                    \"description\": \"Contract instance ID\"\n                },\n\
        \                \"distributions\": {\n                    \"type\": \"array\",\n                    \"items\": {\n\
        \                        \"$ref\": \"#/$defs/ClauseDistributionResult\"\n                    },\n                \
        \    \"nullable\": true,\n                    \"description\": \"Per-clause distribution outcomes with success/failure
        details\"\n                },\n                \"executedAt\": {\n                    \"type\": \"string\",\n    \
        \                \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"When execution occurred\"\n                }\n            }\n        },\n        \"ClauseDistributionResult\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Outcome of a single clause distribution during
        contract execution.\\nUsed in ContractExecutedEvent to provide per-clause success/failure details.\\nDeliberately
        excludes wallet/container IDs - consumers tracking these should\\ncorrelate via clauseId to their own records.\\n\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"clauseId\",\n    \
        \            \"clauseType\",\n                \"assetType\",\n                \"amount\",\n                \"succeeded\"\
        \n            ],\n            \"properties\": {\n                \"clauseId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"The clause that was executed\"\
        \n                },\n                \"clauseType\": {\n                    \"type\": \"string\",\n             \
        \       \"description\": \"Type of clause (e.g., currency_transfer, item_transfer, fee)\"\n                },\n  \
        \              \"assetType\": {\n                    \"type\": \"string\",\n                    \"description\": \"\
        Descriptive type of asset involved (e.g., \\\"currency\\\", \\\"item\\\").\\nProvides human-readable context for what
        was transferred.\\n\"\n                },\n                \"amount\": {\n                    \"type\": \"number\"\
        ,\n                    \"description\": \"Quantity transferred (currency amount, item count, etc.)\"\n           \
        \     },\n                \"succeeded\": {\n                    \"type\": \"boolean\",\n                    \"description\"\
        : \"Whether this clause executed successfully\"\n                },\n                \"failureReason\": {\n      \
        \              \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"If succeeded is false, describes what went wrong\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Execute all contract clauses (idempotent)\",\n    \"description\": \"Executes
        all contract distribution clauses - distribute assets per clauses,\\ncollect fees, mark contract as executed. This
        is idempotent - calling twice\\nreturns the same result without re-executing. Contract must be in fulfilled\\nstatus
        and all template values must be set.\\n\",\n    \"tags\": [\n        \"Execution\"\n    ],\n    \"deprecated\": false,\n\
        \    \"operationId\": \"executeContract\"\n}"
components:
  schemas:
    ContractStatus:
      type: string
      description: Current status of a contract instance
      enum:
      - draft
      - proposed
      - pending
      - active
      - fulfilled
      - expired
      - terminated
      - breached
      - suspended
      - disputed
      - declined
    MilestoneStatus:
      type: string
      description: Current status of a milestone
      enum:
      - pending
      - active
      - completed
      - failed
      - skipped
    BreachType:
      type: string
      description: Type of contract breach
      enum:
      - term_violation
      - milestone_missed
      - milestone_deadline
      - unauthorized_action
      - non_payment
    MilestoneDeadlineBehavior:
      type: string
      description: Behavior when optional milestone deadline passes
      enum:
      - skip
      - warn
      - breach
    BreachStatus:
      type: string
      description: Current status of a breach record
      enum:
      - detected
      - cure_period
      - cured
      - consequences_applied
      - disputed
      - forgiven
    ConsentStatus:
      type: string
      description: Party's consent status
      enum:
      - pending
      - consented
      - declined
      - implicit
    EnforcementMode:
      type: string
      description: How contract breaches are handled
      enum:
      - advisory
      - event_only
      - consequence_based
      - community
    TerminationPolicy:
      type: string
      description: How the contract can be terminated
      enum:
      - mutual_consent
      - unilateral_with_notice
      - unilateral_immediate
      - non_terminable
    PaymentSchedule:
      type: string
      description: When payments occur
      enum:
      - one_time
      - recurring
      - milestone_based
    ConstraintType:
      type: string
      description: Type of constraint to check
      enum:
      - exclusivity
      - non_compete
      - time_commitment
    MetadataType:
      type: string
      description: Type of metadata to update
      enum:
      - instance_data
      - runtime_state
    IndexLockFailureMode:
      type: string
      description: Behavior when index lock acquisition fails
      enum:
      - warn
      - fail
    TermsMergeMode:
      type: string
      description: How instance terms merge with template terms during contract creation
      enum:
      - shallow
      - deep
    CreateContractTemplateRequest:
      type: object
      description: Request to create a new contract template
      additionalProperties: false
      required:
      - code
      - name
      - minParties
      - maxParties
      - partyRoles
      properties:
        code:
          type: string
          maxLength: 64
          pattern: "^[a-z0-9_]+$"
          description: Unique code for this template (lowercase, underscores)
        name:
          type: string
          maxLength: 200
          description: Human-readable template name
        description:
          type: string
          maxLength: 2000
          nullable: true
          description: Detailed description of this contract type
        realmId:
          type: string
          format: uuid
          nullable: true
          description: Realm ID if template is realm-specific (null for cross-realm)
        minParties:
          type: integer
          minimum: 2
          description: Minimum number of parties required
        maxParties:
          type: integer
          minimum: 2
          maximum: 20
          description: Maximum number of parties allowed
        partyRoles:
          type: array
          items:
            $ref: '#/components/schemas/PartyRoleDefinition'
          minItems: 1
          description: Role definitions for parties in this contract
        defaultTerms:
          $ref: '#/components/schemas/ContractTerms'
          nullable: true
          description: Default terms for instances of this template
        milestones:
          type: array
          items:
            $ref: '#/components/schemas/MilestoneDefinition'
          nullable: true
          description: Milestone definitions for this contract type
        defaultEnforcementMode:
          $ref: '#/components/schemas/EnforcementMode'
          description: Default enforcement mode for instances
        transferable:
          type: boolean
          default: false
          description: Whether contracts can be transferred to other parties
        gameMetadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Template-level game-specific metadata
    GetContractTemplateRequest:
      type: object
      description: Request to get a contract template
      additionalProperties: false
      properties:
        templateId:
          type: string
          format: uuid
          nullable: true
          description: Template ID (provide this or code)
        code:
          type: string
          nullable: true
          description: Template code (provide this or templateId)
    ListContractTemplatesRequest:
      type: object
      description: Request to list contract templates with cursor-based pagination.
      additionalProperties: false
      properties:
        realmId:
          type: string
          format: uuid
          nullable: true
          description: Filter by realm (null includes cross-realm templates).
        isActive:
          type: boolean
          nullable: true
          description: Filter by active status.
        searchTerm:
          type: string
          nullable: true
          description: Search in name and description.
        cursor:
          type: string
          nullable: true
          description: Opaque cursor from previous response. Null for first page.
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          nullable: true
          description: Number of items per page. Uses service default if not specified.
    UpdateContractTemplateRequest:
      type: object
      description: Request to update a contract template
      additionalProperties: false
      required:
      - templateId
      properties:
        templateId:
          type: string
          format: uuid
          description: Template ID to update
        name:
          type: string
          maxLength: 200
          nullable: true
          description: New template name
        description:
          type: string
          maxLength: 2000
          nullable: true
          description: New description
        isActive:
          type: boolean
          nullable: true
          description: Active status
        gameMetadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Updated game metadata
    DeleteContractTemplateRequest:
      type: object
      description: Request to delete a contract template
      additionalProperties: false
      required:
      - templateId
      properties:
        templateId:
          type: string
          format: uuid
          description: Template ID to delete
    ContractTemplateResponse:
      type: object
      description: Contract template details
      additionalProperties: false
      required:
      - templateId
      - code
      - name
      - minParties
      - maxParties
      - partyRoles
      - defaultEnforcementMode
      - isActive
      - createdAt
      properties:
        templateId:
          type: string
          format: uuid
          description: Unique template identifier
        code:
          type: string
          description: Unique template code
        name:
          type: string
          description: Human-readable name
        description:
          type: string
          nullable: true
          description: Detailed description
        realmId:
          type: string
          format: uuid
          nullable: true
          description: Realm ID if realm-specific
        minParties:
          type: integer
          description: Minimum parties required
        maxParties:
          type: integer
          description: Maximum parties allowed
        partyRoles:
          type: array
          items:
            $ref: '#/components/schemas/PartyRoleDefinition'
          description: Party role definitions
        defaultTerms:
          $ref: '#/components/schemas/ContractTerms'
          nullable: true
          description: Default contract terms
        milestones:
          type: array
          items:
            $ref: '#/components/schemas/MilestoneDefinition'
          nullable: true
          description: Milestone definitions
        defaultEnforcementMode:
          $ref: '#/components/schemas/EnforcementMode'
          description: Default enforcement mode
        transferable:
          type: boolean
          description: Whether contracts can be transferred
        gameMetadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Game-specific metadata
        isActive:
          type: boolean
          description: Whether template is active
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          nullable: true
          description: Last update timestamp
    ListContractTemplatesResponse:
      type: object
      description: Paginated list of contract templates.
      additionalProperties: false
      required:
      - templates
      - hasMore
      properties:
        templates:
          type: array
          items:
            $ref: '#/components/schemas/ContractTemplateResponse'
          description: Templates in this page.
        nextCursor:
          type: string
          nullable: true
          description: Cursor for next page. Null if no more results.
        hasMore:
          type: boolean
          description: Whether more results exist beyond this page.
    CreateContractInstanceRequest:
      type: object
      description: Request to create a contract instance
      additionalProperties: false
      required:
      - templateId
      - parties
      properties:
        templateId:
          type: string
          format: uuid
          description: Template to create instance from
        parties:
          type: array
          items:
            $ref: '#/components/schemas/ContractPartyInput'
          minItems: 2
          description: Parties to this contract
        terms:
          $ref: '#/components/schemas/ContractTerms'
          nullable: true
          description: Terms overriding template defaults
        effectiveFrom:
          type: string
          format: date-time
          nullable: true
          description: When contract becomes active (null for immediate)
        effectiveUntil:
          type: string
          format: date-time
          nullable: true
          description: When contract expires (null for perpetual)
        escrowIds:
          type: array
          items:
            type: string
            format: uuid
          nullable: true
          description: Related escrow IDs
        gameMetadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Instance-level game metadata
    ProposeContractInstanceRequest:
      type: object
      description: Request to propose a contract to parties
      additionalProperties: false
      required:
      - contractId
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance to propose
    ConsentToContractRequest:
      type: object
      description: Request to consent to a contract
      additionalProperties: false
      required:
      - contractId
      - partyEntityId
      - partyEntityType
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract to consent to
        partyEntityId:
          type: string
          format: uuid
          description: Entity ID of consenting party
        partyEntityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Entity type of consenting party
    GetContractInstanceRequest:
      type: object
      description: Request to get a contract instance
      additionalProperties: false
      required:
      - contractId
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
    QueryContractInstancesRequest:
      type: object
      description: Request to query contract instances with cursor-based pagination.
      additionalProperties: false
      properties:
        partyEntityId:
          type: string
          format: uuid
          nullable: true
          description: Filter by party entity ID.
        partyEntityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          nullable: true
          description: Filter by party entity type.
        templateId:
          type: string
          format: uuid
          nullable: true
          description: Filter by template.
        statuses:
          type: array
          items:
            $ref: '#/components/schemas/ContractStatus'
          nullable: true
          description: Filter by statuses.
        cursor:
          type: string
          nullable: true
          description: Opaque cursor from previous response. Null for first page.
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          nullable: true
          description: Number of items per page. Uses service default if not specified.
    TerminateContractInstanceRequest:
      type: object
      description: Request to terminate a contract
      additionalProperties: false
      required:
      - contractId
      - requestingEntityId
      - requestingEntityType
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract to terminate
        requestingEntityId:
          type: string
          format: uuid
          description: Entity requesting termination
        requestingEntityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Type of requesting entity
        reason:
          type: string
          maxLength: 1000
          nullable: true
          description: Reason for termination
    GetContractInstanceStatusRequest:
      type: object
      description: Request to get contract status
      additionalProperties: false
      required:
      - contractId
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
    ContractInstanceResponse:
      type: object
      description: Contract instance details
      additionalProperties: false
      required:
      - contractId
      - templateId
      - status
      - parties
      - createdAt
      properties:
        contractId:
          type: string
          format: uuid
          description: Unique contract identifier
        templateId:
          type: string
          format: uuid
          description: Source template ID
        templateCode:
          type: string
          description: Source template code
        status:
          $ref: '#/components/schemas/ContractStatus'
          description: Current contract status
        parties:
          type: array
          items:
            $ref: '#/components/schemas/ContractPartyResponse'
          description: Contract parties
        terms:
          $ref: '#/components/schemas/ContractTerms'
          nullable: true
          description: Contract terms
        milestones:
          type: array
          items:
            $ref: '#/components/schemas/MilestoneInstanceResponse'
          nullable: true
          description: Milestone progress
        currentMilestoneIndex:
          type: integer
          nullable: true
          description: Index of current milestone
        escrowIds:
          type: array
          items:
            type: string
            format: uuid
          nullable: true
          description: Related escrow IDs
        proposedAt:
          type: string
          format: date-time
          nullable: true
          description: When contract was proposed
        acceptedAt:
          type: string
          format: date-time
          nullable: true
          description: When all parties consented
        effectiveFrom:
          type: string
          format: date-time
          nullable: true
          description: When contract became active
        effectiveUntil:
          type: string
          format: date-time
          nullable: true
          description: When contract expires
        terminatedAt:
          type: string
          format: date-time
          nullable: true
          description: When contract was terminated
        gameMetadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Game-specific metadata
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          nullable: true
          description: Last update timestamp
    QueryContractInstancesResponse:
      type: object
      description: Paginated list of contract instances.
      additionalProperties: false
      required:
      - contracts
      - hasMore
      properties:
        contracts:
          type: array
          items:
            $ref: '#/components/schemas/ContractInstanceResponse'
          description: Contracts in this page.
        nextCursor:
          type: string
          nullable: true
          description: Cursor for next page. Null if no more results.
        hasMore:
          type: boolean
          description: Whether more results exist beyond this page.
    ContractInstanceStatusResponse:
      type: object
      description: Contract status summary
      additionalProperties: false
      required:
      - contractId
      - status
      - milestoneProgress
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        status:
          $ref: '#/components/schemas/ContractStatus'
          description: Current status
        milestoneProgress:
          type: array
          items:
            $ref: '#/components/schemas/MilestoneProgressSummary'
          description: Milestone progress summary
        pendingConsents:
          type: array
          items:
            $ref: '#/components/schemas/PendingConsentSummary'
          nullable: true
          description: Parties who haven't consented
        activeBreaches:
          type: array
          items:
            $ref: '#/components/schemas/BreachSummary'
          nullable: true
          description: Active breach records
        daysUntilExpiration:
          type: integer
          nullable: true
          description: Days until natural expiration
    PartyRoleDefinition:
      type: object
      description: Definition of a party role in a contract template
      additionalProperties: false
      required:
      - role
      - minCount
      - maxCount
      properties:
        role:
          type: string
          maxLength: 64
          description: Role identifier (employer, employee, buyer, seller, etc.)
        minCount:
          type: integer
          minimum: 0
          description: Minimum entities required in this role
        maxCount:
          type: integer
          minimum: 1
          description: Maximum entities allowed in this role
        allowedEntityTypes:
          type: array
          items:
            $ref: 'common-api.yaml#/components/schemas/EntityType'
          nullable: true
          description: Which entity types can fill this role (null for any)
    ContractPartyInput:
      type: object
      description: Party input for contract creation
      additionalProperties: false
      required:
      - entityId
      - entityType
      - role
      properties:
        entityId:
          type: string
          format: uuid
          description: Entity ID
        entityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Entity type
        role:
          type: string
          description: Role from template
    ContractPartyResponse:
      type: object
      description: Contract party details
      additionalProperties: false
      required:
      - entityId
      - entityType
      - role
      - consentStatus
      properties:
        entityId:
          type: string
          format: uuid
          description: Entity ID
        entityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Entity type
        role:
          type: string
          description: Role in contract
        consentStatus:
          $ref: '#/components/schemas/ConsentStatus'
          description: Consent status
        consentedAt:
          type: string
          format: date-time
          nullable: true
          description: When consent was given
    PendingConsentSummary:
      type: object
      description: Summary of pending consent
      additionalProperties: false
      required:
      - entityId
      - entityType
      - role
      properties:
        entityId:
          type: string
          format: uuid
          description: Entity ID
        entityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Entity type
        role:
          type: string
          description: Role in contract
    ContractTerms:
      type: object
      description: Configurable contract terms
      additionalProperties: false
      properties:
        duration:
          type: string
          nullable: true
          description: Contract duration (ISO 8601 duration, null for perpetual)
        paymentSchedule:
          $ref: '#/components/schemas/PaymentSchedule'
          nullable: true
          description: When payments occur
        paymentFrequency:
          type: string
          nullable: true
          description: Recurring payment frequency (ISO 8601 duration)
        terminationPolicy:
          $ref: '#/components/schemas/TerminationPolicy'
          nullable: true
          description: How contract can be terminated
        terminationNoticePeriod:
          type: string
          nullable: true
          description: Required notice for termination (ISO 8601 duration)
        breachThreshold:
          type: integer
          minimum: 0
          nullable: true
          description: Breaches before auto-termination (0 for no auto)
        gracePeriodForCure:
          type: string
          nullable: true
          description: Time to cure breach (ISO 8601 duration)
        customTerms:
          type: object
          additionalProperties: true
          nullable: true
          description: Game-specific custom terms
    MilestoneDefinition:
      type: object
      description: Milestone definition in a template
      additionalProperties: false
      required:
      - code
      - name
      - sequence
      - required
      properties:
        code:
          type: string
          maxLength: 64
          description: Unique milestone code within template
        name:
          type: string
          maxLength: 200
          description: Human-readable name
        description:
          type: string
          maxLength: 1000
          nullable: true
          description: What this milestone represents
        sequence:
          type: integer
          minimum: 0
          description: Order in the contract flow
        required:
          type: boolean
          description: Whether milestone must be completed
        deadline:
          type: string
          nullable: true
          description: Relative deadline (ISO 8601 duration)
        deadlineBehavior:
          $ref: '#/components/schemas/MilestoneDeadlineBehavior'
          nullable: true
          description: Behavior when deadline passes for optional milestones (default skip). Required milestones always 
            trigger breach.
        onComplete:
          type: array
          items:
            $ref: '#/components/schemas/PreboundApi'
          nullable: true
          description: APIs to call on completion
        onExpire:
          type: array
          items:
            $ref: '#/components/schemas/PreboundApi'
          nullable: true
          description: APIs to call if deadline passes
    MilestoneInstanceResponse:
      type: object
      description: Milestone instance status
      additionalProperties: false
      required:
      - code
      - name
      - sequence
      - required
      - status
      properties:
        code:
          type: string
          description: Milestone code
        name:
          type: string
          description: Milestone name
        sequence:
          type: integer
          description: Order in flow
        required:
          type: boolean
          description: Whether required
        status:
          $ref: '#/components/schemas/MilestoneStatus'
          description: Current status
        completedAt:
          type: string
          format: date-time
          nullable: true
          description: When completed
        failedAt:
          type: string
          format: date-time
          nullable: true
          description: When failed
        activatedAt:
          type: string
          format: date-time
          nullable: true
          description: When this milestone became active
        deadline:
          type: string
          format: date-time
          nullable: true
          description: Absolute deadline (computed from activatedAt + duration)
        deadlineBehavior:
          $ref: '#/components/schemas/MilestoneDeadlineBehavior'
          nullable: true
          description: Behavior when deadline passes for optional milestones
    MilestoneProgressSummary:
      type: object
      description: Brief milestone progress
      additionalProperties: false
      required:
      - code
      - status
      properties:
        code:
          type: string
          description: Milestone code
        status:
          $ref: '#/components/schemas/MilestoneStatus'
          description: Current status
    CompleteMilestoneRequest:
      type: object
      description: Request to complete a milestone
      additionalProperties: false
      required:
      - contractId
      - milestoneCode
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        milestoneCode:
          type: string
          description: Milestone to complete
        evidence:
          type: object
          additionalProperties: true
          nullable: true
          description: Evidence of completion
    FailMilestoneRequest:
      type: object
      description: Request to fail a milestone
      additionalProperties: false
      required:
      - contractId
      - milestoneCode
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        milestoneCode:
          type: string
          description: Milestone that failed
        reason:
          type: string
          maxLength: 1000
          nullable: true
          description: Reason for failure
    GetMilestoneRequest:
      type: object
      description: Request to get milestone details
      additionalProperties: false
      required:
      - contractId
      - milestoneCode
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        milestoneCode:
          type: string
          description: Milestone code
    MilestoneResponse:
      type: object
      description: Milestone details
      additionalProperties: false
      required:
      - contractId
      - milestone
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        milestone:
          $ref: '#/components/schemas/MilestoneInstanceResponse'
          description: Milestone details
    ReportBreachRequest:
      type: object
      description: Request to report a breach
      additionalProperties: false
      required:
      - contractId
      - breachingEntityId
      - breachingEntityType
      - breachType
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract that was breached
        breachingEntityId:
          type: string
          format: uuid
          description: Entity that breached
        breachingEntityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Type of breaching entity
        breachType:
          $ref: '#/components/schemas/BreachType'
          description: Type of breach
        breachedTermOrMilestone:
          type: string
          nullable: true
          description: Code of breached term or milestone
        description:
          type: string
          maxLength: 2000
          nullable: true
          description: Breach description
    CureBreachRequest:
      type: object
      description: Request to cure a breach
      additionalProperties: false
      required:
      - breachId
      properties:
        breachId:
          type: string
          format: uuid
          description: Breach to cure
        cureEvidence:
          type: string
          maxLength: 2000
          nullable: true
          description: Evidence of cure
    GetBreachRequest:
      type: object
      description: Request to get breach details
      additionalProperties: false
      required:
      - breachId
      properties:
        breachId:
          type: string
          format: uuid
          description: Breach ID
    BreachResponse:
      type: object
      description: Breach record details
      additionalProperties: false
      required:
      - breachId
      - contractId
      - breachingEntityId
      - breachingEntityType
      - breachType
      - status
      - detectedAt
      properties:
        breachId:
          type: string
          format: uuid
          description: Unique breach identifier
        contractId:
          type: string
          format: uuid
          description: Contract that was breached
        breachingEntityId:
          type: string
          format: uuid
          description: Entity that breached
        breachingEntityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Type of breaching entity
        breachType:
          $ref: '#/components/schemas/BreachType'
          description: Type of breach
        breachedTermOrMilestone:
          type: string
          nullable: true
          description: What was breached
        description:
          type: string
          nullable: true
          description: Breach description
        status:
          $ref: '#/components/schemas/BreachStatus'
          description: Current status
        detectedAt:
          type: string
          format: date-time
          description: When breach was detected
        cureDeadline:
          type: string
          format: date-time
          nullable: true
          description: Deadline to cure breach
        curedAt:
          type: string
          format: date-time
          nullable: true
          description: When breach was cured
        consequencesAppliedAt:
          type: string
          format: date-time
          nullable: true
          description: When consequences were applied
    BreachSummary:
      type: object
      description: Brief breach information
      additionalProperties: false
      required:
      - breachId
      - breachType
      - status
      properties:
        breachId:
          type: string
          format: uuid
          description: Breach ID
        breachType:
          $ref: '#/components/schemas/BreachType'
          description: Type of breach
        status:
          $ref: '#/components/schemas/BreachStatus'
          description: Current status
    UpdateContractMetadataRequest:
      type: object
      description: Request to update contract metadata
      additionalProperties: false
      required:
      - contractId
      - metadataType
      - data
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        metadataType:
          $ref: '#/components/schemas/MetadataType'
          description: Which metadata to update
        data:
          type: object
          additionalProperties: true
          description: Metadata to set or merge
    GetContractMetadataRequest:
      type: object
      description: Request to get contract metadata
      additionalProperties: false
      required:
      - contractId
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
    ContractMetadataResponse:
      type: object
      description: Contract metadata
      additionalProperties: false
      required:
      - contractId
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        instanceData:
          type: object
          additionalProperties: true
          nullable: true
          description: Instance-level metadata
        runtimeState:
          type: object
          additionalProperties: true
          nullable: true
          description: Runtime state metadata
    CheckConstraintRequest:
      type: object
      description: Request to check constraint
      additionalProperties: false
      required:
      - entityId
      - entityType
      - constraintType
      properties:
        entityId:
          type: string
          format: uuid
          description: Entity to check
        entityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Entity type
        constraintType:
          $ref: '#/components/schemas/ConstraintType'
          description: Type of constraint to check
        proposedAction:
          type: object
          additionalProperties: true
          nullable: true
          description: What the entity wants to do
    CheckConstraintResponse:
      type: object
      description: Constraint check result
      additionalProperties: false
      required:
      - allowed
      properties:
        allowed:
          type: boolean
          description: Whether action is allowed
        conflictingContracts:
          type: array
          items:
            $ref: '#/components/schemas/ContractSummary'
          nullable: true
          description: Contracts that would be violated
        reason:
          type: string
          nullable: true
          description: Explanation if not allowed
    QueryActiveContractsRequest:
      type: object
      description: Request to query active contracts
      additionalProperties: false
      required:
      - entityId
      - entityType
      properties:
        entityId:
          type: string
          format: uuid
          description: Entity to query
        entityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Entity type
        templateCodes:
          type: array
          items:
            type: string
          nullable: true
          description: Filter by template codes
    QueryActiveContractsResponse:
      type: object
      description: Active contracts for entity
      additionalProperties: false
      required:
      - contracts
      properties:
        contracts:
          type: array
          items:
            $ref: '#/components/schemas/ContractSummary'
          description: Active contracts
    ContractSummary:
      type: object
      description: Brief contract information
      additionalProperties: false
      required:
      - contractId
      - templateCode
      - status
      - role
      properties:
        contractId:
          type: string
          format: uuid
          description: Contract ID
        templateCode:
          type: string
          description: Template code
        templateName:
          type: string
          nullable: true
          description: Template name
        status:
          $ref: '#/components/schemas/ContractStatus'
          description: Current status
        role:
          type: string
          description: Entity's role in contract
        effectiveUntil:
          type: string
          format: date-time
          nullable: true
          description: When contract expires
    PreboundApi:
      type: object
      description: Pre-configured API call to execute on contract events
      additionalProperties: false
      required:
      - serviceName
      - endpoint
      - payloadTemplate
      properties:
        serviceName:
          type: string
          description: Target service name
        endpoint:
          type: string
          description: Target endpoint path
        payloadTemplate:
          type: string
          description: JSON payload with variable placeholders
        description:
          type: string
          nullable: true
          description: Human-readable description
        executionMode:
          type: string
          enum:
          - sync
          - async
          - fire_and_forget
          default: sync
          description: How to execute the API call
        responseValidation:
          $ref: '#/components/schemas/ResponseValidation'
          nullable: true
          description: Optional validation rules for the response
    ResponseValidation:
      type: object
      description: |
        Validation rules for API responses with three-outcome model.
        Used by lib-contract to validate clause conditions without
        understanding the specific API semantics.
      additionalProperties: false
      properties:
        successConditions:
          type: array
          items:
            $ref: '#/components/schemas/ValidationCondition'
          description: |
            Conditions that must ALL pass for success.
            If any fail, checks permanent failure conditions.
        permanentFailureConditions:
          type: array
          items:
            $ref: '#/components/schemas/ValidationCondition'
          description: |
            Conditions that indicate permanent failure (clause violated).
            Checked when success conditions fail.
        transientFailureStatusCodes:
          type: array
          items:
            type: integer
          description: |
            HTTP status codes that indicate transient failure (retry later).
            Default: [408, 429, 502, 503, 504]
    ValidationCondition:
      type: object
      description: A single condition to check against an API response
      additionalProperties: false
      required:
      - type
      properties:
        type:
          allOf:
          - $ref: '#/components/schemas/ValidationConditionType'
          description: The type of validation condition to check
        jsonPath:
          type: string
          nullable: true
          description: |
            JsonPath expression to extract value from response.
            Required for jsonPathEquals, jsonPathExists, jsonPathNotExists.
            Example: "$.balance", "$.items[0].status"
        expectedValue:
          type: string
          nullable: true
          description: |
            Expected value for comparison conditions.
            Type coercion applied: "true"/"false" for booleans, numeric strings for numbers.
        operator:
          $ref: '#/components/schemas/ComparisonOperator'
          nullable: true
          description: Comparison operator for numeric comparisons
        statusCodes:
          type: array
          items:
            type: integer
          description: HTTP status codes for statusCodeIn condition
    ValidationConditionType:
      type: string
      description: Type of validation condition
      enum:
      - statusCodeIn
      - jsonPathEquals
      - jsonPathNotEquals
      - jsonPathExists
      - jsonPathNotExists
      - jsonPathGreaterThan
      - jsonPathLessThan
      - jsonPathContains
    ComparisonOperator:
      type: string
      description: Comparison operators for numeric conditions
      enum:
      - eq
      - ne
      - gt
      - gte
      - lt
      - lte
    LockContractRequest:
      type: object
      description: Request to lock a contract under guardian custody
      additionalProperties: false
      required:
      - contractInstanceId
      - guardianId
      - guardianType
      properties:
        contractInstanceId:
          type: string
          format: uuid
          description: Contract instance ID to lock
        guardianId:
          type: string
          format: uuid
          description: Guardian entity ID (e.g., escrow agreement ID)
        guardianType:
          type: string
          maxLength: 64
          description: Guardian entity type (e.g., "escrow")
        idempotencyKey:
          type: string
          maxLength: 64
          nullable: true
          description: Optional idempotency key for the operation
    LockContractResponse:
      type: object
      description: Response from locking a contract
      additionalProperties: false
      required:
      - locked
      - contractId
      properties:
        locked:
          type: boolean
          description: Whether the contract was locked
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        guardianId:
          type: string
          format: uuid
          description: Guardian entity ID
        lockedAt:
          type: string
          format: date-time
          description: When the contract was locked
    UnlockContractRequest:
      type: object
      description: Request to unlock a contract from guardian custody
      additionalProperties: false
      required:
      - contractInstanceId
      - guardianId
      - guardianType
      properties:
        contractInstanceId:
          type: string
          format: uuid
          description: Contract instance ID to unlock
        guardianId:
          type: string
          format: uuid
          description: Guardian entity ID (must match current guardian)
        guardianType:
          type: string
          maxLength: 64
          description: Guardian entity type
        idempotencyKey:
          type: string
          maxLength: 64
          nullable: true
          description: Optional idempotency key for the operation
    UnlockContractResponse:
      type: object
      description: Response from unlocking a contract
      additionalProperties: false
      required:
      - unlocked
      - contractId
      properties:
        unlocked:
          type: boolean
          description: Whether the contract was unlocked
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
    TransferContractPartyRequest:
      type: object
      description: Request to transfer a party role to a new entity
      additionalProperties: false
      required:
      - contractInstanceId
      - fromEntityId
      - fromEntityType
      - toEntityId
      - toEntityType
      - guardianId
      - guardianType
      properties:
        contractInstanceId:
          type: string
          format: uuid
          description: Contract instance ID
        fromEntityId:
          type: string
          format: uuid
          description: Current party entity ID
        fromEntityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: Current party entity type
        toEntityId:
          type: string
          format: uuid
          description: New entity ID to receive the role
        toEntityType:
          $ref: 'common-api.yaml#/components/schemas/EntityType'
          description: New entity type
        guardianId:
          type: string
          format: uuid
          description: Guardian entity ID (must be current guardian)
        guardianType:
          type: string
          maxLength: 64
          description: Guardian entity type
        idempotencyKey:
          type: string
          maxLength: 64
          nullable: true
          description: Optional idempotency key for the operation
    TransferContractPartyResponse:
      type: object
      description: Response from transferring a party role
      additionalProperties: false
      required:
      - transferred
      - contractId
      properties:
        transferred:
          type: boolean
          description: Whether the transfer was successful
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        role:
          type: string
          description: Role that was transferred
        fromEntityId:
          type: string
          format: uuid
          description: Previous party entity ID
        toEntityId:
          type: string
          format: uuid
          description: New party entity ID
    ClauseCategory:
      type: string
      description: Category of clause type
      enum:
      - validation
      - execution
      - both
    ClauseHandlerDefinition:
      type: object
      description: Handler definition for clause type operations
      additionalProperties: false
      required:
      - service
      - endpoint
      properties:
        service:
          type: string
          description: Target service name
        endpoint:
          type: string
          description: Target endpoint path
        requestMapping:
          type: object
          additionalProperties: true
          nullable: true
          description: Template variable to request field mapping
        responseMapping:
          type: object
          additionalProperties: true
          nullable: true
          description: Response field to result mapping
    RegisterClauseTypeRequest:
      type: object
      description: Request to register a new clause type
      additionalProperties: false
      required:
      - typeCode
      - description
      - category
      properties:
        typeCode:
          type: string
          maxLength: 64
          pattern: "^[a-z0-9_]+$"
          description: Unique identifier for this clause type
        description:
          type: string
          maxLength: 500
          description: Human-readable description
        category:
          $ref: '#/components/schemas/ClauseCategory'
          description: Whether this is a validation, execution, or both type of clause
        validationHandler:
          $ref: '#/components/schemas/ClauseHandlerDefinition'
          nullable: true
          description: Handler called during check-asset-requirements
        executionHandler:
          $ref: '#/components/schemas/ClauseHandlerDefinition'
          nullable: true
          description: Handler called during execute
    RegisterClauseTypeResponse:
      type: object
      description: Response from registering a clause type
      additionalProperties: false
      required:
      - registered
      - typeCode
      properties:
        registered:
          type: boolean
          description: Whether the type was registered
        typeCode:
          type: string
          description: The registered type code
    ListClauseTypesRequest:
      type: object
      description: Request to list clause types
      additionalProperties: false
      properties:
        category:
          $ref: '#/components/schemas/ClauseCategory'
          nullable: true
          description: Filter by category
        includeBuiltIn:
          type: boolean
          default: true
          description: Include built-in types in response
    ClauseTypeSummary:
      type: object
      description: Summary of a clause type
      additionalProperties: false
      required:
      - typeCode
      - description
      - category
      - hasValidationHandler
      - hasExecutionHandler
      - isBuiltIn
      properties:
        typeCode:
          type: string
          description: Unique identifier
        description:
          type: string
          description: Human-readable description
        category:
          $ref: '#/components/schemas/ClauseCategory'
          description: Clause category
        hasValidationHandler:
          type: boolean
          description: Whether a validation handler is registered
        hasExecutionHandler:
          type: boolean
          description: Whether an execution handler is registered
        isBuiltIn:
          type: boolean
          description: Whether this is a built-in type
    ListClauseTypesResponse:
      type: object
      description: Response containing list of clause types
      additionalProperties: false
      required:
      - clauseTypes
      properties:
        clauseTypes:
          type: array
          items:
            $ref: '#/components/schemas/ClauseTypeSummary'
          description: List of registered clause types
    SetTemplateValuesRequest:
      type: object
      description: Request to set template values on a contract
      additionalProperties: false
      required:
      - contractInstanceId
      - templateValues
      properties:
        contractInstanceId:
          type: string
          format: uuid
          description: Contract instance ID
        templateValues:
          type: object
          additionalProperties:
            type: string
          description: |
            Key-value pairs for template substitution.
            Keys should follow pattern: EscrowId, PartyA_EscrowWalletId, etc.
    SetTemplateValuesResponse:
      type: object
      description: Response from setting template values
      additionalProperties: false
      required:
      - updated
      - contractId
      properties:
        updated:
          type: boolean
          description: Whether values were updated
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        valueCount:
          type: integer
          description: Number of template values set
    CheckAssetRequirementsRequest:
      type: object
      description: Request to check asset requirement clauses
      additionalProperties: false
      required:
      - contractInstanceId
      properties:
        contractInstanceId:
          type: string
          format: uuid
          description: Contract instance ID
    AssetRequirementInfo:
      type: object
      description: Information about a required asset
      additionalProperties: false
      required:
      - type
      - code
      - amount
      properties:
        type:
          type: string
          description: Asset type (currency, item, item_stack)
        code:
          type: string
          description: Currency code or item template code
        amount:
          type: number
          description: Amount or quantity required
    ClauseAssetStatus:
      type: object
      description: Status of a single clause's asset requirements
      additionalProperties: false
      required:
      - clauseId
      - satisfied
      - required
      - current
      - missing
      properties:
        clauseId:
          type: string
          description: Clause identifier
        satisfied:
          type: boolean
          description: Whether requirement is satisfied
        required:
          $ref: '#/components/schemas/AssetRequirementInfo'
          description: What the clause requires
        current:
          type: number
          description: Current amount present
        missing:
          type: number
          description: Amount still needed (0 if satisfied)
    PartyAssetRequirementStatus:
      type: object
      description: Asset requirement status for a single party
      additionalProperties: false
      required:
      - partyRole
      - satisfied
      - clauses
      properties:
        partyRole:
          type: string
          description: Party role (e.g., party_a, party_b)
        satisfied:
          type: boolean
          description: Whether all party's requirements are satisfied
        clauses:
          type: array
          items:
            $ref: '#/components/schemas/ClauseAssetStatus'
          description: Status of each clause for this party
    CheckAssetRequirementsResponse:
      type: object
      description: Response from checking asset requirements
      additionalProperties: false
      required:
      - allSatisfied
      - byParty
      properties:
        allSatisfied:
          type: boolean
          description: Whether all requirements across all parties are satisfied
        byParty:
          type: array
          items:
            $ref: '#/components/schemas/PartyAssetRequirementStatus'
          description: Status broken down by party
    ExecuteContractRequest:
      type: object
      description: Request to execute contract clauses
      additionalProperties: false
      required:
      - contractInstanceId
      properties:
        contractInstanceId:
          type: string
          format: uuid
          description: Contract instance ID
        idempotencyKey:
          type: string
          maxLength: 64
          nullable: true
          description: Idempotency key for the execution
    ClauseDistributionResult:
      type: object
      description: |
        Outcome of a single clause distribution during contract execution.
        Used in ContractExecutedEvent to provide per-clause success/failure details.
        Deliberately excludes wallet/container IDs - consumers tracking these should
        correlate via clauseId to their own records.
      additionalProperties: false
      required:
      - clauseId
      - clauseType
      - assetType
      - amount
      - succeeded
      properties:
        clauseId:
          type: string
          format: uuid
          description: The clause that was executed
        clauseType:
          type: string
          description: Type of clause (e.g., currency_transfer, item_transfer, fee)
        assetType:
          type: string
          description: |
            Descriptive type of asset involved (e.g., "currency", "item").
            Provides human-readable context for what was transferred.
        amount:
          type: number
          description: Quantity transferred (currency amount, item count, etc.)
        succeeded:
          type: boolean
          description: Whether this clause executed successfully
        failureReason:
          type: string
          nullable: true
          description: If succeeded is false, describes what went wrong
    ExecuteContractResponse:
      type: object
      description: Response from executing a contract
      additionalProperties: false
      required:
      - executed
      - alreadyExecuted
      properties:
        executed:
          type: boolean
          description: Whether execution was successful
        alreadyExecuted:
          type: boolean
          description: True if this was a repeat call (idempotency)
        contractId:
          type: string
          format: uuid
          description: Contract instance ID
        distributions:
          type: array
          items:
            $ref: '#/components/schemas/ClauseDistributionResult'
          nullable: true
          description: Per-clause distribution outcomes with success/failure details
        executedAt:
          type: string
          format: date-time
          nullable: true
          description: When execution occurred
x-service-registration:
  serviceId: "contract"
  serviceName: "Contract Service"
  version: "1.0.0"
  categories:
  - agreements
  - obligations
