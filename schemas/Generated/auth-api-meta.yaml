openapi: 3.0.4
info:
  title: Bannou Auth Service API
  description: |
    Authentication and session management service (Internet-facing).

    **POST-Only API Pattern**: This API uses POST for all WebSocket-routable operations.
    Path parameters are passed in request bodies instead of URLs.

    **Exceptions**: OAuth endpoints (`/auth/oauth/*`) retain path parameters because they
    are browser-facing redirect flows, not WebSocket-routed. The browser navigates to
    these URLs directly for OAuth provider authentication.

    See docs/BANNOU_DESIGN.md for architectural rationale.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 4.0.0
x-service-layer: AppFoundation
servers:
- url: http://localhost:5012
  description: Bannou service endpoint
paths:
  /auth/login:
    post:
      summary: Login with email/password
      operationId: login
      tags:
      - Authentication
      x-permissions:
      - role: anonymous
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful or MFA challenge issued
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          description: Invalid credentials
        '429':
          description: Too many login attempts
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LoginRequest\"\
        ,\n    \"$defs\": {\n        \"LoginRequest\": {\n            \"description\": \"Request to authenticate a user with
        email and password credentials\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"email\",\n                \"password\"\n            ],\n         \
        \   \"properties\": {\n                \"email\": {\n                    \"type\": \"string\",\n                 \
        \   \"format\": \"email\",\n                    \"maxLength\": 254,\n                    \"description\": \"Email
        address for authentication\"\n                },\n                \"password\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"password\",\n                    \"minLength\": 1,\n                \
        \    \"maxLength\": 128,\n                    \"description\": \"User password for authentication\"\n            \
        \    },\n                \"rememberMe\": {\n                    \"type\": \"boolean\",\n                    \"default\"\
        : false,\n                    \"description\": \"Whether to extend the session duration for persistent login\"\n \
        \               },\n                \"deviceInfo\": {\n                    \"$ref\": \"#/$defs/DeviceInfo\",\n   \
        \                 \"nullable\": true,\n                    \"description\": \"Information about the client device
        (optional)\"\n                }\n            }\n        },\n        \"DeviceInfo\": {\n            \"description\"\
        : \"Information about the client device used for authentication or session tracking\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"deviceType\": {\n\
        \                    \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/DeviceType\"\
        \n                        }\n                    ],\n                    \"nullable\": true,\n                   \
        \ \"description\": \"Category of the device\"\n                },\n                \"platform\": {\n             \
        \       \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Operating
        system or platform name\"\n                },\n                \"browser\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Browser name and version if applicable\"\
        \n                },\n                \"appVersion\": {\n                    \"type\": \"string\",\n             \
        \       \"nullable\": true,\n                    \"description\": \"Version of the client application\"\n        \
        \        }\n            }\n        },\n        \"DeviceType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"desktop\",\n                \"mobile\",\n                \"tablet\",\n              \
        \  \"console\"\n            ],\n            \"description\": \"Category of client device used for authentication or
        session tracking\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LoginResponse\"\
        ,\n    \"$defs\": {\n        \"LoginResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response from email/password login. May contain full tokens (no MFA) or a challenge token (MFA required).\",\n\
        \            \"additionalProperties\": false,\n            \"required\": [\n                \"accountId\",\n     \
        \           \"requiresMfa\"\n            ],\n            \"properties\": {\n                \"accountId\": {\n   \
        \                 \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Account ID (always present regardless of MFA status)\"\n                },\n                \"requiresMfa\": {\n\
        \                    \"type\": \"boolean\",\n                    \"description\": \"If true, client must complete
        MFA via /auth/mfa/verify before receiving tokens\"\n                },\n                \"mfaChallengeToken\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Short-lived challenge token for /auth/mfa/verify (only present when requiresMfa is true)\"\n                },\n\
        \                \"accessToken\": {\n                    \"type\": \"string\",\n                    \"nullable\":
        true,\n                    \"description\": \"JWT access token (only present when requiresMfa is false)\"\n      \
        \          },\n                \"refreshToken\": {\n                    \"type\": \"string\",\n                  \
        \  \"nullable\": true,\n                    \"description\": \"Refresh token (only present when requiresMfa is false)\"\
        \n                },\n                \"expiresIn\": {\n                    \"type\": \"integer\",\n             \
        \       \"nullable\": true,\n                    \"description\": \"Seconds until access token expires (only present
        when requiresMfa is false)\"\n                },\n                \"connectUrl\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uri\",\n                    \"nullable\": true,\n               \
        \     \"description\": \"WebSocket connect URL (only present when requiresMfa is false)\"\n                },\n  \
        \              \"roles\": {\n                    \"type\": \"array\",\n                    \"items\": {\n        \
        \                \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n         \
        \           \"description\": \"Account roles (only present when requiresMfa is false)\"\n                }\n     \
        \       }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Login with email/password\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Authentication\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"login\"\n}"
  /auth/register:
    post:
      summary: Register new user account
      operationId: register
      tags:
      - Authentication
      x-permissions:
      - role: anonymous
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '200':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterResponse'
        '400':
          description: Invalid request data
        '409':
          description: Username already exists
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RegisterRequest\"\
        ,\n    \"$defs\": {\n        \"RegisterRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to register a new user account\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"username\",\n                \"password\",\n                \"email\"\n            ],\n   \
        \         \"properties\": {\n                \"username\": {\n                    \"type\": \"string\",\n        \
        \            \"description\": \"Unique username for the account\",\n                    \"minLength\": 3,\n      \
        \              \"maxLength\": 32,\n                    \"pattern\": \"^[a-zA-Z0-9_]+$\",\n                    \"example\"\
        : \"gameuser123\"\n                },\n                \"password\": {\n                    \"type\": \"string\",\n\
        \                    \"description\": \"Password for the account (will be hashed)\",\n                    \"minLength\"\
        : 8,\n                    \"maxLength\": 128,\n                    \"format\": \"password\",\n                   \
        \ \"example\": \"SecurePassword123!\"\n                },\n                \"email\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"email\",\n                    \"description\": \"Email address for
        account recovery and notifications\",\n                    \"example\": \"user@example.com\"\n                }\n\
        \            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RegisterResponse\"\
        ,\n    \"$defs\": {\n        \"RegisterResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response from successful user registration\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountId\",\n                \"accessToken\",\n                \"connectUrl\"\n          \
        \  ],\n            \"properties\": {\n                \"accountId\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the newly
        created account\"\n                },\n                \"accessToken\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"JWT access token for immediate authentication\",\n                    \"\
        example\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnYW1ldXNlcjEyMyIsImlhdCI6MTY0MDk5NTIwMCwiZXhwIjoxNjQwOTk4ODAwfQ.signature\"\
        \n                },\n                \"refreshToken\": {\n                    \"type\": \"string\",\n           \
        \         \"description\": \"Refresh token for obtaining new access tokens\",\n                    \"nullable\": true,\n\
        \                    \"example\": \"refresh_token_abc123xyz789\"\n                },\n                \"connectUrl\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uri\",\n                    \"description\"\
        : \"WebSocket endpoint for Connect service\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Register new user account\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Authentication\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"register\"\n}"
  /auth/oauth/{provider}/init:
    get:
      summary: Initialize OAuth2 flow (browser redirect)
      description: |
        Browser-facing endpoint for initiating OAuth flows. The user's browser navigates
        to this URL directly, which then redirects to the OAuth provider.

        **Note**: This endpoint uses GET with path parameters because it's a browser
        redirect flow, not a WebSocket-routed API call.
      operationId: initOAuth
      tags:
      - OAuth
      x-permissions:
      - role: anonymous
      parameters:
      - name: provider
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/Provider'
      - name: redirectUri
        in: query
        required: true
        schema:
          type: string
          format: uri
      - name: state
        in: query
        schema:
          type: string
      responses:
        '302':
          description: Redirect to OAuth provider
      x-controller-only: true
      x-request-schema-json: '{}'
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Initialize OAuth2 flow (browser redirect)\",\n    \"description\": \"Browser-facing
        endpoint for initiating OAuth flows. The user's browser navigates\\nto this URL directly, which then redirects to
        the OAuth provider.\\n\\n**Note**: This endpoint uses GET with path parameters because it's a browser\\nredirect flow,
        not a WebSocket-routed API call.\\n\",\n    \"tags\": [\n        \"OAuth\"\n    ],\n    \"deprecated\": false,\n \
        \   \"operationId\": \"initOAuth\"\n}"
  /auth/oauth/{provider}/callback:
    post:
      summary: Complete OAuth2 flow (browser redirect callback)
      description: |
        Browser-facing callback endpoint for OAuth providers. The OAuth provider redirects
        the user's browser back to this URL after authentication.

        **Note**: This endpoint uses path parameters because the callback URL is registered
        with OAuth providers and cannot be changed without updating provider configurations.
      operationId: completeOAuth
      tags:
      - OAuth
      x-permissions:
      - role: anonymous
      parameters:
      - name: provider
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/Provider'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthCallbackRequest'
      responses:
        '200':
          description: OAuth authentication successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/OAuthCallbackRequest\"\
        ,\n    \"$defs\": {\n        \"OAuthCallbackRequest\": {\n            \"description\": \"Request containing OAuth
        provider callback data to complete authentication\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"code\"\n            ],\n            \"properties\": {\n \
        \               \"code\": {\n                    \"type\": \"string\",\n                    \"description\": \"Authorization
        code returned by the OAuth provider\"\n                },\n                \"state\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"State parameter for
        CSRF protection, must match the value sent in the init request\"\n                },\n                \"deviceInfo\"\
        : {\n                    \"$ref\": \"#/$defs/DeviceInfo\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"Information about the client device (optional)\"\n                }\n            }\n \
        \       },\n        \"DeviceInfo\": {\n            \"description\": \"Information about the client device used for
        authentication or session tracking\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"properties\": {\n                \"deviceType\": {\n                    \"allOf\": [\n            \
        \            {\n                            \"$ref\": \"#/$defs/DeviceType\"\n                        }\n        \
        \            ],\n                    \"nullable\": true,\n                    \"description\": \"Category of the device\"\
        \n                },\n                \"platform\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"Operating system or platform name\"\n          \
        \      },\n                \"browser\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Browser name and version if applicable\"\n                },\n   \
        \             \"appVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Version of the client application\"\n                }\n            }\n  \
        \      },\n        \"DeviceType\": {\n            \"type\": \"string\",\n            \"enum\": [\n               \
        \ \"desktop\",\n                \"mobile\",\n                \"tablet\",\n                \"console\"\n          \
        \  ],\n            \"description\": \"Category of client device used for authentication or session tracking\"\n  \
        \      }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AuthResponse\"\
        ,\n    \"$defs\": {\n        \"AuthResponse\": {\n            \"description\": \"Successful authentication response
        containing tokens and session information\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"accountId\",\n                \"accessToken\",\n        \
        \        \"refreshToken\",\n                \"expiresIn\",\n                \"connectUrl\"\n            ],\n     \
        \       \"properties\": {\n                \"accountId\": {\n                    \"type\": \"string\",\n         \
        \           \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the authenticated
        account\"\n                },\n                \"accessToken\": {\n                    \"type\": \"string\",\n   \
        \                 \"description\": \"JWT access token for API authentication\"\n                },\n             \
        \   \"refreshToken\": {\n                    \"type\": \"string\",\n                    \"description\": \"Token used
        to obtain new access tokens when the current one expires\"\n                },\n                \"expiresIn\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Seconds until access token expires\"\
        \n                },\n                \"connectUrl\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uri\",\n                    \"description\": \"WebSocket endpoint for Connect service\"\n  \
        \              },\n                \"roles\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\"\
        : true,\n                    \"description\": \"List of roles assigned to the authenticated user\"\n             \
        \   }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Complete OAuth2 flow (browser redirect callback)\",\n    \"description\"\
        : \"Browser-facing callback endpoint for OAuth providers. The OAuth provider redirects\\nthe user's browser back to
        this URL after authentication.\\n\\n**Note**: This endpoint uses path parameters because the callback URL is registered\\
        nwith OAuth providers and cannot be changed without updating provider configurations.\\n\",\n    \"tags\": [\n   \
        \     \"OAuth\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"completeOAuth\"\n}"
  /auth/steam/verify:
    post:
      summary: Verify Steam Session Ticket
      description: |
        Validates a Steam Session Ticket obtained from the game client via ISteamUser::GetAuthTicketForWebApi().
        The server validates the ticket with Steam's Web API and retrieves the SteamID from Steam's response.
        NEVER trust client-provided SteamID - it must come from Steam's authenticated response.
      operationId: verifySteamAuth
      tags:
      - Steam
      x-permissions:
      - role: anonymous
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SteamVerifyRequest'
      responses:
        '200':
          description: Steam authentication successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Invalid or expired Steam ticket
        '500':
          description: Steam API unavailable or internal error
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SteamVerifyRequest\"\
        ,\n    \"$defs\": {\n        \"SteamVerifyRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to verify a Steam Session Ticket. The ticket is obtained client-side via\\nISteamUser::GetAuthTicketForWebApi(\\\
        \"bannou\\\"). SteamID is NOT included because\\nit must be obtained from Steam's Web API response (never trust client-provided
        SteamID).\\n\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"ticket\"\
        \n            ],\n            \"properties\": {\n                \"ticket\": {\n                    \"type\": \"string\"\
        ,\n                    \"pattern\": \"^[0-9A-Fa-f]+$\",\n                    \"minLength\": 16,\n                \
        \    \"maxLength\": 2048,\n                    \"description\": \"Hex-encoded Steam Session Ticket from ISteamUser::GetAuthTicketForWebApi().\\
        nClient converts ticket bytes to hex string: BitConverter.ToString(ticketData).Replace(\\\"-\\\", \\\"\\\")\\n\",\n\
        \                    \"example\": \"140000006A7B3C8E...\"\n                },\n                \"deviceInfo\": {\n\
        \                    \"$ref\": \"#/$defs/DeviceInfo\",\n                    \"nullable\": true,\n                \
        \    \"description\": \"Information about the client device (optional)\"\n                }\n            }\n     \
        \   },\n        \"DeviceInfo\": {\n            \"description\": \"Information about the client device used for authentication
        or session tracking\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n        \
        \    \"properties\": {\n                \"deviceType\": {\n                    \"allOf\": [\n                    \
        \    {\n                            \"$ref\": \"#/$defs/DeviceType\"\n                        }\n                \
        \    ],\n                    \"nullable\": true,\n                    \"description\": \"Category of the device\"\n\
        \                },\n                \"platform\": {\n                    \"type\": \"string\",\n                \
        \    \"nullable\": true,\n                    \"description\": \"Operating system or platform name\"\n           \
        \     },\n                \"browser\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Browser name and version if applicable\"\n                },\n   \
        \             \"appVersion\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Version of the client application\"\n                }\n            }\n  \
        \      },\n        \"DeviceType\": {\n            \"type\": \"string\",\n            \"enum\": [\n               \
        \ \"desktop\",\n                \"mobile\",\n                \"tablet\",\n                \"console\"\n          \
        \  ],\n            \"description\": \"Category of client device used for authentication or session tracking\"\n  \
        \      }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AuthResponse\"\
        ,\n    \"$defs\": {\n        \"AuthResponse\": {\n            \"description\": \"Successful authentication response
        containing tokens and session information\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"accountId\",\n                \"accessToken\",\n        \
        \        \"refreshToken\",\n                \"expiresIn\",\n                \"connectUrl\"\n            ],\n     \
        \       \"properties\": {\n                \"accountId\": {\n                    \"type\": \"string\",\n         \
        \           \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the authenticated
        account\"\n                },\n                \"accessToken\": {\n                    \"type\": \"string\",\n   \
        \                 \"description\": \"JWT access token for API authentication\"\n                },\n             \
        \   \"refreshToken\": {\n                    \"type\": \"string\",\n                    \"description\": \"Token used
        to obtain new access tokens when the current one expires\"\n                },\n                \"expiresIn\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Seconds until access token expires\"\
        \n                },\n                \"connectUrl\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uri\",\n                    \"description\": \"WebSocket endpoint for Connect service\"\n  \
        \              },\n                \"roles\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\"\
        : true,\n                    \"description\": \"List of roles assigned to the authenticated user\"\n             \
        \   }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Verify Steam Session Ticket\",\n    \"description\": \"Validates a Steam
        Session Ticket obtained from the game client via ISteamUser::GetAuthTicketForWebApi().\\nThe server validates the
        ticket with Steam's Web API and retrieves the SteamID from Steam's response.\\nNEVER trust client-provided SteamID
        - it must come from Steam's authenticated response.\\n\",\n    \"tags\": [\n        \"Steam\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"verifySteamAuth\"\n}"
  /auth/refresh:
    post:
      summary: Refresh access token
      operationId: refreshToken
      tags:
      - Tokens
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: Current JWT access token for refresh
        x-from-authorization: bearer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshRequest'
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RefreshRequest\"\
        ,\n    \"$defs\": {\n        \"RefreshRequest\": {\n            \"description\": \"Request to obtain a new access
        token using a valid refresh token\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"refreshToken\"\n            ],\n            \"properties\": {\n  \
        \              \"refreshToken\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Refresh token issued during authentication to obtain a new access token\"\n                }\n            }\n\
        \        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AuthResponse\"\
        ,\n    \"$defs\": {\n        \"AuthResponse\": {\n            \"description\": \"Successful authentication response
        containing tokens and session information\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"accountId\",\n                \"accessToken\",\n        \
        \        \"refreshToken\",\n                \"expiresIn\",\n                \"connectUrl\"\n            ],\n     \
        \       \"properties\": {\n                \"accountId\": {\n                    \"type\": \"string\",\n         \
        \           \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the authenticated
        account\"\n                },\n                \"accessToken\": {\n                    \"type\": \"string\",\n   \
        \                 \"description\": \"JWT access token for API authentication\"\n                },\n             \
        \   \"refreshToken\": {\n                    \"type\": \"string\",\n                    \"description\": \"Token used
        to obtain new access tokens when the current one expires\"\n                },\n                \"expiresIn\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Seconds until access token expires\"\
        \n                },\n                \"connectUrl\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uri\",\n                    \"description\": \"WebSocket endpoint for Connect service\"\n  \
        \              },\n                \"roles\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\"\
        : true,\n                    \"description\": \"List of roles assigned to the authenticated user\"\n             \
        \   }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Refresh access token\",\n    \"description\": \"\",\n    \"tags\": [\n\
        \        \"Tokens\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"refreshToken\"\n}"
  /auth/validate:
    post:
      summary: Validate access token
      operationId: validateToken
      tags:
      - Tokens
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: JWT access token for validation
        x-from-authorization: bearer
      responses:
        '200':
          description: Token is valid
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidateTokenResponse'
        '401':
          description: Invalid or missing token
        '403':
          description: Token expired or malformed
      x-request-schema-json: '{}'
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ValidateTokenResponse\"\
        ,\n    \"$defs\": {\n        \"ValidateTokenResponse\": {\n            \"description\": \"Response from token validation
        containing associated account details. HTTP 200 confirms the token is valid; 401 indicates invalid or expired.\",\n\
        \            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n  \
        \              \"accountId\",\n                \"sessionKey\",\n                \"remainingTime\"\n            ],\n\
        \            \"properties\": {\n                \"accountId\": {\n                    \"type\": \"string\",\n    \
        \                \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the account associated
        with the token\"\n                },\n                \"sessionKey\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Internal session key used by
        Connect service for WebSocket connection tracking and service routing\"\n                },\n                \"roles\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"List of roles assigned to the authenticated user\"\n                },\n                \"authorizations\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"\
        string\"\n                    },\n                    \"nullable\": true,\n                    \"description\": \"\
        Authorization strings from active subscriptions.\\nFormat: \\\"{stubName}:{state}\\\" (e.g., \\\"my-game:authorized\\\
        \")\\n\"\n                },\n                \"remainingTime\": {\n                    \"type\": \"integer\",\n \
        \                   \"description\": \"Seconds until expiration\"\n                }\n            }\n        }\n \
        \   }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Validate access token\",\n    \"description\": \"\",\n    \"tags\": [\n\
        \        \"Tokens\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"validateToken\"\n}"
  /auth/logout:
    post:
      summary: Logout and invalidate tokens
      operationId: logout
      tags:
      - Authentication
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: JWT access token for session identification
        x-from-authorization: bearer
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LogoutRequest'
      responses:
        '200':
          description: Logged out successfully
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/LogoutRequest\"\
        ,\n    \"$defs\": {\n        \"LogoutRequest\": {\n            \"description\": \"Request to logout and invalidate
        authentication tokens\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n      \
        \      \"properties\": {\n                \"allSessions\": {\n                    \"type\": \"boolean\",\n       \
        \             \"default\": false,\n                    \"description\": \"Logout from all sessions/devices\"\n   \
        \             }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Logout and invalidate tokens\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Authentication\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"logout\"\n}"
  /auth/sessions/list:
    post:
      summary: Get active sessions for account
      operationId: getSessions
      tags:
      - Sessions
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: JWT access token for session identification
        x-from-authorization: bearer
      responses:
        '200':
          description: Active sessions retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionsResponse'
      x-request-schema-json: '{}'
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/SessionsResponse\"\
        ,\n    \"$defs\": {\n        \"SessionsResponse\": {\n            \"description\": \"Response containing a list of
        all active sessions for an account\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"sessions\"\n            ],\n            \"properties\": {\n      \
        \          \"sessions\": {\n                    \"type\": \"array\",\n                    \"items\": {\n         \
        \               \"$ref\": \"#/$defs/SessionInfo\"\n                    },\n                    \"description\": \"\
        List of active sessions for the account\"\n                }\n            }\n        },\n        \"SessionInfo\":
        {\n            \"description\": \"Information about an active user session including device and activity details\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"sessionId\",\n                \"createdAt\",\n                \"lastActive\"\n            ],\n\
        \            \"properties\": {\n                \"sessionId\": {\n                    \"type\": \"string\",\n    \
        \                \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the session\"\
        \n                },\n                \"deviceInfo\": {\n                    \"$ref\": \"#/$defs/DeviceInfo\",\n \
        \                   \"nullable\": true,\n                    \"description\": \"Information about the device used
        for this session\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the session
        was created\"\n                },\n                \"lastActive\": {\n                    \"type\": \"string\",\n\
        \                    \"format\": \"date-time\",\n                    \"description\": \"Timestamp of the last activity
        in this session\"\n                },\n                \"ipAddress\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"IP address from which the session
        was initiated\"\n                },\n                \"location\": {\n                    \"type\": \"string\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Geographic location derived from
        the IP address\"\n                }\n            }\n        },\n        \"DeviceInfo\": {\n            \"description\"\
        : \"Information about the client device used for authentication or session tracking\",\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"deviceType\": {\n\
        \                    \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/DeviceType\"\
        \n                        }\n                    ],\n                    \"nullable\": true,\n                   \
        \ \"description\": \"Category of the device\"\n                },\n                \"platform\": {\n             \
        \       \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Operating
        system or platform name\"\n                },\n                \"browser\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Browser name and version if applicable\"\
        \n                },\n                \"appVersion\": {\n                    \"type\": \"string\",\n             \
        \       \"nullable\": true,\n                    \"description\": \"Version of the client application\"\n        \
        \        }\n            }\n        },\n        \"DeviceType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"desktop\",\n                \"mobile\",\n                \"tablet\",\n              \
        \  \"console\"\n            ],\n            \"description\": \"Category of client device used for authentication or
        session tracking\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get active sessions for account\",\n    \"description\": \"\",\n    \"\
        tags\": [\n        \"Sessions\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getSessions\"\n}"
  /auth/sessions/terminate:
    post:
      summary: Terminate specific session
      operationId: terminateSession
      tags:
      - Sessions
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: JWT access token for session identification
        x-from-authorization: bearer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TerminateSessionRequest'
      responses:
        '200':
          description: Session terminated
        '404':
          description: Session not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/TerminateSessionRequest\"\
        ,\n    \"$defs\": {\n        \"TerminateSessionRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to terminate a specific session\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"sessionId\"\n            ],\n            \"properties\": {\n                \"sessionId\":
        {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"ID of the session to terminate\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Terminate specific session\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Sessions\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"terminateSession\"\n}"
  /auth/revocation-list:
    post:
      summary: Get current token revocation list
      description: |
        Returns the current list of revoked tokens and accounts for edge provider synchronization
        and administrative monitoring. Includes token-level revocations (by JTI) and account-level
        revocations (all tokens issued before a timestamp).
      operationId: getRevocationList
      tags:
      - Token Management
      x-permissions:
      - role: admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetRevocationListRequest'
      responses:
        '200':
          description: Revocation list retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RevocationListResponse'
        '403':
          description: Insufficient permissions
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetRevocationListRequest\"\
        ,\n    \"$defs\": {\n        \"GetRevocationListRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to get current revocation list for edge provider synchronization or admin monitoring\",\n            \"\
        additionalProperties\": false,\n            \"properties\": {\n                \"includeTokens\": {\n            \
        \        \"type\": \"boolean\",\n                    \"default\": true,\n                    \"description\": \"Include
        token-level revocations (by JTI)\"\n                },\n                \"includeAccounts\": {\n                 \
        \   \"type\": \"boolean\",\n                    \"default\": true,\n                    \"description\": \"Include
        account-level revocations (all tokens before timestamp)\"\n                },\n                \"limit\": {\n    \
        \                \"type\": \"integer\",\n                    \"minimum\": 1,\n                    \"maximum\": 1000,\n\
        \                    \"default\": 100,\n                    \"description\": \"Maximum entries to return per category\"\
        \n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RevocationListResponse\"\
        ,\n    \"$defs\": {\n        \"RevocationListResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Current revocation list with token and account level entries\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"revokedTokens\",\n                \"revokedAccounts\"\n          \
        \  ],\n            \"properties\": {\n                \"revokedTokens\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/RevokedTokenEntry\"\n           \
        \         },\n                    \"description\": \"Token-level revocations (individual JTIs)\"\n               \
        \ },\n                \"revokedAccounts\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"$ref\": \"#/$defs/RevokedAccountEntry\"\n                    },\n                 \
        \   \"description\": \"Account-level revocations (all tokens before timestamp)\"\n                }\n            }\n\
        \        },\n        \"RevokedTokenEntry\": {\n            \"type\": \"object\",\n            \"description\": \"\
        A single revoked token entry with expiration tracking\",\n            \"additionalProperties\": false,\n         \
        \   \"required\": [\n                \"jti\",\n                \"accountId\",\n                \"revokedAt\",\n  \
        \              \"expiresAt\",\n                \"reason\"\n            ],\n            \"properties\": {\n       \
        \         \"jti\": {\n                    \"type\": \"string\",\n                    \"description\": \"JWT unique
        identifier (jti claim)\"\n                },\n                \"accountId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Account that owned the token\"\
        \n                },\n                \"revokedAt\": {\n                    \"type\": \"string\",\n              \
        \      \"format\": \"date-time\",\n                    \"description\": \"When the token was revoked\"\n         \
        \       },\n                \"expiresAt\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"description\": \"When the revocation entry expires (matches original JWT expiry)\"\
        \n                },\n                \"reason\": {\n                    \"type\": \"string\",\n                 \
        \   \"description\": \"Revocation reason for audit trail\"\n                }\n            }\n        },\n       \
        \ \"RevokedAccountEntry\": {\n            \"type\": \"object\",\n            \"description\": \"Account-level revocation
        entry that invalidates all tokens issued before a timestamp\",\n            \"additionalProperties\": false,\n   \
        \         \"required\": [\n                \"accountId\",\n                \"issuedBefore\",\n                \"revokedAt\"\
        ,\n                \"reason\"\n            ],\n            \"properties\": {\n                \"accountId\": {\n \
        \                   \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Account ID whose tokens are revoked\"\n                },\n                \"issuedBefore\": {\n             \
        \       \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Reject tokens issued before this timestamp\"\n                },\n                \"revokedAt\": {\n         \
        \           \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"When the revocation was created\"\n                },\n                \"reason\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"Revocation reason for audit trail\"\n                }\n   \
        \         }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get current token revocation list\",\n    \"description\": \"Returns the
        current list of revoked tokens and accounts for edge provider synchronization\\nand administrative monitoring. Includes
        token-level revocations (by JTI) and account-level\\nrevocations (all tokens issued before a timestamp).\\n\",\n \
        \   \"tags\": [\n        \"Token Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getRevocationList\"\
        \n}"
  /auth/password/reset:
    post:
      summary: Request password reset
      operationId: requestPasswordReset
      tags:
      - Password
      x-permissions:
      - role: anonymous
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequest'
      responses:
        '200':
          description: Reset email sent if account exists
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/PasswordResetRequest\"\
        ,\n    \"$defs\": {\n        \"PasswordResetRequest\": {\n            \"description\": \"Request to initiate a password
        reset by sending a reset link to the email\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"email\"\n            ],\n            \"properties\": {\n\
        \                \"email\": {\n                    \"type\": \"string\",\n                    \"format\": \"email\"\
        ,\n                    \"maxLength\": 254,\n                    \"description\": \"Email address associated with the
        account to reset\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Request password reset\",\n    \"description\": \"\",\n    \"tags\": [\n\
        \        \"Password\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"requestPasswordReset\"\n}"
  /auth/password/confirm:
    post:
      summary: Confirm password reset with token
      operationId: confirmPasswordReset
      tags:
      - Password
      x-permissions:
      - role: anonymous
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetConfirmRequest'
      responses:
        '200':
          description: Password reset successfully
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/PasswordResetConfirmRequest\"\
        ,\n    \"$defs\": {\n        \"PasswordResetConfirmRequest\": {\n            \"description\": \"Request to confirm
        a password reset using the emailed token and new password\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"token\",\n                \"newPassword\"\n            ],\n\
        \            \"properties\": {\n                \"token\": {\n                    \"type\": \"string\",\n        \
        \            \"description\": \"Password reset token received via email\"\n                },\n                \"\
        newPassword\": {\n                    \"type\": \"string\",\n                    \"format\": \"password\",\n     \
        \               \"minLength\": 8,\n                    \"maxLength\": 128,\n                    \"description\": \"\
        New password to set for the account\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Confirm password reset with token\",\n    \"description\": \"\",\n    \"\
        tags\": [\n        \"Password\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"confirmPasswordReset\"\
        \n}"
  /auth/providers:
    post:
      summary: List available authentication providers
      description: |
        Returns a list of available OAuth and authentication providers based on server configuration.
        Providers are only listed if their client credentials are configured.
        Steam authentication uses session tickets, not OAuth, but is included for completeness.
      operationId: listProviders
      tags:
      - Authentication
      x-permissions:
      - role: anonymous
      responses:
        '200':
          description: List of available providers
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProvidersResponse'
      x-request-schema-json: '{}'
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ProvidersResponse\"\
        ,\n    \"$defs\": {\n        \"ProvidersResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"List of available authentication providers\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"providers\"\n            ],\n            \"properties\": {\n                \"providers\":
        {\n                    \"type\": \"array\",\n                    \"description\": \"Available authentication providers\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/ProviderInfo\"\n                \
        \    }\n                }\n            }\n        },\n        \"ProviderInfo\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"Information about an available authentication provider\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"name\",\n                \"displayName\",\n             \
        \   \"authType\"\n            ],\n            \"properties\": {\n                \"name\": {\n                   \
        \ \"type\": \"string\",\n                    \"example\": \"discord\",\n                    \"description\": \"Internal
        identifier for the provider (matches Provider enum for OAuth)\"\n                },\n                \"displayName\"\
        : {\n                    \"type\": \"string\",\n                    \"example\": \"Discord\",\n                  \
        \  \"description\": \"Human-readable name for the provider\"\n                },\n                \"authType\": {\n\
        \                    \"$ref\": \"#/$defs/AuthType\",\n                    \"description\": \"Authentication mechanism
        (oauth = browser redirect, ticket = game client token)\"\n                },\n                \"authUrl\": {\n   \
        \                 \"type\": \"string\",\n                    \"format\": \"uri\",\n                    \"nullable\"\
        : true,\n                    \"example\": \"https://discord.com/oauth2/authorize\",\n                    \"description\"\
        : \"URL to initiate OAuth authentication (null for ticket-based auth like Steam)\"\n                }\n          \
        \  }\n        },\n        \"AuthType\": {\n            \"type\": \"string\",\n            \"enum\": [\n          \
        \      \"oauth\",\n                \"ticket\"\n            ],\n            \"description\": \"Authentication mechanism
        type (oauth = browser redirect, ticket = game client token)\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List available authentication providers\",\n    \"description\": \"Returns
        a list of available OAuth and authentication providers based on server configuration.\\nProviders are only listed
        if their client credentials are configured.\\nSteam authentication uses session tickets, not OAuth, but is included
        for completeness.\\n\",\n    \"tags\": [\n        \"Authentication\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"listProviders\"\n}"
  /auth/mfa/setup:
    post:
      summary: Initialize MFA setup
      description: |
        Generates a TOTP secret and 10 recovery codes. Returns an otpauth:// URI for QR
        code scanning and the recovery codes in plain text (shown only once). The setup is
        not active until confirmed via /auth/mfa/enable with a valid TOTP code.
      operationId: setupMfa
      tags:
      - MFA
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: JWT access token
        x-from-authorization: bearer
      responses:
        '200':
          description: MFA setup initiated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MfaSetupResponse'
        '409':
          description: MFA already enabled for this account
      x-request-schema-json: '{}'
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MfaSetupResponse\"\
        ,\n    \"$defs\": {\n        \"MfaSetupResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"MFA setup data containing TOTP URI for QR code and recovery codes\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"setupToken\",\n                \"totpUri\",\n                \"recoveryCodes\"\
        \n            ],\n            \"properties\": {\n                \"setupToken\": {\n                    \"type\":
        \"string\",\n                    \"description\": \"Token to pass to /auth/mfa/enable to confirm setup\"\n       \
        \         },\n                \"totpUri\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"otpauth:// URI for authenticator app QR code scanning\"\n                },\n                \"recoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"description\": \"10 single-use recovery codes (shown only
        once, user must save them)\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Initialize MFA setup\",\n    \"description\": \"Generates a TOTP secret
        and 10 recovery codes. Returns an otpauth:// URI for QR\\ncode scanning and the recovery codes in plain text (shown
        only once). The setup is\\nnot active until confirmed via /auth/mfa/enable with a valid TOTP code.\\n\",\n    \"tags\"\
        : [\n        \"MFA\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"setupMfa\"\n}"
  /auth/mfa/enable:
    post:
      summary: Confirm MFA setup with TOTP code
      description: |
        Verifies a TOTP code against the pending setup secret to prove the authenticator
        app is correctly configured. On success, persists MFA settings to the account and
        MFA is active for all subsequent password logins.
      operationId: enableMfa
      tags:
      - MFA
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: JWT access token
        x-from-authorization: bearer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MfaEnableRequest'
      responses:
        '200':
          description: MFA enabled successfully
        '400':
          description: Invalid TOTP code or expired setup token
        '409':
          description: MFA already enabled
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MfaEnableRequest\"\
        ,\n    \"$defs\": {\n        \"MfaEnableRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to confirm MFA setup with a valid TOTP code proving authenticator is configured\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"setupToken\",\n                \"totpCode\"\n           \
        \ ],\n            \"properties\": {\n                \"setupToken\": {\n                    \"type\": \"string\",\n\
        \                    \"description\": \"Setup token from /auth/mfa/setup response\"\n                },\n        \
        \        \"totpCode\": {\n                    \"type\": \"string\",\n                    \"minLength\": 6,\n     \
        \               \"maxLength\": 6,\n                    \"pattern\": \"^\\\\d{6}$\",\n                    \"description\"\
        : \"6-digit TOTP code from authenticator app\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Confirm MFA setup with TOTP code\",\n    \"description\": \"Verifies a
        TOTP code against the pending setup secret to prove the authenticator\\napp is correctly configured. On success, persists
        MFA settings to the account and\\nMFA is active for all subsequent password logins.\\n\",\n    \"tags\": [\n     \
        \   \"MFA\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"enableMfa\"\n}"
  /auth/mfa/disable:
    post:
      summary: Disable MFA for current account
      description: |
        Disables MFA for the authenticated account. Requires a valid TOTP code or
        recovery code to prevent unauthorized disable. Clears the TOTP secret and
        recovery codes from the account.
      operationId: disableMfa
      tags:
      - MFA
      x-permissions:
      - role: user
      parameters:
      - name: jwt
        in: header
        required: true
        schema:
          type: string
        description: JWT access token
        x-from-authorization: bearer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MfaDisableRequest'
      responses:
        '200':
          description: MFA disabled successfully
        '400':
          description: Invalid TOTP code or recovery code
        '404':
          description: MFA not enabled for this account
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MfaDisableRequest\"\
        ,\n    \"$defs\": {\n        \"MfaDisableRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to disable MFA. Exactly one of totpCode or recoveryCode must be provided.\",\n            \"additionalProperties\"\
        : false,\n            \"properties\": {\n                \"totpCode\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"minLength\": 6,\n                    \"maxLength\"\
        : 6,\n                    \"pattern\": \"^\\\\d{6}$\",\n                    \"description\": \"Current 6-digit TOTP
        code from authenticator app\"\n                },\n                \"recoveryCode\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"pattern\": \"^[a-z0-9]{4}-[a-z0-9]{4}$\"\
        ,\n                    \"description\": \"Single-use recovery code (format xxxx-xxxx)\"\n                }\n     \
        \       }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Disable MFA for current account\",\n    \"description\": \"Disables MFA
        for the authenticated account. Requires a valid TOTP code or\\nrecovery code to prevent unauthorized disable. Clears
        the TOTP secret and\\nrecovery codes from the account.\\n\",\n    \"tags\": [\n        \"MFA\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"disableMfa\"\n}"
  /auth/mfa/admin-disable:
    post:
      summary: Admin override to disable MFA
      description: |
        Allows administrators to disable MFA for any account without TOTP verification.
        For account recovery when a user has lost their authenticator and all recovery codes.
      operationId: adminDisableMfa
      tags:
      - MFA
      x-permissions:
      - role: admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminDisableMfaRequest'
      responses:
        '200':
          description: MFA disabled by admin
        '404':
          description: Account not found or MFA not enabled
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AdminDisableMfaRequest\"\
        ,\n    \"$defs\": {\n        \"AdminDisableMfaRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Admin request to forcefully disable MFA for a user account\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"accountId\"\n            ],\n            \"properties\": {\n     \
        \           \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Account ID to disable MFA for\"\n                },\n                \"\
        reason\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                \
        \    \"description\": \"Administrative reason for disabling MFA (stored in audit event)\"\n                }\n   \
        \         }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Admin override to disable MFA\",\n    \"description\": \"Allows administrators
        to disable MFA for any account without TOTP verification.\\nFor account recovery when a user has lost their authenticator
        and all recovery codes.\\n\",\n    \"tags\": [\n        \"MFA\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"adminDisableMfa\"\n}"
  /auth/mfa/verify:
    post:
      summary: Verify MFA code during login
      description: |
        Completes the MFA challenge issued during login by verifying a TOTP code or
        recovery code. On success, returns full authentication tokens (same as a
        non-MFA login would). The challenge token is single-use and has a configurable
        TTL (default 5 minutes).
      operationId: verifyMfa
      tags:
      - MFA
      x-permissions:
      - role: anonymous
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MfaVerifyRequest'
      responses:
        '200':
          description: MFA verified, tokens issued
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Invalid TOTP code or recovery code
        '401':
          description: Challenge token not found, expired, or already used
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/MfaVerifyRequest\"\
        ,\n    \"$defs\": {\n        \"MfaVerifyRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to verify MFA during login. Exactly one of totpCode or recoveryCode must be provided.\",\n           \
        \ \"additionalProperties\": false,\n            \"required\": [\n                \"challengeToken\"\n            ],\n\
        \            \"properties\": {\n                \"challengeToken\": {\n                    \"type\": \"string\",\n\
        \                    \"description\": \"Challenge token from LoginResponse when requiresMfa was true\"\n         \
        \       },\n                \"totpCode\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"minLength\": 6,\n                    \"maxLength\": 6,\n                    \"pattern\"\
        : \"^\\\\d{6}$\",\n                    \"description\": \"6-digit TOTP code from authenticator app\"\n           \
        \     },\n                \"recoveryCode\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"pattern\": \"^[a-z0-9]{4}-[a-z0-9]{4}$\",\n                    \"description\": \"\
        Single-use recovery code (format xxxx-xxxx)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AuthResponse\"\
        ,\n    \"$defs\": {\n        \"AuthResponse\": {\n            \"description\": \"Successful authentication response
        containing tokens and session information\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"accountId\",\n                \"accessToken\",\n        \
        \        \"refreshToken\",\n                \"expiresIn\",\n                \"connectUrl\"\n            ],\n     \
        \       \"properties\": {\n                \"accountId\": {\n                    \"type\": \"string\",\n         \
        \           \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the authenticated
        account\"\n                },\n                \"accessToken\": {\n                    \"type\": \"string\",\n   \
        \                 \"description\": \"JWT access token for API authentication\"\n                },\n             \
        \   \"refreshToken\": {\n                    \"type\": \"string\",\n                    \"description\": \"Token used
        to obtain new access tokens when the current one expires\"\n                },\n                \"expiresIn\": {\n\
        \                    \"type\": \"integer\",\n                    \"description\": \"Seconds until access token expires\"\
        \n                },\n                \"connectUrl\": {\n                    \"type\": \"string\",\n             \
        \       \"format\": \"uri\",\n                    \"description\": \"WebSocket endpoint for Connect service\"\n  \
        \              },\n                \"roles\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\"\
        : true,\n                    \"description\": \"List of roles assigned to the authenticated user\"\n             \
        \   }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Verify MFA code during login\",\n    \"description\": \"Completes the MFA
        challenge issued during login by verifying a TOTP code or\\nrecovery code. On success, returns full authentication
        tokens (same as a\\nnon-MFA login would). The challenge token is single-use and has a configurable\\nTTL (default
        5 minutes).\\n\",\n    \"tags\": [\n        \"MFA\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"verifyMfa\"\
        \n}"
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Provider:
      type: string
      enum:
      - google
      - discord
      - twitch
      - steam
      description: Authentication provider type
    EmailProvider:
      type: string
      enum:
      - none
      - sendgrid
      - smtp
      - ses
      description: Email delivery provider type (none=console logging, sendgrid=SendGrid API, smtp=SMTP via MailKit, 
        ses=AWS SES v2)
    DeviceType:
      type: string
      enum:
      - desktop
      - mobile
      - tablet
      - console
      description: Category of client device used for authentication or session tracking
    AuthType:
      type: string
      enum:
      - oauth
      - ticket
      description: Authentication mechanism type (oauth = browser redirect, ticket = game client token)
    SessionInvalidatedEventReason:
      type: string
      enum:
      - Logout
      - AccountDeleted
      - SecurityRevocation
      - AdminAction
      - SessionExpired
      description: Reason for session invalidation
    SessionUpdatedEventReason:
      type: string
      enum:
      - RoleChanged
      - AuthorizationChanged
      - SubscriptionChanged
      description: Reason for session update
    AuthLoginFailedReason:
      type: string
      enum:
      - InvalidCredentials
      - AccountDisabled
      - AccountLocked
      - AccountNotFound
      - RateLimited
      description: Reason why the login attempt failed
    MfaDisabledBy:
      type: string
      enum:
      - Self
      - Admin
      description: Who triggered the MFA disable action
    MfaVerificationMethod:
      type: string
      enum:
      - Totp
      - RecoveryCode
      description: Method used for MFA verification
    MfaFailedReason:
      type: string
      enum:
      - InvalidCode
      - ExpiredChallenge
      - NoRecoveryCodesRemaining
      description: Reason for MFA verification failure
    InitOAuthResponse:
      type: object
      description: Response containing the OAuth authorization URL for redirect
      additionalProperties: false
      required:
      - authorizationUrl
      properties:
        authorizationUrl:
          type: string
          format: uri
          description: The OAuth provider authorization URL to redirect the user to
    TerminateSessionRequest:
      type: object
      description: Request to terminate a specific session
      additionalProperties: false
      required:
      - sessionId
      properties:
        sessionId:
          type: string
          format: uuid
          description: ID of the session to terminate
    LoginRequest:
      description: Request to authenticate a user with email and password credentials
      type: object
      additionalProperties: false
      required:
      - email
      - password
      properties:
        email:
          type: string
          format: email
          maxLength: 254
          description: Email address for authentication
        password:
          type: string
          format: password
          minLength: 1
          maxLength: 128
          description: User password for authentication
        rememberMe:
          type: boolean
          default: false
          description: Whether to extend the session duration for persistent login
        deviceInfo:
          $ref: '#/components/schemas/DeviceInfo'
          nullable: true
          description: Information about the client device (optional)
    RegisterRequest:
      type: object
      description: Request to register a new user account
      additionalProperties: false
      required:
      - username
      - password
      - email
      properties:
        username:
          type: string
          description: Unique username for the account
          minLength: 3
          maxLength: 32
          pattern: '^[a-zA-Z0-9_]+$'
          example: "gameuser123"
        password:
          type: string
          description: Password for the account (will be hashed)
          minLength: 8
          maxLength: 128
          format: password
          example: "SecurePassword123!"
        email:
          type: string
          format: email
          description: Email address for account recovery and notifications
          example: "user@example.com"
    RegisterResponse:
      type: object
      description: Response from successful user registration
      additionalProperties: false
      required:
      - accountId
      - accessToken
      - connectUrl
      properties:
        accountId:
          type: string
          format: uuid
          description: Unique identifier for the newly created account
        accessToken:
          type: string
          description: JWT access token for immediate authentication
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnYW1ldXNlcjEyMyIsImlhdCI6MTY0MDk5NTIwMCwiZXhwIjoxNjQwOTk4ODAwfQ.signature"
        refreshToken:
          type: string
          description: Refresh token for obtaining new access tokens
          nullable: true
          example: "refresh_token_abc123xyz789"
        connectUrl:
          type: string
          format: uri
          description: WebSocket endpoint for Connect service
    AuthResponse:
      description: Successful authentication response containing tokens and session information
      type: object
      additionalProperties: false
      required:
      - accountId
      - accessToken
      - refreshToken
      - expiresIn
      - connectUrl
      properties:
        accountId:
          type: string
          format: uuid
          description: Unique identifier for the authenticated account
        accessToken:
          type: string
          description: JWT access token for API authentication
        refreshToken:
          type: string
          description: Token used to obtain new access tokens when the current one expires
        expiresIn:
          type: integer
          description: Seconds until access token expires
        connectUrl:
          type: string
          format: uri
          description: WebSocket endpoint for Connect service
        roles:
          type: array
          items:
            type: string
          nullable: true
          description: List of roles assigned to the authenticated user
    OAuthCallbackRequest:
      description: Request containing OAuth provider callback data to complete authentication
      type: object
      additionalProperties: false
      required:
      - code
      properties:
        code:
          type: string
          description: Authorization code returned by the OAuth provider
        state:
          type: string
          nullable: true
          description: State parameter for CSRF protection, must match the value sent in the init request
        deviceInfo:
          $ref: '#/components/schemas/DeviceInfo'
          nullable: true
          description: Information about the client device (optional)
    SteamVerifyRequest:
      type: object
      description: |
        Request to verify a Steam Session Ticket. The ticket is obtained client-side via
        ISteamUser::GetAuthTicketForWebApi("bannou"). SteamID is NOT included because
        it must be obtained from Steam's Web API response (never trust client-provided SteamID).
      additionalProperties: false
      required:
      - ticket
      properties:
        ticket:
          type: string
          pattern: '^[0-9A-Fa-f]+$'
          minLength: 16
          maxLength: 2048
          description: |
            Hex-encoded Steam Session Ticket from ISteamUser::GetAuthTicketForWebApi().
            Client converts ticket bytes to hex string: BitConverter.ToString(ticketData).Replace("-", "")
          example: "140000006A7B3C8E..."
        deviceInfo:
          $ref: '#/components/schemas/DeviceInfo'
          nullable: true
          description: Information about the client device (optional)
    RefreshRequest:
      description: Request to obtain a new access token using a valid refresh token
      type: object
      additionalProperties: false
      required:
      - refreshToken
      properties:
        refreshToken:
          type: string
          description: Refresh token issued during authentication to obtain a new access token
    ValidateTokenResponse:
      description: Response from token validation containing associated account details. HTTP 200 confirms the token is 
        valid; 401 indicates invalid or expired.
      type: object
      additionalProperties: false
      required:
      - accountId
      - sessionKey
      - remainingTime
      properties:
        accountId:
          type: string
          format: uuid
          description: Unique identifier for the account associated with the token
        sessionKey:
          type: string
          format: uuid
          description: Internal session key used by Connect service for WebSocket connection tracking and service 
            routing
        roles:
          type: array
          items:
            type: string
          nullable: true
          description: List of roles assigned to the authenticated user
        authorizations:
          type: array
          items:
            type: string
          nullable: true
          description: |
            Authorization strings from active subscriptions.
            Format: "{stubName}:{state}" (e.g., "my-game:authorized")
        remainingTime:
          type: integer
          description: Seconds until expiration
    LogoutRequest:
      description: Request to logout and invalidate authentication tokens
      type: object
      additionalProperties: false
      properties:
        allSessions:
          type: boolean
          default: false
          description: Logout from all sessions/devices
    SessionsResponse:
      description: Response containing a list of all active sessions for an account
      type: object
      additionalProperties: false
      required:
      - sessions
      properties:
        sessions:
          type: array
          items:
            $ref: '#/components/schemas/SessionInfo'
          description: List of active sessions for the account
    SessionInfo:
      description: Information about an active user session including device and activity details
      type: object
      additionalProperties: false
      required:
      - sessionId
      - createdAt
      - lastActive
      properties:
        sessionId:
          type: string
          format: uuid
          description: Unique identifier for the session
        deviceInfo:
          $ref: '#/components/schemas/DeviceInfo'
          nullable: true
          description: Information about the device used for this session
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the session was created
        lastActive:
          type: string
          format: date-time
          description: Timestamp of the last activity in this session
        ipAddress:
          type: string
          nullable: true
          description: IP address from which the session was initiated
        location:
          type: string
          nullable: true
          description: Geographic location derived from the IP address
    DeviceInfo:
      description: Information about the client device used for authentication or session tracking
      type: object
      additionalProperties: false
      properties:
        deviceType:
          allOf:
          - $ref: '#/components/schemas/DeviceType'
          nullable: true
          description: Category of the device
        platform:
          type: string
          nullable: true
          description: Operating system or platform name
        browser:
          type: string
          nullable: true
          description: Browser name and version if applicable
        appVersion:
          type: string
          nullable: true
          description: Version of the client application
    PasswordResetRequest:
      description: Request to initiate a password reset by sending a reset link to the email
      type: object
      additionalProperties: false
      required:
      - email
      properties:
        email:
          type: string
          format: email
          maxLength: 254
          description: Email address associated with the account to reset
    PasswordResetConfirmRequest:
      description: Request to confirm a password reset using the emailed token and new password
      type: object
      additionalProperties: false
      required:
      - token
      - newPassword
      properties:
        token:
          type: string
          description: Password reset token received via email
        newPassword:
          type: string
          format: password
          minLength: 8
          maxLength: 128
          description: New password to set for the account
    LoginResponse:
      type: object
      description: Response from email/password login. May contain full tokens (no MFA) or a challenge token (MFA 
        required).
      additionalProperties: false
      required:
      - accountId
      - requiresMfa
      properties:
        accountId:
          type: string
          format: uuid
          description: Account ID (always present regardless of MFA status)
        requiresMfa:
          type: boolean
          description: If true, client must complete MFA via /auth/mfa/verify before receiving tokens
        mfaChallengeToken:
          type: string
          nullable: true
          description: Short-lived challenge token for /auth/mfa/verify (only present when requiresMfa is true)
        accessToken:
          type: string
          nullable: true
          description: JWT access token (only present when requiresMfa is false)
        refreshToken:
          type: string
          nullable: true
          description: Refresh token (only present when requiresMfa is false)
        expiresIn:
          type: integer
          nullable: true
          description: Seconds until access token expires (only present when requiresMfa is false)
        connectUrl:
          type: string
          format: uri
          nullable: true
          description: WebSocket connect URL (only present when requiresMfa is false)
        roles:
          type: array
          items:
            type: string
          nullable: true
          description: Account roles (only present when requiresMfa is false)
    MfaSetupResponse:
      type: object
      description: MFA setup data containing TOTP URI for QR code and recovery codes
      additionalProperties: false
      required:
      - setupToken
      - totpUri
      - recoveryCodes
      properties:
        setupToken:
          type: string
          description: Token to pass to /auth/mfa/enable to confirm setup
        totpUri:
          type: string
          description: otpauth:// URI for authenticator app QR code scanning
        recoveryCodes:
          type: array
          items:
            type: string
          description: 10 single-use recovery codes (shown only once, user must save them)
    MfaEnableRequest:
      type: object
      description: Request to confirm MFA setup with a valid TOTP code proving authenticator is configured
      additionalProperties: false
      required:
      - setupToken
      - totpCode
      properties:
        setupToken:
          type: string
          description: Setup token from /auth/mfa/setup response
        totpCode:
          type: string
          minLength: 6
          maxLength: 6
          pattern: '^\d{6}$'
          description: 6-digit TOTP code from authenticator app
    MfaDisableRequest:
      type: object
      description: Request to disable MFA. Exactly one of totpCode or recoveryCode must be provided.
      additionalProperties: false
      properties:
        totpCode:
          type: string
          nullable: true
          minLength: 6
          maxLength: 6
          pattern: '^\d{6}$'
          description: Current 6-digit TOTP code from authenticator app
        recoveryCode:
          type: string
          nullable: true
          pattern: '^[a-z0-9]{4}-[a-z0-9]{4}$'
          description: Single-use recovery code (format xxxx-xxxx)
    AdminDisableMfaRequest:
      type: object
      description: Admin request to forcefully disable MFA for a user account
      additionalProperties: false
      required:
      - accountId
      properties:
        accountId:
          type: string
          format: uuid
          description: Account ID to disable MFA for
        reason:
          type: string
          nullable: true
          description: Administrative reason for disabling MFA (stored in audit event)
    MfaVerifyRequest:
      type: object
      description: Request to verify MFA during login. Exactly one of totpCode or recoveryCode must be provided.
      additionalProperties: false
      required:
      - challengeToken
      properties:
        challengeToken:
          type: string
          description: Challenge token from LoginResponse when requiresMfa was true
        totpCode:
          type: string
          nullable: true
          minLength: 6
          maxLength: 6
          pattern: '^\d{6}$'
          description: 6-digit TOTP code from authenticator app
        recoveryCode:
          type: string
          nullable: true
          pattern: '^[a-z0-9]{4}-[a-z0-9]{4}$'
          description: Single-use recovery code (format xxxx-xxxx)
    ProvidersResponse:
      type: object
      description: List of available authentication providers
      additionalProperties: false
      required:
      - providers
      properties:
        providers:
          type: array
          description: Available authentication providers
          items:
            $ref: '#/components/schemas/ProviderInfo'
    ProviderInfo:
      type: object
      description: Information about an available authentication provider
      additionalProperties: false
      required:
      - name
      - displayName
      - authType
      properties:
        name:
          type: string
          example: "discord"
          description: Internal identifier for the provider (matches Provider enum for OAuth)
        displayName:
          type: string
          example: "Discord"
          description: Human-readable name for the provider
        authType:
          $ref: '#/components/schemas/AuthType'
          description: Authentication mechanism (oauth = browser redirect, ticket = game client token)
        authUrl:
          type: string
          format: uri
          nullable: true
          example: "https://discord.com/oauth2/authorize"
          description: URL to initiate OAuth authentication (null for ticket-based auth like Steam)
    GetRevocationListRequest:
      type: object
      description: Request to get current revocation list for edge provider synchronization or admin monitoring
      additionalProperties: false
      properties:
        includeTokens:
          type: boolean
          default: true
          description: Include token-level revocations (by JTI)
        includeAccounts:
          type: boolean
          default: true
          description: Include account-level revocations (all tokens before timestamp)
        limit:
          type: integer
          minimum: 1
          maximum: 1000
          default: 100
          description: Maximum entries to return per category
    RevocationListResponse:
      type: object
      description: Current revocation list with token and account level entries
      additionalProperties: false
      required:
      - revokedTokens
      - revokedAccounts
      properties:
        revokedTokens:
          type: array
          items:
            $ref: '#/components/schemas/RevokedTokenEntry'
          description: Token-level revocations (individual JTIs)
        revokedAccounts:
          type: array
          items:
            $ref: '#/components/schemas/RevokedAccountEntry'
          description: Account-level revocations (all tokens before timestamp)
    RevokedTokenEntry:
      type: object
      description: A single revoked token entry with expiration tracking
      additionalProperties: false
      required:
      - jti
      - accountId
      - revokedAt
      - expiresAt
      - reason
      properties:
        jti:
          type: string
          description: JWT unique identifier (jti claim)
        accountId:
          type: string
          format: uuid
          description: Account that owned the token
        revokedAt:
          type: string
          format: date-time
          description: When the token was revoked
        expiresAt:
          type: string
          format: date-time
          description: When the revocation entry expires (matches original JWT expiry)
        reason:
          type: string
          description: Revocation reason for audit trail
    RevokedAccountEntry:
      type: object
      description: Account-level revocation entry that invalidates all tokens issued before a timestamp
      additionalProperties: false
      required:
      - accountId
      - issuedBefore
      - revokedAt
      - reason
      properties:
        accountId:
          type: string
          format: uuid
          description: Account ID whose tokens are revoked
        issuedBefore:
          type: string
          format: date-time
          description: Reject tokens issued before this timestamp
        revokedAt:
          type: string
          format: date-time
          description: When the revocation was created
        reason:
          type: string
          description: Revocation reason for audit trail
