openapi: 3.0.3
info:
  title: Asset Service API
  version: 1.0.0
  description: |
    Asset management service for storage, versioning, and distribution of large binary assets.

    **POST-Only API Pattern**: This API uses POST for all operations to support zero-copy
    WebSocket routing. Path parameters are passed in request bodies instead of URLs.
    See docs/BANNOU_DESIGN.md for architectural rationale.

    **Pre-signed URL Architecture**: All asset transfers use pre-signed URLs via MinIO/S3.
    WebSocket handles only metadata requests and progress notifications - never raw asset data.
    This bypasses payload limits entirely.

    **Key Features**:
    - Individual asset upload/download via pre-signed URLs
    - Asset versioning with content-based hashing
    - Asset bundles (.bannou format) for grouped distribution
    - Asset search by type, tags, realm
    - Processing pipeline for textures, models, audio, behaviors

    **NRT Compliance**: AI agents MUST review docs/NRT-SCHEMA-RULES.md before modifying this schema. Optional reference types require `nullable: true`.
servers:
- url: http://localhost:5012
  description: Bannou service endpoint
paths:
  /assets/upload/request:
    post:
      summary: Request upload URL for a new asset
      description: |
        Generate a pre-signed URL for uploading a new asset directly to storage.
        For large files (>50MB), returns multipart upload configuration.
      operationId: requestUpload
      tags:
      - Assets
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UploadRequest'
      responses:
        '200':
          description: Upload URL generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadResponse'
        '400':
          description: Invalid request (filename, size, or content_type)
        '401':
          description: Not authenticated
        '403':
          description: Insufficient permissions
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UploadRequest\"\
        ,\n    \"$defs\": {\n        \"UploadRequest\": {\n            \"description\": \"Request to initiate an asset upload
        and receive a pre-signed URL\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"filename\",\n                \"size\",\n                \"contentType\"\
        ,\n                \"owner\"\n            ],\n            \"properties\": {\n                \"owner\": {\n      \
        \              \"type\": \"string\",\n                    \"description\": \"Owner of this asset operation. NOT a
        session ID.\\nFor user-initiated uploads: the accountId (UUID format).\\nFor service-initiated uploads: the service
        name (e.g., \\\"behavior\\\", \\\"orchestrator\\\").\\n\"\n                },\n                \"filename\": {\n \
        \                   \"type\": \"string\",\n                    \"description\": \"Original filename with extension\"\
        \n                },\n                \"size\": {\n                    \"type\": \"integer\",\n                  \
        \  \"format\": \"int64\",\n                    \"description\": \"File size in bytes\"\n                },\n     \
        \           \"contentType\": {\n                    \"type\": \"string\",\n                    \"description\": \"\
        MIME content type (e.g., image/png, model/gltf-binary)\"\n                },\n                \"metadata\": {\n  \
        \                  \"$ref\": \"#/$defs/AssetMetadataInput\",\n                    \"description\": \"Optional metadata
        for asset categorization\"\n                }\n            }\n        },\n        \"AssetMetadataInput\": {\n    \
        \        \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"description\": \"User-provided
        metadata for asset categorization\",\n            \"properties\": {\n                \"assetType\": {\n          \
        \          \"$ref\": \"#/$defs/AssetType\",\n                    \"description\": \"Type classification for the asset\"\
        \n                },\n                \"realm\": {\n                    \"$ref\": \"#/$defs/Realm\",\n           \
        \         \"description\": \"Game realm the asset belongs to\"\n                },\n                \"tags\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"\
        string\"\n                    },\n                    \"description\": \"Searchable tags for the asset\"\n       \
        \         }\n            }\n        },\n        \"AssetType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"texture\",\n                \"model\",\n                \"audio\",\n                \"\
        behavior\",\n                \"bundle\",\n                \"prefab\",\n                \"other\"\n            ],\n\
        \            \"description\": \"Type classification for assets\"\n        },\n        \"Realm\": {\n            \"\
        type\": \"string\",\n            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n         \
        \       \"fantasia\",\n                \"shared\"\n            ],\n            \"description\": \"Game realm the asset
        belongs to\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UploadResponse\"\
        ,\n    \"$defs\": {\n        \"UploadResponse\": {\n            \"description\": \"Response containing pre-signed
        URL and configuration for uploading an asset\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"uploadId\",\n                \"uploadUrl\",\n           \
        \     \"expiresAt\"\n            ],\n            \"properties\": {\n                \"uploadId\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"\
        Unique upload session identifier\"\n                },\n                \"uploadUrl\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uri\",\n                    \"description\": \"Pre-signed URL for
        uploading the file\"\n                },\n                \"expiresAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"description\": \"When the upload URL expires\"\
        \n                },\n                \"multipart\": {\n                    \"$ref\": \"#/$defs/MultipartConfig\"\
        ,\n                    \"description\": \"Configuration for multipart uploads if file size requires it\"\n       \
        \         },\n                \"requiredHeaders\": {\n                    \"type\": \"object\",\n                \
        \    \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n         \
        \           \"description\": \"Headers the client must include when uploading to the pre-signed URL\"\n          \
        \      }\n            }\n        },\n        \"MultipartConfig\": {\n            \"description\": \"Configuration
        for multipart uploads of large files\",\n            \"type\": \"object\",\n            \"additionalProperties\":
        false,\n            \"properties\": {\n                \"required\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether multipart upload is required for this file size\"\n            \
        \    },\n                \"partSize\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Size of each part in bytes\"\n                },\n                \"maxParts\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Maximum number of parts\"\n                },\n           \
        \     \"uploadUrls\": {\n                    \"type\": \"array\",\n                    \"nullable\": true,\n     \
        \               \"description\": \"Pre-signed URLs for each part of the multipart upload\",\n                    \"\
        items\": {\n                        \"$ref\": \"#/$defs/PartUploadInfo\"\n                    }\n                }\n\
        \            }\n        },\n        \"PartUploadInfo\": {\n            \"description\": \"Upload information for a
        single part in a multipart upload\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"partNumber\",\n                \"uploadUrl\"\n            ],\n   \
        \         \"properties\": {\n                \"partNumber\": {\n                    \"type\": \"integer\",\n     \
        \               \"description\": \"Part number (1-based)\"\n                },\n                \"uploadUrl\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uri\",\n                    \"description\"\
        : \"Pre-signed URL for uploading this part\"\n                },\n                \"minSize\": {\n               \
        \     \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"\
        Minimum size for this part\"\n                },\n                \"maxSize\": {\n                    \"type\": \"\
        integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Maximum size for this
        part\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Request upload URL for a new asset\",\n    \"description\": \"Generate
        a pre-signed URL for uploading a new asset directly to storage.\\nFor large files (>50MB), returns multipart upload
        configuration.\\n\",\n    \"tags\": [\n        \"Assets\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"requestUpload\"\n}"
  /assets/upload/complete:
    post:
      summary: Mark upload as complete, trigger processing
      description: |
        Called after the client has uploaded the file to the pre-signed URL.
        Triggers the asset processing pipeline (texture conversion, model validation, etc.)
        and emits completion events via WebSocket.
      operationId: completeUpload
      tags:
      - Assets
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompleteUploadRequest'
      responses:
        '200':
          description: Asset created, processing started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssetMetadata'
        '400':
          description: Invalid upload_id or missing parts for multipart
        '404':
          description: Upload session not found or expired
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CompleteUploadRequest\"\
        ,\n    \"$defs\": {\n        \"CompleteUploadRequest\": {\n            \"description\": \"Request to finalize an upload
        and trigger asset processing\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"uploadId\"\n            ],\n            \"properties\": {\n      \
        \          \"uploadId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n\
        \                    \"description\": \"Upload session ID from requestUpload\"\n                },\n             \
        \   \"parts\": {\n                    \"type\": \"array\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"For multipart uploads - ETags of completed parts (null for single-file uploads)\",\n \
        \                   \"items\": {\n                        \"$ref\": \"#/$defs/CompletedPart\"\n                  \
        \  }\n                }\n            }\n        },\n        \"CompletedPart\": {\n            \"description\": \"\
        Information about a completed part in a multipart upload\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"partNumber\",\n                \"etag\"\n            ],\n\
        \            \"properties\": {\n                \"partNumber\": {\n                    \"type\": \"integer\",\n  \
        \                  \"description\": \"Part number (1-based)\"\n                },\n                \"etag\": {\n \
        \                   \"type\": \"string\",\n                    \"description\": \"ETag returned from part upload\"\
        \n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AssetMetadata\"\
        ,\n    \"$defs\": {\n        \"AssetMetadata\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Complete asset metadata including system-generated fields\",\n          \
        \  \"required\": [\n                \"assetId\",\n                \"contentHash\",\n                \"filename\",\n\
        \                \"contentType\",\n                \"size\",\n                \"assetType\",\n                \"realm\"\
        ,\n                \"tags\",\n                \"processingStatus\",\n                \"isArchived\",\n           \
        \     \"createdAt\",\n                \"updatedAt\"\n            ],\n            \"properties\": {\n             \
        \   \"assetId\": {\n                    \"type\": \"string\",\n                    \"description\": \"Unique asset
        identifier\"\n                },\n                \"contentHash\": {\n                    \"type\": \"string\",\n\
        \                    \"description\": \"SHA256 hash of file contents\"\n                },\n                \"filename\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Original filename\"\n     \
        \           },\n                \"contentType\": {\n                    \"type\": \"string\",\n                  \
        \  \"description\": \"MIME content type\"\n                },\n                \"size\": {\n                    \"\
        type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"File size
        in bytes\"\n                },\n                \"assetType\": {\n                    \"$ref\": \"#/$defs/AssetType\"\
        ,\n                    \"description\": \"Type classification for the asset\"\n                },\n              \
        \  \"realm\": {\n                    \"$ref\": \"#/$defs/Realm\",\n                    \"description\": \"Game realm
        the asset belongs to\"\n                },\n                \"tags\": {\n                    \"type\": \"array\",\n\
        \                    \"items\": {\n                        \"type\": \"string\"\n                    },\n        \
        \            \"description\": \"Searchable tags for the asset\"\n                },\n                \"processingStatus\"\
        : {\n                    \"$ref\": \"#/$defs/ProcessingStatus\",\n                    \"description\": \"Current status
        of asset processing pipeline\"\n                },\n                \"isArchived\": {\n                    \"type\"\
        : \"boolean\",\n                    \"description\": \"Whether the asset is in cold/archival storage\",\n        \
        \            \"default\": false\n                },\n                \"createdAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Timestamp when
        the asset was created\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the asset
        was last updated\"\n                }\n            }\n        },\n        \"AssetType\": {\n            \"type\":
        \"string\",\n            \"enum\": [\n                \"texture\",\n                \"model\",\n                \"\
        audio\",\n                \"behavior\",\n                \"bundle\",\n                \"prefab\",\n              \
        \  \"other\"\n            ],\n            \"description\": \"Type classification for assets\"\n        },\n      \
        \  \"Realm\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"omega\",\n        \
        \        \"arcadia\",\n                \"fantasia\",\n                \"shared\"\n            ],\n            \"description\"\
        : \"Game realm the asset belongs to\"\n        },\n        \"ProcessingStatus\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"pending\",\n                \"processing\",\n                \"complete\"\
        ,\n                \"failed\"\n            ],\n            \"description\": \"Asset processing pipeline status\"\n\
        \        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Mark upload as complete, trigger processing\",\n    \"description\": \"\
        Called after the client has uploaded the file to the pre-signed URL.\\nTriggers the asset processing pipeline (texture
        conversion, model validation, etc.)\\nand emits completion events via WebSocket.\\n\",\n    \"tags\": [\n        \"\
        Assets\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"completeUpload\"\n}"
  /assets/get:
    post:
      summary: Get asset metadata and download URL
      description: |
        Retrieve asset metadata and generate a pre-signed download URL.
        Specify version to download a specific version, or omit for latest.
      operationId: getAsset
      tags:
      - Assets
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetAssetRequest'
      responses:
        '200':
          description: Asset metadata with download URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssetWithDownloadUrl'
        '404':
          description: Asset not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetAssetRequest\"\
        ,\n    \"$defs\": {\n        \"GetAssetRequest\": {\n            \"description\": \"Request to retrieve asset metadata
        and download URL\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n           \
        \ \"required\": [\n                \"assetId\"\n            ],\n            \"properties\": {\n                \"\
        assetId\": {\n                    \"type\": \"string\",\n                    \"description\": \"Asset identifier\"\
        \n                },\n                \"version\": {\n                    \"type\": \"string\",\n                \
        \    \"default\": \"latest\",\n                    \"description\": \"Version ID or 'latest'\"\n                }\n\
        \            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AssetWithDownloadUrl\"\
        ,\n    \"$defs\": {\n        \"AssetWithDownloadUrl\": {\n            \"description\": \"Asset metadata with optional
        pre-signed download URL\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n    \
        \        \"required\": [\n                \"assetId\",\n                \"versionId\",\n                \"size\",\n\
        \                \"contentHash\",\n                \"contentType\",\n                \"metadata\"\n            ],\n\
        \            \"properties\": {\n                \"assetId\": {\n                    \"type\": \"string\",\n      \
        \              \"description\": \"Unique asset identifier\"\n                },\n                \"versionId\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Version identifier for this specific
        asset version\"\n                },\n                \"downloadUrl\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uri\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Pre-signed download URL (only populated when requested)\"\n                },\n                \"expiresAt\":
        {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                   \
        \ \"nullable\": true,\n                    \"description\": \"When the download URL expires (only populated when requested)\"\
        \n                },\n                \"size\": {\n                    \"type\": \"integer\",\n                  \
        \  \"format\": \"int64\",\n                    \"description\": \"File size in bytes\"\n                },\n     \
        \           \"contentHash\": {\n                    \"type\": \"string\",\n                    \"description\": \"\
        SHA256 hash of file contents\"\n                },\n                \"contentType\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"MIME content type\"\n                },\n                \"\
        metadata\": {\n                    \"$ref\": \"#/$defs/AssetMetadata\",\n                    \"description\": \"Complete
        asset metadata\"\n                }\n            }\n        },\n        \"AssetMetadata\": {\n            \"type\"\
        : \"object\",\n            \"additionalProperties\": false,\n            \"description\": \"Complete asset metadata
        including system-generated fields\",\n            \"required\": [\n                \"assetId\",\n                \"\
        contentHash\",\n                \"filename\",\n                \"contentType\",\n                \"size\",\n     \
        \           \"assetType\",\n                \"realm\",\n                \"tags\",\n                \"processingStatus\"\
        ,\n                \"isArchived\",\n                \"createdAt\",\n                \"updatedAt\"\n            ],\n\
        \            \"properties\": {\n                \"assetId\": {\n                    \"type\": \"string\",\n      \
        \              \"description\": \"Unique asset identifier\"\n                },\n                \"contentHash\":
        {\n                    \"type\": \"string\",\n                    \"description\": \"SHA256 hash of file contents\"\
        \n                },\n                \"filename\": {\n                    \"type\": \"string\",\n               \
        \     \"description\": \"Original filename\"\n                },\n                \"contentType\": {\n           \
        \         \"type\": \"string\",\n                    \"description\": \"MIME content type\"\n                },\n\
        \                \"size\": {\n                    \"type\": \"integer\",\n                    \"format\": \"int64\"\
        ,\n                    \"description\": \"File size in bytes\"\n                },\n                \"assetType\"\
        : {\n                    \"$ref\": \"#/$defs/AssetType\",\n                    \"description\": \"Type classification
        for the asset\"\n                },\n                \"realm\": {\n                    \"$ref\": \"#/$defs/Realm\"\
        ,\n                    \"description\": \"Game realm the asset belongs to\"\n                },\n                \"\
        tags\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"\
        type\": \"string\"\n                    },\n                    \"description\": \"Searchable tags for the asset\"\
        \n                },\n                \"processingStatus\": {\n                    \"$ref\": \"#/$defs/ProcessingStatus\"\
        ,\n                    \"description\": \"Current status of asset processing pipeline\"\n                },\n    \
        \            \"isArchived\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"\
        Whether the asset is in cold/archival storage\",\n                    \"default\": false\n                },\n   \
        \             \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"description\": \"Timestamp when the asset was created\"\n                },\n           \
        \     \"updatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n\
        \                    \"description\": \"Timestamp when the asset was last updated\"\n                }\n         \
        \   }\n        },\n        \"AssetType\": {\n            \"type\": \"string\",\n            \"enum\": [\n        \
        \        \"texture\",\n                \"model\",\n                \"audio\",\n                \"behavior\",\n   \
        \             \"bundle\",\n                \"prefab\",\n                \"other\"\n            ],\n            \"\
        description\": \"Type classification for assets\"\n        },\n        \"Realm\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n                \"fantasia\"\
        ,\n                \"shared\"\n            ],\n            \"description\": \"Game realm the asset belongs to\"\n\
        \        },\n        \"ProcessingStatus\": {\n            \"type\": \"string\",\n            \"enum\": [\n       \
        \         \"pending\",\n                \"processing\",\n                \"complete\",\n                \"failed\"\
        \n            ],\n            \"description\": \"Asset processing pipeline status\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get asset metadata and download URL\",\n    \"description\": \"Retrieve
        asset metadata and generate a pre-signed download URL.\\nSpecify version to download a specific version, or omit for
        latest.\\n\",\n    \"tags\": [\n        \"Assets\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getAsset\"\
        \n}"
  /assets/delete:
    post:
      summary: Delete an asset
      description: |
        Delete an asset from storage. If versionId is specified, only that version is deleted.
        If versionId is omitted, all versions are deleted.
      operationId: deleteAsset
      tags:
      - Assets
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteAssetRequest'
      responses:
        '200':
          description: Asset deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteAssetResponse'
        '404':
          description: Asset not found
        '403':
          description: Insufficient permissions
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteAssetRequest\"\
        ,\n    \"$defs\": {\n        \"DeleteAssetRequest\": {\n            \"description\": \"Request to delete an asset
        from storage\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"assetId\"\n            ],\n            \"properties\": {\n                \"assetId\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Asset identifier to delete\"\n\
        \                },\n                \"versionId\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"Specific version to delete. If omitted, all versions
        are deleted.\\n\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteAssetResponse\"\
        ,\n    \"$defs\": {\n        \"DeleteAssetResponse\": {\n            \"description\": \"Response confirming asset
        deletion\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"assetId\",\n                \"versionsDeleted\"\n            ],\n            \"properties\"\
        : {\n                \"assetId\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Deleted asset identifier\"\n                },\n                \"versionsDeleted\": {\n                    \"\
        type\": \"integer\",\n                    \"description\": \"Number of versions deleted\"\n                }\n   \
        \         }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Delete an asset\",\n    \"description\": \"Delete an asset from storage.
        If versionId is specified, only that version is deleted.\\nIf versionId is omitted, all versions are deleted.\\n\"\
        ,\n    \"tags\": [\n        \"Assets\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"deleteAsset\"\n\
        }"
  /assets/list-versions:
    post:
      summary: List all versions of an asset
      description: |
        Retrieve version history for an asset with pagination.
        Includes version IDs, creation timestamps, and archive status.
      operationId: listAssetVersions
      tags:
      - Assets
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListVersionsRequest'
      responses:
        '200':
          description: List of asset versions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssetVersionList'
        '404':
          description: Asset not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListVersionsRequest\"\
        ,\n    \"$defs\": {\n        \"ListVersionsRequest\": {\n            \"description\": \"Request to list all versions
        of an asset with pagination\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"assetId\"\n            ],\n            \"properties\": {\n       \
        \         \"assetId\": {\n                    \"type\": \"string\",\n                    \"description\": \"Asset
        identifier to list versions for\"\n                },\n                \"limit\": {\n                    \"type\"\
        : \"integer\",\n                    \"default\": 50,\n                    \"description\": \"Maximum number of versions
        to return\"\n                },\n                \"offset\": {\n                    \"type\": \"integer\",\n     \
        \               \"default\": 0,\n                    \"description\": \"Number of versions to skip for pagination\"\
        \n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AssetVersionList\"\
        ,\n    \"$defs\": {\n        \"AssetVersionList\": {\n            \"description\": \"Paginated list of asset versions\"\
        ,\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\": [\n\
        \                \"assetId\",\n                \"versions\",\n                \"total\",\n                \"limit\"\
        ,\n                \"offset\"\n            ],\n            \"properties\": {\n                \"assetId\": {\n   \
        \                 \"type\": \"string\",\n                    \"description\": \"Asset identifier\"\n             \
        \   },\n                \"versions\": {\n                    \"type\": \"array\",\n                    \"items\":
        {\n                        \"$ref\": \"#/$defs/AssetVersion\"\n                    },\n                    \"description\"\
        : \"List of asset versions\"\n                },\n                \"total\": {\n                    \"type\": \"integer\"\
        ,\n                    \"description\": \"Total number of versions available\"\n                },\n             \
        \   \"limit\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Maximum number
        of versions returned per page\"\n                },\n                \"offset\": {\n                    \"type\":
        \"integer\",\n                    \"description\": \"Number of versions skipped\"\n                }\n           \
        \ }\n        },\n        \"AssetVersion\": {\n            \"description\": \"Metadata for a specific version of an
        asset\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"versionId\",\n                \"createdAt\",\n                \"size\",\n                \"\
        isArchived\"\n            ],\n            \"properties\": {\n                \"versionId\": {\n                  \
        \  \"type\": \"string\",\n                    \"description\": \"Unique version identifier\"\n                },\n\
        \                \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"description\": \"Timestamp when this version was created\"\n                },\n        \
        \        \"size\": {\n                    \"type\": \"integer\",\n                    \"format\": \"int64\",\n   \
        \                 \"description\": \"File size in bytes for this version\"\n                },\n                \"\
        isArchived\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether this version
        is in cold storage\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List all versions of an asset\",\n    \"description\": \"Retrieve version
        history for an asset with pagination.\\nIncludes version IDs, creation timestamps, and archive status.\\n\",\n   \
        \ \"tags\": [\n        \"Assets\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"listAssetVersions\"\n\
        }"
  /assets/search:
    post:
      summary: Search assets by tags, type, or realm
      description: |
        Search assets using various filters with pagination.
        All filters are optional and combine with AND logic.
      operationId: searchAssets
      tags:
      - Assets
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssetSearchRequest'
      responses:
        '200':
          description: Matching assets
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssetSearchResult'
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AssetSearchRequest\"\
        ,\n    \"$defs\": {\n        \"AssetSearchRequest\": {\n            \"description\": \"Search criteria for filtering
        assets with pagination\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n     \
        \       \"required\": [\n                \"assetType\",\n                \"realm\"\n            ],\n            \"\
        properties\": {\n                \"tags\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Filter by tags (assets must have all specified tags) (null to skip tag filtering)\"\
        \n                },\n                \"assetType\": {\n                    \"$ref\": \"#/$defs/AssetType\",\n   \
        \                 \"description\": \"Filter by asset type\"\n                },\n                \"realm\": {\n  \
        \                  \"$ref\": \"#/$defs/Realm\",\n                    \"description\": \"Filter by game realm\"\n \
        \               },\n                \"contentType\": {\n                    \"type\": \"string\",\n              \
        \      \"nullable\": true,\n                    \"description\": \"MIME content type filter (null to skip content
        type filtering)\"\n                },\n                \"limit\": {\n                    \"type\": \"integer\",\n\
        \                    \"default\": 50,\n                    \"description\": \"Maximum number of results to return\"\
        \n                },\n                \"offset\": {\n                    \"type\": \"integer\",\n                \
        \    \"default\": 0,\n                    \"description\": \"Number of results to skip for pagination\"\n        \
        \        }\n            }\n        },\n        \"AssetType\": {\n            \"type\": \"string\",\n            \"\
        enum\": [\n                \"texture\",\n                \"model\",\n                \"audio\",\n                \"\
        behavior\",\n                \"bundle\",\n                \"prefab\",\n                \"other\"\n            ],\n\
        \            \"description\": \"Type classification for assets\"\n        },\n        \"Realm\": {\n            \"\
        type\": \"string\",\n            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n         \
        \       \"fantasia\",\n                \"shared\"\n            ],\n            \"description\": \"Game realm the asset
        belongs to\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AssetSearchResult\"\
        ,\n    \"$defs\": {\n        \"AssetSearchResult\": {\n            \"description\": \"Paginated results from an asset
        search query\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"assets\",\n                \"total\",\n                \"limit\",\n                \"offset\"\
        \n            ],\n            \"properties\": {\n                \"assets\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AssetMetadata\"\n               \
        \     },\n                    \"description\": \"List of matching assets\"\n                },\n                \"\
        total\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Total number of matching
        assets\"\n                },\n                \"limit\": {\n                    \"type\": \"integer\",\n         \
        \           \"description\": \"Maximum number of results returned per page\"\n                },\n               \
        \ \"offset\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Number of results
        skipped\"\n                }\n            }\n        },\n        \"AssetMetadata\": {\n            \"type\": \"object\"\
        ,\n            \"additionalProperties\": false,\n            \"description\": \"Complete asset metadata including
        system-generated fields\",\n            \"required\": [\n                \"assetId\",\n                \"contentHash\"\
        ,\n                \"filename\",\n                \"contentType\",\n                \"size\",\n                \"\
        assetType\",\n                \"realm\",\n                \"tags\",\n                \"processingStatus\",\n     \
        \           \"isArchived\",\n                \"createdAt\",\n                \"updatedAt\"\n            ],\n     \
        \       \"properties\": {\n                \"assetId\": {\n                    \"type\": \"string\",\n           \
        \         \"description\": \"Unique asset identifier\"\n                },\n                \"contentHash\": {\n \
        \                   \"type\": \"string\",\n                    \"description\": \"SHA256 hash of file contents\"\n\
        \                },\n                \"filename\": {\n                    \"type\": \"string\",\n                \
        \    \"description\": \"Original filename\"\n                },\n                \"contentType\": {\n            \
        \        \"type\": \"string\",\n                    \"description\": \"MIME content type\"\n                },\n \
        \               \"size\": {\n                    \"type\": \"integer\",\n                    \"format\": \"int64\"\
        ,\n                    \"description\": \"File size in bytes\"\n                },\n                \"assetType\"\
        : {\n                    \"$ref\": \"#/$defs/AssetType\",\n                    \"description\": \"Type classification
        for the asset\"\n                },\n                \"realm\": {\n                    \"$ref\": \"#/$defs/Realm\"\
        ,\n                    \"description\": \"Game realm the asset belongs to\"\n                },\n                \"\
        tags\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"\
        type\": \"string\"\n                    },\n                    \"description\": \"Searchable tags for the asset\"\
        \n                },\n                \"processingStatus\": {\n                    \"$ref\": \"#/$defs/ProcessingStatus\"\
        ,\n                    \"description\": \"Current status of asset processing pipeline\"\n                },\n    \
        \            \"isArchived\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"\
        Whether the asset is in cold/archival storage\",\n                    \"default\": false\n                },\n   \
        \             \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"description\": \"Timestamp when the asset was created\"\n                },\n           \
        \     \"updatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n\
        \                    \"description\": \"Timestamp when the asset was last updated\"\n                }\n         \
        \   }\n        },\n        \"AssetType\": {\n            \"type\": \"string\",\n            \"enum\": [\n        \
        \        \"texture\",\n                \"model\",\n                \"audio\",\n                \"behavior\",\n   \
        \             \"bundle\",\n                \"prefab\",\n                \"other\"\n            ],\n            \"\
        description\": \"Type classification for assets\"\n        },\n        \"Realm\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n                \"fantasia\"\
        ,\n                \"shared\"\n            ],\n            \"description\": \"Game realm the asset belongs to\"\n\
        \        },\n        \"ProcessingStatus\": {\n            \"type\": \"string\",\n            \"enum\": [\n       \
        \         \"pending\",\n                \"processing\",\n                \"complete\",\n                \"failed\"\
        \n            ],\n            \"description\": \"Asset processing pipeline status\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Search assets by tags, type, or realm\",\n    \"description\": \"Search
        assets using various filters with pagination.\\nAll filters are optional and combine with AND logic.\\n\",\n    \"\
        tags\": [\n        \"Assets\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"searchAssets\"\n}"
  /bundles/create:
    post:
      summary: Create asset bundle from multiple assets
      description: |
        Create a .bannou bundle containing multiple assets.
        For large bundles, processing is delegated to the processing pool.
        Completion notification sent via WebSocket event.
      operationId: createBundle
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateBundleRequest'
      responses:
        '200':
          description: Bundle created immediately (small bundles)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateBundleResponse'
        '202':
          description: Bundle creation queued (large bundles)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateBundleResponse'
        '400':
          description: Invalid asset_ids or bundle_id
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateBundleRequest\"\
        ,\n    \"$defs\": {\n        \"CreateBundleRequest\": {\n            \"description\": \"Request to create a new asset
        bundle from multiple assets\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"bundleId\",\n                \"assetIds\",\n                \"owner\"\
        \n            ],\n            \"properties\": {\n                \"owner\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Owner of this bundle. NOT a session ID.\\nFor user-initiated bundles: the
        accountId (UUID format).\\nFor service-initiated bundles: the service name (e.g., \\\"orchestrator\\\").\\n\"\n  \
        \              },\n                \"bundleId\": {\n                    \"type\": \"string\",\n                  \
        \  \"description\": \"Unique bundle identifier\"\n                },\n                \"version\": {\n           \
        \         \"type\": \"string\",\n                    \"default\": \"1.0.0\",\n                    \"description\"\
        : \"Bundle version string\"\n                },\n                \"realm\": {\n                    \"allOf\": [\n\
        \                        {\n                            \"$ref\": \"#/$defs/Realm\"\n                        }\n \
        \                   ],\n                    \"nullable\": true,\n                    \"description\": \"Game realm
        this bundle belongs to.\\nDefaults to 'shared' if not specified.\\n\"\n                },\n                \"assetIds\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"description\": \"List of asset IDs to include in the bundle\"\
        \n                },\n                \"compression\": {\n                    \"$ref\": \"#/$defs/CompressionType\"\
        ,\n                    \"description\": \"Compression algorithm to use for the bundle\"\n                },\n    \
        \            \"metadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : true,\n                    \"nullable\": true,\n                    \"description\": \"Custom metadata for the bundle
        (null if none)\"\n                }\n            }\n        },\n        \"Realm\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n                \"fantasia\"\
        ,\n                \"shared\"\n            ],\n            \"description\": \"Game realm the asset belongs to\"\n\
        \        },\n        \"CompressionType\": {\n            \"type\": \"string\",\n            \"enum\": [\n        \
        \        \"lz4\",\n                \"lzma\",\n                \"none\"\n            ],\n            \"description\"\
        : \"Compression algorithm for bundles\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateBundleResponse\"\
        ,\n    \"$defs\": {\n        \"CreateBundleResponse\": {\n            \"description\": \"Response with bundle creation
        status and estimated size\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n  \
        \          \"required\": [\n                \"bundleId\",\n                \"status\",\n                \"estimatedSize\"\
        \n            ],\n            \"properties\": {\n                \"bundleId\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Unique bundle identifier\"\n                },\n               \
        \ \"status\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n                    \
        \    \"queued\",\n                        \"processing\",\n                        \"ready\",\n                  \
        \      \"failed\"\n                    ],\n                    \"description\": \"Bundle creation status\"\n     \
        \           },\n                \"estimatedSize\": {\n                    \"type\": \"integer\",\n               \
        \     \"format\": \"int64\",\n                    \"description\": \"Estimated bundle size in bytes\"\n          \
        \      }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Create asset bundle from multiple assets\",\n    \"description\": \"Create
        a .bannou bundle containing multiple assets.\\nFor large bundles, processing is delegated to the processing pool.\\
        nCompletion notification sent via WebSocket event.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"createBundle\"\n}"
  /bundles/get:
    post:
      summary: Get bundle manifest and download URL
      description: |
        Retrieve bundle metadata and generate a pre-signed download URL.
        Supports both native .bannou format and ZIP conversion (cached).
      operationId: getBundle
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetBundleRequest'
      responses:
        '200':
          description: Bundle manifest with download URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BundleWithDownloadUrl'
        '404':
          description: Bundle not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetBundleRequest\"\
        ,\n    \"$defs\": {\n        \"GetBundleRequest\": {\n            \"description\": \"Request to retrieve bundle metadata
        and download URL\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n           \
        \ \"required\": [\n                \"bundleId\"\n            ],\n            \"properties\": {\n                \"\
        bundleId\": {\n                    \"type\": \"string\",\n                    \"description\": \"Bundle identifier
        to retrieve\"\n                },\n                \"format\": {\n                    \"$ref\": \"#/$defs/BundleFormat\"\
        ,\n                    \"description\": \"Desired download format (bannou or zip)\"\n                }\n         \
        \   }\n        },\n        \"BundleFormat\": {\n            \"type\": \"string\",\n            \"enum\": [\n     \
        \           \"bannou\",\n                \"zip\"\n            ],\n            \"description\": \"Bundle file format\"\
        \n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BundleWithDownloadUrl\"\
        ,\n    \"$defs\": {\n        \"BundleWithDownloadUrl\": {\n            \"description\": \"Bundle metadata combined
        with a pre-signed download URL\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"bundleId\",\n                \"version\",\n                \"downloadUrl\"\
        ,\n                \"format\",\n                \"expiresAt\",\n                \"size\",\n                \"assetCount\"\
        ,\n                \"fromCache\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Unique bundle identifier\"\n  \
        \              },\n                \"version\": {\n                    \"type\": \"string\",\n                   \
        \ \"description\": \"Bundle version string\"\n                },\n                \"downloadUrl\": {\n           \
        \         \"type\": \"string\",\n                    \"format\": \"uri\",\n                    \"description\": \"\
        Pre-signed URL for downloading the bundle\"\n                },\n                \"format\": {\n                 \
        \   \"$ref\": \"#/$defs/BundleFormat\",\n                    \"description\": \"Format of the downloadable bundle\"\
        \n                },\n                \"expiresAt\": {\n                    \"type\": \"string\",\n              \
        \      \"format\": \"date-time\",\n                    \"description\": \"When the download URL expires\"\n      \
        \          },\n                \"size\": {\n                    \"type\": \"integer\",\n                    \"format\"\
        : \"int64\",\n                    \"description\": \"Bundle file size in bytes\"\n                },\n           \
        \     \"assetCount\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Number
        of assets contained in the bundle\"\n                },\n                \"fromCache\": {\n                    \"\
        type\": \"boolean\",\n                    \"description\": \"True if ZIP format was served from conversion cache\"\
        \n                }\n            }\n        },\n        \"BundleFormat\": {\n            \"type\": \"string\",\n \
        \           \"enum\": [\n                \"bannou\",\n                \"zip\"\n            ],\n            \"description\"\
        : \"Bundle file format\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get bundle manifest and download URL\",\n    \"description\": \"Retrieve
        bundle metadata and generate a pre-signed download URL.\\nSupports both native .bannou format and ZIP conversion (cached).\\\
        n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getBundle\"\
        \n}"
  /bundles/upload/request:
    post:
      summary: Request upload URL for a pre-made bundle
      description: |
        Upload a pre-built bundle (.bannou or .zip format).
        After upload, the bundle undergoes validation before registration.
      operationId: requestBundleUpload
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BundleUploadRequest'
      responses:
        '200':
          description: Upload URL generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadResponse'
        '400':
          description: Invalid filename or size
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BundleUploadRequest\"\
        ,\n    \"$defs\": {\n        \"BundleUploadRequest\": {\n            \"description\": \"Request to upload a pre-built
        asset bundle file\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n          \
        \  \"required\": [\n                \"filename\",\n                \"size\",\n                \"owner\"\n        \
        \    ],\n            \"properties\": {\n                \"owner\": {\n                    \"type\": \"string\",\n\
        \                    \"description\": \"Owner of this bundle upload. NOT a session ID.\\nFor user-initiated uploads:
        the accountId (UUID format).\\nFor service-initiated uploads: the service name (e.g., \\\"orchestrator\\\").\\n\"\n\
        \                },\n                \"filename\": {\n                    \"type\": \"string\",\n                \
        \    \"description\": \"Must end with .bannou or .zip\"\n                },\n                \"size\": {\n       \
        \             \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\"\
        : \"Bundle file size in bytes\"\n                },\n                \"manifestPreview\": {\n                    \"\
        allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/BundleManifestPreview\"\n \
        \                       }\n                    ],\n                    \"nullable\": true,\n                    \"\
        description\": \"Optional preview of bundle manifest for validation\"\n                }\n            }\n        },\n\
        \        \"BundleManifestPreview\": {\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"description\": \"Preview of bundle manifest for validation\",\n            \"required\": [\n      \
        \          \"bundleId\",\n                \"version\",\n                \"assetCount\"\n            ],\n         \
        \   \"properties\": {\n                \"bundleId\": {\n                    \"type\": \"string\",\n              \
        \      \"description\": \"Bundle identifier from the manifest\"\n                },\n                \"version\":
        {\n                    \"type\": \"string\",\n                    \"description\": \"Bundle version from the manifest\"\
        \n                },\n                \"assetCount\": {\n                    \"type\": \"integer\",\n            \
        \        \"description\": \"Number of assets declared in the manifest\"\n                }\n            }\n      \
        \  }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UploadResponse\"\
        ,\n    \"$defs\": {\n        \"UploadResponse\": {\n            \"description\": \"Response containing pre-signed
        URL and configuration for uploading an asset\",\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"uploadId\",\n                \"uploadUrl\",\n           \
        \     \"expiresAt\"\n            ],\n            \"properties\": {\n                \"uploadId\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"\
        Unique upload session identifier\"\n                },\n                \"uploadUrl\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"uri\",\n                    \"description\": \"Pre-signed URL for
        uploading the file\"\n                },\n                \"expiresAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"description\": \"When the upload URL expires\"\
        \n                },\n                \"multipart\": {\n                    \"$ref\": \"#/$defs/MultipartConfig\"\
        ,\n                    \"description\": \"Configuration for multipart uploads if file size requires it\"\n       \
        \         },\n                \"requiredHeaders\": {\n                    \"type\": \"object\",\n                \
        \    \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n         \
        \           \"description\": \"Headers the client must include when uploading to the pre-signed URL\"\n          \
        \      }\n            }\n        },\n        \"MultipartConfig\": {\n            \"description\": \"Configuration
        for multipart uploads of large files\",\n            \"type\": \"object\",\n            \"additionalProperties\":
        false,\n            \"properties\": {\n                \"required\": {\n                    \"type\": \"boolean\"\
        ,\n                    \"description\": \"Whether multipart upload is required for this file size\"\n            \
        \    },\n                \"partSize\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Size of each part in bytes\"\n                },\n                \"maxParts\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Maximum number of parts\"\n                },\n           \
        \     \"uploadUrls\": {\n                    \"type\": \"array\",\n                    \"nullable\": true,\n     \
        \               \"description\": \"Pre-signed URLs for each part of the multipart upload\",\n                    \"\
        items\": {\n                        \"$ref\": \"#/$defs/PartUploadInfo\"\n                    }\n                }\n\
        \            }\n        },\n        \"PartUploadInfo\": {\n            \"description\": \"Upload information for a
        single part in a multipart upload\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"partNumber\",\n                \"uploadUrl\"\n            ],\n   \
        \         \"properties\": {\n                \"partNumber\": {\n                    \"type\": \"integer\",\n     \
        \               \"description\": \"Part number (1-based)\"\n                },\n                \"uploadUrl\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"uri\",\n                    \"description\"\
        : \"Pre-signed URL for uploading this part\"\n                },\n                \"minSize\": {\n               \
        \     \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"\
        Minimum size for this part\"\n                },\n                \"maxSize\": {\n                    \"type\": \"\
        integer\",\n                    \"format\": \"int64\",\n                    \"description\": \"Maximum size for this
        part\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Request upload URL for a pre-made bundle\",\n    \"description\": \"Upload
        a pre-built bundle (.bannou or .zip format).\\nAfter upload, the bundle undergoes validation before registration.\\\
        n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"requestBundleUpload\"\
        \n}"
  /bundles/metabundle/create:
    post:
      summary: Create metabundle from source bundles
      description: |
        Compose a metabundle by extracting and repackaging assets from multiple
        source bundles. The resulting metabundle is a complete physical copy with
        provenance metadata tracking the source bundles.

        Assets are deduplicated by content hash. If the same asset ID exists in
        multiple source bundles with different content hashes, the request fails
        with conflict details.
      operationId: createMetabundle
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMetabundleRequest'
      responses:
        '200':
          description: Metabundle created or queued for creation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateMetabundleResponse'
        '400':
          description: Invalid request or asset conflicts detected
        '404':
          description: One or more source bundles not found
        '409':
          description: Metabundle ID already exists
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateMetabundleRequest\"\
        ,\n    \"$defs\": {\n        \"CreateMetabundleRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to create a metabundle from source bundles and/or standalone assets.\\
        nAt least one of sourceBundleIds or standaloneAssetIds must be provided.\\nThis enables packaging behaviors/scripts
        with 3D assets as a complete unit.\\n\",\n            \"required\": [\n                \"metabundleId\",\n       \
        \         \"owner\",\n                \"realm\"\n            ],\n            \"properties\": {\n                \"\
        metabundleId\": {\n                    \"type\": \"string\",\n                    \"description\": \"Unique identifier
        for the new metabundle\"\n                },\n                \"sourceBundleIds\": {\n                    \"type\"\
        : \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n                   \
        \ },\n                    \"nullable\": true,\n                    \"description\": \"Source bundle IDs to pull assets
        from. Can cherry-pick specific\\nassets using assetFilter, or include all if assetFilter is null.\\n\"\n         \
        \       },\n                \"standaloneAssetIds\": {\n                    \"type\": \"array\",\n                \
        \    \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\"\
        : true,\n                    \"description\": \"Individual asset IDs (not in bundles) to include directly.\\nUseful
        for including behaviors, scripts, or metadata files\\nalongside bundled 3D assets.\\n\"\n                },\n    \
        \            \"version\": {\n                    \"type\": \"string\",\n                    \"default\": \"1.0.0\"\
        ,\n                    \"description\": \"Metabundle version string\"\n                },\n                \"owner\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Owner of this metabundle. NOT
        a session ID.\\nFor user-initiated: the accountId (UUID format).\\nFor service-initiated: the service name.\\n\"\n\
        \                },\n                \"realm\": {\n                    \"$ref\": \"#/$defs/Realm\",\n            \
        \        \"description\": \"Game realm for this metabundle\"\n                },\n                \"description\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Human-readable description\"\n                },\n                \"assetFilter\": {\n                    \"type\"\
        : \"array\",\n                    \"nullable\": true,\n                    \"items\": {\n                        \"\
        type\": \"string\"\n                    },\n                    \"description\": \"Optional subset of asset IDs to
        include FROM SOURCE BUNDLES.\\nIf null, all assets from source bundles are included.\\nStandalone assets are always
        included regardless of this filter.\\n\"\n                },\n                \"metadata\": {\n                  \
        \  \"type\": \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Custom metadata for the metabundle\"\n                }\n            }\n \
        \       },\n        \"Realm\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"omega\"\
        ,\n                \"arcadia\",\n                \"fantasia\",\n                \"shared\"\n            ],\n     \
        \       \"description\": \"Game realm the asset belongs to\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateMetabundleResponse\"\
        ,\n    \"$defs\": {\n        \"CreateMetabundleResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Response from metabundle creation.\\nFor synchronous creation (small jobs):
        status=ready with downloadUrl.\\nFor async creation (large jobs): status=queued with jobId for polling.\\n\",\n  \
        \          \"required\": [\n                \"metabundleId\",\n                \"status\",\n                \"assetCount\"\
        ,\n                \"sizeBytes\"\n            ],\n            \"properties\": {\n                \"metabundleId\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Metabundle identifier\"\n \
        \               },\n                \"jobId\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\": \"Job ID for async
        processing. Only present when status is 'queued' or 'processing'.\\nUse /bundles/job/status to poll for completion,
        or wait for\\nMetabundleCreationCompleteEvent via WebSocket.\\n\"\n                },\n                \"status\"\
        : {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"queued\"\
        ,\n                        \"processing\",\n                        \"ready\",\n                        \"failed\"\
        \n                    ],\n                    \"description\": \"Creation status.\\n- queued: Job accepted for async
        processing (poll with jobId)\\n- processing: Job is actively running\\n- ready: Metabundle created and available for
        download\\n- failed: Creation failed (see conflicts for details)\\n\"\n                },\n                \"downloadUrl\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"uri\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Pre-signed download URL (only present when status is 'ready')\"\n\
        \                },\n                \"assetCount\": {\n                    \"type\": \"integer\",\n             \
        \       \"description\": \"Number of assets in the metabundle\"\n                },\n                \"standaloneAssetCount\"\
        : {\n                    \"type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Number of standalone assets included directly (not from bundles)\"\n                },\n                \"sizeBytes\"\
        : {\n                    \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"\
        description\": \"Total size in bytes\"\n                },\n                \"sourceBundles\": {\n               \
        \     \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/SourceBundleReference\"\
        \n                    },\n                    \"description\": \"Provenance data for the metabundle\"\n          \
        \      },\n                \"conflicts\": {\n                    \"type\": \"array\",\n                    \"nullable\"\
        : true,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AssetConflict\"\n         \
        \           },\n                    \"description\": \"Present if creation failed due to asset conflicts\"\n     \
        \           }\n            }\n        },\n        \"SourceBundleReference\": {\n            \"type\": \"object\",\n\
        \            \"additionalProperties\": false,\n            \"description\": \"Provenance reference to a source bundle
        used in metabundle creation\",\n            \"required\": [\n                \"bundleId\",\n                \"version\"\
        ,\n                \"assetIds\",\n                \"contentHash\"\n            ],\n            \"properties\": {\n\
        \                \"bundleId\": {\n                    \"type\": \"string\",\n                    \"description\":
        \"Source bundle identifier\"\n                },\n                \"version\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Version of source bundle at composition time\"\n               \
        \ },\n                \"assetIds\": {\n                    \"type\": \"array\",\n                    \"items\": {\n\
        \                        \"type\": \"string\"\n                    },\n                    \"description\": \"Asset
        IDs contributed from this source bundle\"\n                },\n                \"contentHash\": {\n              \
        \      \"type\": \"string\",\n                    \"description\": \"Hash of source bundle at composition time (for
        integrity verification)\"\n                }\n            }\n        },\n        \"AssetConflict\": {\n          \
        \  \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"description\": \"Describes a
        conflict when the same asset ID has different content hashes\",\n            \"required\": [\n                \"assetId\"\
        ,\n                \"conflictingBundles\"\n            ],\n            \"properties\": {\n                \"assetId\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"The conflicting asset identifier\"\
        \n                },\n                \"conflictingBundles\": {\n                    \"type\": \"array\",\n      \
        \              \"items\": {\n                        \"$ref\": \"#/$defs/ConflictingBundleEntry\"\n              \
        \      },\n                    \"description\": \"Bundles with conflicting versions of this asset\"\n            \
        \    }\n            }\n        },\n        \"ConflictingBundleEntry\": {\n            \"type\": \"object\",\n    \
        \        \"additionalProperties\": false,\n            \"description\": \"A bundle entry in an asset conflict\",\n\
        \            \"required\": [\n                \"bundleId\",\n                \"contentHash\"\n            ],\n   \
        \         \"properties\": {\n                \"bundleId\": {\n                    \"type\": \"string\",\n        \
        \            \"description\": \"Bundle containing this version\"\n                },\n                \"contentHash\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Content hash of asset in this
        bundle\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Create metabundle from source bundles\",\n    \"description\": \"Compose
        a metabundle by extracting and repackaging assets from multiple\\nsource bundles. The resulting metabundle is a complete
        physical copy with\\nprovenance metadata tracking the source bundles.\\n\\nAssets are deduplicated by content hash.
        If the same asset ID exists in\\nmultiple source bundles with different content hashes, the request fails\\nwith conflict
        details.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"\
        createMetabundle\"\n}"
  /bundles/job/status:
    post:
      summary: Get async metabundle job status
      description: |
        Poll the status of an async metabundle creation job.
        Use the jobId returned from createMetabundle when status was 'queued'.

        Clients can either poll this endpoint or wait for the
        MetabundleCreationCompleteEvent via WebSocket for completion notification.
      operationId: getJobStatus
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetJobStatusRequest'
      responses:
        '200':
          description: Job status retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetJobStatusResponse'
        '404':
          description: Job not found or expired
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetJobStatusRequest\"\
        ,\n    \"$defs\": {\n        \"GetJobStatusRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to get the status of an async metabundle creation job\",\n      \
        \      \"required\": [\n                \"jobId\"\n            ],\n            \"properties\": {\n               \
        \ \"jobId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Job ID from the createMetabundle response\"\n                }\n            }\n     \
        \   }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetJobStatusResponse\"\
        ,\n    \"$defs\": {\n        \"GetJobStatusResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Status of an async metabundle creation job.\\nWhen status is 'ready', the
        response includes the full metabundle details.\\n\",\n            \"required\": [\n                \"jobId\",\n  \
        \              \"metabundleId\",\n                \"status\"\n            ],\n            \"properties\": {\n    \
        \            \"jobId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n\
        \                    \"description\": \"Job identifier\"\n                },\n                \"metabundleId\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Metabundle identifier being created\"\
        \n                },\n                \"status\": {\n                    \"type\": \"string\",\n                 \
        \   \"enum\": [\n                        \"queued\",\n                        \"processing\",\n                  \
        \      \"ready\",\n                        \"failed\",\n                        \"cancelled\"\n                  \
        \  ],\n                    \"description\": \"Current job status.\\n- queued: Waiting for processing resources\\n-
        processing: Actively being processed\\n- ready: Completed successfully\\n- failed: Creation failed\\n- cancelled:
        Job was cancelled\\n\"\n                },\n                \"progress\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 0,\n                    \"maximum\": 100,\n                    \"nullable\": true,\n\
        \                    \"description\": \"Progress percentage (0-100) when status is 'processing'\"\n              \
        \  },\n                \"downloadUrl\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uri\",\n                    \"nullable\": true,\n                    \"description\": \"Pre-signed download URL
        (only when status is 'ready')\"\n                },\n                \"assetCount\": {\n                    \"type\"\
        : \"integer\",\n                    \"nullable\": true,\n                    \"description\": \"Number of assets in
        metabundle (when ready)\"\n                },\n                \"standaloneAssetCount\": {\n                    \"\
        type\": \"integer\",\n                    \"nullable\": true,\n                    \"description\": \"Number of standalone
        assets included (when ready)\"\n                },\n                \"sizeBytes\": {\n                    \"type\"\
        : \"integer\",\n                    \"format\": \"int64\",\n                    \"nullable\": true,\n            \
        \        \"description\": \"Total size in bytes (when ready)\"\n                },\n                \"sourceBundles\"\
        : {\n                    \"type\": \"array\",\n                    \"nullable\": true,\n                    \"items\"\
        : {\n                        \"$ref\": \"#/$defs/SourceBundleReference\"\n                    },\n               \
        \     \"description\": \"Provenance data (when ready)\"\n                },\n                \"errorCode\": {\n  \
        \                  \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Error code (when status is 'failed')\"\n                },\n                \"errorMessage\": {\n            \
        \        \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Human-readable
        error description (when status is 'failed')\"\n                },\n                \"createdAt\": {\n            \
        \        \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\":
        true,\n                    \"description\": \"When the job was created\"\n                },\n                \"updatedAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When the job was last updated\"\n                },\n\
        \                \"processingTimeMs\": {\n                    \"type\": \"integer\",\n                    \"format\"\
        : \"int64\",\n                    \"nullable\": true,\n                    \"description\": \"Total processing time
        in milliseconds (when complete)\"\n                }\n            }\n        },\n        \"SourceBundleReference\"\
        : {\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"description\"\
        : \"Provenance reference to a source bundle used in metabundle creation\",\n            \"required\": [\n        \
        \        \"bundleId\",\n                \"version\",\n                \"assetIds\",\n                \"contentHash\"\
        \n            ],\n            \"properties\": {\n                \"bundleId\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Source bundle identifier\"\n                },\n               \
        \ \"version\": {\n                    \"type\": \"string\",\n                    \"description\": \"Version of source
        bundle at composition time\"\n                },\n                \"assetIds\": {\n                    \"type\": \"\
        array\",\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n\
        \                    \"description\": \"Asset IDs contributed from this source bundle\"\n                },\n    \
        \            \"contentHash\": {\n                    \"type\": \"string\",\n                    \"description\": \"\
        Hash of source bundle at composition time (for integrity verification)\"\n                }\n            }\n     \
        \   }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get async metabundle job status\",\n    \"description\": \"Poll the status
        of an async metabundle creation job.\\nUse the jobId returned from createMetabundle when status was 'queued'.\\n\\
        nClients can either poll this endpoint or wait for the\\nMetabundleCreationCompleteEvent via WebSocket for completion
        notification.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"getJobStatus\"\n}"
  /bundles/job/cancel:
    post:
      summary: Cancel an async metabundle job
      description: |
        Cancel a pending or processing metabundle creation job.
        Jobs that are already completed (ready or failed) cannot be cancelled.

        Successfully cancelled jobs will emit a MetabundleCreationCompleteEvent
        with status 'cancelled' via WebSocket.
      operationId: cancelJob
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CancelJobRequest'
      responses:
        '200':
          description: Job cancellation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CancelJobResponse'
        '404':
          description: Job not found or expired
        '409':
          description: Job cannot be cancelled (already completed)
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CancelJobRequest\"\
        ,\n    \"$defs\": {\n        \"CancelJobRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to cancel an async metabundle creation job\",\n            \"required\"\
        : [\n                \"jobId\"\n            ],\n            \"properties\": {\n                \"jobId\": {\n    \
        \                \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Job ID from the createMetabundle response\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CancelJobResponse\"\
        ,\n    \"$defs\": {\n        \"CancelJobResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Result of job cancellation attempt\",\n            \"required\": [\n    \
        \            \"jobId\",\n                \"cancelled\",\n                \"status\"\n            ],\n            \"\
        properties\": {\n                \"jobId\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"uuid\",\n                    \"description\": \"Job identifier\"\n                },\n                \"cancelled\"\
        : {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether the job was successfully
        cancelled\"\n                },\n                \"status\": {\n                    \"type\": \"string\",\n      \
        \              \"enum\": [\n                        \"queued\",\n                        \"processing\",\n       \
        \                 \"ready\",\n                        \"failed\",\n                        \"cancelled\"\n       \
        \             ],\n                    \"description\": \"Current job status after cancellation attempt\"\n       \
        \         },\n                \"message\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Additional context about the cancellation result\"\n             \
        \   }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Cancel an async metabundle job\",\n    \"description\": \"Cancel a pending
        or processing metabundle creation job.\\nJobs that are already completed (ready or failed) cannot be cancelled.\\\
        n\\nSuccessfully cancelled jobs will emit a MetabundleCreationCompleteEvent\\nwith status 'cancelled' via WebSocket.\\\
        n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"cancelJob\"\
        \n}"
  /bundles/resolve:
    post:
      summary: Compute optimal bundles for requested assets
      description: |
        Given a list of asset IDs, compute the optimal set of bundles to download
        to obtain all requested assets with minimal transfers.

        The algorithm uses greedy set-cover optimization:
        1. Find all bundles containing requested assets
        2. Select bundles that cover the most uncovered assets
        3. Prefer metabundles when coverage is equal (tie-breaker)
        4. Include standalone assets for any remaining unresolved IDs

        Returns pre-signed download URLs for all selected bundles and assets.
      operationId: resolveBundles
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResolveBundlesRequest'
      responses:
        '200':
          description: Resolution complete with download URLs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResolveBundlesResponse'
        '400':
          description: Invalid request
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ResolveBundlesRequest\"\
        ,\n    \"$defs\": {\n        \"ResolveBundlesRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to resolve optimal bundle downloads for requested assets\",\n   \
        \         \"required\": [\n                \"assetIds\",\n                \"realm\"\n            ],\n            \"\
        properties\": {\n                \"assetIds\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"Platform asset IDs to resolve\"\n                },\n                \"realm\": {\n                    \"$ref\"\
        : \"#/$defs/Realm\",\n                    \"description\": \"Game realm to search within\"\n                },\n \
        \               \"preferMetabundles\": {\n                    \"type\": \"boolean\",\n                    \"default\"\
        : true,\n                    \"description\": \"Prefer metabundles when coverage is equal\"\n                },\n\
        \                \"includeStandalone\": {\n                    \"type\": \"boolean\",\n                    \"default\"\
        : true,\n                    \"description\": \"Include standalone assets not in any bundle\"\n                },\n\
        \                \"maxBundles\": {\n                    \"type\": \"integer\",\n                    \"nullable\":
        true,\n                    \"description\": \"Maximum number of bundles to return (optimization limit)\"\n       \
        \         }\n            }\n        },\n        \"Realm\": {\n            \"type\": \"string\",\n            \"enum\"\
        : [\n                \"omega\",\n                \"arcadia\",\n                \"fantasia\",\n                \"shared\"\
        \n            ],\n            \"description\": \"Game realm the asset belongs to\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ResolveBundlesResponse\"\
        ,\n    \"$defs\": {\n        \"ResolveBundlesResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Optimal bundle set for requested assets\",\n            \"required\": [\n\
        \                \"bundles\",\n                \"standaloneAssets\",\n                \"coverage\"\n            ],\n\
        \            \"properties\": {\n                \"bundles\": {\n                    \"type\": \"array\",\n       \
        \             \"items\": {\n                        \"$ref\": \"#/$defs/ResolvedBundle\"\n                    },\n\
        \                    \"description\": \"Bundles to download\"\n                },\n                \"standaloneAssets\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/ResolvedAsset\"\n                    },\n                    \"description\": \"Individual assets to download\"\
        \n                },\n                \"coverage\": {\n                    \"$ref\": \"#/$defs/CoverageAnalysis\"\
        ,\n                    \"description\": \"Coverage statistics\"\n                },\n                \"unresolved\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"Asset IDs that couldn't be found (null if all resolved)\"\n                }\n            }\n        },\n    \
        \    \"ResolvedBundle\": {\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n    \
        \        \"description\": \"A bundle selected for download in resolution\",\n            \"required\": [\n       \
        \         \"bundleId\",\n                \"bundleType\",\n                \"downloadUrl\",\n                \"expiresAt\"\
        ,\n                \"size\",\n                \"assetsProvided\"\n            ],\n            \"properties\": {\n\
        \                \"bundleId\": {\n                    \"type\": \"string\",\n                    \"description\":
        \"Bundle identifier\"\n                },\n                \"bundleType\": {\n                    \"$ref\": \"#/$defs/BundleType\"\
        ,\n                    \"description\": \"Whether source or metabundle\"\n                },\n                \"version\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Bundle version\"\n                },\n                \"downloadUrl\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uri\",\n                    \"description\": \"Pre-signed download URL\"\n  \
        \              },\n                \"expiresAt\": {\n                    \"type\": \"string\",\n                 \
        \   \"format\": \"date-time\",\n                    \"description\": \"When the download URL expires\"\n         \
        \       },\n                \"size\": {\n                    \"type\": \"integer\",\n                    \"format\"\
        : \"int64\",\n                    \"description\": \"Bundle file size in bytes\"\n                },\n           \
        \     \"assetsProvided\": {\n                    \"type\": \"array\",\n                    \"items\": {\n        \
        \                \"type\": \"string\"\n                    },\n                    \"description\": \"Which of the
        requested assets this bundle provides\"\n                }\n            }\n        },\n        \"BundleType\": {\n\
        \            \"type\": \"string\",\n            \"enum\": [\n                \"source\",\n                \"metabundle\"\
        \n            ],\n            \"description\": \"Bundle category:\\n- source: Original bundle (uploaded or server-created
        from assets)\\n- metabundle: Composed from other bundles server-side\\n\"\n        },\n        \"ResolvedAsset\":
        {\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"description\": \"\
        A standalone asset selected for download\",\n            \"required\": [\n                \"assetId\",\n         \
        \       \"downloadUrl\",\n                \"expiresAt\",\n                \"size\"\n            ],\n            \"\
        properties\": {\n                \"assetId\": {\n                    \"type\": \"string\",\n                    \"\
        description\": \"Asset identifier\"\n                },\n                \"downloadUrl\": {\n                    \"\
        type\": \"string\",\n                    \"format\": \"uri\",\n                    \"description\": \"Pre-signed download
        URL\"\n                },\n                \"expiresAt\": {\n                    \"type\": \"string\",\n         \
        \           \"format\": \"date-time\",\n                    \"description\": \"When the download URL expires\"\n \
        \               },\n                \"size\": {\n                    \"type\": \"integer\",\n                    \"\
        format\": \"int64\",\n                    \"description\": \"Asset file size in bytes\"\n                },\n    \
        \            \"contentHash\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"SHA256 hash of asset content\"\n                }\n            }\n       \
        \ },\n        \"CoverageAnalysis\": {\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n\
        \            \"description\": \"Statistics about asset resolution coverage\",\n            \"required\": [\n     \
        \           \"totalRequested\",\n                \"resolvedViaBundles\",\n                \"resolvedStandalone\",\n\
        \                \"unresolvedCount\"\n            ],\n            \"properties\": {\n                \"totalRequested\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Total number of assets requested\"\
        \n                },\n                \"resolvedViaBundles\": {\n                    \"type\": \"integer\",\n    \
        \                \"description\": \"Assets resolved through bundle downloads\"\n                },\n             \
        \   \"resolvedStandalone\": {\n                    \"type\": \"integer\",\n                    \"description\": \"\
        Assets resolved as standalone downloads\"\n                },\n                \"unresolvedCount\": {\n          \
        \          \"type\": \"integer\",\n                    \"description\": \"Assets that could not be found\"\n     \
        \           },\n                \"bundleEfficiency\": {\n                    \"type\": \"number\",\n             \
        \       \"format\": \"float\",\n                    \"nullable\": true,\n                    \"description\": \"Ratio
        of assets provided to bundle downloads (higher is better)\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Compute optimal bundles for requested assets\",\n    \"description\": \"\
        Given a list of asset IDs, compute the optimal set of bundles to download\\nto obtain all requested assets with minimal
        transfers.\\n\\nThe algorithm uses greedy set-cover optimization:\\n1. Find all bundles containing requested assets\\
        n2. Select bundles that cover the most uncovered assets\\n3. Prefer metabundles when coverage is equal (tie-breaker)\\
        n4. Include standalone assets for any remaining unresolved IDs\\n\\nReturns pre-signed download URLs for all selected
        bundles and assets.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\"\
        : \"resolveBundles\"\n}"
  /bundles/query/by-asset:
    post:
      summary: Find all bundles containing a specific asset
      description: |
        Query the reverse index to find all bundles (source and metabundle)
        that contain a specific asset ID. Useful for understanding asset
        distribution and debugging resolution issues.
      operationId: queryBundlesByAsset
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryBundlesByAssetRequest'
      responses:
        '200':
          description: Bundles containing the asset
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryBundlesByAssetResponse'
        '400':
          description: Invalid request
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryBundlesByAssetRequest\"\
        ,\n    \"$defs\": {\n        \"QueryBundlesByAssetRequest\": {\n            \"type\": \"object\",\n            \"\
        additionalProperties\": false,\n            \"description\": \"Request to find bundles containing a specific asset\"\
        ,\n            \"required\": [\n                \"assetId\",\n                \"realm\"\n            ],\n        \
        \    \"properties\": {\n                \"assetId\": {\n                    \"type\": \"string\",\n              \
        \      \"description\": \"Platform asset ID to search for\"\n                },\n                \"realm\": {\n  \
        \                  \"$ref\": \"#/$defs/Realm\",\n                    \"description\": \"Game realm to search within\"\
        \n                },\n                \"bundleType\": {\n                    \"allOf\": [\n                      \
        \  {\n                            \"$ref\": \"#/$defs/BundleType\"\n                        }\n                  \
        \  ],\n                    \"nullable\": true,\n                    \"description\": \"Filter by bundle type (optional,
        null for all types)\"\n                },\n                \"limit\": {\n                    \"type\": \"integer\"\
        ,\n                    \"default\": 50,\n                    \"description\": \"Maximum results to return\"\n    \
        \            },\n                \"offset\": {\n                    \"type\": \"integer\",\n                    \"\
        default\": 0,\n                    \"description\": \"Pagination offset\"\n                }\n            }\n    \
        \    },\n        \"Realm\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"omega\"\
        ,\n                \"arcadia\",\n                \"fantasia\",\n                \"shared\"\n            ],\n     \
        \       \"description\": \"Game realm the asset belongs to\"\n        },\n        \"BundleType\": {\n            \"\
        type\": \"string\",\n            \"enum\": [\n                \"source\",\n                \"metabundle\"\n      \
        \      ],\n            \"description\": \"Bundle category:\\n- source: Original bundle (uploaded or server-created
        from assets)\\n- metabundle: Composed from other bundles server-side\\n\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryBundlesByAssetResponse\"\
        ,\n    \"$defs\": {\n        \"QueryBundlesByAssetResponse\": {\n            \"type\": \"object\",\n            \"\
        additionalProperties\": false,\n            \"description\": \"Bundles containing the requested asset\",\n       \
        \     \"required\": [\n                \"assetId\",\n                \"bundles\",\n                \"total\",\n  \
        \              \"limit\",\n                \"offset\"\n            ],\n            \"properties\": {\n           \
        \     \"assetId\": {\n                    \"type\": \"string\",\n                    \"description\": \"The queried
        asset ID\"\n                },\n                \"bundles\": {\n                    \"type\": \"array\",\n       \
        \             \"items\": {\n                        \"$ref\": \"#/$defs/BundleSummary\"\n                    },\n\
        \                    \"description\": \"Bundles containing this asset\"\n                },\n                \"total\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Total matching bundles\"\n\
        \                },\n                \"limit\": {\n                    \"type\": \"integer\",\n                  \
        \  \"description\": \"Page size\"\n                },\n                \"offset\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Page offset\"\n                }\n            }\n        },\n\
        \        \"BundleSummary\": {\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n \
        \           \"description\": \"Summary information about a bundle\",\n            \"required\": [\n              \
        \  \"bundleId\",\n                \"bundleType\",\n                \"version\",\n                \"assetCount\",\n\
        \                \"realm\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n     \
        \               \"type\": \"string\",\n                    \"description\": \"Bundle identifier\"\n              \
        \  },\n                \"bundleType\": {\n                    \"$ref\": \"#/$defs/BundleType\",\n                \
        \    \"description\": \"Source or metabundle\"\n                },\n                \"version\": {\n             \
        \       \"type\": \"string\",\n                    \"description\": \"Bundle version\"\n                },\n     \
        \           \"assetCount\": {\n                    \"type\": \"integer\",\n                    \"description\": \"\
        Number of assets in bundle\"\n                },\n                \"sizeBytes\": {\n                    \"type\":
        \"integer\",\n                    \"format\": \"int64\",\n                    \"nullable\": true,\n              \
        \      \"description\": \"Bundle file size\"\n                },\n                \"realm\": {\n                 \
        \   \"$ref\": \"#/$defs/Realm\",\n                    \"description\": \"Game realm\"\n                },\n      \
        \          \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"When the bundle was created\"\n\
        \                }\n            }\n        },\n        \"BundleType\": {\n            \"type\": \"string\",\n    \
        \        \"enum\": [\n                \"source\",\n                \"metabundle\"\n            ],\n            \"\
        description\": \"Bundle category:\\n- source: Original bundle (uploaded or server-created from assets)\\n- metabundle:
        Composed from other bundles server-side\\n\"\n        },\n        \"Realm\": {\n            \"type\": \"string\",\n\
        \            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n                \"fantasia\",\n\
        \                \"shared\"\n            ],\n            \"description\": \"Game realm the asset belongs to\"\n  \
        \      }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Find all bundles containing a specific asset\",\n    \"description\": \"\
        Query the reverse index to find all bundles (source and metabundle)\\nthat contain a specific asset ID. Useful for
        understanding asset\\ndistribution and debugging resolution issues.\\n\",\n    \"tags\": [\n        \"Bundles\"\n\
        \    ],\n    \"deprecated\": false,\n    \"operationId\": \"queryBundlesByAsset\"\n}"
  /bundles/update:
    post:
      summary: Update bundle metadata
      description: |
        Update metadata for an existing bundle (name, description, tags).
        Does not modify bundle contents - for that, create a new bundle.

        Increments the bundle version and records the change in version history.
        Only the bundle owner or admin can update.
      operationId: updateBundle
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateBundleRequest'
      responses:
        '200':
          description: Bundle updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateBundleResponse'
        '400':
          description: Invalid request
        '403':
          description: Not authorized to update this bundle
        '404':
          description: Bundle not found or deleted
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateBundleRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateBundleRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to update bundle metadata\",\n            \"required\": [\n     \
        \           \"bundleId\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n       \
        \             \"type\": \"string\",\n                    \"description\": \"Bundle identifier to update\"\n      \
        \          },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"New bundle name (null to leave unchanged)\"\n                },\n\
        \                \"description\": {\n                    \"type\": \"string\",\n                    \"nullable\":
        true,\n                    \"description\": \"New bundle description (null to leave unchanged)\"\n               \
        \ },\n                \"tags\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Replace all tags with these (null to leave unchanged)\"\n                },\n\
        \                \"addTags\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Tags to add (merged with existing)\"\n                },\n               \
        \ \"removeTags\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                \
        \        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n                 \
        \   \"description\": \"Tag keys to remove\"\n                },\n                \"reason\": {\n                 \
        \   \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Optional
        reason for the update (recorded in version history)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateBundleResponse\"\
        ,\n    \"$defs\": {\n        \"UpdateBundleResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Result of bundle update operation\",\n            \"required\": [\n     \
        \           \"bundleId\",\n                \"version\",\n                \"previousVersion\",\n                \"\
        changes\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n                    \"\
        type\": \"string\",\n                    \"description\": \"Updated bundle identifier\"\n                },\n    \
        \            \"version\": {\n                    \"type\": \"integer\",\n                    \"description\": \"New
        version number after update\"\n                },\n                \"previousVersion\": {\n                    \"\
        type\": \"integer\",\n                    \"description\": \"Version number before update\"\n                },\n\
        \                \"changes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n    \
        \                    \"type\": \"string\"\n                    },\n                    \"description\": \"List of
        changes made (e.g., \\\"name changed\\\", \\\"tag 'env' added\\\")\"\n                },\n                \"updatedAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"When the update occurred\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Update bundle metadata\",\n    \"description\": \"Update metadata for an
        existing bundle (name, description, tags).\\nDoes not modify bundle contents - for that, create a new bundle.\\n\\
        nIncrements the bundle version and records the change in version history.\\nOnly the bundle owner or admin can update.\\\
        n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updateBundle\"\
        \n}"
  /bundles/delete:
    post:
      summary: Soft-delete a bundle
      description: |
        Soft-delete a bundle, marking it as deleted but retaining data
        for the configured retention period (default 30 days).

        Deleted bundles are excluded from resolution and queries by default.
        Use permanent=true for immediate, unrecoverable deletion (admin only).

        Only the bundle owner or admin can delete.
      operationId: deleteBundle
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteBundleRequest'
      responses:
        '200':
          description: Bundle deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteBundleResponse'
        '400':
          description: Invalid request
        '403':
          description: Not authorized to delete this bundle
        '404':
          description: Bundle not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteBundleRequest\"\
        ,\n    \"$defs\": {\n        \"DeleteBundleRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to delete a bundle\",\n            \"required\": [\n            \
        \    \"bundleId\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n              \
        \      \"type\": \"string\",\n                    \"description\": \"Bundle identifier to delete\"\n             \
        \   },\n                \"permanent\": {\n                    \"type\": \"boolean\",\n                    \"default\"\
        : false,\n                    \"description\": \"If true, permanently delete (admin only). If false, soft-delete.\"\
        \n                },\n                \"reason\": {\n                    \"type\": \"string\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"Optional reason for deletion (recorded in version
        history)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteBundleResponse\"\
        ,\n    \"$defs\": {\n        \"DeleteBundleResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Result of bundle deletion\",\n            \"required\": [\n             \
        \   \"bundleId\",\n                \"status\",\n                \"deletedAt\"\n            ],\n            \"properties\"\
        : {\n                \"bundleId\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Deleted bundle identifier\"\n                },\n                \"status\": {\n                    \"type\":
        \"string\",\n                    \"enum\": [\n                        \"deleted\",\n                        \"permanently_deleted\"\
        \n                    ],\n                    \"description\": \"Deletion status\"\n                },\n         \
        \       \"deletedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\
        ,\n                    \"description\": \"When the bundle was deleted\"\n                },\n                \"retentionUntil\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"nullable\": true,\n                    \"description\": \"When soft-deleted bundle will be permanently removed
        (null for permanent deletes)\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Soft-delete a bundle\",\n    \"description\": \"Soft-delete a bundle, marking
        it as deleted but retaining data\\nfor the configured retention period (default 30 days).\\n\\nDeleted bundles are
        excluded from resolution and queries by default.\\nUse permanent=true for immediate, unrecoverable deletion (admin
        only).\\n\\nOnly the bundle owner or admin can delete.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"\
        deprecated\": false,\n    \"operationId\": \"deleteBundle\"\n}"
  /bundles/restore:
    post:
      summary: Restore a soft-deleted bundle
      description: |
        Restore a bundle that was soft-deleted, making it active again.
        Can only restore bundles within their retention period.

        Only the bundle owner or admin can restore.
      operationId: restoreBundle
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RestoreBundleRequest'
      responses:
        '200':
          description: Bundle restored successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestoreBundleResponse'
        '400':
          description: Invalid request or bundle not in deleted state
        '403':
          description: Not authorized to restore this bundle
        '404':
          description: Bundle not found or permanently deleted
        '410':
          description: Bundle retention period has expired
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RestoreBundleRequest\"\
        ,\n    \"$defs\": {\n        \"RestoreBundleRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to restore a soft-deleted bundle\",\n            \"required\": [\n\
        \                \"bundleId\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n  \
        \                  \"type\": \"string\",\n                    \"description\": \"Bundle identifier to restore\"\n\
        \                },\n                \"reason\": {\n                    \"type\": \"string\",\n                  \
        \  \"nullable\": true,\n                    \"description\": \"Optional reason for restoration (recorded in version
        history)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RestoreBundleResponse\"\
        ,\n    \"$defs\": {\n        \"RestoreBundleResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Result of bundle restoration\",\n            \"required\": [\n          \
        \      \"bundleId\",\n                \"status\",\n                \"restoredAt\",\n                \"restoredFromVersion\"\
        \n            ],\n            \"properties\": {\n                \"bundleId\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Restored bundle identifier\"\n                },\n             \
        \   \"status\": {\n                    \"type\": \"string\",\n                    \"description\": \"Current bundle
        status (should be \\\"active\\\")\"\n                },\n                \"restoredAt\": {\n                    \"\
        type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"When the
        bundle was restored\"\n                },\n                \"restoredFromVersion\": {\n                    \"type\"\
        : \"integer\",\n                    \"description\": \"Version number the bundle was restored from\"\n           \
        \     }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Restore a soft-deleted bundle\",\n    \"description\": \"Restore a bundle
        that was soft-deleted, making it active again.\\nCan only restore bundles within their retention period.\\n\\nOnly
        the bundle owner or admin can restore.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n\
        \    \"operationId\": \"restoreBundle\"\n}"
  /bundles/query:
    post:
      summary: Query bundles with advanced filters
      description: |
        Query bundles with flexible filtering options including:
        - Tag matching (exact, exists, not exists)
        - Status filtering (active, deleted)
        - Date range filtering
        - Name search (contains)
        - Owner filtering
        - Realm and bundle type filtering

        Supports pagination and sorting.
      operationId: queryBundles
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryBundlesRequest'
      responses:
        '200':
          description: Query results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryBundlesResponse'
        '400':
          description: Invalid query parameters
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryBundlesRequest\"\
        ,\n    \"$defs\": {\n        \"QueryBundlesRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Advanced bundle query with filters\",\n            \"properties\": {\n  \
        \              \"tags\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"Filter by exact tag key-value matches\"\n                },\n            \
        \    \"tagExists\": {\n                    \"type\": \"array\",\n                    \"items\": {\n              \
        \          \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n               \
        \     \"description\": \"Filter bundles that have these tag keys (any value)\"\n                },\n             \
        \   \"tagNotExists\": {\n                    \"type\": \"array\",\n                    \"items\": {\n            \
        \            \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n             \
        \       \"description\": \"Filter bundles that do NOT have these tag keys\"\n                },\n                \"\
        status\": {\n                    \"allOf\": [\n                        {\n                            \"$ref\": \"\
        #/$defs/BundleLifecycle\"\n                        }\n                    ],\n                    \"nullable\": true,\n\
        \                    \"description\": \"Filter by lifecycle status (null for active only by default)\"\n         \
        \       },\n                \"createdAfter\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"Filter bundles
        created after this time\"\n                },\n                \"createdBefore\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"Filter bundles created before this time\"\n                },\n                \"nameContains\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Filter bundles with name containing this string (case-insensitive)\"\n                },\n                \"owner\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Filter by bundle owner account ID\"\n                },\n                \"realm\": {\n                    \"\
        allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/Realm\"\n                 \
        \       }\n                    ],\n                    \"nullable\": true,\n                    \"description\": \"\
        Filter by realm\"\n                },\n                \"bundleType\": {\n                    \"allOf\": [\n     \
        \                   {\n                            \"$ref\": \"#/$defs/BundleType\"\n                        }\n \
        \                   ],\n                    \"nullable\": true,\n                    \"description\": \"Filter by
        bundle type (source or metabundle)\"\n                },\n                \"sortField\": {\n                    \"\
        type\": \"string\",\n                    \"enum\": [\n                        \"created_at\",\n                  \
        \      \"updated_at\",\n                        \"name\",\n                        \"size\"\n                    ],\n\
        \                    \"nullable\": true,\n                    \"description\": \"Field to sort by (default created_at)\"\
        \n                },\n                \"sortOrder\": {\n                    \"type\": \"string\",\n              \
        \      \"enum\": [\n                        \"asc\",\n                        \"desc\"\n                    ],\n \
        \                   \"nullable\": true,\n                    \"description\": \"Sort order (default desc)\"\n    \
        \            },\n                \"limit\": {\n                    \"type\": \"integer\",\n                    \"\
        default\": 100,\n                    \"description\": \"Maximum results to return (max 1000)\"\n                },\n\
        \                \"offset\": {\n                    \"type\": \"integer\",\n                    \"default\": 0,\n\
        \                    \"description\": \"Pagination offset\"\n                },\n                \"includeDeleted\"\
        : {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n                    \"description\"\
        : \"Include soft-deleted bundles in results\"\n                }\n            }\n        },\n        \"BundleLifecycle\"\
        : {\n            \"type\": \"string\",\n            \"enum\": [\n                \"active\",\n                \"deleted\"\
        ,\n                \"processing\"\n            ],\n            \"description\": \"Bundle lifecycle status:\\n- active:
        Bundle is available for use\\n- deleted: Bundle has been soft-deleted (within retention period)\\n- processing: Bundle
        is being processed (metabundle creation)\\n\"\n        },\n        \"Realm\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n                \"fantasia\"\
        ,\n                \"shared\"\n            ],\n            \"description\": \"Game realm the asset belongs to\"\n\
        \        },\n        \"BundleType\": {\n            \"type\": \"string\",\n            \"enum\": [\n             \
        \   \"source\",\n                \"metabundle\"\n            ],\n            \"description\": \"Bundle category:\\
        n- source: Original bundle (uploaded or server-created from assets)\\n- metabundle: Composed from other bundles server-side\\\
        n\"\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/QueryBundlesResponse\"\
        ,\n    \"$defs\": {\n        \"QueryBundlesResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Bundle query results\",\n            \"required\": [\n                \"\
        bundles\",\n                \"totalCount\",\n                \"limit\",\n                \"offset\"\n            ],\n\
        \            \"properties\": {\n                \"bundles\": {\n                    \"type\": \"array\",\n       \
        \             \"items\": {\n                        \"$ref\": \"#/$defs/BundleInfo\"\n                    },\n   \
        \                 \"description\": \"Matching bundles\"\n                },\n                \"totalCount\": {\n \
        \                   \"type\": \"integer\",\n                    \"description\": \"Total number of matching bundles
        (for pagination)\"\n                },\n                \"limit\": {\n                    \"type\": \"integer\",\n\
        \                    \"description\": \"Page size used\"\n                },\n                \"offset\": {\n    \
        \                \"type\": \"integer\",\n                    \"description\": \"Page offset used\"\n             \
        \   }\n            }\n        },\n        \"BundleInfo\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Complete metadata for an asset bundle (API response model)\",\n         \
        \   \"required\": [\n                \"bundleId\",\n                \"bundleType\",\n                \"version\",\n\
        \                \"metadataVersion\",\n                \"owner\",\n                \"realm\",\n                \"\
        status\",\n                \"assetCount\",\n                \"createdAt\"\n            ],\n            \"properties\"\
        : {\n                \"bundleId\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Unique bundle identifier\"\n                },\n                \"bundleType\": {\n                    \"$ref\"\
        : \"#/$defs/BundleType\",\n                    \"description\": \"Whether source or metabundle\"\n               \
        \ },\n                \"version\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Bundle content version string\"\n                },\n                \"metadataVersion\": {\n                \
        \    \"type\": \"integer\",\n                    \"description\": \"Metadata version number (increments on metadata
        changes)\"\n                },\n                \"name\": {\n                    \"type\": \"string\",\n         \
        \           \"nullable\": true,\n                    \"description\": \"Human-readable bundle name\"\n           \
        \     },\n                \"description\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Bundle description\"\n                },\n                \"owner\"\
        : {\n                    \"type\": \"string\",\n                    \"description\": \"Owner account ID or service
        name\"\n                },\n                \"realm\": {\n                    \"$ref\": \"#/$defs/Realm\",\n     \
        \               \"description\": \"Game realm this bundle belongs to\"\n                },\n                \"tags\"\
        : {\n                    \"type\": \"object\",\n                    \"additionalProperties\": {\n                \
        \        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n                 \
        \   \"description\": \"Key-value tags for categorization and filtering\"\n                },\n                \"status\"\
        : {\n                    \"$ref\": \"#/$defs/BundleLifecycle\",\n                    \"description\": \"Bundle lifecycle
        status\"\n                },\n                \"assetCount\": {\n                    \"type\": \"integer\",\n    \
        \                \"description\": \"Number of assets in the bundle\"\n                },\n                \"sizeBytes\"\
        : {\n                    \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Bundle file size in bytes (null if not yet calculated)\"\
        \n                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n              \
        \      \"format\": \"date-time\",\n                    \"description\": \"When the bundle was created\"\n        \
        \        },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n                    \"format\"\
        : \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"When the bundle
        metadata was last updated\"\n                },\n                \"deletedAt\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n             \
        \       \"description\": \"When the bundle was soft-deleted (null if active)\"\n                }\n            }\n\
        \        },\n        \"BundleType\": {\n            \"type\": \"string\",\n            \"enum\": [\n             \
        \   \"source\",\n                \"metabundle\"\n            ],\n            \"description\": \"Bundle category:\\
        n- source: Original bundle (uploaded or server-created from assets)\\n- metabundle: Composed from other bundles server-side\\\
        n\"\n        },\n        \"Realm\": {\n            \"type\": \"string\",\n            \"enum\": [\n              \
        \  \"omega\",\n                \"arcadia\",\n                \"fantasia\",\n                \"shared\"\n         \
        \   ],\n            \"description\": \"Game realm the asset belongs to\"\n        },\n        \"BundleLifecycle\"\
        : {\n            \"type\": \"string\",\n            \"enum\": [\n                \"active\",\n                \"deleted\"\
        ,\n                \"processing\"\n            ],\n            \"description\": \"Bundle lifecycle status:\\n- active:
        Bundle is available for use\\n- deleted: Bundle has been soft-deleted (within retention period)\\n- processing: Bundle
        is being processed (metabundle creation)\\n\"\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Query bundles with advanced filters\",\n    \"description\": \"Query bundles
        with flexible filtering options including:\\n- Tag matching (exact, exists, not exists)\\n- Status filtering (active,
        deleted)\\n- Date range filtering\\n- Name search (contains)\\n- Owner filtering\\n- Realm and bundle type filtering\\
        n\\nSupports pagination and sorting.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\": false,\n\
        \    \"operationId\": \"queryBundles\"\n}"
  /bundles/list-versions:
    post:
      summary: List version history for a bundle
      description: |
        Get the version history for a bundle, showing all metadata changes
        over time. Each version record includes:
        - Version number
        - When the change was made
        - Who made the change
        - What changed
        - Optional reason for the change

        The current version's full metadata snapshot is always included.
      operationId: listBundleVersions
      tags:
      - Bundles
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListBundleVersionsRequest'
      responses:
        '200':
          description: Version history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListBundleVersionsResponse'
        '404':
          description: Bundle not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListBundleVersionsRequest\"\
        ,\n    \"$defs\": {\n        \"ListBundleVersionsRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to list bundle version history\",\n            \"required\": [\n\
        \                \"bundleId\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n  \
        \                  \"type\": \"string\",\n                    \"description\": \"Bundle identifier to get history
        for\"\n                },\n                \"limit\": {\n                    \"type\": \"integer\",\n            \
        \        \"default\": 50,\n                    \"description\": \"Maximum versions to return\"\n                },\n\
        \                \"offset\": {\n                    \"type\": \"integer\",\n                    \"default\": 0,\n\
        \                    \"description\": \"Pagination offset\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListBundleVersionsResponse\"\
        ,\n    \"$defs\": {\n        \"ListBundleVersionsResponse\": {\n            \"type\": \"object\",\n            \"\
        additionalProperties\": false,\n            \"description\": \"Bundle version history\",\n            \"required\"\
        : [\n                \"bundleId\",\n                \"currentVersion\",\n                \"versions\",\n         \
        \       \"totalCount\"\n            ],\n            \"properties\": {\n                \"bundleId\": {\n         \
        \           \"type\": \"string\",\n                    \"description\": \"Bundle identifier\"\n                },\n\
        \                \"currentVersion\": {\n                    \"type\": \"integer\",\n                    \"description\"\
        : \"Current version number\"\n                },\n                \"versions\": {\n                    \"type\": \"\
        array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/BundleVersionRecord\"\n  \
        \                  },\n                    \"description\": \"Version history records (newest first)\"\n         \
        \       },\n                \"totalCount\": {\n                    \"type\": \"integer\",\n                    \"\
        description\": \"Total number of versions\"\n                }\n            }\n        },\n        \"BundleVersionRecord\"\
        : {\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"description\"\
        : \"A single version record in bundle history\",\n            \"required\": [\n                \"version\",\n    \
        \            \"createdAt\",\n                \"createdBy\",\n                \"changes\"\n            ],\n       \
        \     \"properties\": {\n                \"version\": {\n                    \"type\": \"integer\",\n            \
        \        \"description\": \"Version number\"\n                },\n                \"createdAt\": {\n             \
        \       \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"When this version was created\"\n                },\n                \"createdBy\": {\n                    \"\
        type\": \"string\",\n                    \"description\": \"Account ID that made the change\"\n                },\n\
        \                \"changes\": {\n                    \"type\": \"array\",\n                    \"items\": {\n    \
        \                    \"type\": \"string\"\n                    },\n                    \"description\": \"List of
        changes in this version\"\n                },\n                \"reason\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Reason provided for the change\"\
        \n                },\n                \"snapshot\": {\n                    \"allOf\": [\n                        {\n\
        \                            \"$ref\": \"#/$defs/BundleInfo\"\n                        }\n                    ],\n\
        \                    \"nullable\": true,\n                    \"description\": \"Full metadata snapshot at this version
        (only for current version)\"\n                }\n            }\n        },\n        \"BundleInfo\": {\n          \
        \  \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"description\": \"Complete metadata
        for an asset bundle (API response model)\",\n            \"required\": [\n                \"bundleId\",\n        \
        \        \"bundleType\",\n                \"version\",\n                \"metadataVersion\",\n                \"owner\"\
        ,\n                \"realm\",\n                \"status\",\n                \"assetCount\",\n                \"createdAt\"\
        \n            ],\n            \"properties\": {\n                \"bundleId\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Unique bundle identifier\"\n                },\n               \
        \ \"bundleType\": {\n                    \"$ref\": \"#/$defs/BundleType\",\n                    \"description\": \"\
        Whether source or metabundle\"\n                },\n                \"version\": {\n                    \"type\":
        \"string\",\n                    \"description\": \"Bundle content version string\"\n                },\n        \
        \        \"metadataVersion\": {\n                    \"type\": \"integer\",\n                    \"description\":
        \"Metadata version number (increments on metadata changes)\"\n                },\n                \"name\": {\n  \
        \                  \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Human-readable bundle name\"\n                },\n                \"description\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Bundle description\"\
        \n                },\n                \"owner\": {\n                    \"type\": \"string\",\n                  \
        \  \"description\": \"Owner account ID or service name\"\n                },\n                \"realm\": {\n     \
        \               \"$ref\": \"#/$defs/Realm\",\n                    \"description\": \"Game realm this bundle belongs
        to\"\n                },\n                \"tags\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": {\n                        \"type\": \"string\"\n                    },\n        \
        \            \"nullable\": true,\n                    \"description\": \"Key-value tags for categorization and filtering\"\
        \n                },\n                \"status\": {\n                    \"$ref\": \"#/$defs/BundleLifecycle\",\n\
        \                    \"description\": \"Bundle lifecycle status\"\n                },\n                \"assetCount\"\
        : {\n                    \"type\": \"integer\",\n                    \"description\": \"Number of assets in the bundle\"\
        \n                },\n                \"sizeBytes\": {\n                    \"type\": \"integer\",\n             \
        \       \"format\": \"int64\",\n                    \"nullable\": true,\n                    \"description\": \"Bundle
        file size in bytes (null if not yet calculated)\"\n                },\n                \"createdAt\": {\n        \
        \            \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"When the bundle was created\"\n                },\n                \"updatedAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n         \
        \           \"description\": \"When the bundle metadata was last updated\"\n                },\n                \"\
        deletedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n      \
        \              \"nullable\": true,\n                    \"description\": \"When the bundle was soft-deleted (null
        if active)\"\n                }\n            }\n        },\n        \"BundleType\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"source\",\n                \"metabundle\"\n            ],\n        \
        \    \"description\": \"Bundle category:\\n- source: Original bundle (uploaded or server-created from assets)\\n-
        metabundle: Composed from other bundles server-side\\n\"\n        },\n        \"Realm\": {\n            \"type\":
        \"string\",\n            \"enum\": [\n                \"omega\",\n                \"arcadia\",\n                \"\
        fantasia\",\n                \"shared\"\n            ],\n            \"description\": \"Game realm the asset belongs
        to\"\n        },\n        \"BundleLifecycle\": {\n            \"type\": \"string\",\n            \"enum\": [\n   \
        \             \"active\",\n                \"deleted\",\n                \"processing\"\n            ],\n        \
        \    \"description\": \"Bundle lifecycle status:\\n- active: Bundle is available for use\\n- deleted: Bundle has been
        soft-deleted (within retention period)\\n- processing: Bundle is being processed (metabundle creation)\\n\"\n    \
        \    }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List version history for a bundle\",\n    \"description\": \"Get the version
        history for a bundle, showing all metadata changes\\nover time. Each version record includes:\\n- Version number\\
        n- When the change was made\\n- Who made the change\\n- What changed\\n- Optional reason for the change\\n\\nThe current
        version's full metadata snapshot is always included.\\n\",\n    \"tags\": [\n        \"Bundles\"\n    ],\n    \"deprecated\"\
        : false,\n    \"operationId\": \"listBundleVersions\"\n}"
  /assets/bulk-get:
    post:
      summary: Batch asset metadata lookup
      description: |
        Retrieve metadata for multiple assets in a single request.
        Optionally includes pre-signed download URLs.
        Maximum 100 asset IDs per request.
      operationId: bulkGetAssets
      tags:
      - Assets
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkGetAssetsRequest'
      responses:
        '200':
          description: Asset metadata retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkGetAssetsResponse'
        '400':
          description: Invalid request or too many asset IDs
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkGetAssetsRequest\"\
        ,\n    \"$defs\": {\n        \"BulkGetAssetsRequest\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Request to retrieve metadata for multiple assets\",\n            \"required\"\
        : [\n                \"assetIds\"\n            ],\n            \"properties\": {\n                \"assetIds\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"\
        string\"\n                    },\n                    \"description\": \"Asset IDs to retrieve (max 100)\"\n     \
        \           },\n                \"includeDownloadUrls\": {\n                    \"type\": \"boolean\",\n         \
        \           \"default\": false,\n                    \"description\": \"Whether to generate pre-signed download URLs\"\
        \n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkGetAssetsResponse\"\
        ,\n    \"$defs\": {\n        \"BulkGetAssetsResponse\": {\n            \"type\": \"object\",\n            \"additionalProperties\"\
        : false,\n            \"description\": \"Batch asset metadata response\",\n            \"required\": [\n         \
        \       \"assets\",\n                \"notFound\"\n            ],\n            \"properties\": {\n               \
        \ \"assets\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                    \
        \    \"$ref\": \"#/$defs/AssetWithDownloadUrl\"\n                    },\n                    \"description\": \"Found
        assets with metadata\"\n                },\n                \"notFound\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n      \
        \              \"description\": \"Asset IDs that weren't found\"\n                }\n            }\n        },\n \
        \       \"AssetWithDownloadUrl\": {\n            \"description\": \"Asset metadata with optional pre-signed download
        URL\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"assetId\",\n                \"versionId\",\n                \"size\",\n                \"contentHash\"\
        ,\n                \"contentType\",\n                \"metadata\"\n            ],\n            \"properties\": {\n\
        \                \"assetId\": {\n                    \"type\": \"string\",\n                    \"description\": \"\
        Unique asset identifier\"\n                },\n                \"versionId\": {\n                    \"type\": \"\
        string\",\n                    \"description\": \"Version identifier for this specific asset version\"\n         \
        \       },\n                \"downloadUrl\": {\n                    \"type\": \"string\",\n                    \"\
        format\": \"uri\",\n                    \"nullable\": true,\n                    \"description\": \"Pre-signed download
        URL (only populated when requested)\"\n                },\n                \"expiresAt\": {\n                    \"\
        type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"nullable\": true,\n   \
        \                 \"description\": \"When the download URL expires (only populated when requested)\"\n           \
        \     },\n                \"size\": {\n                    \"type\": \"integer\",\n                    \"format\"\
        : \"int64\",\n                    \"description\": \"File size in bytes\"\n                },\n                \"\
        contentHash\": {\n                    \"type\": \"string\",\n                    \"description\": \"SHA256 hash of
        file contents\"\n                },\n                \"contentType\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"MIME content type\"\n                },\n                \"metadata\": {\n\
        \                    \"$ref\": \"#/$defs/AssetMetadata\",\n                    \"description\": \"Complete asset metadata\"\
        \n                }\n            }\n        },\n        \"AssetMetadata\": {\n            \"type\": \"object\",\n\
        \            \"additionalProperties\": false,\n            \"description\": \"Complete asset metadata including system-generated
        fields\",\n            \"required\": [\n                \"assetId\",\n                \"contentHash\",\n         \
        \       \"filename\",\n                \"contentType\",\n                \"size\",\n                \"assetType\"\
        ,\n                \"realm\",\n                \"tags\",\n                \"processingStatus\",\n                \"\
        isArchived\",\n                \"createdAt\",\n                \"updatedAt\"\n            ],\n            \"properties\"\
        : {\n                \"assetId\": {\n                    \"type\": \"string\",\n                    \"description\"\
        : \"Unique asset identifier\"\n                },\n                \"contentHash\": {\n                    \"type\"\
        : \"string\",\n                    \"description\": \"SHA256 hash of file contents\"\n                },\n       \
        \         \"filename\": {\n                    \"type\": \"string\",\n                    \"description\": \"Original
        filename\"\n                },\n                \"contentType\": {\n                    \"type\": \"string\",\n  \
        \                  \"description\": \"MIME content type\"\n                },\n                \"size\": {\n     \
        \               \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\"\
        : \"File size in bytes\"\n                },\n                \"assetType\": {\n                    \"$ref\": \"#/$defs/AssetType\"\
        ,\n                    \"description\": \"Type classification for the asset\"\n                },\n              \
        \  \"realm\": {\n                    \"$ref\": \"#/$defs/Realm\",\n                    \"description\": \"Game realm
        the asset belongs to\"\n                },\n                \"tags\": {\n                    \"type\": \"array\",\n\
        \                    \"items\": {\n                        \"type\": \"string\"\n                    },\n        \
        \            \"description\": \"Searchable tags for the asset\"\n                },\n                \"processingStatus\"\
        : {\n                    \"$ref\": \"#/$defs/ProcessingStatus\",\n                    \"description\": \"Current status
        of asset processing pipeline\"\n                },\n                \"isArchived\": {\n                    \"type\"\
        : \"boolean\",\n                    \"description\": \"Whether the asset is in cold/archival storage\",\n        \
        \            \"default\": false\n                },\n                \"createdAt\": {\n                    \"type\"\
        : \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Timestamp when
        the asset was created\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the asset
        was last updated\"\n                }\n            }\n        },\n        \"AssetType\": {\n            \"type\":
        \"string\",\n            \"enum\": [\n                \"texture\",\n                \"model\",\n                \"\
        audio\",\n                \"behavior\",\n                \"bundle\",\n                \"prefab\",\n              \
        \  \"other\"\n            ],\n            \"description\": \"Type classification for assets\"\n        },\n      \
        \  \"Realm\": {\n            \"type\": \"string\",\n            \"enum\": [\n                \"omega\",\n        \
        \        \"arcadia\",\n                \"fantasia\",\n                \"shared\"\n            ],\n            \"description\"\
        : \"Game realm the asset belongs to\"\n        },\n        \"ProcessingStatus\": {\n            \"type\": \"string\"\
        ,\n            \"enum\": [\n                \"pending\",\n                \"processing\",\n                \"complete\"\
        ,\n                \"failed\"\n            ],\n            \"description\": \"Asset processing pipeline status\"\n\
        \        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Batch asset metadata lookup\",\n    \"description\": \"Retrieve metadata
        for multiple assets in a single request.\\nOptionally includes pre-signed download URLs.\\nMaximum 100 asset IDs per
        request.\\n\",\n    \"tags\": [\n        \"Assets\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"bulkGetAssets\"\
        \n}"
components:
  schemas:
    AssetType:
      type: string
      enum:
      - texture
      - model
      - audio
      - behavior
      - bundle
      - prefab
      - other
      description: Type classification for assets
    Realm:
      type: string
      enum:
      - omega
      - arcadia
      - fantasia
      - shared
      description: Game realm the asset belongs to
    ProcessingStatus:
      type: string
      enum:
      - pending
      - processing
      - complete
      - failed
      description: Asset processing pipeline status
    CompressionType:
      type: string
      enum:
      - lz4
      - lzma
      - none
      description: Compression algorithm for bundles
    BundleFormat:
      type: string
      enum:
      - bannou
      - zip
      description: Bundle file format
    BundleType:
      type: string
      enum:
      - source
      - metabundle
      description: |
        Bundle category:
        - source: Original bundle (uploaded or server-created from assets)
        - metabundle: Composed from other bundles server-side
    UploadRequest:
      description: Request to initiate an asset upload and receive a pre-signed URL
      type: object
      additionalProperties: false
      required:
      - filename
      - size
      - contentType
      - owner
      properties:
        owner:
          type: string
          description: |
            Owner of this asset operation. NOT a session ID.
            For user-initiated uploads: the accountId (UUID format).
            For service-initiated uploads: the service name (e.g., "behavior", "orchestrator").
        filename:
          type: string
          description: Original filename with extension
        size:
          type: integer
          format: int64
          description: File size in bytes
        contentType:
          type: string
          description: MIME content type (e.g., image/png, model/gltf-binary)
        metadata:
          $ref: '#/components/schemas/AssetMetadataInput'
          description: Optional metadata for asset categorization
    UploadResponse:
      description: Response containing pre-signed URL and configuration for uploading an asset
      type: object
      additionalProperties: false
      required:
      - uploadId
      - uploadUrl
      - expiresAt
      properties:
        uploadId:
          type: string
          format: uuid
          description: Unique upload session identifier
        uploadUrl:
          type: string
          format: uri
          description: Pre-signed URL for uploading the file
        expiresAt:
          type: string
          format: date-time
          description: When the upload URL expires
        multipart:
          $ref: '#/components/schemas/MultipartConfig'
          description: Configuration for multipart uploads if file size requires it
        requiredHeaders:
          type: object
          additionalProperties:
            type: string
          description: Headers the client must include when uploading to the pre-signed URL
    CompleteUploadRequest:
      description: Request to finalize an upload and trigger asset processing
      type: object
      additionalProperties: false
      required:
      - uploadId
      properties:
        uploadId:
          type: string
          format: uuid
          description: Upload session ID from requestUpload
        parts:
          type: array
          nullable: true
          description: For multipart uploads - ETags of completed parts (null for single-file uploads)
          items:
            $ref: '#/components/schemas/CompletedPart'
    CompletedPart:
      description: Information about a completed part in a multipart upload
      type: object
      additionalProperties: false
      required:
      - partNumber
      - etag
      properties:
        partNumber:
          type: integer
          description: Part number (1-based)
        etag:
          type: string
          description: ETag returned from part upload
    MultipartConfig:
      description: Configuration for multipart uploads of large files
      type: object
      additionalProperties: false
      properties:
        required:
          type: boolean
          description: Whether multipart upload is required for this file size
        partSize:
          type: integer
          description: Size of each part in bytes
        maxParts:
          type: integer
          description: Maximum number of parts
        uploadUrls:
          type: array
          nullable: true
          description: Pre-signed URLs for each part of the multipart upload
          items:
            $ref: '#/components/schemas/PartUploadInfo'
    PartUploadInfo:
      description: Upload information for a single part in a multipart upload
      type: object
      additionalProperties: false
      required:
      - partNumber
      - uploadUrl
      properties:
        partNumber:
          type: integer
          description: Part number (1-based)
        uploadUrl:
          type: string
          format: uri
          description: Pre-signed URL for uploading this part
        minSize:
          type: integer
          format: int64
          description: Minimum size for this part
        maxSize:
          type: integer
          format: int64
          description: Maximum size for this part
    AssetMetadataInput:
      type: object
      additionalProperties: false
      description: User-provided metadata for asset categorization
      properties:
        assetType:
          $ref: '#/components/schemas/AssetType'
          description: Type classification for the asset
        realm:
          $ref: '#/components/schemas/Realm'
          description: Game realm the asset belongs to
        tags:
          type: array
          items:
            type: string
          description: Searchable tags for the asset
    AssetMetadata:
      type: object
      additionalProperties: false
      description: Complete asset metadata including system-generated fields
      required:
      - assetId
      - contentHash
      - filename
      - contentType
      - size
      - assetType
      - realm
      - tags
      - processingStatus
      - isArchived
      - createdAt
      - updatedAt
      properties:
        assetId:
          type: string
          description: Unique asset identifier
        contentHash:
          type: string
          description: SHA256 hash of file contents
        filename:
          type: string
          description: Original filename
        contentType:
          type: string
          description: MIME content type
        size:
          type: integer
          format: int64
          description: File size in bytes
        assetType:
          $ref: '#/components/schemas/AssetType'
          description: Type classification for the asset
        realm:
          $ref: '#/components/schemas/Realm'
          description: Game realm the asset belongs to
        tags:
          type: array
          items:
            type: string
          description: Searchable tags for the asset
        processingStatus:
          $ref: '#/components/schemas/ProcessingStatus'
          description: Current status of asset processing pipeline
        isArchived:
          type: boolean
          description: Whether the asset is in cold/archival storage
          default: false
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the asset was created
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the asset was last updated
    GetAssetRequest:
      description: Request to retrieve asset metadata and download URL
      type: object
      additionalProperties: false
      required:
      - assetId
      properties:
        assetId:
          type: string
          description: Asset identifier
        version:
          type: string
          default: latest
          description: Version ID or 'latest'
    AssetWithDownloadUrl:
      description: Asset metadata with optional pre-signed download URL
      type: object
      additionalProperties: false
      required:
      - assetId
      - versionId
      - size
      - contentHash
      - contentType
      - metadata
      properties:
        assetId:
          type: string
          description: Unique asset identifier
        versionId:
          type: string
          description: Version identifier for this specific asset version
        downloadUrl:
          type: string
          format: uri
          nullable: true
          description: Pre-signed download URL (only populated when requested)
        expiresAt:
          type: string
          format: date-time
          nullable: true
          description: When the download URL expires (only populated when requested)
        size:
          type: integer
          format: int64
          description: File size in bytes
        contentHash:
          type: string
          description: SHA256 hash of file contents
        contentType:
          type: string
          description: MIME content type
        metadata:
          $ref: '#/components/schemas/AssetMetadata'
          description: Complete asset metadata
    DeleteAssetRequest:
      description: Request to delete an asset from storage
      type: object
      additionalProperties: false
      required:
      - assetId
      properties:
        assetId:
          type: string
          description: Asset identifier to delete
        versionId:
          type: string
          nullable: true
          description: |
            Specific version to delete. If omitted, all versions are deleted.
    DeleteAssetResponse:
      description: Response confirming asset deletion
      type: object
      additionalProperties: false
      required:
      - assetId
      - versionsDeleted
      properties:
        assetId:
          type: string
          description: Deleted asset identifier
        versionsDeleted:
          type: integer
          description: Number of versions deleted
    ListVersionsRequest:
      description: Request to list all versions of an asset with pagination
      type: object
      additionalProperties: false
      required:
      - assetId
      properties:
        assetId:
          type: string
          description: Asset identifier to list versions for
        limit:
          type: integer
          default: 50
          description: Maximum number of versions to return
        offset:
          type: integer
          default: 0
          description: Number of versions to skip for pagination
    AssetVersionList:
      description: Paginated list of asset versions
      type: object
      additionalProperties: false
      required:
      - assetId
      - versions
      - total
      - limit
      - offset
      properties:
        assetId:
          type: string
          description: Asset identifier
        versions:
          type: array
          items:
            $ref: '#/components/schemas/AssetVersion'
          description: List of asset versions
        total:
          type: integer
          description: Total number of versions available
        limit:
          type: integer
          description: Maximum number of versions returned per page
        offset:
          type: integer
          description: Number of versions skipped
    AssetVersion:
      description: Metadata for a specific version of an asset
      type: object
      additionalProperties: false
      required:
      - versionId
      - createdAt
      - size
      - isArchived
      properties:
        versionId:
          type: string
          description: Unique version identifier
        createdAt:
          type: string
          format: date-time
          description: Timestamp when this version was created
        size:
          type: integer
          format: int64
          description: File size in bytes for this version
        isArchived:
          type: boolean
          description: Whether this version is in cold storage
    AssetSearchRequest:
      description: Search criteria for filtering assets with pagination
      type: object
      additionalProperties: false
      required:
      - assetType
      - realm
      properties:
        tags:
          type: array
          items:
            type: string
          nullable: true
          description: Filter by tags (assets must have all specified tags) (null to skip tag filtering)
        assetType:
          $ref: '#/components/schemas/AssetType'
          description: Filter by asset type
        realm:
          $ref: '#/components/schemas/Realm'
          description: Filter by game realm
        contentType:
          type: string
          nullable: true
          description: MIME content type filter (null to skip content type filtering)
        limit:
          type: integer
          default: 50
          description: Maximum number of results to return
        offset:
          type: integer
          default: 0
          description: Number of results to skip for pagination
    AssetSearchResult:
      description: Paginated results from an asset search query
      type: object
      additionalProperties: false
      required:
      - assets
      - total
      - limit
      - offset
      properties:
        assets:
          type: array
          items:
            $ref: '#/components/schemas/AssetMetadata'
          description: List of matching assets
        total:
          type: integer
          description: Total number of matching assets
        limit:
          type: integer
          description: Maximum number of results returned per page
        offset:
          type: integer
          description: Number of results skipped
    CreateBundleRequest:
      description: Request to create a new asset bundle from multiple assets
      type: object
      additionalProperties: false
      required:
      - bundleId
      - assetIds
      - owner
      properties:
        owner:
          type: string
          description: |
            Owner of this bundle. NOT a session ID.
            For user-initiated bundles: the accountId (UUID format).
            For service-initiated bundles: the service name (e.g., "orchestrator").
        bundleId:
          type: string
          description: Unique bundle identifier
        version:
          type: string
          default: 1.0.0
          description: Bundle version string
        realm:
          allOf:
          - $ref: '#/components/schemas/Realm'
          nullable: true
          description: |
            Game realm this bundle belongs to.
            Defaults to 'shared' if not specified.
        assetIds:
          type: array
          items:
            type: string
          description: List of asset IDs to include in the bundle
        compression:
          $ref: '#/components/schemas/CompressionType'
          description: Compression algorithm to use for the bundle
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Custom metadata for the bundle (null if none)
    CreateBundleResponse:
      description: Response with bundle creation status and estimated size
      type: object
      additionalProperties: false
      required:
      - bundleId
      - status
      - estimatedSize
      properties:
        bundleId:
          type: string
          description: Unique bundle identifier
        status:
          type: string
          enum:
          - queued
          - processing
          - ready
          - failed
          description: Bundle creation status
        estimatedSize:
          type: integer
          format: int64
          description: Estimated bundle size in bytes
    GetBundleRequest:
      description: Request to retrieve bundle metadata and download URL
      type: object
      additionalProperties: false
      required:
      - bundleId
      properties:
        bundleId:
          type: string
          description: Bundle identifier to retrieve
        format:
          $ref: '#/components/schemas/BundleFormat'
          description: Desired download format (bannou or zip)
    BundleWithDownloadUrl:
      description: Bundle metadata combined with a pre-signed download URL
      type: object
      additionalProperties: false
      required:
      - bundleId
      - version
      - downloadUrl
      - format
      - expiresAt
      - size
      - assetCount
      - fromCache
      properties:
        bundleId:
          type: string
          description: Unique bundle identifier
        version:
          type: string
          description: Bundle version string
        downloadUrl:
          type: string
          format: uri
          description: Pre-signed URL for downloading the bundle
        format:
          $ref: '#/components/schemas/BundleFormat'
          description: Format of the downloadable bundle
        expiresAt:
          type: string
          format: date-time
          description: When the download URL expires
        size:
          type: integer
          format: int64
          description: Bundle file size in bytes
        assetCount:
          type: integer
          description: Number of assets contained in the bundle
        fromCache:
          type: boolean
          description: True if ZIP format was served from conversion cache
    BundleUploadRequest:
      description: Request to upload a pre-built asset bundle file
      type: object
      additionalProperties: false
      required:
      - filename
      - size
      - owner
      properties:
        owner:
          type: string
          description: |
            Owner of this bundle upload. NOT a session ID.
            For user-initiated uploads: the accountId (UUID format).
            For service-initiated uploads: the service name (e.g., "orchestrator").
        filename:
          type: string
          description: Must end with .bannou or .zip
        size:
          type: integer
          format: int64
          description: Bundle file size in bytes
        manifestPreview:
          allOf:
          - $ref: '#/components/schemas/BundleManifestPreview'
          nullable: true
          description: Optional preview of bundle manifest for validation
    BundleManifestPreview:
      type: object
      additionalProperties: false
      description: Preview of bundle manifest for validation
      required:
      - bundleId
      - version
      - assetCount
      properties:
        bundleId:
          type: string
          description: Bundle identifier from the manifest
        version:
          type: string
          description: Bundle version from the manifest
        assetCount:
          type: integer
          description: Number of assets declared in the manifest
    SourceBundleReference:
      type: object
      additionalProperties: false
      description: Provenance reference to a source bundle used in metabundle creation
      required:
      - bundleId
      - version
      - assetIds
      - contentHash
      properties:
        bundleId:
          type: string
          description: Source bundle identifier
        version:
          type: string
          description: Version of source bundle at composition time
        assetIds:
          type: array
          items:
            type: string
          description: Asset IDs contributed from this source bundle
        contentHash:
          type: string
          description: Hash of source bundle at composition time (for integrity verification)
    AssetConflict:
      type: object
      additionalProperties: false
      description: Describes a conflict when the same asset ID has different content hashes
      required:
      - assetId
      - conflictingBundles
      properties:
        assetId:
          type: string
          description: The conflicting asset identifier
        conflictingBundles:
          type: array
          items:
            $ref: '#/components/schemas/ConflictingBundleEntry'
          description: Bundles with conflicting versions of this asset
    ConflictingBundleEntry:
      type: object
      additionalProperties: false
      description: A bundle entry in an asset conflict
      required:
      - bundleId
      - contentHash
      properties:
        bundleId:
          type: string
          description: Bundle containing this version
        contentHash:
          type: string
          description: Content hash of asset in this bundle
    CreateMetabundleRequest:
      type: object
      additionalProperties: false
      description: |
        Request to create a metabundle from source bundles and/or standalone assets.
        At least one of sourceBundleIds or standaloneAssetIds must be provided.
        This enables packaging behaviors/scripts with 3D assets as a complete unit.
      required:
      - metabundleId
      - owner
      - realm
      properties:
        metabundleId:
          type: string
          description: Unique identifier for the new metabundle
        sourceBundleIds:
          type: array
          items:
            type: string
          nullable: true
          description: |
            Source bundle IDs to pull assets from. Can cherry-pick specific
            assets using assetFilter, or include all if assetFilter is null.
        standaloneAssetIds:
          type: array
          items:
            type: string
          nullable: true
          description: |
            Individual asset IDs (not in bundles) to include directly.
            Useful for including behaviors, scripts, or metadata files
            alongside bundled 3D assets.
        version:
          type: string
          default: "1.0.0"
          description: Metabundle version string
        owner:
          type: string
          description: |
            Owner of this metabundle. NOT a session ID.
            For user-initiated: the accountId (UUID format).
            For service-initiated: the service name.
        realm:
          $ref: '#/components/schemas/Realm'
          description: Game realm for this metabundle
        description:
          type: string
          nullable: true
          description: Human-readable description
        assetFilter:
          type: array
          nullable: true
          items:
            type: string
          description: |
            Optional subset of asset IDs to include FROM SOURCE BUNDLES.
            If null, all assets from source bundles are included.
            Standalone assets are always included regardless of this filter.
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Custom metadata for the metabundle
    CreateMetabundleResponse:
      type: object
      additionalProperties: false
      description: |
        Response from metabundle creation.
        For synchronous creation (small jobs): status=ready with downloadUrl.
        For async creation (large jobs): status=queued with jobId for polling.
      required:
      - metabundleId
      - status
      - assetCount
      - sizeBytes
      properties:
        metabundleId:
          type: string
          description: Metabundle identifier
        jobId:
          type: string
          format: uuid
          nullable: true
          description: |
            Job ID for async processing. Only present when status is 'queued' or 'processing'.
            Use /bundles/job/status to poll for completion, or wait for
            MetabundleCreationCompleteEvent via WebSocket.
        status:
          type: string
          enum:
          - queued
          - processing
          - ready
          - failed
          description: |
            Creation status.
            - queued: Job accepted for async processing (poll with jobId)
            - processing: Job is actively running
            - ready: Metabundle created and available for download
            - failed: Creation failed (see conflicts for details)
        downloadUrl:
          type: string
          format: uri
          nullable: true
          description: Pre-signed download URL (only present when status is 'ready')
        assetCount:
          type: integer
          description: Number of assets in the metabundle
        standaloneAssetCount:
          type: integer
          nullable: true
          description: Number of standalone assets included directly (not from bundles)
        sizeBytes:
          type: integer
          format: int64
          description: Total size in bytes
        sourceBundles:
          type: array
          items:
            $ref: '#/components/schemas/SourceBundleReference'
          description: Provenance data for the metabundle
        conflicts:
          type: array
          nullable: true
          items:
            $ref: '#/components/schemas/AssetConflict'
          description: Present if creation failed due to asset conflicts
    GetJobStatusRequest:
      type: object
      additionalProperties: false
      description: Request to get the status of an async metabundle creation job
      required:
      - jobId
      properties:
        jobId:
          type: string
          format: uuid
          description: Job ID from the createMetabundle response
    GetJobStatusResponse:
      type: object
      additionalProperties: false
      description: |
        Status of an async metabundle creation job.
        When status is 'ready', the response includes the full metabundle details.
      required:
      - jobId
      - metabundleId
      - status
      properties:
        jobId:
          type: string
          format: uuid
          description: Job identifier
        metabundleId:
          type: string
          description: Metabundle identifier being created
        status:
          type: string
          enum:
          - queued
          - processing
          - ready
          - failed
          - cancelled
          description: |
            Current job status.
            - queued: Waiting for processing resources
            - processing: Actively being processed
            - ready: Completed successfully
            - failed: Creation failed
            - cancelled: Job was cancelled
        progress:
          type: integer
          minimum: 0
          maximum: 100
          nullable: true
          description: Progress percentage (0-100) when status is 'processing'
        downloadUrl:
          type: string
          format: uri
          nullable: true
          description: Pre-signed download URL (only when status is 'ready')
        assetCount:
          type: integer
          nullable: true
          description: Number of assets in metabundle (when ready)
        standaloneAssetCount:
          type: integer
          nullable: true
          description: Number of standalone assets included (when ready)
        sizeBytes:
          type: integer
          format: int64
          nullable: true
          description: Total size in bytes (when ready)
        sourceBundles:
          type: array
          nullable: true
          items:
            $ref: '#/components/schemas/SourceBundleReference'
          description: Provenance data (when ready)
        errorCode:
          type: string
          nullable: true
          description: Error code (when status is 'failed')
        errorMessage:
          type: string
          nullable: true
          description: Human-readable error description (when status is 'failed')
        createdAt:
          type: string
          format: date-time
          nullable: true
          description: When the job was created
        updatedAt:
          type: string
          format: date-time
          nullable: true
          description: When the job was last updated
        processingTimeMs:
          type: integer
          format: int64
          nullable: true
          description: Total processing time in milliseconds (when complete)
    CancelJobRequest:
      type: object
      additionalProperties: false
      description: Request to cancel an async metabundle creation job
      required:
      - jobId
      properties:
        jobId:
          type: string
          format: uuid
          description: Job ID from the createMetabundle response
    CancelJobResponse:
      type: object
      additionalProperties: false
      description: Result of job cancellation attempt
      required:
      - jobId
      - cancelled
      - status
      properties:
        jobId:
          type: string
          format: uuid
          description: Job identifier
        cancelled:
          type: boolean
          description: Whether the job was successfully cancelled
        status:
          type: string
          enum:
          - queued
          - processing
          - ready
          - failed
          - cancelled
          description: Current job status after cancellation attempt
        message:
          type: string
          nullable: true
          description: Additional context about the cancellation result
    ResolveBundlesRequest:
      type: object
      additionalProperties: false
      description: Request to resolve optimal bundle downloads for requested assets
      required:
      - assetIds
      - realm
      properties:
        assetIds:
          type: array
          items:
            type: string
          description: Platform asset IDs to resolve
        realm:
          $ref: '#/components/schemas/Realm'
          description: Game realm to search within
        preferMetabundles:
          type: boolean
          default: true
          description: Prefer metabundles when coverage is equal
        includeStandalone:
          type: boolean
          default: true
          description: Include standalone assets not in any bundle
        maxBundles:
          type: integer
          nullable: true
          description: Maximum number of bundles to return (optimization limit)
    ResolveBundlesResponse:
      type: object
      additionalProperties: false
      description: Optimal bundle set for requested assets
      required:
      - bundles
      - standaloneAssets
      - coverage
      properties:
        bundles:
          type: array
          items:
            $ref: '#/components/schemas/ResolvedBundle'
          description: Bundles to download
        standaloneAssets:
          type: array
          items:
            $ref: '#/components/schemas/ResolvedAsset'
          description: Individual assets to download
        coverage:
          $ref: '#/components/schemas/CoverageAnalysis'
          description: Coverage statistics
        unresolved:
          type: array
          items:
            type: string
          nullable: true
          description: Asset IDs that couldn't be found (null if all resolved)
    ResolvedBundle:
      type: object
      additionalProperties: false
      description: A bundle selected for download in resolution
      required:
      - bundleId
      - bundleType
      - downloadUrl
      - expiresAt
      - size
      - assetsProvided
      properties:
        bundleId:
          type: string
          description: Bundle identifier
        bundleType:
          $ref: '#/components/schemas/BundleType'
          description: Whether source or metabundle
        version:
          type: string
          nullable: true
          description: Bundle version
        downloadUrl:
          type: string
          format: uri
          description: Pre-signed download URL
        expiresAt:
          type: string
          format: date-time
          description: When the download URL expires
        size:
          type: integer
          format: int64
          description: Bundle file size in bytes
        assetsProvided:
          type: array
          items:
            type: string
          description: Which of the requested assets this bundle provides
    ResolvedAsset:
      type: object
      additionalProperties: false
      description: A standalone asset selected for download
      required:
      - assetId
      - downloadUrl
      - expiresAt
      - size
      properties:
        assetId:
          type: string
          description: Asset identifier
        downloadUrl:
          type: string
          format: uri
          description: Pre-signed download URL
        expiresAt:
          type: string
          format: date-time
          description: When the download URL expires
        size:
          type: integer
          format: int64
          description: Asset file size in bytes
        contentHash:
          type: string
          nullable: true
          description: SHA256 hash of asset content
    CoverageAnalysis:
      type: object
      additionalProperties: false
      description: Statistics about asset resolution coverage
      required:
      - totalRequested
      - resolvedViaBundles
      - resolvedStandalone
      - unresolvedCount
      properties:
        totalRequested:
          type: integer
          description: Total number of assets requested
        resolvedViaBundles:
          type: integer
          description: Assets resolved through bundle downloads
        resolvedStandalone:
          type: integer
          description: Assets resolved as standalone downloads
        unresolvedCount:
          type: integer
          description: Assets that could not be found
        bundleEfficiency:
          type: number
          format: float
          nullable: true
          description: Ratio of assets provided to bundle downloads (higher is better)
    QueryBundlesByAssetRequest:
      type: object
      additionalProperties: false
      description: Request to find bundles containing a specific asset
      required:
      - assetId
      - realm
      properties:
        assetId:
          type: string
          description: Platform asset ID to search for
        realm:
          $ref: '#/components/schemas/Realm'
          description: Game realm to search within
        bundleType:
          allOf:
          - $ref: '#/components/schemas/BundleType'
          nullable: true
          description: Filter by bundle type (optional, null for all types)
        limit:
          type: integer
          default: 50
          description: Maximum results to return
        offset:
          type: integer
          default: 0
          description: Pagination offset
    QueryBundlesByAssetResponse:
      type: object
      additionalProperties: false
      description: Bundles containing the requested asset
      required:
      - assetId
      - bundles
      - total
      - limit
      - offset
      properties:
        assetId:
          type: string
          description: The queried asset ID
        bundles:
          type: array
          items:
            $ref: '#/components/schemas/BundleSummary'
          description: Bundles containing this asset
        total:
          type: integer
          description: Total matching bundles
        limit:
          type: integer
          description: Page size
        offset:
          type: integer
          description: Page offset
    BundleSummary:
      type: object
      additionalProperties: false
      description: Summary information about a bundle
      required:
      - bundleId
      - bundleType
      - version
      - assetCount
      - realm
      properties:
        bundleId:
          type: string
          description: Bundle identifier
        bundleType:
          $ref: '#/components/schemas/BundleType'
          description: Source or metabundle
        version:
          type: string
          description: Bundle version
        assetCount:
          type: integer
          description: Number of assets in bundle
        sizeBytes:
          type: integer
          format: int64
          nullable: true
          description: Bundle file size
        realm:
          $ref: '#/components/schemas/Realm'
          description: Game realm
        createdAt:
          type: string
          format: date-time
          nullable: true
          description: When the bundle was created
    BulkGetAssetsRequest:
      type: object
      additionalProperties: false
      description: Request to retrieve metadata for multiple assets
      required:
      - assetIds
      properties:
        assetIds:
          type: array
          items:
            type: string
          description: Asset IDs to retrieve (max 100)
        includeDownloadUrls:
          type: boolean
          default: false
          description: Whether to generate pre-signed download URLs
    BulkGetAssetsResponse:
      type: object
      additionalProperties: false
      description: Batch asset metadata response
      required:
      - assets
      - notFound
      properties:
        assets:
          type: array
          items:
            $ref: '#/components/schemas/AssetWithDownloadUrl'
          description: Found assets with metadata
        notFound:
          type: array
          items:
            type: string
          description: Asset IDs that weren't found
    BundleStatus:
      type: string
      enum:
      - pending
      - processing
      - ready
      - failed
      description: |
        Bundle processing status:
        - pending: Bundle creation is pending/queued
        - processing: Bundle is being processed
        - ready: Bundle is ready for download
        - failed: Bundle creation failed
    BundleLifecycle:
      type: string
      enum:
      - active
      - deleted
      - processing
      description: |
        Bundle lifecycle status:
        - active: Bundle is available for use
        - deleted: Bundle has been soft-deleted (within retention period)
        - processing: Bundle is being processed (metabundle creation)
    BundleInfo:
      type: object
      additionalProperties: false
      description: Complete metadata for an asset bundle (API response model)
      required:
      - bundleId
      - bundleType
      - version
      - metadataVersion
      - owner
      - realm
      - status
      - assetCount
      - createdAt
      properties:
        bundleId:
          type: string
          description: Unique bundle identifier
        bundleType:
          $ref: '#/components/schemas/BundleType'
          description: Whether source or metabundle
        version:
          type: string
          description: Bundle content version string
        metadataVersion:
          type: integer
          description: Metadata version number (increments on metadata changes)
        name:
          type: string
          nullable: true
          description: Human-readable bundle name
        description:
          type: string
          nullable: true
          description: Bundle description
        owner:
          type: string
          description: Owner account ID or service name
        realm:
          $ref: '#/components/schemas/Realm'
          description: Game realm this bundle belongs to
        tags:
          type: object
          additionalProperties:
            type: string
          nullable: true
          description: Key-value tags for categorization and filtering
        status:
          $ref: '#/components/schemas/BundleLifecycle'
          description: Bundle lifecycle status
        assetCount:
          type: integer
          description: Number of assets in the bundle
        sizeBytes:
          type: integer
          format: int64
          nullable: true
          description: Bundle file size in bytes (null if not yet calculated)
        createdAt:
          type: string
          format: date-time
          description: When the bundle was created
        updatedAt:
          type: string
          format: date-time
          nullable: true
          description: When the bundle metadata was last updated
        deletedAt:
          type: string
          format: date-time
          nullable: true
          description: When the bundle was soft-deleted (null if active)
    UpdateBundleRequest:
      type: object
      additionalProperties: false
      description: Request to update bundle metadata
      required:
      - bundleId
      properties:
        bundleId:
          type: string
          description: Bundle identifier to update
        name:
          type: string
          nullable: true
          description: New bundle name (null to leave unchanged)
        description:
          type: string
          nullable: true
          description: New bundle description (null to leave unchanged)
        tags:
          type: object
          additionalProperties:
            type: string
          nullable: true
          description: Replace all tags with these (null to leave unchanged)
        addTags:
          type: object
          additionalProperties:
            type: string
          nullable: true
          description: Tags to add (merged with existing)
        removeTags:
          type: array
          items:
            type: string
          nullable: true
          description: Tag keys to remove
        reason:
          type: string
          nullable: true
          description: Optional reason for the update (recorded in version history)
    UpdateBundleResponse:
      type: object
      additionalProperties: false
      description: Result of bundle update operation
      required:
      - bundleId
      - version
      - previousVersion
      - changes
      properties:
        bundleId:
          type: string
          description: Updated bundle identifier
        version:
          type: integer
          description: New version number after update
        previousVersion:
          type: integer
          description: Version number before update
        changes:
          type: array
          items:
            type: string
          description: List of changes made (e.g., "name changed", "tag 'env' added")
        updatedAt:
          type: string
          format: date-time
          description: When the update occurred
    DeleteBundleRequest:
      type: object
      additionalProperties: false
      description: Request to delete a bundle
      required:
      - bundleId
      properties:
        bundleId:
          type: string
          description: Bundle identifier to delete
        permanent:
          type: boolean
          default: false
          description: If true, permanently delete (admin only). If false, soft-delete.
        reason:
          type: string
          nullable: true
          description: Optional reason for deletion (recorded in version history)
    DeleteBundleResponse:
      type: object
      additionalProperties: false
      description: Result of bundle deletion
      required:
      - bundleId
      - status
      - deletedAt
      properties:
        bundleId:
          type: string
          description: Deleted bundle identifier
        status:
          type: string
          enum:
          - deleted
          - permanently_deleted
          description: Deletion status
        deletedAt:
          type: string
          format: date-time
          description: When the bundle was deleted
        retentionUntil:
          type: string
          format: date-time
          nullable: true
          description: When soft-deleted bundle will be permanently removed (null for permanent deletes)
    RestoreBundleRequest:
      type: object
      additionalProperties: false
      description: Request to restore a soft-deleted bundle
      required:
      - bundleId
      properties:
        bundleId:
          type: string
          description: Bundle identifier to restore
        reason:
          type: string
          nullable: true
          description: Optional reason for restoration (recorded in version history)
    RestoreBundleResponse:
      type: object
      additionalProperties: false
      description: Result of bundle restoration
      required:
      - bundleId
      - status
      - restoredAt
      - restoredFromVersion
      properties:
        bundleId:
          type: string
          description: Restored bundle identifier
        status:
          type: string
          description: Current bundle status (should be "active")
        restoredAt:
          type: string
          format: date-time
          description: When the bundle was restored
        restoredFromVersion:
          type: integer
          description: Version number the bundle was restored from
    QueryBundlesRequest:
      type: object
      additionalProperties: false
      description: Advanced bundle query with filters
      properties:
        tags:
          type: object
          additionalProperties:
            type: string
          nullable: true
          description: Filter by exact tag key-value matches
        tagExists:
          type: array
          items:
            type: string
          nullable: true
          description: Filter bundles that have these tag keys (any value)
        tagNotExists:
          type: array
          items:
            type: string
          nullable: true
          description: Filter bundles that do NOT have these tag keys
        status:
          allOf:
          - $ref: '#/components/schemas/BundleLifecycle'
          nullable: true
          description: Filter by lifecycle status (null for active only by default)
        createdAfter:
          type: string
          format: date-time
          nullable: true
          description: Filter bundles created after this time
        createdBefore:
          type: string
          format: date-time
          nullable: true
          description: Filter bundles created before this time
        nameContains:
          type: string
          nullable: true
          description: Filter bundles with name containing this string (case-insensitive)
        owner:
          type: string
          nullable: true
          description: Filter by bundle owner account ID
        realm:
          allOf:
          - $ref: '#/components/schemas/Realm'
          nullable: true
          description: Filter by realm
        bundleType:
          allOf:
          - $ref: '#/components/schemas/BundleType'
          nullable: true
          description: Filter by bundle type (source or metabundle)
        sortField:
          type: string
          enum:
          - created_at
          - updated_at
          - name
          - size
          nullable: true
          description: Field to sort by (default created_at)
        sortOrder:
          type: string
          enum:
          - asc
          - desc
          nullable: true
          description: Sort order (default desc)
        limit:
          type: integer
          default: 100
          description: Maximum results to return (max 1000)
        offset:
          type: integer
          default: 0
          description: Pagination offset
        includeDeleted:
          type: boolean
          default: false
          description: Include soft-deleted bundles in results
    QueryBundlesResponse:
      type: object
      additionalProperties: false
      description: Bundle query results
      required:
      - bundles
      - totalCount
      - limit
      - offset
      properties:
        bundles:
          type: array
          items:
            $ref: '#/components/schemas/BundleInfo'
          description: Matching bundles
        totalCount:
          type: integer
          description: Total number of matching bundles (for pagination)
        limit:
          type: integer
          description: Page size used
        offset:
          type: integer
          description: Page offset used
    ListBundleVersionsRequest:
      type: object
      additionalProperties: false
      description: Request to list bundle version history
      required:
      - bundleId
      properties:
        bundleId:
          type: string
          description: Bundle identifier to get history for
        limit:
          type: integer
          default: 50
          description: Maximum versions to return
        offset:
          type: integer
          default: 0
          description: Pagination offset
    ListBundleVersionsResponse:
      type: object
      additionalProperties: false
      description: Bundle version history
      required:
      - bundleId
      - currentVersion
      - versions
      - totalCount
      properties:
        bundleId:
          type: string
          description: Bundle identifier
        currentVersion:
          type: integer
          description: Current version number
        versions:
          type: array
          items:
            $ref: '#/components/schemas/BundleVersionRecord'
          description: Version history records (newest first)
        totalCount:
          type: integer
          description: Total number of versions
    BundleVersionRecord:
      type: object
      additionalProperties: false
      description: A single version record in bundle history
      required:
      - version
      - createdAt
      - createdBy
      - changes
      properties:
        version:
          type: integer
          description: Version number
        createdAt:
          type: string
          format: date-time
          description: When this version was created
        createdBy:
          type: string
          description: Account ID that made the change
        changes:
          type: array
          items:
            type: string
          description: List of changes in this version
        reason:
          type: string
          nullable: true
          description: Reason provided for the change
        snapshot:
          allOf:
          - $ref: '#/components/schemas/BundleInfo'
          nullable: true
          description: Full metadata snapshot at this version (only for current version)
