openapi: 3.0.0
info:
  title: Bannou Account Service API
  description: |
    Internal account management service (CRUD operations only, never exposed to internet).

    **POST-Only API Pattern**: This API uses POST for all operations to support zero-copy
    WebSocket routing. Path parameters are passed in request bodies instead of URLs.
    See docs/BANNOU_DESIGN.md for architectural rationale.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 2.0.0
x-service-layer: AppFoundation
servers:
- url: http://localhost:5012
  description: Bannou service endpoint (internal only)
paths:
  /account/list:
    post:
      summary: List accounts with filtering
      operationId: listAccounts
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListAccountsRequest'
      responses:
        '200':
          description: Accounts retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountListResponse'
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/ListAccountsRequest\"\
        ,\n    \"$defs\": {\n        \"ListAccountsRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to list accounts with optional filtering\",\n            \"additionalProperties\": false,\n          \
        \  \"properties\": {\n                \"email\": {\n                    \"type\": \"string\",\n                  \
        \  \"format\": \"email\",\n                    \"nullable\": true,\n                    \"description\": \"Filter
        accounts by email address\"\n                },\n                \"displayName\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Filter accounts by
        display name\"\n                },\n                \"provider\": {\n                    \"allOf\": [\n          \
        \              {\n                            \"$ref\": \"#/$defs/AuthProvider\"\n                        }\n    \
        \                ],\n                    \"nullable\": true,\n                    \"description\": \"Filter accounts
        by authentication provider\"\n                },\n                \"verified\": {\n                    \"type\": \"\
        boolean\",\n                    \"nullable\": true,\n                    \"description\": \"Filter accounts by email
        verification status\"\n                },\n                \"page\": {\n                    \"type\": \"integer\"\
        ,\n                    \"minimum\": 1,\n                    \"default\": 1,\n                    \"description\":
        \"Page number for pagination\"\n                },\n                \"pageSize\": {\n                    \"type\"\
        : \"integer\",\n                    \"minimum\": 1,\n                    \"maximum\": 100,\n                    \"\
        default\": 20,\n                    \"description\": \"Number of accounts per page\"\n                }\n        \
        \    }\n        },\n        \"AuthProvider\": {\n            \"type\": \"string\",\n            \"description\": \"\
        All authentication provider types including email\",\n            \"enum\": [\n                \"email\",\n      \
        \          \"google\",\n                \"discord\",\n                \"twitch\",\n                \"steam\"\n   \
        \         ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountListResponse\"\
        ,\n    \"$defs\": {\n        \"AccountListResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Paginated list of accounts\",\n            \"additionalProperties\": false,\n            \"required\": [\n   \
        \             \"accounts\",\n                \"totalCount\",\n                \"page\",\n                \"pageSize\"\
        ,\n                \"hasNextPage\",\n                \"hasPreviousPage\"\n            ],\n            \"properties\"\
        : {\n                \"accounts\": {\n                    \"type\": \"array\",\n                    \"items\": {\n\
        \                        \"$ref\": \"#/$defs/AccountResponse\"\n                    },\n                    \"description\"\
        : \"List of accounts for the current page\"\n                },\n                \"totalCount\": {\n             \
        \       \"type\": \"integer\",\n                    \"description\": \"Total number of accounts matching the filter\"\
        \n                },\n                \"page\": {\n                    \"type\": \"integer\",\n                  \
        \  \"description\": \"Current page number\"\n                },\n                \"pageSize\": {\n               \
        \     \"type\": \"integer\",\n                    \"description\": \"Number of accounts per page\"\n             \
        \   },\n                \"hasNextPage\": {\n                    \"type\": \"boolean\",\n                    \"description\"\
        : \"Whether there are more pages after this one\"\n                },\n                \"hasPreviousPage\": {\n  \
        \                  \"type\": \"boolean\",\n                    \"description\": \"Whether there are pages before this
        one\"\n                }\n            }\n        },\n        \"AccountResponse\": {\n            \"type\": \"object\"\
        ,\n            \"description\": \"Account information response\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"accountId\",\n                \"createdAt\",\n                \"emailVerified\"\
        ,\n                \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n  \
        \              \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"Unique identifier for the account\"\n                },\n              \
        \  \"email\": {\n                    \"type\": \"string\",\n                    \"format\": \"email\",\n         \
        \           \"nullable\": true,\n                    \"description\": \"Email address associated with the account.
        Null for OAuth/Steam accounts without email.\"\n                },\n                \"displayName\": {\n         \
        \           \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Display name for the account\"\n                },\n                \"passwordHash\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"BCrypt hashed password
        for authentication\"\n                },\n                \"createdAt\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account
        was created\"\n                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n \
        \                   \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n    \
        \                \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been
        verified\"\n                },\n                \"roles\": {\n                    \"type\": \"array\",\n         \
        \           \"items\": {\n                        \"type\": \"string\"\n                    },\n                 \
        \   \"description\": \"List of roles assigned to the account\"\n                },\n                \"authMethods\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\"\
        : \"#/$defs/AuthMethodInfo\"\n                    },\n                    \"description\": \"List of authentication
        methods linked to the account\"\n                },\n                \"metadata\": {\n                    \"type\"\
        : \"object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n    \
        \                \"description\": \"Client-only metadata. No Bannou plugin reads specific keys from this field by
        convention.\"\n                },\n                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n\
        \                    \"default\": false,\n                    \"description\": \"Whether multi-factor authentication
        is enabled for this account\"\n                },\n                \"mfaSecret\": {\n                    \"type\"\
        : \"string\",\n                    \"nullable\": true,\n                    \"description\": \"Encrypted TOTP secret
        (AES-256-GCM ciphertext). Auth service encrypts and decrypts. Account stores opaque ciphertext.\"\n              \
        \  },\n                \"mfaRecoveryCodes\": {\n                    \"type\": \"array\",\n                    \"items\"\
        : {\n                        \"type\": \"string\"\n                    },\n                    \"nullable\": true,\n\
        \                    \"description\": \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies.
        Account stores opaque hashes.\"\n                }\n            }\n        },\n        \"AuthMethodInfo\": {\n   \
        \         \"type\": \"object\",\n            \"description\": \"Information about a linked authentication method\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"provider\",\n    \
        \            \"linkedAt\"\n            ],\n            \"properties\": {\n                \"methodId\": {\n      \
        \              \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Unique identifier for the authentication method\"\n              \
        \  },\n                \"provider\": {\n                    \"allOf\": [\n                        {\n            \
        \                \"$ref\": \"#/$defs/AuthProvider\"\n                        }\n                    ],\n         \
        \           \"description\": \"Authentication provider type\"\n                },\n                \"externalId\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"External user ID from the authentication provider\"\n                },\n                \"displayName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Display name from the authentication provider\"\n                },\n                \"linkedAt\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Timestamp when the authentication method was linked\"\n                }\n            }\n        },\n        \"\
        AuthProvider\": {\n            \"type\": \"string\",\n            \"description\": \"All authentication provider types
        including email\",\n            \"enum\": [\n                \"email\",\n                \"google\",\n           \
        \     \"discord\",\n                \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"List accounts with filtering\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"listAccounts\"\n}"
  /account/create:
    post:
      summary: Create new account
      operationId: createAccount
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAccountRequest'
      responses:
        '200':
          description: Account created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '400':
          description: Invalid account data
        '409':
          description: Account already exists
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CreateAccountRequest\"\
        ,\n    \"$defs\": {\n        \"CreateAccountRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to create a new account\",\n            \"additionalProperties\": false,\n            \"properties\":
        {\n                \"email\": {\n                    \"type\": \"string\",\n                    \"format\": \"email\"\
        ,\n                    \"maxLength\": 254,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Email address for the new account. Null for OAuth/Steam accounts without email.\"\n                },\n      \
        \          \"passwordHash\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 255,\n\
        \                    \"nullable\": true,\n                    \"description\": \"Pre-hashed password from Auth service\"\
        \n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"maxLength\": 100,\n                    \"description\": \"Display
        name for the account\"\n                },\n                \"emailVerified\": {\n                    \"type\": \"\
        boolean\",\n                    \"default\": false,\n                    \"description\": \"Whether the email address
        has been verified\"\n                },\n                \"roles\": {\n                    \"type\": \"array\",\n\
        \                    \"items\": {\n                        \"type\": \"string\",\n                        \"maxLength\"\
        : 50\n                    },\n                    \"maxItems\": 20,\n                    \"nullable\": true,\n   \
        \                 \"description\": \"List of roles assigned to the account (null defaults to empty)\"\n          \
        \      },\n                \"metadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : true,\n                    \"nullable\": true,\n                    \"description\": \"Client-only metadata. No
        Bannou plugin reads specific keys from this field by convention.\"\n                }\n            }\n        }\n\
        \    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountResponse\"\
        ,\n    \"$defs\": {\n        \"AccountResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Account information response\",\n            \"additionalProperties\": false,\n            \"required\": [\n \
        \               \"accountId\",\n                \"createdAt\",\n                \"emailVerified\",\n             \
        \   \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n                \"\
        accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Unique identifier for the account\"\n                },\n                \"email\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Email address associated with the account. Null for OAuth/Steam accounts
        without email.\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Display name for the account\"\n\
        \                },\n                \"passwordHash\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"BCrypt hashed password for authentication\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n        \
        \            \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been verified\"\
        \n                },\n                \"roles\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"List of roles assigned to the account\"\n                },\n                \"authMethods\": {\n            \
        \        \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\
        \n                    },\n                    \"description\": \"List of authentication methods linked to the account\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\n                },\n\
        \                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n\
        \                    \"description\": \"Whether multi-factor authentication is enabled for this account\"\n      \
        \          },\n                \"mfaSecret\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service
        encrypts and decrypts. Account stores opaque ciphertext.\"\n                },\n                \"mfaRecoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores opaque hashes.\"\n\
        \                }\n            }\n        },\n        \"AuthMethodInfo\": {\n            \"type\": \"object\",\n\
        \            \"description\": \"Information about a linked authentication method\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"provider\",\n                \"linkedAt\"\n            ],\n\
        \            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Unique identifier for the authentication method\"\n                },\n                \"provider\": {\n     \
        \               \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/AuthProvider\"\
        \n                        }\n                    ],\n                    \"description\": \"Authentication provider
        type\"\n                },\n                \"externalId\": {\n                    \"type\": \"string\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"External user ID from the authentication
        provider\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n  \
        \                  \"nullable\": true,\n                    \"description\": \"Display name from the authentication
        provider\"\n                },\n                \"linkedAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the authentication
        method was linked\"\n                }\n            }\n        },\n        \"AuthProvider\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"All authentication provider types including email\",\n            \"\
        enum\": [\n                \"email\",\n                \"google\",\n                \"discord\",\n               \
        \ \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Create new account\",\n    \"description\": \"\",\n    \"tags\": [\n  \
        \      \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"createAccount\"\n}"
  /account/get:
    post:
      summary: Get account by ID
      operationId: getAccount
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetAccountRequest'
      responses:
        '200':
          description: Account retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          description: Account not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetAccountRequest\"\
        ,\n    \"$defs\": {\n        \"GetAccountRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to get a specific account by ID\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountId\"\n            ],\n            \"properties\": {\n                \"accountId\":
        {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"ID of the account to retrieve\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountResponse\"\
        ,\n    \"$defs\": {\n        \"AccountResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Account information response\",\n            \"additionalProperties\": false,\n            \"required\": [\n \
        \               \"accountId\",\n                \"createdAt\",\n                \"emailVerified\",\n             \
        \   \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n                \"\
        accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Unique identifier for the account\"\n                },\n                \"email\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Email address associated with the account. Null for OAuth/Steam accounts
        without email.\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Display name for the account\"\n\
        \                },\n                \"passwordHash\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"BCrypt hashed password for authentication\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n        \
        \            \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been verified\"\
        \n                },\n                \"roles\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"List of roles assigned to the account\"\n                },\n                \"authMethods\": {\n            \
        \        \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\
        \n                    },\n                    \"description\": \"List of authentication methods linked to the account\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\n                },\n\
        \                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n\
        \                    \"description\": \"Whether multi-factor authentication is enabled for this account\"\n      \
        \          },\n                \"mfaSecret\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service
        encrypts and decrypts. Account stores opaque ciphertext.\"\n                },\n                \"mfaRecoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores opaque hashes.\"\n\
        \                }\n            }\n        },\n        \"AuthMethodInfo\": {\n            \"type\": \"object\",\n\
        \            \"description\": \"Information about a linked authentication method\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"provider\",\n                \"linkedAt\"\n            ],\n\
        \            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Unique identifier for the authentication method\"\n                },\n                \"provider\": {\n     \
        \               \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/AuthProvider\"\
        \n                        }\n                    ],\n                    \"description\": \"Authentication provider
        type\"\n                },\n                \"externalId\": {\n                    \"type\": \"string\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"External user ID from the authentication
        provider\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n  \
        \                  \"nullable\": true,\n                    \"description\": \"Display name from the authentication
        provider\"\n                },\n                \"linkedAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the authentication
        method was linked\"\n                }\n            }\n        },\n        \"AuthProvider\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"All authentication provider types including email\",\n            \"\
        enum\": [\n                \"email\",\n                \"google\",\n                \"discord\",\n               \
        \ \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get account by ID\",\n    \"description\": \"\",\n    \"tags\": [\n   \
        \     \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getAccount\"\n}"
  /account/update:
    post:
      summary: Update account
      operationId: updateAccount
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAccountRequest'
      responses:
        '200':
          description: Account updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          description: Account not found
        '400':
          description: Invalid update data
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateAccountRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateAccountRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to update an existing account\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountId\"\n            ],\n            \"properties\": {\n                \"accountId\":
        {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"ID of the account to update\"\n                },\n                \"displayName\": {\n                    \"\
        type\": \"string\",\n                    \"nullable\": true,\n                    \"maxLength\": 100,\n          \
        \          \"description\": \"New display name for the account\"\n                },\n                \"roles\": {\n\
        \                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"\
        string\",\n                        \"maxLength\": 50\n                    },\n                    \"maxItems\": 20,\n\
        \                    \"nullable\": true,\n                    \"description\": \"Updated list of roles for the account
        (null to keep unchanged)\"\n                },\n                \"metadata\": {\n                    \"type\": \"\
        object\",\n                    \"additionalProperties\": true,\n                    \"nullable\": true,\n        \
        \            \"description\": \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\
        \n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountResponse\"\
        ,\n    \"$defs\": {\n        \"AccountResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Account information response\",\n            \"additionalProperties\": false,\n            \"required\": [\n \
        \               \"accountId\",\n                \"createdAt\",\n                \"emailVerified\",\n             \
        \   \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n                \"\
        accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Unique identifier for the account\"\n                },\n                \"email\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Email address associated with the account. Null for OAuth/Steam accounts
        without email.\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Display name for the account\"\n\
        \                },\n                \"passwordHash\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"BCrypt hashed password for authentication\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n        \
        \            \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been verified\"\
        \n                },\n                \"roles\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"List of roles assigned to the account\"\n                },\n                \"authMethods\": {\n            \
        \        \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\
        \n                    },\n                    \"description\": \"List of authentication methods linked to the account\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\n                },\n\
        \                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n\
        \                    \"description\": \"Whether multi-factor authentication is enabled for this account\"\n      \
        \          },\n                \"mfaSecret\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service
        encrypts and decrypts. Account stores opaque ciphertext.\"\n                },\n                \"mfaRecoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores opaque hashes.\"\n\
        \                }\n            }\n        },\n        \"AuthMethodInfo\": {\n            \"type\": \"object\",\n\
        \            \"description\": \"Information about a linked authentication method\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"provider\",\n                \"linkedAt\"\n            ],\n\
        \            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Unique identifier for the authentication method\"\n                },\n                \"provider\": {\n     \
        \               \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/AuthProvider\"\
        \n                        }\n                    ],\n                    \"description\": \"Authentication provider
        type\"\n                },\n                \"externalId\": {\n                    \"type\": \"string\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"External user ID from the authentication
        provider\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n  \
        \                  \"nullable\": true,\n                    \"description\": \"Display name from the authentication
        provider\"\n                },\n                \"linkedAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the authentication
        method was linked\"\n                }\n            }\n        },\n        \"AuthProvider\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"All authentication provider types including email\",\n            \"\
        enum\": [\n                \"email\",\n                \"google\",\n                \"discord\",\n               \
        \ \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Update account\",\n    \"description\": \"\",\n    \"tags\": [\n      \
        \  \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updateAccount\"\n}"
  /account/delete:
    post:
      summary: Delete account
      operationId: deleteAccount
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteAccountRequest'
      responses:
        '200':
          description: Account deleted successfully
        '404':
          description: Account not found
        '409':
          description: Account cannot be deleted (active sessions exist)
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/DeleteAccountRequest\"\
        ,\n    \"$defs\": {\n        \"DeleteAccountRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to delete a specific account\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountId\"\n            ],\n            \"properties\": {\n                \"accountId\":
        {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"ID of the account to delete\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Delete account\",\n    \"description\": \"\",\n    \"tags\": [\n      \
        \  \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"deleteAccount\"\n}"
  /account/by-email:
    post:
      summary: Get account by email
      operationId: getAccountByEmail
      tags:
      - Account Lookup
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetAccountByEmailRequest'
      responses:
        '200':
          description: Account retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          description: Account not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetAccountByEmailRequest\"\
        ,\n    \"$defs\": {\n        \"GetAccountByEmailRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to get account by email address\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"email\"\n            ],\n            \"properties\": {\n                \"email\": {\n    \
        \                \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"maxLength\"\
        : 254,\n                    \"description\": \"Email address to look up\"\n                }\n            }\n    \
        \    }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountResponse\"\
        ,\n    \"$defs\": {\n        \"AccountResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Account information response\",\n            \"additionalProperties\": false,\n            \"required\": [\n \
        \               \"accountId\",\n                \"createdAt\",\n                \"emailVerified\",\n             \
        \   \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n                \"\
        accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Unique identifier for the account\"\n                },\n                \"email\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Email address associated with the account. Null for OAuth/Steam accounts
        without email.\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Display name for the account\"\n\
        \                },\n                \"passwordHash\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"BCrypt hashed password for authentication\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n        \
        \            \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been verified\"\
        \n                },\n                \"roles\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"List of roles assigned to the account\"\n                },\n                \"authMethods\": {\n            \
        \        \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\
        \n                    },\n                    \"description\": \"List of authentication methods linked to the account\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\n                },\n\
        \                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n\
        \                    \"description\": \"Whether multi-factor authentication is enabled for this account\"\n      \
        \          },\n                \"mfaSecret\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service
        encrypts and decrypts. Account stores opaque ciphertext.\"\n                },\n                \"mfaRecoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores opaque hashes.\"\n\
        \                }\n            }\n        },\n        \"AuthMethodInfo\": {\n            \"type\": \"object\",\n\
        \            \"description\": \"Information about a linked authentication method\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"provider\",\n                \"linkedAt\"\n            ],\n\
        \            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Unique identifier for the authentication method\"\n                },\n                \"provider\": {\n     \
        \               \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/AuthProvider\"\
        \n                        }\n                    ],\n                    \"description\": \"Authentication provider
        type\"\n                },\n                \"externalId\": {\n                    \"type\": \"string\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"External user ID from the authentication
        provider\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n  \
        \                  \"nullable\": true,\n                    \"description\": \"Display name from the authentication
        provider\"\n                },\n                \"linkedAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the authentication
        method was linked\"\n                }\n            }\n        },\n        \"AuthProvider\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"All authentication provider types including email\",\n            \"\
        enum\": [\n                \"email\",\n                \"google\",\n                \"discord\",\n               \
        \ \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get account by email\",\n    \"description\": \"\",\n    \"tags\": [\n\
        \        \"Account Lookup\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getAccountByEmail\"\n}"
  /account/auth-methods/list:
    post:
      summary: Get authentication methods for account
      operationId: getAuthMethods
      tags:
      - Authentication Methods
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetAuthMethodsRequest'
      responses:
        '200':
          description: Authentication methods retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthMethodsResponse'
        '404':
          description: Account not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetAuthMethodsRequest\"\
        ,\n    \"$defs\": {\n        \"GetAuthMethodsRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to get authentication methods for an account\",\n            \"additionalProperties\": false,\n      \
        \      \"required\": [\n                \"accountId\"\n            ],\n            \"properties\": {\n           \
        \     \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n   \
        \                 \"description\": \"ID of the account\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AuthMethodsResponse\"\
        ,\n    \"$defs\": {\n        \"AuthMethodsResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response containing list of authentication methods\",\n            \"additionalProperties\": false,\n        \
        \    \"required\": [\n                \"authMethods\"\n            ],\n            \"properties\": {\n           \
        \     \"authMethods\": {\n                    \"type\": \"array\",\n                    \"items\": {\n           \
        \             \"$ref\": \"#/$defs/AuthMethodInfo\"\n                    },\n                    \"description\": \"\
        List of authentication methods linked to the account\"\n                }\n            }\n        },\n        \"AuthMethodInfo\"\
        : {\n            \"type\": \"object\",\n            \"description\": \"Information about a linked authentication method\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"provider\",\n    \
        \            \"linkedAt\"\n            ],\n            \"properties\": {\n                \"methodId\": {\n      \
        \              \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Unique identifier for the authentication method\"\n              \
        \  },\n                \"provider\": {\n                    \"allOf\": [\n                        {\n            \
        \                \"$ref\": \"#/$defs/AuthProvider\"\n                        }\n                    ],\n         \
        \           \"description\": \"Authentication provider type\"\n                },\n                \"externalId\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"External user ID from the authentication provider\"\n                },\n                \"displayName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Display name from the authentication provider\"\n                },\n                \"linkedAt\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Timestamp when the authentication method was linked\"\n                }\n            }\n        },\n        \"\
        AuthProvider\": {\n            \"type\": \"string\",\n            \"description\": \"All authentication provider types
        including email\",\n            \"enum\": [\n                \"email\",\n                \"google\",\n           \
        \     \"discord\",\n                \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get authentication methods for account\",\n    \"description\": \"\",\n\
        \    \"tags\": [\n        \"Authentication Methods\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"\
        getAuthMethods\"\n}"
  /account/auth-methods/add:
    post:
      summary: Add authentication method to account
      operationId: addAuthMethod
      tags:
      - Authentication Methods
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddAuthMethodRequest'
      responses:
        '200':
          description: Authentication method added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthMethodResponse'
        '404':
          description: Account not found
        '409':
          description: Authentication method already exists
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AddAuthMethodRequest\"\
        ,\n    \"$defs\": {\n        \"AddAuthMethodRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to add an authentication method to an account\",\n            \"additionalProperties\": false,\n     \
        \       \"required\": [\n                \"accountId\",\n                \"provider\",\n                \"externalId\"\
        \n            ],\n            \"properties\": {\n                \"accountId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"ID of the account to
        add auth method to\"\n                },\n                \"provider\": {\n                    \"allOf\": [\n    \
        \                    {\n                            \"$ref\": \"#/$defs/OAuthProvider\"\n                        }\n\
        \                    ],\n                    \"description\": \"OAuth provider type to add\"\n                },\n\
        \                \"externalId\": {\n                    \"type\": \"string\",\n                    \"maxLength\":
        255,\n                    \"description\": \"External user ID from the OAuth provider\"\n                },\n    \
        \            \"displayName\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Display name from the OAuth provider\"\n                }\n            }\n\
        \        },\n        \"OAuthProvider\": {\n            \"type\": \"string\",\n            \"description\": \"OAuth
        provider types (excludes email)\",\n            \"enum\": [\n                \"google\",\n                \"discord\"\
        ,\n                \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AuthMethodResponse\"\
        ,\n    \"$defs\": {\n        \"AuthMethodResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response after adding an authentication method\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"methodId\",\n                \"provider\",\n                \"linkedAt\"\n      \
        \      ],\n            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\"\
        ,\n                    \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for the authentication
        method\"\n                },\n                \"provider\": {\n                    \"allOf\": [\n                \
        \        {\n                            \"$ref\": \"#/$defs/OAuthProvider\"\n                        }\n         \
        \           ],\n                    \"description\": \"OAuth provider type\"\n                },\n               \
        \ \"externalId\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n        \
        \            \"description\": \"External user ID from the OAuth provider\"\n                },\n                \"\
        displayName\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n           \
        \         \"description\": \"Display name from the OAuth provider\"\n                },\n                \"linkedAt\"\
        : {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                 \
        \   \"description\": \"Timestamp when the authentication method was linked\"\n                }\n            }\n \
        \       },\n        \"OAuthProvider\": {\n            \"type\": \"string\",\n            \"description\": \"OAuth
        provider types (excludes email)\",\n            \"enum\": [\n                \"google\",\n                \"discord\"\
        ,\n                \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Add authentication method to account\",\n    \"description\": \"\",\n \
        \   \"tags\": [\n        \"Authentication Methods\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"addAuthMethod\"\
        \n}"
  /account/auth-methods/remove:
    post:
      summary: Remove authentication method from account
      operationId: removeAuthMethod
      tags:
      - Authentication Methods
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RemoveAuthMethodRequest'
      responses:
        '200':
          description: Authentication method removed successfully
        '404':
          description: Account or method not found
        '400':
          description: Cannot remove last authentication method
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/RemoveAuthMethodRequest\"\
        ,\n    \"$defs\": {\n        \"RemoveAuthMethodRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to remove an authentication method from an account\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"accountId\",\n                \"methodId\"\n            ],\n     \
        \       \"properties\": {\n                \"accountId\": {\n                    \"type\": \"string\",\n         \
        \           \"format\": \"uuid\",\n                    \"description\": \"ID of the account\"\n                },\n\
        \                \"methodId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\"\
        ,\n                    \"description\": \"ID of the authentication method to remove\"\n                }\n       \
        \     }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Remove authentication method from account\",\n    \"description\": \"\"\
        ,\n    \"tags\": [\n        \"Authentication Methods\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"\
        removeAuthMethod\"\n}"
  /account/by-provider:
    post:
      summary: Get account by external provider ID
      operationId: getAccountByProvider
      tags:
      - Account Lookup
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetAccountByProviderRequest'
      responses:
        '200':
          description: Account retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          description: Account not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/GetAccountByProviderRequest\"\
        ,\n    \"$defs\": {\n        \"GetAccountByProviderRequest\": {\n            \"type\": \"object\",\n            \"\
        description\": \"Request to get account by external provider ID\",\n            \"additionalProperties\": false,\n\
        \            \"required\": [\n                \"provider\",\n                \"externalId\"\n            ],\n    \
        \        \"properties\": {\n                \"provider\": {\n                    \"allOf\": [\n                  \
        \      {\n                            \"$ref\": \"#/$defs/OAuthProvider\"\n                        }\n           \
        \         ],\n                    \"description\": \"OAuth provider type\"\n                },\n                \"\
        externalId\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 255,\n            \
        \        \"description\": \"External ID from the provider\"\n                }\n            }\n        },\n      \
        \  \"OAuthProvider\": {\n            \"type\": \"string\",\n            \"description\": \"OAuth provider types (excludes
        email)\",\n            \"enum\": [\n                \"google\",\n                \"discord\",\n                \"\
        twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountResponse\"\
        ,\n    \"$defs\": {\n        \"AccountResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Account information response\",\n            \"additionalProperties\": false,\n            \"required\": [\n \
        \               \"accountId\",\n                \"createdAt\",\n                \"emailVerified\",\n             \
        \   \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n                \"\
        accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Unique identifier for the account\"\n                },\n                \"email\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Email address associated with the account. Null for OAuth/Steam accounts
        without email.\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Display name for the account\"\n\
        \                },\n                \"passwordHash\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"BCrypt hashed password for authentication\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n        \
        \            \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been verified\"\
        \n                },\n                \"roles\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"List of roles assigned to the account\"\n                },\n                \"authMethods\": {\n            \
        \        \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\
        \n                    },\n                    \"description\": \"List of authentication methods linked to the account\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\n                },\n\
        \                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n\
        \                    \"description\": \"Whether multi-factor authentication is enabled for this account\"\n      \
        \          },\n                \"mfaSecret\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service
        encrypts and decrypts. Account stores opaque ciphertext.\"\n                },\n                \"mfaRecoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores opaque hashes.\"\n\
        \                }\n            }\n        },\n        \"AuthMethodInfo\": {\n            \"type\": \"object\",\n\
        \            \"description\": \"Information about a linked authentication method\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"provider\",\n                \"linkedAt\"\n            ],\n\
        \            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Unique identifier for the authentication method\"\n                },\n                \"provider\": {\n     \
        \               \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/AuthProvider\"\
        \n                        }\n                    ],\n                    \"description\": \"Authentication provider
        type\"\n                },\n                \"externalId\": {\n                    \"type\": \"string\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"External user ID from the authentication
        provider\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n  \
        \                  \"nullable\": true,\n                    \"description\": \"Display name from the authentication
        provider\"\n                },\n                \"linkedAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the authentication
        method was linked\"\n                }\n            }\n        },\n        \"AuthProvider\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"All authentication provider types including email\",\n            \"\
        enum\": [\n                \"email\",\n                \"google\",\n                \"discord\",\n               \
        \ \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get account by external provider ID\",\n    \"description\": \"\",\n  \
        \  \"tags\": [\n        \"Account Lookup\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"getAccountByProvider\"\
        \n}"
  /account/profile/update:
    post:
      summary: Update account profile
      operationId: updateProfile
      tags:
      - Profile Management
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProfileRequest'
      responses:
        '200':
          description: Profile updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          description: Account not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateProfileRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateProfileRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to update an account profile\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountId\"\n            ],\n            \"properties\": {\n                \"accountId\":
        {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"ID of the account to update\"\n                },\n                \"displayName\": {\n                    \"\
        type\": \"string\",\n                    \"nullable\": true,\n                    \"maxLength\": 100,\n          \
        \          \"description\": \"New display name for the account\"\n                },\n                \"metadata\"\
        : {\n                    \"type\": \"object\",\n                    \"additionalProperties\": true,\n            \
        \        \"nullable\": true,\n                    \"description\": \"Client-only metadata. No Bannou plugin reads
        specific keys from this field by convention.\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountResponse\"\
        ,\n    \"$defs\": {\n        \"AccountResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Account information response\",\n            \"additionalProperties\": false,\n            \"required\": [\n \
        \               \"accountId\",\n                \"createdAt\",\n                \"emailVerified\",\n             \
        \   \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n                \"\
        accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Unique identifier for the account\"\n                },\n                \"email\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Email address associated with the account. Null for OAuth/Steam accounts
        without email.\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Display name for the account\"\n\
        \                },\n                \"passwordHash\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"BCrypt hashed password for authentication\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n        \
        \            \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been verified\"\
        \n                },\n                \"roles\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"List of roles assigned to the account\"\n                },\n                \"authMethods\": {\n            \
        \        \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\
        \n                    },\n                    \"description\": \"List of authentication methods linked to the account\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\n                },\n\
        \                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n\
        \                    \"description\": \"Whether multi-factor authentication is enabled for this account\"\n      \
        \          },\n                \"mfaSecret\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service
        encrypts and decrypts. Account stores opaque ciphertext.\"\n                },\n                \"mfaRecoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores opaque hashes.\"\n\
        \                }\n            }\n        },\n        \"AuthMethodInfo\": {\n            \"type\": \"object\",\n\
        \            \"description\": \"Information about a linked authentication method\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"provider\",\n                \"linkedAt\"\n            ],\n\
        \            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Unique identifier for the authentication method\"\n                },\n                \"provider\": {\n     \
        \               \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/AuthProvider\"\
        \n                        }\n                    ],\n                    \"description\": \"Authentication provider
        type\"\n                },\n                \"externalId\": {\n                    \"type\": \"string\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"External user ID from the authentication
        provider\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n  \
        \                  \"nullable\": true,\n                    \"description\": \"Display name from the authentication
        provider\"\n                },\n                \"linkedAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the authentication
        method was linked\"\n                }\n            }\n        },\n        \"AuthProvider\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"All authentication provider types including email\",\n            \"\
        enum\": [\n                \"email\",\n                \"google\",\n                \"discord\",\n               \
        \ \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Update account profile\",\n    \"description\": \"\",\n    \"tags\": [\n\
        \        \"Profile Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updateProfile\"\n}"
  /account/password/update:
    post:
      summary: Update account password hash
      operationId: updatePasswordHash
      tags:
      - Account Management
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePasswordRequest'
      responses:
        '200':
          description: Password hash updated successfully
        '404':
          description: Account not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdatePasswordRequest\"\
        ,\n    \"$defs\": {\n        \"UpdatePasswordRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to update an account password\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountId\",\n                \"passwordHash\"\n            ],\n            \"properties\"\
        : {\n                \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\":
        \"uuid\",\n                    \"description\": \"ID of the account to update\"\n                },\n            \
        \    \"passwordHash\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 255,\n   \
        \                 \"description\": \"New pre-hashed password from Auth service\"\n                }\n            }\n\
        \        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Update account password hash\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updatePasswordHash\"\
        \n}"
  /account/mfa/update:
    post:
      summary: Update MFA settings for an account
      description: |
        Sets or clears MFA-related fields (mfaEnabled, mfaSecret, mfaRecoveryCodes) atomically.
        Used by Auth service during MFA enable/disable flows. Auth owns the encryption logic;
        Account stores the opaque encrypted data.
      operationId: updateMfa
      tags:
      - Account Management
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMfaRequest'
      responses:
        '200':
          description: MFA settings updated successfully
        '404':
          description: Account not found
        '409':
          description: Concurrent modification detected
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateMfaRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateMfaRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to update MFA settings for an account\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"accountId\",\n                \"mfaEnabled\"\n            ],\n            \"properties\"\
        : {\n                \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\":
        \"uuid\",\n                    \"description\": \"ID of the account to update\"\n                },\n            \
        \    \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"Whether
        to enable or disable MFA\"\n                },\n                \"mfaSecret\": {\n                    \"type\": \"\
        string\",\n                    \"nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (set
        when enabling, null when disabling)\"\n                },\n                \"mfaRecoveryCodes\": {\n             \
        \       \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n   \
        \                 },\n                    \"nullable\": true,\n                    \"description\": \"BCrypt-hashed
        recovery codes (set when enabling, null when disabling)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Update MFA settings for an account\",\n    \"description\": \"Sets or clears
        MFA-related fields (mfaEnabled, mfaSecret, mfaRecoveryCodes) atomically.\\nUsed by Auth service during MFA enable/disable
        flows. Auth owns the encryption logic;\\nAccount stores the opaque encrypted data.\\n\",\n    \"tags\": [\n      \
        \  \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updateMfa\"\n}"
  /account/batch-get:
    post:
      summary: Get multiple accounts by ID
      operationId: batchGetAccounts
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchGetAccountsRequest'
      responses:
        '200':
          description: Batch get completed (partial results possible)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchGetAccountsResponse'
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BatchGetAccountsRequest\"\
        ,\n    \"$defs\": {\n        \"BatchGetAccountsRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to get multiple accounts by ID\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountIds\"\n            ],\n            \"properties\": {\n                \"accountIds\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\",\n                        \"format\": \"uuid\"\n                    },\n                    \"minItems\"\
        : 1,\n                    \"maxItems\": 100,\n                    \"description\": \"List of account IDs to retrieve
        (max 100)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BatchGetAccountsResponse\"\
        ,\n    \"$defs\": {\n        \"BatchGetAccountsResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response containing found accounts, IDs not found, and fetch failures\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"accounts\",\n                \"notFound\",\n            \
        \    \"failed\"\n            ],\n            \"properties\": {\n                \"accounts\": {\n                \
        \    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AccountResponse\"\
        \n                    },\n                    \"description\": \"Successfully retrieved accounts\"\n             \
        \   },\n                \"notFound\": {\n                    \"type\": \"array\",\n                    \"items\":
        {\n                        \"type\": \"string\",\n                        \"format\": \"uuid\"\n                 \
        \   },\n                    \"description\": \"Account IDs that were not found or are deleted\"\n                },\n\
        \                \"failed\": {\n                    \"type\": \"array\",\n                    \"items\": {\n     \
        \                   \"$ref\": \"#/$defs/BulkOperationFailure\"\n                    },\n                    \"description\"\
        : \"Account IDs that failed to fetch with error reasons\"\n                }\n            }\n        },\n        \"\
        AccountResponse\": {\n            \"type\": \"object\",\n            \"description\": \"Account information response\"\
        ,\n            \"additionalProperties\": false,\n            \"required\": [\n                \"accountId\",\n   \
        \             \"createdAt\",\n                \"emailVerified\",\n                \"roles\",\n                \"authMethods\"\
        \n            ],\n            \"properties\": {\n                \"accountId\": {\n                    \"type\": \"\
        string\",\n                    \"format\": \"uuid\",\n                    \"description\": \"Unique identifier for
        the account\"\n                },\n                \"email\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"email\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Email address associated with the account. Null for OAuth/Steam accounts without email.\"\n                },\n\
        \                \"displayName\": {\n                    \"type\": \"string\",\n                    \"nullable\":
        true,\n                    \"description\": \"Display name for the account\"\n                },\n               \
        \ \"passwordHash\": {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n      \
        \              \"description\": \"BCrypt hashed password for authentication\"\n                },\n              \
        \  \"createdAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n \
        \                   \"description\": \"Timestamp when the account was created\"\n                },\n            \
        \    \"updatedAt\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n\
        \                    \"nullable\": true,\n                    \"description\": \"Timestamp when the account was last
        updated\"\n                },\n                \"emailVerified\": {\n                    \"type\": \"boolean\",\n\
        \                    \"description\": \"Whether the email address has been verified\"\n                },\n      \
        \          \"roles\": {\n                    \"type\": \"array\",\n                    \"items\": {\n            \
        \            \"type\": \"string\"\n                    },\n                    \"description\": \"List of roles assigned
        to the account\"\n                },\n                \"authMethods\": {\n                    \"type\": \"array\"\
        ,\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\n              \
        \      },\n                    \"description\": \"List of authentication methods linked to the account\"\n       \
        \         },\n                \"metadata\": {\n                    \"type\": \"object\",\n                    \"additionalProperties\"\
        : true,\n                    \"nullable\": true,\n                    \"description\": \"Client-only metadata. No
        Bannou plugin reads specific keys from this field by convention.\"\n                },\n                \"mfaEnabled\"\
        : {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n                    \"description\"\
        : \"Whether multi-factor authentication is enabled for this account\"\n                },\n                \"mfaSecret\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service encrypts and decrypts. Account stores opaque ciphertext.\"\
        \n                },\n                \"mfaRecoveryCodes\": {\n                    \"type\": \"array\",\n        \
        \            \"items\": {\n                        \"type\": \"string\"\n                    },\n                \
        \    \"nullable\": true,\n                    \"description\": \"BCrypt-hashed single-use recovery codes. Auth service
        generates and verifies. Account stores opaque hashes.\"\n                }\n            }\n        },\n        \"\
        AuthMethodInfo\": {\n            \"type\": \"object\",\n            \"description\": \"Information about a linked
        authentication method\",\n            \"additionalProperties\": false,\n            \"required\": [\n            \
        \    \"provider\",\n                \"linkedAt\"\n            ],\n            \"properties\": {\n                \"\
        methodId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"Unique identifier for the authentication method\"\
        \n                },\n                \"provider\": {\n                    \"allOf\": [\n                        {\n\
        \                            \"$ref\": \"#/$defs/AuthProvider\"\n                        }\n                    ],\n\
        \                    \"description\": \"Authentication provider type\"\n                },\n                \"externalId\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"External user ID from the authentication provider\"\n                },\n                \"displayName\": {\n\
        \                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Display name from the authentication provider\"\n                },\n                \"linkedAt\": {\n       \
        \             \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\"\
        : \"Timestamp when the authentication method was linked\"\n                }\n            }\n        },\n        \"\
        AuthProvider\": {\n            \"type\": \"string\",\n            \"description\": \"All authentication provider types
        including email\",\n            \"enum\": [\n                \"email\",\n                \"google\",\n           \
        \     \"discord\",\n                \"twitch\",\n                \"steam\"\n            ]\n        },\n        \"\
        BulkOperationFailure\": {\n            \"type\": \"object\",\n            \"description\": \"Details of a failed bulk
        operation item\",\n            \"additionalProperties\": false,\n            \"required\": [\n                \"accountId\"\
        ,\n                \"error\"\n            ],\n            \"properties\": {\n                \"accountId\": {\n  \
        \                  \"type\": \"string\",\n                    \"format\": \"uuid\",\n                    \"description\"\
        : \"Account ID that failed\"\n                },\n                \"error\": {\n                    \"type\": \"string\"\
        ,\n                    \"description\": \"Human-readable error reason\"\n                }\n            }\n      \
        \  }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Get multiple accounts by ID\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"batchGetAccounts\"\
        \n}"
  /account/count:
    post:
      summary: Count accounts matching filters
      operationId: countAccounts
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CountAccountsRequest'
      responses:
        '200':
          description: Account count retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountAccountsResponse'
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CountAccountsRequest\"\
        ,\n    \"$defs\": {\n        \"CountAccountsRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to count accounts matching optional filters\",\n            \"additionalProperties\": false,\n       \
        \     \"properties\": {\n                \"email\": {\n                    \"type\": \"string\",\n               \
        \     \"nullable\": true,\n                    \"description\": \"Filter by email (contains match)\"\n           \
        \     },\n                \"displayName\": {\n                    \"type\": \"string\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Filter by display name (contains match)\"\n                },\n  \
        \              \"verified\": {\n                    \"type\": \"boolean\",\n                    \"nullable\": true,\n\
        \                    \"description\": \"Filter by verification status\"\n                },\n                \"role\"\
        : {\n                    \"type\": \"string\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Filter by role membership (checks JSON array containment)\"\n                }\n            }\n        }\n   \
        \ }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/CountAccountsResponse\"\
        ,\n    \"$defs\": {\n        \"CountAccountsResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response containing account count\",\n            \"additionalProperties\": false,\n            \"required\":
        [\n                \"count\"\n            ],\n            \"properties\": {\n                \"count\": {\n      \
        \              \"type\": \"integer\",\n                    \"format\": \"int64\",\n                    \"description\"\
        : \"Number of accounts matching the filters\"\n                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Count accounts matching filters\",\n    \"description\": \"\",\n    \"\
        tags\": [\n        \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"countAccounts\"\
        \n}"
  /account/roles/bulk-update:
    post:
      summary: Bulk update roles for multiple accounts
      operationId: bulkUpdateRoles
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkUpdateRolesRequest'
      responses:
        '200':
          description: Bulk update completed (partial success possible)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkUpdateRolesResponse'
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkUpdateRolesRequest\"\
        ,\n    \"$defs\": {\n        \"BulkUpdateRolesRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to update roles for multiple accounts\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"accountIds\"\n            ],\n            \"properties\": {\n                \"accountIds\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\",\n                        \"format\": \"uuid\"\n                    },\n                    \"minItems\"\
        : 1,\n                    \"maxItems\": 100,\n                    \"description\": \"List of account IDs to update
        (max 100)\"\n                },\n                \"addRoles\": {\n                    \"type\": \"array\",\n     \
        \               \"items\": {\n                        \"type\": \"string\"\n                    },\n             \
        \       \"nullable\": true,\n                    \"description\": \"Roles to add to all specified accounts (null to
        skip)\"\n                },\n                \"removeRoles\": {\n                    \"type\": \"array\",\n      \
        \              \"items\": {\n                        \"type\": \"string\"\n                    },\n              \
        \      \"nullable\": true,\n                    \"description\": \"Roles to remove from all specified accounts (null
        to skip)\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/BulkUpdateRolesResponse\"\
        ,\n    \"$defs\": {\n        \"BulkUpdateRolesResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Response containing bulk update results (partial success)\",\n            \"additionalProperties\": false,\n \
        \           \"required\": [\n                \"succeeded\",\n                \"failed\"\n            ],\n        \
        \    \"properties\": {\n                \"succeeded\": {\n                    \"type\": \"array\",\n             \
        \       \"items\": {\n                        \"type\": \"string\",\n                        \"format\": \"uuid\"\n\
        \                    },\n                    \"description\": \"Account IDs that were successfully updated\"\n   \
        \             },\n                \"failed\": {\n                    \"type\": \"array\",\n                    \"\
        items\": {\n                        \"$ref\": \"#/$defs/BulkOperationFailure\"\n                    },\n         \
        \           \"description\": \"Account IDs that failed with reasons\"\n                }\n            }\n        },\n\
        \        \"BulkOperationFailure\": {\n            \"type\": \"object\",\n            \"description\": \"Details of
        a failed bulk operation item\",\n            \"additionalProperties\": false,\n            \"required\": [\n     \
        \           \"accountId\",\n                \"error\"\n            ],\n            \"properties\": {\n           \
        \     \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n   \
        \                 \"description\": \"Account ID that failed\"\n                },\n                \"error\": {\n\
        \                    \"type\": \"string\",\n                    \"description\": \"Human-readable error reason\"\n\
        \                }\n            }\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Bulk update roles for multiple accounts\",\n    \"description\": \"\",\n\
        \    \"tags\": [\n        \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"bulkUpdateRoles\"\
        \n}"
  /account/verification/update:
    post:
      summary: Update email verification status
      operationId: updateVerificationStatus
      tags:
      - Account Management
      x-permissions:
      - role: user
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateVerificationRequest'
      responses:
        '200':
          description: Verification status updated successfully
        '404':
          description: Account not found
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateVerificationRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateVerificationRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to update email verification status\",\n            \"additionalProperties\": false,\n            \"required\"\
        : [\n                \"accountId\",\n                \"emailVerified\"\n            ],\n            \"properties\"\
        : {\n                \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\":
        \"uuid\",\n                    \"description\": \"ID of the account to update\"\n                },\n            \
        \    \"emailVerified\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"New
        email verification status\"\n                }\n            }\n        }\n    }\n}"
      x-response-schema-json: '{}'
      x-endpoint-info-json: "{\n    \"summary\": \"Update email verification status\",\n    \"description\": \"\",\n    \"\
        tags\": [\n        \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updateVerificationStatus\"\
        \n}"
  /account/email/update:
    post:
      summary: Update account email address
      operationId: updateEmail
      tags:
      - Account Management
      x-permissions:
      - role: admin
        states: {}
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateEmailRequest'
      responses:
        '200':
          description: Email updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          description: Account not found
        '409':
          description: Email already in use or concurrent modification
      x-request-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/UpdateEmailRequest\"\
        ,\n    \"$defs\": {\n        \"UpdateEmailRequest\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Request to update an account's email address\",\n            \"additionalProperties\": false,\n            \"\
        required\": [\n                \"accountId\",\n                \"newEmail\"\n            ],\n            \"properties\"\
        : {\n                \"accountId\": {\n                    \"type\": \"string\",\n                    \"format\":
        \"uuid\",\n                    \"description\": \"ID of the account to update\"\n                },\n            \
        \    \"newEmail\": {\n                    \"type\": \"string\",\n                    \"format\": \"email\",\n    \
        \                \"maxLength\": 254,\n                    \"description\": \"New email address for the account\"\n\
        \                }\n            }\n        }\n    }\n}"
      x-response-schema-json: "{\n    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n    \"$ref\": \"#/$defs/AccountResponse\"\
        ,\n    \"$defs\": {\n        \"AccountResponse\": {\n            \"type\": \"object\",\n            \"description\"\
        : \"Account information response\",\n            \"additionalProperties\": false,\n            \"required\": [\n \
        \               \"accountId\",\n                \"createdAt\",\n                \"emailVerified\",\n             \
        \   \"roles\",\n                \"authMethods\"\n            ],\n            \"properties\": {\n                \"\
        accountId\": {\n                    \"type\": \"string\",\n                    \"format\": \"uuid\",\n           \
        \         \"description\": \"Unique identifier for the account\"\n                },\n                \"email\": {\n\
        \                    \"type\": \"string\",\n                    \"format\": \"email\",\n                    \"nullable\"\
        : true,\n                    \"description\": \"Email address associated with the account. Null for OAuth/Steam accounts
        without email.\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\"\
        ,\n                    \"nullable\": true,\n                    \"description\": \"Display name for the account\"\n\
        \                },\n                \"passwordHash\": {\n                    \"type\": \"string\",\n            \
        \        \"nullable\": true,\n                    \"description\": \"BCrypt hashed password for authentication\"\n\
        \                },\n                \"createdAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the account was created\"\n\
        \                },\n                \"updatedAt\": {\n                    \"type\": \"string\",\n               \
        \     \"format\": \"date-time\",\n                    \"nullable\": true,\n                    \"description\": \"\
        Timestamp when the account was last updated\"\n                },\n                \"emailVerified\": {\n        \
        \            \"type\": \"boolean\",\n                    \"description\": \"Whether the email address has been verified\"\
        \n                },\n                \"roles\": {\n                    \"type\": \"array\",\n                   \
        \ \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"description\"\
        : \"List of roles assigned to the account\"\n                },\n                \"authMethods\": {\n            \
        \        \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/$defs/AuthMethodInfo\"\
        \n                    },\n                    \"description\": \"List of authentication methods linked to the account\"\
        \n                },\n                \"metadata\": {\n                    \"type\": \"object\",\n               \
        \     \"additionalProperties\": true,\n                    \"nullable\": true,\n                    \"description\"\
        : \"Client-only metadata. No Bannou plugin reads specific keys from this field by convention.\"\n                },\n\
        \                \"mfaEnabled\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n\
        \                    \"description\": \"Whether multi-factor authentication is enabled for this account\"\n      \
        \          },\n                \"mfaSecret\": {\n                    \"type\": \"string\",\n                    \"\
        nullable\": true,\n                    \"description\": \"Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service
        encrypts and decrypts. Account stores opaque ciphertext.\"\n                },\n                \"mfaRecoveryCodes\"\
        : {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\"\
        : \"string\"\n                    },\n                    \"nullable\": true,\n                    \"description\"\
        : \"BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores opaque hashes.\"\n\
        \                }\n            }\n        },\n        \"AuthMethodInfo\": {\n            \"type\": \"object\",\n\
        \            \"description\": \"Information about a linked authentication method\",\n            \"additionalProperties\"\
        : false,\n            \"required\": [\n                \"provider\",\n                \"linkedAt\"\n            ],\n\
        \            \"properties\": {\n                \"methodId\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"uuid\",\n                    \"nullable\": true,\n                    \"description\"\
        : \"Unique identifier for the authentication method\"\n                },\n                \"provider\": {\n     \
        \               \"allOf\": [\n                        {\n                            \"$ref\": \"#/$defs/AuthProvider\"\
        \n                        }\n                    ],\n                    \"description\": \"Authentication provider
        type\"\n                },\n                \"externalId\": {\n                    \"type\": \"string\",\n       \
        \             \"nullable\": true,\n                    \"description\": \"External user ID from the authentication
        provider\"\n                },\n                \"displayName\": {\n                    \"type\": \"string\",\n  \
        \                  \"nullable\": true,\n                    \"description\": \"Display name from the authentication
        provider\"\n                },\n                \"linkedAt\": {\n                    \"type\": \"string\",\n     \
        \               \"format\": \"date-time\",\n                    \"description\": \"Timestamp when the authentication
        method was linked\"\n                }\n            }\n        },\n        \"AuthProvider\": {\n            \"type\"\
        : \"string\",\n            \"description\": \"All authentication provider types including email\",\n            \"\
        enum\": [\n                \"email\",\n                \"google\",\n                \"discord\",\n               \
        \ \"twitch\",\n                \"steam\"\n            ]\n        }\n    }\n}"
      x-endpoint-info-json: "{\n    \"summary\": \"Update account email address\",\n    \"description\": \"\",\n    \"tags\"\
        : [\n        \"Account Management\"\n    ],\n    \"deprecated\": false,\n    \"operationId\": \"updateEmail\"\n}"
components:
  schemas:
    AuthProvider:
      type: string
      description: All authentication provider types including email
      enum:
      - email
      - google
      - discord
      - twitch
      - steam
    OAuthProvider:
      type: string
      description: OAuth provider types (excludes email)
      enum:
      - google
      - discord
      - twitch
      - steam
    ListAccountsRequest:
      type: object
      description: Request to list accounts with optional filtering
      additionalProperties: false
      properties:
        email:
          type: string
          format: email
          nullable: true
          description: Filter accounts by email address
        displayName:
          type: string
          nullable: true
          description: Filter accounts by display name
        provider:
          allOf:
          - $ref: '#/components/schemas/AuthProvider'
          nullable: true
          description: Filter accounts by authentication provider
        verified:
          type: boolean
          nullable: true
          description: Filter accounts by email verification status
        page:
          type: integer
          minimum: 1
          default: 1
          description: Page number for pagination
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Number of accounts per page
    GetAccountRequest:
      type: object
      description: Request to get a specific account by ID
      additionalProperties: false
      required:
      - accountId
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to retrieve
    DeleteAccountRequest:
      type: object
      description: Request to delete a specific account
      additionalProperties: false
      required:
      - accountId
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to delete
    GetAccountByEmailRequest:
      type: object
      description: Request to get account by email address
      additionalProperties: false
      required:
      - email
      properties:
        email:
          type: string
          format: email
          maxLength: 254
          description: Email address to look up
    GetAuthMethodsRequest:
      type: object
      description: Request to get authentication methods for an account
      additionalProperties: false
      required:
      - accountId
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account
    RemoveAuthMethodRequest:
      type: object
      description: Request to remove an authentication method from an account
      additionalProperties: false
      required:
      - accountId
      - methodId
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account
        methodId:
          type: string
          format: uuid
          description: ID of the authentication method to remove
    GetAccountByProviderRequest:
      type: object
      description: Request to get account by external provider ID
      additionalProperties: false
      required:
      - provider
      - externalId
      properties:
        provider:
          allOf:
          - $ref: '#/components/schemas/OAuthProvider'
          description: OAuth provider type
        externalId:
          type: string
          maxLength: 255
          description: External ID from the provider
    CreateAccountRequest:
      type: object
      description: Request to create a new account
      additionalProperties: false
      properties:
        email:
          type: string
          format: email
          maxLength: 254
          nullable: true
          description: Email address for the new account. Null for OAuth/Steam accounts without email.
        passwordHash:
          type: string
          maxLength: 255
          nullable: true
          description: Pre-hashed password from Auth service
        displayName:
          type: string
          nullable: true
          maxLength: 100
          description: Display name for the account
        emailVerified:
          type: boolean
          default: false
          description: Whether the email address has been verified
        roles:
          type: array
          items:
            type: string
            maxLength: 50
          maxItems: 20
          nullable: true
          description: List of roles assigned to the account (null defaults to empty)
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Client-only metadata. No Bannou plugin reads specific keys from this field by convention.
    UpdateAccountRequest:
      type: object
      description: Request to update an existing account
      additionalProperties: false
      required:
      - accountId
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to update
        displayName:
          type: string
          nullable: true
          maxLength: 100
          description: New display name for the account
        roles:
          type: array
          items:
            type: string
            maxLength: 50
          maxItems: 20
          nullable: true
          description: Updated list of roles for the account (null to keep unchanged)
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Client-only metadata. No Bannou plugin reads specific keys from this field by convention.
    UpdateProfileRequest:
      type: object
      description: Request to update an account profile
      additionalProperties: false
      required:
      - accountId
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to update
        displayName:
          type: string
          nullable: true
          maxLength: 100
          description: New display name for the account
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Client-only metadata. No Bannou plugin reads specific keys from this field by convention.
    UpdatePasswordRequest:
      type: object
      description: Request to update an account password
      additionalProperties: false
      required:
      - accountId
      - passwordHash
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to update
        passwordHash:
          type: string
          maxLength: 255
          description: New pre-hashed password from Auth service
    UpdateMfaRequest:
      type: object
      description: Request to update MFA settings for an account
      additionalProperties: false
      required:
      - accountId
      - mfaEnabled
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to update
        mfaEnabled:
          type: boolean
          description: Whether to enable or disable MFA
        mfaSecret:
          type: string
          nullable: true
          description: Encrypted TOTP secret (set when enabling, null when disabling)
        mfaRecoveryCodes:
          type: array
          items:
            type: string
          nullable: true
          description: BCrypt-hashed recovery codes (set when enabling, null when disabling)
    UpdateVerificationRequest:
      type: object
      description: Request to update email verification status
      additionalProperties: false
      required:
      - accountId
      - emailVerified
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to update
        emailVerified:
          type: boolean
          description: New email verification status
    UpdateEmailRequest:
      type: object
      description: Request to update an account's email address
      additionalProperties: false
      required:
      - accountId
      - newEmail
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to update
        newEmail:
          type: string
          format: email
          maxLength: 254
          description: New email address for the account
    AddAuthMethodRequest:
      type: object
      description: Request to add an authentication method to an account
      additionalProperties: false
      required:
      - accountId
      - provider
      - externalId
      properties:
        accountId:
          type: string
          format: uuid
          description: ID of the account to add auth method to
        provider:
          allOf:
          - $ref: '#/components/schemas/OAuthProvider'
          description: OAuth provider type to add
        externalId:
          type: string
          maxLength: 255
          description: External user ID from the OAuth provider
        displayName:
          type: string
          nullable: true
          description: Display name from the OAuth provider
    AccountResponse:
      type: object
      description: Account information response
      additionalProperties: false
      required:
      - accountId
      - createdAt
      - emailVerified
      - roles
      - authMethods
      properties:
        accountId:
          type: string
          format: uuid
          description: Unique identifier for the account
        email:
          type: string
          format: email
          nullable: true
          description: Email address associated with the account. Null for OAuth/Steam accounts without email.
        displayName:
          type: string
          nullable: true
          description: Display name for the account
        passwordHash:
          type: string
          nullable: true
          description: BCrypt hashed password for authentication
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the account was created
        updatedAt:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when the account was last updated
        emailVerified:
          type: boolean
          description: Whether the email address has been verified
        roles:
          type: array
          items:
            type: string
          description: List of roles assigned to the account
        authMethods:
          type: array
          items:
            $ref: '#/components/schemas/AuthMethodInfo'
          description: List of authentication methods linked to the account
        metadata:
          type: object
          additionalProperties: true
          nullable: true
          description: Client-only metadata. No Bannou plugin reads specific keys from this field by convention.
        mfaEnabled:
          type: boolean
          default: false
          description: Whether multi-factor authentication is enabled for this account
        mfaSecret:
          type: string
          nullable: true
          description: Encrypted TOTP secret (AES-256-GCM ciphertext). Auth service encrypts and decrypts. Account 
            stores opaque ciphertext.
        mfaRecoveryCodes:
          type: array
          items:
            type: string
          nullable: true
          description: BCrypt-hashed single-use recovery codes. Auth service generates and verifies. Account stores 
            opaque hashes.
    AuthMethodInfo:
      type: object
      description: Information about a linked authentication method
      additionalProperties: false
      required:
      - provider
      - linkedAt
      properties:
        methodId:
          type: string
          format: uuid
          nullable: true
          description: Unique identifier for the authentication method
        provider:
          allOf:
          - $ref: '#/components/schemas/AuthProvider'
          description: Authentication provider type
        externalId:
          type: string
          nullable: true
          description: External user ID from the authentication provider
        displayName:
          type: string
          nullable: true
          description: Display name from the authentication provider
        linkedAt:
          type: string
          format: date-time
          description: Timestamp when the authentication method was linked
    AuthMethodResponse:
      type: object
      description: Response after adding an authentication method
      additionalProperties: false
      required:
      - methodId
      - provider
      - linkedAt
      properties:
        methodId:
          type: string
          format: uuid
          description: Unique identifier for the authentication method
        provider:
          allOf:
          - $ref: '#/components/schemas/OAuthProvider'
          description: OAuth provider type
        externalId:
          type: string
          nullable: true
          description: External user ID from the OAuth provider
        displayName:
          type: string
          nullable: true
          description: Display name from the OAuth provider
        linkedAt:
          type: string
          format: date-time
          description: Timestamp when the authentication method was linked
    AuthMethodsResponse:
      type: object
      description: Response containing list of authentication methods
      additionalProperties: false
      required:
      - authMethods
      properties:
        authMethods:
          type: array
          items:
            $ref: '#/components/schemas/AuthMethodInfo'
          description: List of authentication methods linked to the account
    AccountListResponse:
      type: object
      description: Paginated list of accounts
      additionalProperties: false
      required:
      - accounts
      - totalCount
      - page
      - pageSize
      - hasNextPage
      - hasPreviousPage
      properties:
        accounts:
          type: array
          items:
            $ref: '#/components/schemas/AccountResponse'
          description: List of accounts for the current page
        totalCount:
          type: integer
          description: Total number of accounts matching the filter
        page:
          type: integer
          description: Current page number
        pageSize:
          type: integer
          description: Number of accounts per page
        hasNextPage:
          type: boolean
          description: Whether there are more pages after this one
        hasPreviousPage:
          type: boolean
          description: Whether there are pages before this one
    BatchGetAccountsRequest:
      type: object
      description: Request to get multiple accounts by ID
      additionalProperties: false
      required:
      - accountIds
      properties:
        accountIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100
          description: List of account IDs to retrieve (max 100)
    CountAccountsRequest:
      type: object
      description: Request to count accounts matching optional filters
      additionalProperties: false
      properties:
        email:
          type: string
          nullable: true
          description: Filter by email (contains match)
        displayName:
          type: string
          nullable: true
          description: Filter by display name (contains match)
        verified:
          type: boolean
          nullable: true
          description: Filter by verification status
        role:
          type: string
          nullable: true
          description: Filter by role membership (checks JSON array containment)
    BulkUpdateRolesRequest:
      type: object
      description: Request to update roles for multiple accounts
      additionalProperties: false
      required:
      - accountIds
      properties:
        accountIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100
          description: List of account IDs to update (max 100)
        addRoles:
          type: array
          items:
            type: string
          nullable: true
          description: Roles to add to all specified accounts (null to skip)
        removeRoles:
          type: array
          items:
            type: string
          nullable: true
          description: Roles to remove from all specified accounts (null to skip)
    BatchGetAccountsResponse:
      type: object
      description: Response containing found accounts, IDs not found, and fetch failures
      additionalProperties: false
      required:
      - accounts
      - notFound
      - failed
      properties:
        accounts:
          type: array
          items:
            $ref: '#/components/schemas/AccountResponse'
          description: Successfully retrieved accounts
        notFound:
          type: array
          items:
            type: string
            format: uuid
          description: Account IDs that were not found or are deleted
        failed:
          type: array
          items:
            $ref: '#/components/schemas/BulkOperationFailure'
          description: Account IDs that failed to fetch with error reasons
    CountAccountsResponse:
      type: object
      description: Response containing account count
      additionalProperties: false
      required:
      - count
      properties:
        count:
          type: integer
          format: int64
          description: Number of accounts matching the filters
    BulkUpdateRolesResponse:
      type: object
      description: Response containing bulk update results (partial success)
      additionalProperties: false
      required:
      - succeeded
      - failed
      properties:
        succeeded:
          type: array
          items:
            type: string
            format: uuid
          description: Account IDs that were successfully updated
        failed:
          type: array
          items:
            $ref: '#/components/schemas/BulkOperationFailure'
          description: Account IDs that failed with reasons
    BulkOperationFailure:
      type: object
      description: Details of a failed bulk operation item
      additionalProperties: false
      required:
      - accountId
      - error
      properties:
        accountId:
          type: string
          format: uuid
          description: Account ID that failed
        error:
          type: string
          description: Human-readable error reason
