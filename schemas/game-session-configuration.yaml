openapi: 3.0.4
info:
  title: Game Session Service Configuration
  description: |
    Configuration schema for Game Session service.
    Properties are bound to environment variables with BANNOU_ prefix.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 1.0.0
paths: {}
x-service-configuration:
  properties:
    ServerSalt:
      type: string
      minLength: 16
      description: Server salt for GUID generation. Must be shared across all instances for session GUIDs to work correctly. Change in production.
      env: GAME_SESSION_SERVER_SALT
      default: "bannou-dev-game-session-salt-change-in-production"
    MaxPlayersPerSession:
      type: integer
      minimum: 1
      maximum: 1000
      description: Maximum players allowed per session
      default: 16
      env: GAME_SESSION_MAX_PLAYERS_PER_SESSION
    DefaultSessionTimeoutSeconds:
      type: integer
      minimum: 1
      nullable: true
      description: Default session timeout in seconds. Null means sessions have no expiry.
      env: GAME_SESSION_DEFAULT_SESSION_TIMEOUT_SECONDS
    DefaultReservationTtlSeconds:
      type: integer
      minimum: 10
      maximum: 600
      description: Default TTL for player reservations when not specified in request
      default: 60
      env: GAME_SESSION_DEFAULT_RESERVATION_TTL_SECONDS
    DefaultLobbyMaxPlayers:
      type: integer
      minimum: 1
      maximum: 10000
      description: Default maximum players for game lobbies
      default: 100
      env: GAME_SESSION_DEFAULT_LOBBY_MAX_PLAYERS
    CleanupIntervalSeconds:
      type: integer
      minimum: 5
      description: Interval between reservation cleanup cycles
      default: 30
      env: GAME_SESSION_CLEANUP_INTERVAL_SECONDS
    CleanupServiceStartupDelaySeconds:
      type: integer
      minimum: 0
      description: Delay before cleanup service starts (allows other services to initialize)
      default: 10
      env: GAME_SESSION_CLEANUP_SERVICE_STARTUP_DELAY_SECONDS
    StartupServiceDelaySeconds:
      type: integer
      minimum: 0
      description: Delay before startup service initializes subscription caches
      default: 2
      env: GAME_SESSION_STARTUP_SERVICE_DELAY_SECONDS
    SubscriberSessionRetryMaxAttempts:
      type: integer
      minimum: 1
      maximum: 10
      description: Maximum retry attempts for optimistic concurrency on subscriber session state
      default: 3
      env: GAME_SESSION_SUBSCRIBER_SESSION_RETRY_MAX_ATTEMPTS
    LockTimeoutSeconds:
      type: integer
      minimum: 1
      maximum: 300
      description: Timeout in seconds for distributed session locks
      default: 60
      env: GAME_SESSION_LOCK_TIMEOUT_SECONDS
    SupportedGameServices:
      type: string
      description: Comma-separated list of supported game service stub names (e.g. "generic" or "arcadia,fantasia"). Only subscription.updated events for these services trigger shortcut publishing. Use "generic" for catch-all lobbies.
      default: "generic"
      env: GAME_SESSION_SUPPORTED_GAME_SERVICES
    GenericLobbiesEnabled:
      type: boolean
      description: When true AND "generic" is in SupportedGameServices, auto-publish generic lobby shortcut to ALL authenticated sessions on connect without requiring subscription. Enables open catch-all lobbies.
      default: false
      env: GAME_SESSION_GENERIC_LOBBIES_ENABLED
