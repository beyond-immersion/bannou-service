openapi: 3.0.3
info:
  title: Puppetmaster Service Events
  description: |
    Event models for Puppetmaster RabbitMQ pub/sub.

    **SCHEMA MODIFICATION GATE**: STOP. Before modifying this schema, you MUST:
    1. Read docs/reference/SCHEMA-RULES.md
    2. State which section applies to your change
    3. Only then proceed with edits
    Edits without stating the applicable rule are FORBIDDEN.
  version: 1.0.0

  # No subscriptions for Phase 2 (future: realm.activated, realm.deactivated)
x-event-subscriptions: []

servers: []

paths: {}

components:
  schemas:
    BehaviorInvalidatedEvent:
      allOf:
        - $ref: 'common-events.yaml#/components/schemas/BaseServiceEvent'
      type: object
      additionalProperties: false
      description: Event published when behavior documents are invalidated from cache
      required:
        - invalidatedCount
      properties:
        eventName:
          type: string
          default: "puppetmaster.behavior.invalidated"
          description: Event type identifier for behavior cache invalidation
        behaviorRef:
          type: string
          nullable: true
          description: Specific behavior that was invalidated, or null if all were invalidated
        invalidatedCount:
          type: integer
          description: Number of behaviors invalidated
