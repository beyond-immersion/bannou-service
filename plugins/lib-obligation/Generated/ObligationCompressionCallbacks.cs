// <auto-generated>
// This code was generated by generate-compression-callbacks.py
// Do not edit this file manually.
// </auto-generated>

#nullable enable

using BeyondImmersion.Bannou.Core;
using BeyondImmersion.BannouService.Resource;

namespace BeyondImmersion.BannouService.Obligation;

/// <summary>
/// Generated compression callback registration for ObligationService.
/// </summary>
/// <remarks>
/// Call <see cref="RegisterAsync"/> during service startup (OnRunningAsync)
/// to register compression callbacks with lib-resource.
/// </remarks>
public static class ObligationCompressionCallbacks
{
    /// <summary>
    /// Registers compression callbacks with lib-resource.
    /// Call this during service startup (OnRunningAsync).
    /// </summary>
    /// <param name="resourceClient">The resource service client.</param>
    /// <param name="cancellationToken">Cancellation token.</param>
    /// <returns>True if registration succeeded, false on failure.</returns>
    public static async Task<bool> RegisterAsync(
        IResourceClient resourceClient,
        CancellationToken cancellationToken = default)
    {
        try
        {
            await resourceClient.DefineCompressCallbackAsync(
                new DefineCompressCallbackRequest
                {
                    ResourceType = "character",
                    SourceType = "obligation",
                    ServiceName = "obligation",
                    CompressEndpoint = "/obligation/get-compress-data",
                    CompressPayloadTemplate = "{\"characterId\": \"{{resourceId}}\"}",
                    Priority = 25,
                    Description = "Obligation violation history and behavioral constraint state",
                    DecompressEndpoint = "/obligation/restore-from-archive",
                    DecompressPayloadTemplate = "{\"characterId\": \"{{resourceId}}\", \"data\": \"{{data}}\"}"
                },
                cancellationToken);
            return true;
        }
        catch (ApiException)
        {
            return false;
        }
    }
}
