//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace BeyondImmersion.BannouService.Escrow;

/// <summary>
/// Meta/introspection endpoints for runtime schema access.
/// Generated from schemas/Generated/escrow-api-meta.yaml
/// </summary>
public partial class EscrowController
{
    #region Meta Endpoints for CreateEscrow

    private static readonly string _CreateEscrow_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/CreateEscrowRequest",
    "$defs": {
        "CreateEscrowRequest": {
            "type": "object",
            "description": "Request to create a new escrow agreement",
            "required": [
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "idempotencyKey"
            ],
            "properties": {
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted mode"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/CreateEscrowPartyInput"
                    },
                    "description": "Parties in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDepositInput"
                    },
                    "description": "Expected deposits from parties"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocationInput"
                    },
                    "description": "Optional explicit release allocations"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing this escrow"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "nullable": true,
                    "description": "Number of consents required (-1 for all)"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Optional expiration time"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "Reference type (trade, auction, etc.)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Reference entity ID"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Application metadata"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this operation"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "CreateEscrowPartyInput": {
            "type": "object",
            "description": "Input for defining a party in escrow creation",
            "required": [
                "partyId",
                "partyType",
                "role"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity ID"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "nullable": true,
                    "description": "Whether consent is required (defaults based on role)"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party wallet for currency operations"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party container for item operations"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\ n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDepositInput": {
            "type": "object",
            "description": "Input for defining expected deposits from a party",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAssetInput"
                    },
                    "description": "Expected assets"
                },
                "optional": {
                    "type": "boolean",
                    "nullable": true,
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Specific deadline for this deposit"
                }
            }
        },
        "EscrowAssetInput": {
            "type": "object",
            "description": "Input for specifying an asset in escrow operations",
            "required": [
                "assetType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset to deposit"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Currency code"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Currency amount"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item name"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item template ID (for stacks)"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item template name"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "Item quantity (for stacks)"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract description"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract party role being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset ID"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Custom asset data"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\ n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "ReleaseAllocationInput": {
            "type": "object",
            "description": "Input for specifying how assets should be allocated on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Recipient party ID"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Recipient party type"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAssetInput"
                    },
                    "description": "Assets to allocate"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Destination wallet"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Destination container"
                }
            }
        }
    }
}
""";

    private static readonly string _CreateEscrow_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/CreateEscrowResponse",
    "$defs": {
        "CreateEscrowResponse": {
            "type": "object",
            "description": "Response from creating an escrow agreement",
            "required": [
                "escrow",
                "depositTokens"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Created escrow agreement"
                },
                "depositTokens": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/PartyToken"
                    },
                    "description": "Deposit tokens for each party (full_consent mode)"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        },
        "PartyToken": {
            "type": "object",
            "description": "Token issued to a party for deposit or release operations",
            "required": [
                "partyId",
                "partyType",
                "token"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party ID"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "token": {
                    "type": "string",
                    "description": "The token"
                }
            }
        }
    }
}
""";

    private static readonly string _CreateEscrow_Info = """
{
    "summary": "Create a new escrow agreement",
    "description": "Create a new escrow agreement. For each party, creates a dedicated escrow wallet\nand container (owned by escrow entity). Issues deposit tokens and returns ALL\ntokens to the creating service, which is responsible for distributing them to\nparties through appropriate channels. Sets template values on bound contract.\n",
    "tags": [
        "Lifecycle"
    ],
    "deprecated": false,
    "operationId": "createEscrow"
}
""";

    /// <summary>Returns endpoint information for CreateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/create/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> CreateEscrow_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/create",
            _CreateEscrow_Info));

    /// <summary>Returns request schema for CreateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/create/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> CreateEscrow_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/create",
            "request-schema",
            _CreateEscrow_RequestSchema));

    /// <summary>Returns response schema for CreateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/create/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> CreateEscrow_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/create",
            "response-schema",
            _CreateEscrow_ResponseSchema));

    /// <summary>Returns full schema for CreateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/create/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> CreateEscrow_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/create",
            _CreateEscrow_Info,
            _CreateEscrow_RequestSchema,
            _CreateEscrow_ResponseSchema));

    #endregion

    #region Meta Endpoints for GetEscrow

    private static readonly string _GetEscrow_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetEscrowRequest",
    "$defs": {
        "GetEscrowRequest": {
            "type": "object",
            "description": "Request to retrieve an escrow agreement by ID",
            "required": [
                "escrowId"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID to retrieve"
                }
            }
        }
    }
}
""";

    private static readonly string _GetEscrow_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetEscrowResponse",
    "$defs": {
        "GetEscrowResponse": {
            "type": "object",
            "description": "Response containing escrow agreement details",
            "required": [
                "escrow"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Escrow agreement details"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        }
    }
}
""";

    private static readonly string _GetEscrow_Info = """
{
    "summary": "Get escrow details",
    "description": "Get escrow agreement details by ID.",
    "tags": [
        "Lifecycle"
    ],
    "deprecated": false,
    "operationId": "getEscrow"
}
""";

    /// <summary>Returns endpoint information for GetEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetEscrow_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/get",
            _GetEscrow_Info));

    /// <summary>Returns request schema for GetEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetEscrow_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/get",
            "request-schema",
            _GetEscrow_RequestSchema));

    /// <summary>Returns response schema for GetEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetEscrow_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/get",
            "response-schema",
            _GetEscrow_ResponseSchema));

    /// <summary>Returns full schema for GetEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetEscrow_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/get",
            _GetEscrow_Info,
            _GetEscrow_RequestSchema,
            _GetEscrow_ResponseSchema));

    #endregion

    #region Meta Endpoints for ListEscrows

    private static readonly string _ListEscrows_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ListEscrowsRequest",
    "$defs": {
        "ListEscrowsRequest": {
            "type": "object",
            "description": "Request to list escrow agreements with optional filters",
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Filter by party"
                },
                "partyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Party type filter"
                },
                "status": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/EscrowStatus"
                    },
                    "description": "Filter by status"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "Filter by reference type"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Filter by reference ID"
                },
                "fromDate": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Filter from date"
                },
                "toDate": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Filter to date"
                },
                "limit": {
                    "type": "integer",
                    "nullable": true,
                    "description": "Limit results"
                },
                "offset": {
                    "type": "integer",
                    "nullable": true,
                    "description": "Offset for pagination"
                }
            }
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\ n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\ n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        }
    }
}
""";

    private static readonly string _ListEscrows_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ListEscrowsResponse",
    "$defs": {
        "ListEscrowsResponse": {
            "type": "object",
            "description": "Response containing list of escrow agreements",
            "required": [
                "escrows",
                "totalCount"
            ],
            "properties": {
                "escrows": {
                    "type": "array",
                    "description": "List of escrow agreements matching the query",
                    "items": {
                        "$ref": "#/$defs/EscrowAgreement"
                    }
                },
                "totalCount": {
                    "type": "integer",
                    "description": "Total count for pagination"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        }
    }
}
""";

    private static readonly string _ListEscrows_Info = """
{
    "summary": "List escrows for a party",
    "description": "List escrow agreements with filtering options.",
    "tags": [
        "Lifecycle"
    ],
    "deprecated": false,
    "operationId": "listEscrows"
}
""";

    /// <summary>Returns endpoint information for ListEscrows</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/list/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListEscrows_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/list",
            _ListEscrows_Info));

    /// <summary>Returns request schema for ListEscrows</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/list/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListEscrows_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/list",
            "request-schema",
            _ListEscrows_RequestSchema));

    /// <summary>Returns response schema for ListEscrows</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/list/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListEscrows_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/list",
            "response-schema",
            _ListEscrows_ResponseSchema));

    /// <summary>Returns full schema for ListEscrows</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/list/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListEscrows_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/list",
            _ListEscrows_Info,
            _ListEscrows_RequestSchema,
            _ListEscrows_ResponseSchema));

    #endregion

    #region Meta Endpoints for GetMyToken

    private static readonly string _GetMyToken_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetMyTokenRequest",
    "$defs": {
        "GetMyTokenRequest": {
            "type": "object",
            "description": "Request to retrieve a party token for deposit or release",
            "required": [
                "escrowId",
                "ownerId",
                "ownerType",
                "tokenType"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "ownerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party ID"
                },
                "ownerType": {
                    "type": "object",
                    "description": "Party type"
                },
                "tokenType": {
                    "$ref": "#/$defs/TokenType",
                    "description": "Type of token to retrieve"
                }
            }
        },
        "TokenType": {
            "type": "string",
            "description": "Type of token being requested.\n- deposit: Token for depositing assets\n- release: Token for consenting to release\n",
            "enum": [
                "deposit",
                "release"
            ]
        }
    }
}
""";

    private static readonly string _GetMyToken_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetMyTokenResponse",
    "$defs": {
        "GetMyTokenResponse": {
            "type": "object",
            "description": "Response containing party token information",
            "required": [
                "tokenUsed"
            ],
            "properties": {
                "token": {
                    "type": "string",
                    "nullable": true,
                    "description": "The requested token (if available)"
                },
                "tokenUsed": {
                    "type": "boolean",
                    "description": "Whether the token has been used"
                },
                "tokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the token was used"
                }
            }
        }
    }
}
""";

    private static readonly string _GetMyToken_Info = """
{
    "summary": "Get deposit or release token for a party",
    "description": "Get the deposit or release token for a specific party. Internal-only endpoint\naccessed via Shortcut APIs (prebound). Direct user access is prohibited to prevent\ntoken snooping. The party is identified by ownerId/ownerType (works for characters,\nNPCs, guilds, etc.).\n",
    "tags": [
        "Lifecycle"
    ],
    "deprecated": false,
    "operationId": "getMyToken"
}
""";

    /// <summary>Returns endpoint information for GetMyToken</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get-my-token/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetMyToken_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/get-my-token",
            _GetMyToken_Info));

    /// <summary>Returns request schema for GetMyToken</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get-my-token/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetMyToken_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/get-my-token",
            "request-schema",
            _GetMyToken_RequestSchema));

    /// <summary>Returns response schema for GetMyToken</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get-my-token/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetMyToken_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/get-my-token",
            "response-schema",
            _GetMyToken_ResponseSchema));

    /// <summary>Returns full schema for GetMyToken</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/get-my-token/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetMyToken_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/get-my-token",
            _GetMyToken_Info,
            _GetMyToken_RequestSchema,
            _GetMyToken_ResponseSchema));

    #endregion

    #region Meta Endpoints for Deposit

    private static readonly string _Deposit_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/DepositRequest",
    "$defs": {
        "DepositRequest": {
            "type": "object",
            "description": "Request to deposit assets into an escrow",
            "required": [
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party depositing"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundleInput",
                    "description": "Assets to deposit"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Deposit token (required for full_consent)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        },
        "EscrowAssetBundleInput": {
            "type": "object",
            "description": "Input for specifying a bundle of assets",
            "required": [
                "assets"
            ],
            "properties": {
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAssetInput"
                    },
                    "description": "Assets to deposit"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Bundle description"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Estimated value"
                }
            }
        },
        "EscrowAssetInput": {
            "type": "object",
            "description": "Input for specifying an asset in escrow operations",
            "required": [
                "assetType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset to deposit"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Currency code"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Currency amount"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item name"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item template ID (for stacks)"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item template name"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "Item quantity (for stacks)"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract description"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract party role being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset ID"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Custom asset data"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\ n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        }
    }
}
""";

    private static readonly string _Deposit_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/DepositResponse",
    "$defs": {
        "DepositResponse": {
            "type": "object",
            "description": "Response from depositing assets into an escrow",
            "required": [
                "escrow",
                "deposit",
                "fullyFunded",
                "releaseTokens"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Updated escrow agreement"
                },
                "deposit": {
                    "$ref": "#/$defs/EscrowDeposit",
                    "description": "Deposit record"
                },
                "fullyFunded": {
                    "type": "boolean",
                    "description": "Whether escrow is now fully funded"
                },
                "releaseTokens": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/PartyToken"
                    },
                    "description": "Release tokens (issued when fully funded)"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        },
        "PartyToken": {
            "type": "object",
            "description": "Token issued to a party for deposit or release operations",
            "required": [
                "partyId",
                "partyType",
                "token"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party ID"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "token": {
                    "type": "string",
                    "description": "The token"
                }
            }
        }
    }
}
""";

    private static readonly string _Deposit_Info = """
{
    "summary": "Deposit assets into escrow",
    "description": "Deposit assets into escrow. Transfers currency from party's own wallet to that\nparty's escrow wallet. Moves items from party's own container to that party's\nescrow container. Locks contracts with escrow as guardian.\nRejects soulbound/non-tradeable items. After each deposit, queries bound contract\nto check if all asset requirements are satisfied.\n",
    "tags": [
        "Deposits"
    ],
    "deprecated": false,
    "operationId": "deposit"
}
""";

    /// <summary>Returns endpoint information for Deposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Deposit_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/deposit",
            _Deposit_Info));

    /// <summary>Returns request schema for Deposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Deposit_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit",
            "request-schema",
            _Deposit_RequestSchema));

    /// <summary>Returns response schema for Deposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Deposit_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit",
            "response-schema",
            _Deposit_ResponseSchema));

    /// <summary>Returns full schema for Deposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Deposit_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit",
            _Deposit_Info,
            _Deposit_RequestSchema,
            _Deposit_ResponseSchema));

    #endregion

    #region Meta Endpoints for ValidateDeposit

    private static readonly string _ValidateDeposit_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ValidateDepositRequest",
    "$defs": {
        "ValidateDepositRequest": {
            "type": "object",
            "description": "Request to validate a deposit without executing",
            "required": [
                "escrowId",
                "partyId",
                "partyType",
                "assets"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party to validate"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundleInput",
                    "description": "Assets to validate"
                }
            }
        },
        "EscrowAssetBundleInput": {
            "type": "object",
            "description": "Input for specifying a bundle of assets",
            "required": [
                "assets"
            ],
            "properties": {
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAssetInput"
                    },
                    "description": "Assets to deposit"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Bundle description"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Estimated value"
                }
            }
        },
        "EscrowAssetInput": {
            "type": "object",
            "description": "Input for specifying an asset in escrow operations",
            "required": [
                "assetType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset to deposit"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Currency code"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Currency amount"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item name"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item template ID (for stacks)"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item template name"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "Item quantity (for stacks)"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract description"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract party role being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset ID"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Custom asset data"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\ n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        }
    }
}
""";

    private static readonly string _ValidateDeposit_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ValidateDepositResponse",
    "$defs": {
        "ValidateDepositResponse": {
            "type": "object",
            "description": "Response from deposit validation",
            "required": [
                "valid",
                "errors",
                "warnings"
            ],
            "properties": {
                "valid": {
                    "type": "boolean",
                    "description": "Whether the deposit would be valid"
                },
                "errors": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "Validation errors"
                },
                "warnings": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "Validation warnings"
                }
            }
        }
    }
}
""";

    private static readonly string _ValidateDeposit_Info = """
{
    "summary": "Validate a deposit without executing",
    "description": "Validate a deposit without executing (dry run).",
    "tags": [
        "Deposits"
    ],
    "deprecated": false,
    "operationId": "validateDeposit"
}
""";

    /// <summary>Returns endpoint information for ValidateDeposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/validate/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateDeposit_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/validate",
            _ValidateDeposit_Info));

    /// <summary>Returns request schema for ValidateDeposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/validate/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateDeposit_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/validate",
            "request-schema",
            _ValidateDeposit_RequestSchema));

    /// <summary>Returns response schema for ValidateDeposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/validate/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateDeposit_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/validate",
            "response-schema",
            _ValidateDeposit_ResponseSchema));

    /// <summary>Returns full schema for ValidateDeposit</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/validate/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateDeposit_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/validate",
            _ValidateDeposit_Info,
            _ValidateDeposit_RequestSchema,
            _ValidateDeposit_ResponseSchema));

    #endregion

    #region Meta Endpoints for GetDepositStatus

    private static readonly string _GetDepositStatus_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetDepositStatusRequest",
    "$defs": {
        "GetDepositStatusRequest": {
            "type": "object",
            "description": "Request to get deposit status for a party",
            "required": [
                "escrowId",
                "partyId",
                "partyType"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party ID"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                }
            }
        }
    }
}
""";

    private static readonly string _GetDepositStatus_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetDepositStatusResponse",
    "$defs": {
        "GetDepositStatusResponse": {
            "type": "object",
            "description": "Response containing party deposit status",
            "required": [
                "expectedAssets",
                "depositedAssets",
                "fulfilled"
            ],
            "properties": {
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "depositedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Actually deposited assets"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Whether deposit requirement is fulfilled"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Deposit token (if not yet used)"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deposit deadline"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        }
    }
}
""";

    private static readonly string _GetDepositStatus_Info = """
{
    "summary": "Get deposit status for a party",
    "description": "Get deposit status for a party in an escrow.",
    "tags": [
        "Deposits"
    ],
    "deprecated": false,
    "operationId": "getDepositStatus"
}
""";

    /// <summary>Returns endpoint information for GetDepositStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/status/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetDepositStatus_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/status",
            _GetDepositStatus_Info));

    /// <summary>Returns request schema for GetDepositStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/status/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetDepositStatus_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/status",
            "request-schema",
            _GetDepositStatus_RequestSchema));

    /// <summary>Returns response schema for GetDepositStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/status/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetDepositStatus_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/status",
            "response-schema",
            _GetDepositStatus_ResponseSchema));

    /// <summary>Returns full schema for GetDepositStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/deposit/status/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetDepositStatus_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/deposit/status",
            _GetDepositStatus_Info,
            _GetDepositStatus_RequestSchema,
            _GetDepositStatus_ResponseSchema));

    #endregion

    #region Meta Endpoints for RecordConsent

    private static readonly string _RecordConsent_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ConsentRequest",
    "$defs": {
        "ConsentRequest": {
            "type": "object",
            "description": "Request to record party consent for release or refund",
            "required": [
                "escrowId",
                "partyId",
                "partyType",
                "consentType",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent being given"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Release token (required for full_consent)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\ n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        }
    }
}
""";

    private static readonly string _RecordConsent_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ConsentResponse",
    "$defs": {
        "ConsentResponse": {
            "type": "object",
            "description": "Response from recording party consent",
            "required": [
                "escrow",
                "consentRecorded",
                "triggered",
                "newStatus"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Updated escrow agreement"
                },
                "consentRecorded": {
                    "type": "boolean",
                    "description": "Whether consent was recorded"
                },
                "triggered": {
                    "type": "boolean",
                    "description": "Whether this consent triggered completion"
                },
                "newStatus": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "New escrow status after consent"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        }
    }
}
""";

    private static readonly string _RecordConsent_Info = """
{
    "summary": "Record party consent",
    "description": "Record party consent for release, refund, or re-affirmation.",
    "tags": [
        "Consent"
    ],
    "deprecated": false,
    "operationId": "recordConsent"
}
""";

    /// <summary>Returns endpoint information for RecordConsent</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RecordConsent_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/consent",
            _RecordConsent_Info));

    /// <summary>Returns request schema for RecordConsent</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RecordConsent_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/consent",
            "request-schema",
            _RecordConsent_RequestSchema));

    /// <summary>Returns response schema for RecordConsent</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RecordConsent_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/consent",
            "response-schema",
            _RecordConsent_ResponseSchema));

    /// <summary>Returns full schema for RecordConsent</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RecordConsent_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/consent",
            _RecordConsent_Info,
            _RecordConsent_RequestSchema,
            _RecordConsent_ResponseSchema));

    #endregion

    #region Meta Endpoints for GetConsentStatus

    private static readonly string _GetConsentStatus_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetConsentStatusRequest",
    "$defs": {
        "GetConsentStatusRequest": {
            "type": "object",
            "description": "Request to get consent status for all parties",
            "required": [
                "escrowId"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                }
            }
        }
    }
}
""";

    private static readonly string _GetConsentStatus_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/GetConsentStatusResponse",
    "$defs": {
        "GetConsentStatusResponse": {
            "type": "object",
            "description": "Response containing consent status for all parties",
            "required": [
                "partiesRequiringConsent",
                "consentsReceived",
                "consentsRequired",
                "canRelease",
                "canRefund"
            ],
            "properties": {
                "partiesRequiringConsent": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/PartyConsentStatus"
                    },
                    "description": "Consent status per party"
                },
                "consentsReceived": {
                    "type": "integer",
                    "description": "Number of consents received"
                },
                "consentsRequired": {
                    "type": "integer",
                    "description": "Number of consents required"
                },
                "canRelease": {
                    "type": "boolean",
                    "description": "Whether release can proceed"
                },
                "canRefund": {
                    "type": "boolean",
                    "description": "Whether refund can proceed"
                }
            }
        },
        "PartyConsentStatus": {
            "type": "object",
            "description": "Consent status for a single party",
            "required": [
                "partyId",
                "partyType",
                "consentGiven"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party ID"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Party display name"
                },
                "consentGiven": {
                    "type": "boolean",
                    "description": "Whether consent was given"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given (if any)",
                    "nullable": true
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When consent was given"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\ n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        }
    }
}
""";

    private static readonly string _GetConsentStatus_Info = """
{
    "summary": "Get consent status for escrow",
    "description": "Get consent status for all parties in an escrow.",
    "tags": [
        "Consent"
    ],
    "deprecated": false,
    "operationId": "getConsentStatus"
}
""";

    /// <summary>Returns endpoint information for GetConsentStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/status/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetConsentStatus_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/consent/status",
            _GetConsentStatus_Info));

    /// <summary>Returns request schema for GetConsentStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/status/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetConsentStatus_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/consent/status",
            "request-schema",
            _GetConsentStatus_RequestSchema));

    /// <summary>Returns response schema for GetConsentStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/status/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetConsentStatus_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/consent/status",
            "response-schema",
            _GetConsentStatus_ResponseSchema));

    /// <summary>Returns full schema for GetConsentStatus</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/consent/status/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> GetConsentStatus_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/consent/status",
            _GetConsentStatus_Info,
            _GetConsentStatus_RequestSchema,
            _GetConsentStatus_ResponseSchema));

    #endregion

    #region Meta Endpoints for Release

    private static readonly string _Release_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ReleaseRequest",
    "$defs": {
        "ReleaseRequest": {
            "type": "object",
            "description": "Request to trigger escrow release to recipients",
            "required": [
                "escrowId",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted mode"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        }
    }
}
""";

    private static readonly string _Release_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ReleaseResponse",
    "$defs": {
        "ReleaseResponse": {
            "type": "object",
            "description": "Response from releasing escrow assets to recipients",
            "required": [
                "escrow",
                "finalizerResults",
                "releases"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Released escrow agreement"
                },
                "finalizerResults": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/FinalizerResult"
                    },
                    "description": "Results of contract finalizer APIs"
                },
                "releases": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ReleaseResult"
                    },
                    "description": "Release results per recipient"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        },
        "FinalizerResult": {
            "type": "object",
            "description": "Result from a contract finalizer API call",
            "required": [
                "endpoint",
                "success"
            ],
            "properties": {
                "endpoint": {
                    "type": "string",
                    "description": "Finalizer endpoint"
                },
                "success": {
                    "type": "boolean",
                    "description": "Whether it succeeded"
                },
                "error": {
                    "type": "string",
                    "nullable": true,
                    "description": "Error message if failed"
                }
            }
        },
        "ReleaseResult": {
            "type": "object",
            "description": "Result of releasing assets to a single recipient",
            "required": [
                "recipientPartyId",
                "success"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Recipient party ID"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets released (null if failed)",
                    "nullable": true
                },
                "success": {
                    "type": "boolean",
                    "description": "Whether release succeeded"
                },
                "error": {
                    "type": "string",
                    "nullable": true,
                    "description": "Error message if failed"
                }
            }
        }
    }
}
""";

    private static readonly string _Release_Info = """
{
    "summary": "Trigger release",
    "description": "Trigger release (for trusted modes or after consent).\nIf boundContractId is set, checks contract status first (must be fulfilled).\nRuns finalization flow before releasing remaining assets.\n",
    "tags": [
        "Completion"
    ],
    "deprecated": false,
    "operationId": "release"
}
""";

    /// <summary>Returns endpoint information for Release</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/release/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Release_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/release",
            _Release_Info));

    /// <summary>Returns request schema for Release</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/release/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Release_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/release",
            "request-schema",
            _Release_RequestSchema));

    /// <summary>Returns response schema for Release</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/release/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Release_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/release",
            "response-schema",
            _Release_ResponseSchema));

    /// <summary>Returns full schema for Release</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/release/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Release_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/release",
            _Release_Info,
            _Release_RequestSchema,
            _Release_ResponseSchema));

    #endregion

    #region Meta Endpoints for Refund

    private static readonly string _Refund_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/RefundRequest",
    "$defs": {
        "RefundRequest": {
            "type": "object",
            "description": "Request to trigger escrow refund to depositors",
            "required": [
                "escrowId",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted mode"
                },
                "reason": {
                    "type": "string",
                    "nullable": true,
                    "description": "Reason for refund"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        }
    }
}
""";

    private static readonly string _Refund_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/RefundResponse",
    "$defs": {
        "RefundResponse": {
            "type": "object",
            "description": "Response from refunding escrow assets to depositors",
            "required": [
                "escrow",
                "refunds"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Refunded escrow agreement"
                },
                "refunds": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/RefundResult"
                    },
                    "description": "Refund results per depositor"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        },
        "RefundResult": {
            "type": "object",
            "description": "Result of refunding assets to a single depositor",
            "required": [
                "depositorPartyId",
                "success"
            ],
            "properties": {
                "depositorPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Depositor party ID"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets refunded (null if failed)",
                    "nullable": true
                },
                "success": {
                    "type": "boolean",
                    "description": "Whether refund succeeded"
                },
                "error": {
                    "type": "string",
                    "nullable": true,
                    "description": "Error message if failed"
                }
            }
        }
    }
}
""";

    private static readonly string _Refund_Info = """
{
    "summary": "Trigger refund",
    "description": "Trigger refund (for trusted modes or consent).",
    "tags": [
        "Completion"
    ],
    "deprecated": false,
    "operationId": "refund"
}
""";

    /// <summary>Returns endpoint information for Refund</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/refund/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Refund_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/refund",
            _Refund_Info));

    /// <summary>Returns request schema for Refund</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/refund/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Refund_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/refund",
            "request-schema",
            _Refund_RequestSchema));

    /// <summary>Returns response schema for Refund</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/refund/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Refund_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/refund",
            "response-schema",
            _Refund_ResponseSchema));

    /// <summary>Returns full schema for Refund</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/refund/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Refund_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/refund",
            _Refund_Info,
            _Refund_RequestSchema,
            _Refund_ResponseSchema));

    #endregion

    #region Meta Endpoints for Cancel

    private static readonly string _Cancel_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/CancelRequest",
    "$defs": {
        "CancelRequest": {
            "type": "object",
            "description": "Request to cancel escrow before fully funded",
            "required": [
                "escrowId",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "reason": {
                    "type": "string",
                    "nullable": true,
                    "description": "Reason for cancellation"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        }
    }
}
""";

    private static readonly string _Cancel_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/CancelResponse",
    "$defs": {
        "CancelResponse": {
            "type": "object",
            "description": "Response from cancelling an escrow",
            "required": [
                "escrow",
                "refunds"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Cancelled escrow agreement"
                },
                "refunds": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/RefundResult"
                    },
                    "description": "Refund results for any deposits"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        },
        "RefundResult": {
            "type": "object",
            "description": "Result of refunding assets to a single depositor",
            "required": [
                "depositorPartyId",
                "success"
            ],
            "properties": {
                "depositorPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Depositor party ID"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets refunded (null if failed)",
                    "nullable": true
                },
                "success": {
                    "type": "boolean",
                    "description": "Whether refund succeeded"
                },
                "error": {
                    "type": "string",
                    "nullable": true,
                    "description": "Error message if failed"
                }
            }
        }
    }
}
""";

    private static readonly string _Cancel_Info = """
{
    "summary": "Cancel escrow before fully funded",
    "description": "Cancel escrow before fully funded, refunding any deposits.",
    "tags": [
        "Completion"
    ],
    "deprecated": false,
    "operationId": "cancel"
}
""";

    /// <summary>Returns endpoint information for Cancel</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/cancel/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Cancel_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/cancel",
            _Cancel_Info));

    /// <summary>Returns request schema for Cancel</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/cancel/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Cancel_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/cancel",
            "request-schema",
            _Cancel_RequestSchema));

    /// <summary>Returns response schema for Cancel</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/cancel/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Cancel_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/cancel",
            "response-schema",
            _Cancel_ResponseSchema));

    /// <summary>Returns full schema for Cancel</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/cancel/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Cancel_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/cancel",
            _Cancel_Info,
            _Cancel_RequestSchema,
            _Cancel_ResponseSchema));

    #endregion

    #region Meta Endpoints for Dispute

    private static readonly string _Dispute_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/DisputeRequest",
    "$defs": {
        "DisputeRequest": {
            "type": "object",
            "description": "Request to raise a dispute on a funded escrow",
            "required": [
                "escrowId",
                "partyId",
                "partyType",
                "reason",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party raising dispute"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "reason": {
                    "type": "string",
                    "description": "Reason for dispute"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Release token (proves party identity)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        }
    }
}
""";

    private static readonly string _Dispute_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/DisputeResponse",
    "$defs": {
        "DisputeResponse": {
            "type": "object",
            "description": "Response from raising a dispute on an escrow",
            "required": [
                "escrow"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Disputed escrow agreement"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        }
    }
}
""";

    private static readonly string _Dispute_Info = """
{
    "summary": "Raise a dispute on funded escrow",
    "description": "Raise a dispute on a funded escrow.",
    "tags": [
        "Completion"
    ],
    "deprecated": false,
    "operationId": "dispute"
}
""";

    /// <summary>Returns endpoint information for Dispute</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/dispute/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Dispute_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/dispute",
            _Dispute_Info));

    /// <summary>Returns request schema for Dispute</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/dispute/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Dispute_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/dispute",
            "request-schema",
            _Dispute_RequestSchema));

    /// <summary>Returns response schema for Dispute</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/dispute/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Dispute_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/dispute",
            "response-schema",
            _Dispute_ResponseSchema));

    /// <summary>Returns full schema for Dispute</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/dispute/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Dispute_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/dispute",
            _Dispute_Info,
            _Dispute_RequestSchema,
            _Dispute_ResponseSchema));

    #endregion

    #region Meta Endpoints for Resolve

    private static readonly string _Resolve_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ResolveRequest",
    "$defs": {
        "ResolveRequest": {
            "type": "object",
            "description": "Request for arbiter to resolve a disputed escrow",
            "required": [
                "escrowId",
                "arbiterId",
                "arbiterType",
                "resolution",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "arbiterId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Arbiter ID"
                },
                "arbiterType": {
                    "type": "object",
                    "description": "Arbiter type"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "Resolution decision for the dispute"
                },
                "splitAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/SplitAllocation"
                    },
                    "description": "For split resolution"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Resolution notes"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        },
        "SplitAllocation": {
            "type": "object",
            "description": "Allocation of assets to a party in a split resolution",
            "required": [
                "partyId",
                "partyType",
                "assets"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party ID"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAssetInput"
                    },
                    "description": "Assets allocated to this party"
                }
            }
        },
        "EscrowAssetInput": {
            "type": "object",
            "description": "Input for specifying an asset in escrow operations",
            "required": [
                "assetType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset to deposit"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Currency code"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Currency amount"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item name"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Item template ID (for stacks)"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Item template name"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "Item quantity (for stacks)"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract description"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Contract party role being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset ID"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Custom asset data"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\ n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\ n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        }
    }
}
""";

    private static readonly string _Resolve_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ResolveResponse",
    "$defs": {
        "ResolveResponse": {
            "type": "object",
            "description": "Response from arbiter resolving a disputed escrow",
            "required": [
                "escrow",
                "transfers"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Resolved escrow agreement"
                },
                "transfers": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/TransferResult"
                    },
                    "description": "Transfer results"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        },
        "TransferResult": {
            "type": "object",
            "description": "Result of transferring assets to a party during resolution",
            "required": [
                "partyId",
                "success"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party ID"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets transferred (null if failed)",
                    "nullable": true
                },
                "success": {
                    "type": "boolean",
                    "description": "Whether transfer succeeded"
                },
                "error": {
                    "type": "string",
                    "nullable": true,
                    "description": "Error message if failed"
                }
            }
        }
    }
}
""";

    private static readonly string _Resolve_Info = """
{
    "summary": "Arbiter resolves disputed escrow",
    "description": "Arbiter resolves a disputed escrow.",
    "tags": [
        "Arbiter"
    ],
    "deprecated": false,
    "operationId": "resolve"
}
""";

    /// <summary>Returns endpoint information for Resolve</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/resolve/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Resolve_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/resolve",
            _Resolve_Info));

    /// <summary>Returns request schema for Resolve</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/resolve/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Resolve_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/resolve",
            "request-schema",
            _Resolve_RequestSchema));

    /// <summary>Returns response schema for Resolve</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/resolve/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Resolve_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/resolve",
            "response-schema",
            _Resolve_ResponseSchema));

    /// <summary>Returns full schema for Resolve</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/resolve/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Resolve_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/resolve",
            _Resolve_Info,
            _Resolve_RequestSchema,
            _Resolve_ResponseSchema));

    #endregion

    #region Meta Endpoints for VerifyCondition

    private static readonly string _VerifyCondition_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/VerifyConditionRequest",
    "$defs": {
        "VerifyConditionRequest": {
            "type": "object",
            "description": "Request to verify a condition for conditional escrow",
            "required": [
                "escrowId",
                "conditionMet",
                "verifierId",
                "verifierType",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "conditionMet": {
                    "type": "boolean",
                    "description": "Whether the condition was met"
                },
                "verifierId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Verifier entity ID"
                },
                "verifierType": {
                    "type": "object",
                    "description": "Verifier entity type"
                },
                "verificationData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Proof/evidence data"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        }
    }
}
""";

    private static readonly string _VerifyCondition_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/VerifyConditionResponse",
    "$defs": {
        "VerifyConditionResponse": {
            "type": "object",
            "description": "Response from verifying a condition on an escrow",
            "required": [
                "escrow",
                "triggered"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Updated escrow agreement"
                },
                "triggered": {
                    "type": "boolean",
                    "description": "Whether this triggered release/refund"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        }
    }
}
""";

    private static readonly string _VerifyCondition_Info = """
{
    "summary": "Verify condition for conditional escrow",
    "description": "Verify condition for conditional escrow (non-contract path).\nFor escrows with boundContractId, use contract milestones instead.\n",
    "tags": [
        "Condition"
    ],
    "deprecated": false,
    "operationId": "verifyCondition"
}
""";

    /// <summary>Returns endpoint information for VerifyCondition</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/verify-condition/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> VerifyCondition_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/verify-condition",
            _VerifyCondition_Info));

    /// <summary>Returns request schema for VerifyCondition</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/verify-condition/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> VerifyCondition_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/verify-condition",
            "request-schema",
            _VerifyCondition_RequestSchema));

    /// <summary>Returns response schema for VerifyCondition</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/verify-condition/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> VerifyCondition_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/verify-condition",
            "response-schema",
            _VerifyCondition_ResponseSchema));

    /// <summary>Returns full schema for VerifyCondition</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/verify-condition/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> VerifyCondition_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/verify-condition",
            _VerifyCondition_Info,
            _VerifyCondition_RequestSchema,
            _VerifyCondition_ResponseSchema));

    #endregion

    #region Meta Endpoints for ValidateEscrow

    private static readonly string _ValidateEscrow_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ValidateEscrowRequest",
    "$defs": {
        "ValidateEscrowRequest": {
            "type": "object",
            "description": "Request to manually validate escrow assets",
            "required": [
                "escrowId"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                }
            }
        }
    }
}
""";

    private static readonly string _ValidateEscrow_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ValidateEscrowResponse",
    "$defs": {
        "ValidateEscrowResponse": {
            "type": "object",
            "description": "Response from validating escrow assets",
            "required": [
                "valid",
                "failures",
                "escrow"
            ],
            "properties": {
                "valid": {
                    "type": "boolean",
                    "description": "Whether all assets are valid"
                },
                "failures": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Validation failures"
                },
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Escrow agreement with validation results"
                }
            }
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\ n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\ n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\ n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\ n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\ n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        }
    }
}
""";

    private static readonly string _ValidateEscrow_Info = """
{
    "summary": "Manually trigger validation",
    "description": "Manually trigger validation on an active escrow.",
    "tags": [
        "Validation"
    ],
    "deprecated": false,
    "operationId": "validateEscrow"
}
""";

    /// <summary>Returns endpoint information for ValidateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/validate/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateEscrow_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/validate",
            _ValidateEscrow_Info));

    /// <summary>Returns request schema for ValidateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/validate/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateEscrow_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/validate",
            "request-schema",
            _ValidateEscrow_RequestSchema));

    /// <summary>Returns response schema for ValidateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/validate/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateEscrow_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/validate",
            "response-schema",
            _ValidateEscrow_ResponseSchema));

    /// <summary>Returns full schema for ValidateEscrow</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/validate/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ValidateEscrow_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/validate",
            _ValidateEscrow_Info,
            _ValidateEscrow_RequestSchema,
            _ValidateEscrow_ResponseSchema));

    #endregion

    #region Meta Endpoints for Reaffirm

    private static readonly string _Reaffirm_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ReaffirmRequest",
    "$defs": {
        "ReaffirmRequest": {
            "type": "object",
            "description": "Request to re-affirm after validation failure",
            "required": [
                "escrowId",
                "partyId",
                "partyType",
                "idempotencyKey"
            ],
            "properties": {
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow ID"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party reaffirming"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Release token"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key"
                }
            }
        }
    }
}
""";

    private static readonly string _Reaffirm_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ReaffirmResponse",
    "$defs": {
        "ReaffirmResponse": {
            "type": "object",
            "description": "Response from party re-affirming after validation failure",
            "required": [
                "escrow",
                "allReaffirmed"
            ],
            "properties": {
                "escrow": {
                    "$ref": "#/$defs/EscrowAgreement",
                    "description": "Reaffirmed escrow agreement"
                },
                "allReaffirmed": {
                    "type": "boolean",
                    "description": "Whether all parties have reaffirmed"
                }
            }
        },
        "EscrowAgreement": {
            "type": "object",
            "description": "Main escrow agreement record",
            "required": [
                "id",
                "escrowType",
                "trustMode",
                "parties",
                "expectedDeposits",
                "deposits",
                "consents",
                "status",
                "requiredConsentsForRelease",
                "createdAt",
                "createdBy",
                "createdByType",
                "expiresAt"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Unique escrow agreement identifier"
                },
                "escrowType": {
                    "$ref": "#/$defs/EscrowType",
                    "description": "Type of escrow agreement"
                },
                "trustMode": {
                    "$ref": "#/$defs/EscrowTrustMode",
                    "description": "Trust mode for the escrow"
                },
                "trustedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For single_party_trusted - which party has authority"
                },
                "trustedPartyType": {
                    "allOf": [
                        {
                            "type": "object"
                        }
                    ],
                    "nullable": true,
                    "description": "Type of the trusted party"
                },
                "initiatorServiceId": {
                    "type": "string",
                    "nullable": true,
                    "description": "For initiator_trusted - which service created this"
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowParty"
                    },
                    "description": "All parties involved in the escrow"
                },
                "expectedDeposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/ExpectedDeposit"
                    },
                    "description": "What deposits are expected from each party"
                },
                "deposits": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowDeposit"
                    },
                    "description": "Actual deposits received"
                },
                "releaseAllocations": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ReleaseAllocation"
                    },
                    "description": "How assets should be distributed on release"
                },
                "boundContractId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Contract governing conditions for this escrow"
                },
                "consents": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowConsent"
                    },
                    "description": "Consent decisions from parties"
                },
                "status": {
                    "$ref": "#/$defs/EscrowStatus",
                    "description": "Current escrow status"
                },
                "requiredConsentsForRelease": {
                    "type": "integer",
                    "description": "How many parties must consent for release (-1 = all required)"
                },
                "lastValidatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow was last validated"
                },
                "validationFailures": {
                    "type": "array",
                    "nullable": true,
                    "items": {
                        "$ref": "#/$defs/ValidationFailure"
                    },
                    "description": "Any validation failures detected"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the escrow was created"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Who created the escrow"
                },
                "createdByType": {
                    "type": "object",
                    "description": "Type of the creator entity"
                },
                "fundedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When all expected deposits were received"
                },
                "expiresAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Auto-refund if not completed by this time"
                },
                "completedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the escrow reached terminal state"
                },
                "referenceType": {
                    "type": "string",
                    "nullable": true,
                    "description": "What this escrow is for (e.g., trade, auction, contract)"
                },
                "referenceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "ID of the referenced entity"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Human-readable description"
                },
                "metadata": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Game/application specific metadata"
                },
                "resolution": {
                    "$ref": "#/$defs/EscrowResolution",
                    "description": "How the escrow was resolved",
                    "nullable": true
                },
                "resolutionNotes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Notes about the resolution"
                }
            }
        },
        "EscrowType": {
            "type": "string",
            "description": "Type of escrow agreement.\n- two_party: Simple trade escrow between Party A and Party B\n- multi_party: N parties with complex deposit/receive rules\n- conditional: Release based on external condition or contract fulfillment\n- auction: Winner-takes-all with refunds to losers\n",
            "enum": [
                "two_party",
                "multi_party",
                "conditional",
                "auction"
            ]
        },
        "EscrowTrustMode": {
            "type": "string",
            "description": "Trust model for the escrow agreement.\n- full_consent: All parties must explicitly consent using tokens\n- initiator_trusted: The service that created the escrow can complete unilaterally\n- single_party_trusted: A designated party can complete unilaterally\n",
            "enum": [
                "full_consent",
                "initiator_trusted",
                "single_party_trusted"
            ]
        },
        "EscrowParty": {
            "type": "object",
            "description": "A party in the escrow agreement",
            "required": [
                "partyId",
                "partyType",
                "role",
                "consentRequired",
                "depositTokenUsed",
                "releaseTokenUsed"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party entity identifier"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "displayName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Display name for UI/logging"
                },
                "role": {
                    "$ref": "#/$defs/EscrowPartyRole",
                    "description": "Role of this party in the escrow"
                },
                "consentRequired": {
                    "type": "boolean",
                    "description": "Whether this party consent is required for release"
                },
                "walletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own wallet (where currency comes from/returns to)"
                },
                "containerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Party own container (where items come from/return to)"
                },
                "escrowWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow wallet for THIS party deposits (owned by escrow)"
                },
                "escrowContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Escrow container for THIS party deposits (owned by escrow)"
                },
                "depositToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for depositing (full_consent mode)"
                },
                "depositTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the deposit token has been used"
                },
                "depositTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the deposit token was used"
                },
                "releaseToken": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token for consenting to release"
                },
                "releaseTokenUsed": {
                    "type": "boolean",
                    "description": "Whether the release token has been used"
                },
                "releaseTokenUsedAt": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "When the release token was used"
                }
            }
        },
        "EscrowPartyRole": {
            "type": "string",
            "description": "Role of a party in the escrow.\n- depositor: Deposits assets into escrow\n- recipient: Receives assets when released\n- depositor_recipient: Both deposits and can receive (typical for trades)\n- arbiter: Can resolve disputes, does not deposit or receive\n- observer: Can view status but cannot act\n",
            "enum": [
                "depositor",
                "recipient",
                "depositor_recipient",
                "arbiter",
                "observer"
            ]
        },
        "ExpectedDeposit": {
            "type": "object",
            "description": "Defines what a party should deposit",
            "required": [
                "partyId",
                "partyType",
                "expectedAssets",
                "optional",
                "fulfilled"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who should deposit"
                },
                "partyType": {
                    "description": "Type of depositing party",
                    "type": "object"
                },
                "expectedAssets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Expected assets from this party"
                },
                "optional": {
                    "type": "boolean",
                    "description": "Is this deposit optional"
                },
                "depositDeadline": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Deadline for this specific deposit"
                },
                "fulfilled": {
                    "type": "boolean",
                    "description": "Has this party fulfilled their deposit requirement"
                }
            }
        },
        "EscrowAsset": {
            "type": "object",
            "description": "An asset held in escrow",
            "required": [
                "assetType",
                "sourceOwnerId",
                "sourceOwnerType"
            ],
            "properties": {
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset held in escrow"
                },
                "currencyDefinitionId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=currency - currency definition ID"
                },
                "currencyCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized currency code for display"
                },
                "currencyAmount": {
                    "type": "number",
                    "nullable": true,
                    "description": "Amount of currency"
                },
                "itemInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item - unique item instance ID"
                },
                "itemName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized item name for display"
                },
                "itemTemplateId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=item_stack - stackable item template"
                },
                "itemTemplateName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized template name for display"
                },
                "itemQuantity": {
                    "type": "integer",
                    "nullable": true,
                    "description": "For assetType=item_stack - quantity"
                },
                "contractInstanceId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "For assetType=contract - contract instance ID"
                },
                "contractTemplateCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "Denormalized contract template code"
                },
                "contractDescription": {
                    "type": "string",
                    "nullable": true,
                    "description": "Description of the contract"
                },
                "contractPartyRole": {
                    "type": "string",
                    "nullable": true,
                    "description": "Which party role in the contract is being escrowed"
                },
                "customAssetType": {
                    "type": "string",
                    "nullable": true,
                    "description": "For assetType=custom - registered handler type"
                },
                "customAssetId": {
                    "type": "string",
                    "nullable": true,
                    "description": "Custom asset identifier"
                },
                "customAssetData": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Handler-specific data"
                },
                "sourceOwnerId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Where this asset came from (for refunds)"
                },
                "sourceOwnerType": {
                    "type": "object",
                    "description": "Type of the source owner"
                },
                "sourceContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Source wallet/container ID"
                }
            }
        },
        "AssetType": {
            "type": "string",
            "description": "Type of asset held in escrow.\n- currency: Currency amount held in escrow wallet\n- item: Item instance held in escrow container\n- item_stack: Stackable items (quantity) held in escrow container\n- contract: Contract instance locked under escrow guardianship\n- custom: Custom asset type via registered handler\n",
            "enum": [
                "currency",
                "item",
                "item_stack",
                "contract",
                "custom"
            ]
        },
        "EscrowDeposit": {
            "type": "object",
            "description": "Records an actual deposit",
            "required": [
                "id",
                "escrowId",
                "partyId",
                "partyType",
                "assets",
                "depositedAt",
                "idempotencyKey"
            ],
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Deposit record identifier"
                },
                "escrowId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Escrow this deposit belongs to"
                },
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party who deposited"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "assets": {
                    "$ref": "#/$defs/EscrowAssetBundle",
                    "description": "Assets deposited"
                },
                "depositedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the deposit was made"
                },
                "depositTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "idempotencyKey": {
                    "type": "string",
                    "description": "Idempotency key for this deposit"
                }
            }
        },
        "EscrowAssetBundle": {
            "type": "object",
            "description": "Groups multiple assets for a single deposit or release",
            "required": [
                "bundleId",
                "assets"
            ],
            "properties": {
                "bundleId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Bundle identifier"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets in this bundle"
                },
                "description": {
                    "type": "string",
                    "nullable": true,
                    "description": "Summary for display"
                },
                "estimatedValue": {
                    "type": "number",
                    "nullable": true,
                    "description": "Optional valuation for UI display"
                }
            }
        },
        "ReleaseAllocation": {
            "type": "object",
            "description": "Defines who gets what on release",
            "required": [
                "recipientPartyId",
                "recipientPartyType",
                "assets"
            ],
            "properties": {
                "recipientPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party receiving assets"
                },
                "recipientPartyType": {
                    "type": "object",
                    "description": "Type of the recipient party"
                },
                "assets": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/EscrowAsset"
                    },
                    "description": "Assets this recipient should receive"
                },
                "destinationWalletId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver currency"
                },
                "destinationContainerId": {
                    "type": "string",
                    "format": "uuid",
                    "nullable": true,
                    "description": "Where to deliver items"
                }
            }
        },
        "EscrowConsent": {
            "type": "object",
            "description": "Records a party consent decision",
            "required": [
                "partyId",
                "partyType",
                "consentType",
                "consentedAt"
            ],
            "properties": {
                "partyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Party giving consent"
                },
                "partyType": {
                    "description": "Type of entity (Account, Character, etc.)",
                    "type": "object"
                },
                "consentType": {
                    "$ref": "#/$defs/EscrowConsentType",
                    "description": "Type of consent given"
                },
                "consentedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When consent was given"
                },
                "releaseTokenUsed": {
                    "type": "string",
                    "nullable": true,
                    "description": "Token used (for audit)"
                },
                "notes": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional notes"
                }
            }
        },
        "EscrowConsentType": {
            "type": "string",
            "description": "Type of consent being given.\n- release: Agrees to release assets to recipients\n- refund: Agrees to refund assets to depositors\n- dispute: Raises a dispute\n- reaffirm: Re-affirms after validation failure\n",
            "enum": [
                "release",
                "refund",
                "dispute",
                "reaffirm"
            ]
        },
        "EscrowStatus": {
            "type": "string",
            "description": "Current status of the escrow agreement.\n- pending_deposits: Waiting for parties to deposit\n- partially_funded: Some but not all deposits received\n- funded: All deposits received, awaiting consent/condition\ n- pending_consent: Some consents received, waiting for more\n- pending_condition: Waiting for contract fulfillment or external verification\n- finalizing: Running contract finalizer prebound APIs (transient)\n- releasing: Release in progress (transient)\n- released: Assets transferred to recipients\n- refunding: Refund in progress (transient)\ n- refunded: Assets returned to depositors\n- disputed: In dispute, arbiter must resolve\n- expired: Timed out without completion\n- cancelled: Cancelled before funding complete\n- validation_failed: Held assets changed, awaiting re-affirmation\n",
            "enum": [
                "pending_deposits",
                "partially_funded",
                "funded",
                "pending_consent",
                "pending_condition",
                "finalizing",
                "releasing",
                "released",
                "refunding",
                "refunded",
                "disputed",
                "expired",
                "cancelled",
                "validation_failed"
            ]
        },
        "ValidationFailure": {
            "type": "object",
            "description": "Records a validation check failure",
            "required": [
                "detectedAt",
                "assetType",
                "assetDescription",
                "failureType",
                "affectedPartyId",
                "affectedPartyType"
            ],
            "properties": {
                "detectedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the failure was detected"
                },
                "assetType": {
                    "$ref": "#/$defs/AssetType",
                    "description": "Type of asset affected"
                },
                "assetDescription": {
                    "type": "string",
                    "description": "Description of the affected asset"
                },
                "failureType": {
                    "$ref": "#/$defs/ValidationFailureType",
                    "description": "Type of validation failure"
                },
                "affectedPartyId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Which party deposit is affected"
                },
                "affectedPartyType": {
                    "type": "object",
                    "description": "Type of the affected party"
                },
                "details": {
                    "type": "object",
                    "nullable": true,
                    "additionalProperties": true,
                    "description": "Additional failure details"
                }
            }
        },
        "ValidationFailureType": {
            "type": "string",
            "description": "Type of validation failure detected.\n- asset_missing: Asset no longer exists in escrow custody\n- asset_mutated: Asset properties changed (e.g., item durability)\n- asset_expired: Asset has a time-based expiration that triggered\n- balance_mismatch: Wallet balance does not match expected held amount\n",
            "enum": [
                "asset_missing",
                "asset_mutated",
                "asset_expired",
                "balance_mismatch"
            ]
        },
        "EscrowResolution": {
            "type": "string",
            "description": "How the escrow was resolved.\n- released: Assets went to designated recipients\n- refunded: Assets returned to depositors\n- split: Arbiter split assets between parties\n- expired_refunded: Timed out, auto-refunded\n- cancelled_refunded: Cancelled, deposits refunded\n- violation_refunded: Validation failure caused refund\n",
            "enum": [
                "released",
                "refunded",
                "split",
                "expired_refunded",
                "cancelled_refunded",
                "violation_refunded"
            ]
        }
    }
}
""";

    private static readonly string _Reaffirm_Info = """
{
    "summary": "Re-affirm after validation failure",
    "description": "Re-affirm after validation failure (party accepts changed state).",
    "tags": [
        "Validation"
    ],
    "deprecated": false,
    "operationId": "reaffirm"
}
""";

    /// <summary>Returns endpoint information for Reaffirm</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/reaffirm/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Reaffirm_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/reaffirm",
            _Reaffirm_Info));

    /// <summary>Returns request schema for Reaffirm</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/reaffirm/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Reaffirm_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/reaffirm",
            "request-schema",
            _Reaffirm_RequestSchema));

    /// <summary>Returns response schema for Reaffirm</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/reaffirm/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Reaffirm_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/reaffirm",
            "response-schema",
            _Reaffirm_ResponseSchema));

    /// <summary>Returns full schema for Reaffirm</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/reaffirm/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> Reaffirm_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/reaffirm",
            _Reaffirm_Info,
            _Reaffirm_RequestSchema,
            _Reaffirm_ResponseSchema));

    #endregion

    #region Meta Endpoints for RegisterHandler

    private static readonly string _RegisterHandler_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/RegisterHandlerRequest",
    "$defs": {
        "RegisterHandlerRequest": {
            "type": "object",
            "description": "Request to register a custom asset type handler",
            "required": [
                "assetType",
                "pluginId",
                "depositEndpoint",
                "releaseEndpoint",
                "refundEndpoint",
                "validateEndpoint"
            ],
            "properties": {
                "assetType": {
                    "type": "string",
                    "description": "Unique asset type identifier"
                },
                "pluginId": {
                    "type": "string",
                    "description": "Plugin implementing this handler"
                },
                "depositEndpoint": {
                    "type": "string",
                    "description": "Deposit endpoint path"
                },
                "releaseEndpoint": {
                    "type": "string",
                    "description": "Release endpoint path"
                },
                "refundEndpoint": {
                    "type": "string",
                    "description": "Refund endpoint path"
                },
                "validateEndpoint": {
                    "type": "string",
                    "description": "Validate endpoint path"
                }
            }
        }
    }
}
""";

    private static readonly string _RegisterHandler_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/RegisterHandlerResponse",
    "$defs": {
        "RegisterHandlerResponse": {
            "type": "object",
            "description": "Response from registering an asset handler",
            "required": [
                "registered"
            ],
            "properties": {
                "registered": {
                    "type": "boolean",
                    "description": "Whether registration succeeded"
                }
            }
        }
    }
}
""";

    private static readonly string _RegisterHandler_Info = """
{
    "summary": "Register a custom asset type handler",
    "description": "Register a custom asset type handler for extensibility.",
    "tags": [
        "Handlers"
    ],
    "deprecated": false,
    "operationId": "registerHandler"
}
""";

    /// <summary>Returns endpoint information for RegisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/register/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RegisterHandler_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/handler/register",
            _RegisterHandler_Info));

    /// <summary>Returns request schema for RegisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/register/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RegisterHandler_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/register",
            "request-schema",
            _RegisterHandler_RequestSchema));

    /// <summary>Returns response schema for RegisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/register/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RegisterHandler_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/register",
            "response-schema",
            _RegisterHandler_ResponseSchema));

    /// <summary>Returns full schema for RegisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/register/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> RegisterHandler_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/register",
            _RegisterHandler_Info,
            _RegisterHandler_RequestSchema,
            _RegisterHandler_ResponseSchema));

    #endregion

    #region Meta Endpoints for ListHandlers

    private static readonly string _ListHandlers_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ListHandlersRequest",
    "$defs": {
        "ListHandlersRequest": {
            "type": "object",
            "description": "Empty request to list handlers",
            "properties": {}
        }
    }
}
""";

    private static readonly string _ListHandlers_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/ListHandlersResponse",
    "$defs": {
        "ListHandlersResponse": {
            "type": "object",
            "description": "Response containing list of registered asset handlers",
            "required": [
                "handlers"
            ],
            "properties": {
                "handlers": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/AssetHandlerInfo"
                    },
                    "description": "Registered handlers"
                }
            }
        },
        "AssetHandlerInfo": {
            "type": "object",
            "description": "Information about a registered asset handler",
            "required": [
                "assetType",
                "pluginId",
                "builtIn",
                "depositEndpoint",
                "releaseEndpoint",
                "refundEndpoint",
                "validateEndpoint"
            ],
            "properties": {
                "assetType": {
                    "type": "string",
                    "description": "Unique asset type identifier"
                },
                "pluginId": {
                    "type": "string",
                    "description": "Plugin that implements this handler"
                },
                "builtIn": {
                    "type": "boolean",
                    "description": "Whether this is a built-in handler"
                },
                "depositEndpoint": {
                    "type": "string",
                    "description": "Endpoint for depositing"
                },
                "releaseEndpoint": {
                    "type": "string",
                    "description": "Endpoint for releasing"
                },
                "refundEndpoint": {
                    "type": "string",
                    "description": "Endpoint for refunding"
                },
                "validateEndpoint": {
                    "type": "string",
                    "description": "Endpoint for validation"
                }
            }
        }
    }
}
""";

    private static readonly string _ListHandlers_Info = """
{
    "summary": "List registered asset handlers",
    "description": "List registered asset handlers (includes built-in).",
    "tags": [
        "Handlers"
    ],
    "deprecated": false,
    "operationId": "listHandlers"
}
""";

    /// <summary>Returns endpoint information for ListHandlers</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/list/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListHandlers_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/handler/list",
            _ListHandlers_Info));

    /// <summary>Returns request schema for ListHandlers</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/list/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListHandlers_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/list",
            "request-schema",
            _ListHandlers_RequestSchema));

    /// <summary>Returns response schema for ListHandlers</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/list/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListHandlers_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/list",
            "response-schema",
            _ListHandlers_ResponseSchema));

    /// <summary>Returns full schema for ListHandlers</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/list/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> ListHandlers_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/list",
            _ListHandlers_Info,
            _ListHandlers_RequestSchema,
            _ListHandlers_ResponseSchema));

    #endregion

    #region Meta Endpoints for DeregisterHandler

    private static readonly string _DeregisterHandler_RequestSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/DeregisterHandlerRequest",
    "$defs": {
        "DeregisterHandlerRequest": {
            "type": "object",
            "description": "Request to remove a custom asset handler registration",
            "required": [
                "assetType"
            ],
            "properties": {
                "assetType": {
                    "type": "string",
                    "description": "Asset type to deregister"
                }
            }
        }
    }
}
""";

    private static readonly string _DeregisterHandler_ResponseSchema = """
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/$defs/DeregisterHandlerResponse",
    "$defs": {
        "DeregisterHandlerResponse": {
            "type": "object",
            "description": "Response from deregistering an asset handler",
            "required": [
                "deregistered"
            ],
            "properties": {
                "deregistered": {
                    "type": "boolean",
                    "description": "Whether deregistration succeeded"
                }
            }
        }
    }
}
""";

    private static readonly string _DeregisterHandler_Info = """
{
    "summary": "Remove a custom asset handler registration",
    "description": "Remove a custom asset handler registration.",
    "tags": [
        "Handlers"
    ],
    "deprecated": false,
    "operationId": "deregisterHandler"
}
""";

    /// <summary>Returns endpoint information for DeregisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/deregister/meta/info")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> DeregisterHandler_MetaInfo()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildInfoResponse(
            "Escrow",
            "POST",
            "/escrow/handler/deregister",
            _DeregisterHandler_Info));

    /// <summary>Returns request schema for DeregisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/deregister/meta/request-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> DeregisterHandler_MetaRequestSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/deregister",
            "request-schema",
            _DeregisterHandler_RequestSchema));

    /// <summary>Returns response schema for DeregisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/deregister/meta/response-schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> DeregisterHandler_MetaResponseSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/deregister",
            "response-schema",
            _DeregisterHandler_ResponseSchema));

    /// <summary>Returns full schema for DeregisterHandler</summary>
    [Microsoft.AspNetCore.Mvc.HttpGet, Microsoft.AspNetCore.Mvc.Route("/escrow/handler/deregister/meta/schema")]
    public Microsoft.AspNetCore.Mvc.ActionResult<BeyondImmersion.BannouService.Meta.MetaResponse> DeregisterHandler_MetaFullSchema()
        => Ok(BeyondImmersion.BannouService.Meta.MetaResponseBuilder.BuildFullSchemaResponse(
            "Escrow",
            "POST",
            "/escrow/handler/deregister",
            _DeregisterHandler_Info,
            _DeregisterHandler_RequestSchema,
            _DeregisterHandler_ResponseSchema));

    #endregion
}
