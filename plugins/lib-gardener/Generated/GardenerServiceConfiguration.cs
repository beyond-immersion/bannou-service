//----------------------
// <auto-generated>
//     Generated from OpenAPI schema: schemas/gardener-configuration.yaml
//
//     WARNING: DO NOT EDIT THIS FILE (FOUNDATION TENETS)
//     This file is auto-generated from configuration schema.
//     Any manual changes will be overwritten on next generation.
//
//     To add/modify configuration:
//     1. Edit the source schema (schemas/gardener-configuration.yaml)
//     2. Run: scripts/generate-all-services.sh
//
//     IMPLEMENTATION TENETS - Configuration-First:
//     - Access configuration via dependency injection, never Environment.GetEnvironmentVariable.
//     - ALL properties below MUST be referenced somewhere in the plugin (no dead config).
//     - Any hardcoded tunable (limit, timeout, threshold, capacity) in service code means
//       a configuration property is MISSING - add it to the configuration schema.
//     - If a property is unused, remove it from the configuration schema.
//
//     Example: public MyService(GardenerServiceConfiguration config) { _config = config; }
//
//     See: docs/reference/tenets/IMPLEMENTATION.md (Configuration-First, Internal Model Type Safety)
// </auto-generated>
//----------------------

using System.ComponentModel.DataAnnotations;
using BeyondImmersion.BannouService;
using BeyondImmersion.BannouService.Attributes;
using BeyondImmersion.BannouService.Configuration;

#nullable enable

namespace BeyondImmersion.BannouService.Gardener;

/// <summary>
/// Configuration class for Gardener service.
/// Properties are automatically bound from environment variables.
/// </summary>
/// <remarks>
/// <para>
/// <b>IMPLEMENTATION TENETS - Configuration-First:</b> Access configuration via dependency injection.
/// Never use <c>Environment.GetEnvironmentVariable()</c> directly in service code.
/// ALL properties in this class MUST be referenced somewhere in the plugin.
/// If a property is unused, remove it from the configuration schema.
/// </para>
/// <para>
/// Environment variable names follow the pattern: {SERVICE}_{PROPERTY} (e.g., AUTH_JWT_SECRET).
/// </para>
/// </remarks>
[ServiceConfiguration(typeof(GardenerService))]
public class GardenerServiceConfiguration : IServiceConfiguration
{
    /// <inheritdoc />
    public Guid? ForceServiceId { get; set; }

    /// <summary>
    /// Milliseconds between void orchestrator evaluation cycles
    /// Environment variable: GARDENER_VOID_TICK_INTERVAL_MS
    /// </summary>
    [ConfigRange(Minimum = 1000, Maximum = 60000)]
    public int VoidTickIntervalMs { get; set; } = 5000;

    /// <summary>
    /// Maximum concurrent POIs per player void instance
    /// Environment variable: GARDENER_MAX_ACTIVE_POIS_PER_VOID
    /// </summary>
    [ConfigRange(Minimum = 1, Maximum = 50)]
    public int MaxActivePoisPerVoid { get; set; } = 8;

    /// <summary>
    /// Default time-to-live in minutes for spawned POIs before expiration
    /// Environment variable: GARDENER_POI_DEFAULT_TTL_MINUTES
    /// </summary>
    [ConfigRange(Minimum = 1, Maximum = 120)]
    public int PoiDefaultTtlMinutes { get; set; } = 10;

    /// <summary>
    /// Minimum distance from player to spawn a POI in void space units
    /// Environment variable: GARDENER_POI_SPAWN_RADIUS_MIN
    /// </summary>
    public double PoiSpawnRadiusMin { get; set; } = 50.0;

    /// <summary>
    /// Maximum distance from player to spawn a POI in void space units
    /// Environment variable: GARDENER_POI_SPAWN_RADIUS_MAX
    /// </summary>
    public double PoiSpawnRadiusMax { get; set; } = 200.0;

    /// <summary>
    /// Minimum distance between any two POIs in void space units
    /// Environment variable: GARDENER_MIN_POI_SPACING
    /// </summary>
    public double MinPoiSpacing { get; set; } = 30.0;

    /// <summary>
    /// Default initial intensity ramp value for spawned POIs (0.0-1.0)
    /// Environment variable: GARDENER_POI_DEFAULT_INTENSITY_RAMP
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double PoiDefaultIntensityRamp { get; set; } = 0.5;

    /// <summary>
    /// Default trigger radius for POI proximity detection in void space units
    /// Environment variable: GARDENER_POI_DEFAULT_TRIGGER_RADIUS
    /// </summary>
    [ConfigRange(Minimum = 1.0)]
    public double PoiDefaultTriggerRadius { get; set; } = 15.0;

    /// <summary>
    /// Minimum distance movement for hesitation detection in void space units
    /// Environment variable: GARDENER_HESITATION_DETECTION_THRESHOLD
    /// </summary>
    [ConfigRange(Minimum = 0.0)]
    public double HesitationDetectionThreshold { get; set; } = 0.1;

    /// <summary>
    /// Diversity score multiplier for recently completed scenarios (0 = never reoffered, 1 = no penalty)
    /// Environment variable: GARDENER_DIVERSITY_SEEN_PENALTY
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double DiversitySeenPenalty { get; set; } = 0.2;

    /// <summary>
    /// Minimum total drift distance to classify a player as exploring
    /// Environment variable: GARDENER_EXPLORATION_DISTANCE_THRESHOLD
    /// </summary>
    [ConfigRange(Minimum = 0.0)]
    public double ExplorationDistanceThreshold { get; set; } = 500.0;

    /// <summary>
    /// Minimum hesitation ratio to classify a player as hesitant
    /// Environment variable: GARDENER_HESITANT_HESITATION_THRESHOLD
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double HesitantHesitationThreshold { get; set; } = 0.6;

    /// <summary>
    /// Maximum hesitation ratio to still classify a player as exploring
    /// Environment variable: GARDENER_EXPLORATION_MAX_HESITATION_RATIO
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double ExplorationMaxHesitationRatio { get; set; } = 0.3;

    /// <summary>
    /// Minimum total drift distance to classify a player as directed
    /// Environment variable: GARDENER_DIRECTED_DISTANCE_THRESHOLD
    /// </summary>
    [ConfigRange(Minimum = 0.0)]
    public double DirectedDistanceThreshold { get; set; } = 200.0;

    /// <summary>
    /// Maximum hesitation ratio to classify a player as directed
    /// Environment variable: GARDENER_DIRECTED_MAX_HESITATION_RATIO
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double DirectedMaxHesitationRatio { get; set; } = 0.15;

    /// <summary>
    /// Maximum hesitation ratio for proximity-based POI trigger mode selection
    /// Environment variable: GARDENER_PROXIMITY_TRIGGER_MAX_HESITATION_RATIO
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double ProximityTriggerMaxHesitationRatio { get; set; } = 0.2;

    /// <summary>
    /// Divisor for normalizing hesitation count to a ratio against distance
    /// Environment variable: GARDENER_HESITATION_RATIO_NORMALIZATION_FACTOR
    /// </summary>
    [ConfigRange(Minimum = 1.0)]
    public double HesitationRatioNormalizationFactor { get; set; } = 10.0;

    /// <summary>
    /// Narrative score for strongest category-pattern match (e.g. exploring player + exploration scenario)
    /// Environment variable: GARDENER_NARRATIVE_SCORE_HIGH
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double NarrativeScoreHigh { get; set; } = 0.9;

    /// <summary>
    /// Narrative score for good category-pattern match (e.g. exploring player + narrative scenario)
    /// Environment variable: GARDENER_NARRATIVE_SCORE_MEDIUM_HIGH
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double NarrativeScoreMediumHigh { get; set; } = 0.7;

    /// <summary>
    /// Narrative score for moderate category-pattern match (e.g. exploring player + mixed scenario)
    /// Environment variable: GARDENER_NARRATIVE_SCORE_MEDIUM
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double NarrativeScoreMedium { get; set; } = 0.6;

    /// <summary>
    /// Narrative score for weak category-pattern match (e.g. exploring player + combat scenario)
    /// Environment variable: GARDENER_NARRATIVE_SCORE_LOW
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double NarrativeScoreLow { get; set; } = 0.4;

    /// <summary>
    /// Baseline narrative score when no player drift pattern is detected
    /// Environment variable: GARDENER_NARRATIVE_SCORE_NEUTRAL
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double NarrativeScoreNeutral { get; set; } = 0.5;

    /// <summary>
    /// Weight for domain affinity in scenario scoring algorithm
    /// Environment variable: GARDENER_AFFINITY_WEIGHT
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double AffinityWeight { get; set; } = 0.4;

    /// <summary>
    /// Weight for category diversity in scenario scoring algorithm
    /// Environment variable: GARDENER_DIVERSITY_WEIGHT
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double DiversityWeight { get; set; } = 0.3;

    /// <summary>
    /// Weight for drift-pattern narrative response in scenario scoring
    /// Environment variable: GARDENER_NARRATIVE_WEIGHT
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double NarrativeWeight { get; set; } = 0.2;

    /// <summary>
    /// Weight for randomness and discovery in scenario scoring
    /// Environment variable: GARDENER_RANDOM_WEIGHT
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double RandomWeight { get; set; } = 0.1;

    /// <summary>
    /// Minutes before a completed scenario can be re-offered to the same player
    /// Environment variable: GARDENER_RECENT_SCENARIO_COOLDOWN_MINUTES
    /// </summary>
    [ConfigRange(Minimum = 0, Maximum = 1440)]
    public int RecentScenarioCooldownMinutes { get; set; } = 30;

    /// <summary>
    /// Maximum total active scenario instances across all players
    /// Environment variable: GARDENER_MAX_CONCURRENT_SCENARIOS_GLOBAL
    /// </summary>
    [ConfigRange(Minimum = 1)]
    public int MaxConcurrentScenariosGlobal { get; set; } = 1000;

    /// <summary>
    /// Maximum scenario duration before forced completion in minutes
    /// Environment variable: GARDENER_SCENARIO_TIMEOUT_MINUTES
    /// </summary>
    [ConfigRange(Minimum = 5, Maximum = 480)]
    public int ScenarioTimeoutMinutes { get; set; } = 60;

    /// <summary>
    /// Minutes without player input before scenario is marked abandoned
    /// Environment variable: GARDENER_ABANDON_DETECTION_MINUTES
    /// </summary>
    [ConfigRange(Minimum = 1, Maximum = 60)]
    public int AbandonDetectionMinutes { get; set; } = 5;

    /// <summary>
    /// Global multiplier applied to all growth awards from scenario completion
    /// Environment variable: GARDENER_GROWTH_AWARD_MULTIPLIER
    /// </summary>
    [ConfigRange(Minimum = 0.0)]
    public double GrowthAwardMultiplier { get; set; } = 1.0;

    /// <summary>
    /// Maximum time ratio cap for full completion growth (overtime bonus cap)
    /// Environment variable: GARDENER_GROWTH_FULL_COMPLETION_MAX_RATIO
    /// </summary>
    [ConfigRange(Minimum = 0.1)]
    public double GrowthFullCompletionMaxRatio { get; set; } = 1.5;

    /// <summary>
    /// Minimum time ratio floor for full completion growth (speed-run minimum)
    /// Environment variable: GARDENER_GROWTH_FULL_COMPLETION_MIN_RATIO
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double GrowthFullCompletionMinRatio { get; set; } = 0.5;

    /// <summary>
    /// Maximum time ratio cap for abandoned/timed-out scenario growth
    /// Environment variable: GARDENER_GROWTH_PARTIAL_MAX_RATIO
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double GrowthPartialMaxRatio { get; set; } = 0.5;

    /// <summary>
    /// Fallback estimated duration for templates without an explicit value
    /// Environment variable: GARDENER_DEFAULT_ESTIMATED_DURATION_MINUTES
    /// </summary>
    [ConfigRange(Minimum = 1)]
    public int DefaultEstimatedDurationMinutes { get; set; } = 30;

    /// <summary>
    /// Whether bonded players share a void instance with merged POIs
    /// Environment variable: GARDENER_BOND_SHARED_VOID_ENABLED
    /// </summary>
    public bool BondSharedVoidEnabled { get; set; } = true;

    /// <summary>
    /// Scoring boost multiplier for bond-friendly scenarios when player is bonded
    /// Environment variable: GARDENER_BOND_SCENARIO_PRIORITY
    /// </summary>
    [ConfigRange(Minimum = 1.0)]
    public double BondScenarioPriority { get; set; } = 1.5;

    /// <summary>
    /// Starting deployment phase for new installations
    /// Environment variable: GARDENER_DEFAULT_PHASE
    /// </summary>
    public DeploymentPhase DefaultPhase { get; set; } = DeploymentPhase.Alpha;

    /// <summary>
    /// Which seed type code this gardener manages for player spirits
    /// Environment variable: GARDENER_SEED_TYPE_CODE
    /// </summary>
    public string SeedTypeCode { get; set; } = "guardian";

    /// <summary>
    /// Seconds between scenario lifecycle worker evaluation cycles
    /// Environment variable: GARDENER_SCENARIO_LIFECYCLE_WORKER_INTERVAL_SECONDS
    /// </summary>
    [ConfigRange(Minimum = 5, Maximum = 300)]
    public int ScenarioLifecycleWorkerIntervalSeconds { get; set; } = 30;

    /// <summary>
    /// Seconds to wait before starting background workers after service initialization
    /// Environment variable: GARDENER_BACKGROUND_SERVICE_STARTUP_DELAY_SECONDS
    /// </summary>
    [ConfigRange(Minimum = 0, Maximum = 60)]
    public int BackgroundServiceStartupDelaySeconds { get; set; } = 5;

    /// <summary>
    /// Timeout in seconds for distributed lock acquisition on gardener operations
    /// Environment variable: GARDENER_DISTRIBUTED_LOCK_TIMEOUT_SECONDS
    /// </summary>
    [ConfigRange(Minimum = 5, Maximum = 300)]
    public int DistributedLockTimeoutSeconds { get; set; } = 30;

    /// <summary>
    /// Maximum rejection sampling attempts when generating a valid POI position
    /// Environment variable: GARDENER_POI_POSITION_MAX_RETRIES
    /// </summary>
    [ConfigRange(Minimum = 1, Maximum = 100)]
    public int PoiPositionMaxRetries { get; set; } = 10;

    /// <summary>
    /// Y-axis scale factor for POI vertical distribution relative to horizontal spread
    /// Environment variable: GARDENER_POI_VERTICAL_DAMPENING_FACTOR
    /// </summary>
    [ConfigRange(Minimum = 0.0, Maximum = 1.0)]
    public double PoiVerticalDampeningFactor { get; set; } = 0.3;

}
