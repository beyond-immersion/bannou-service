// <auto-generated>
// This code was generated by generate-compression-callbacks.py
// Do not edit this file manually.
// </auto-generated>

#nullable enable

using BeyondImmersion.Bannou.Core;
using BeyondImmersion.BannouService.Resource;

namespace BeyondImmersion.BannouService.Quest;

/// <summary>
/// Generated compression callback registration for QuestService.
/// </summary>
/// <remarks>
/// Call <see cref="RegisterAsync"/> during service startup (OnRunningAsync)
/// to register compression callbacks with lib-resource.
/// </remarks>
public static class QuestCompressionCallbacks
{
    /// <summary>
    /// Registers compression callbacks with lib-resource.
    /// Call this during service startup (OnRunningAsync).
    /// </summary>
    /// <param name="resourceClient">The resource service client.</param>
    /// <param name="cancellationToken">Cancellation token.</param>
    /// <returns>True if registration succeeded, false on failure.</returns>
    public static async Task<bool> RegisterAsync(
        IResourceClient resourceClient,
        CancellationToken cancellationToken = default)
    {
        try
        {
            await resourceClient.DefineCompressCallbackAsync(
                new DefineCompressCallbackRequest
                {
                    ResourceType = "character",
                    SourceType = "quest",
                    ServiceName = "quest",
                    CompressEndpoint = "/quest/get-compress-data",
                    CompressPayloadTemplate = "{\"characterId\": \"{{resourceId}}\"}",
                    Priority = 50,
                    Description = "Quest state (active quests, completed counts, category breakdown)"
                },
                cancellationToken);
            return true;
        }
        catch (ApiException)
        {
            return false;
        }
    }
}
