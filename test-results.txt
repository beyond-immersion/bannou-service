lysander@Lys-Desktop:~/repos/bannou$ make test-edge
ğŸ§ª Running Edge/WebSocket integration tests...
WARN[0000] The "SERVICE_DOMAIN" variable is not set. Defaulting to a blank string.
Compose can now delegate builds to bake for better performance.
 To do so, set COMPOSE_BAKE=true.
[+] Building 49.9s (35/35) FINISHED                                                                                                                                          docker:default
 => [bannou-edge-tester internal] load build definition from Dockerfile                                                                                                                0.0s
 => => transferring dockerfile: 983B                                                                                                                                                   0.0s
 => [bannou internal] load build definition from Dockerfile                                                                                                                            0.0s
 => => transferring dockerfile: 1.60kB                                                                                                                                                 0.0s
 => [bannou internal] load metadata for mcr.microsoft.com/dotnet/aspnet:9.0                                                                                                            0.2s
 => [bannou-edge-tester internal] load metadata for docker.io/library/bannou:latest                                                                                                    0.0s
 => [bannou internal] load metadata for mcr.microsoft.com/dotnet/sdk:9.0                                                                                                               0.2s
 => [bannou internal] load .dockerignore                                                                                                                                               0.0s
 => => transferring context: 382B                                                                                                                                                      0.0s
 => [bannou-edge-tester internal] load .dockerignore                                                                                                                                   0.1s
 => => transferring context: 382B                                                                                                                                                      0.0s
 => [bannou internal] load build context                                                                                                                                               0.1s
 => => transferring context: 29.14kB                                                                                                                                                   0.0s
 => CACHED [bannou-edge-tester stage-1 1/8] FROM mcr.microsoft.com/dotnet/aspnet:9.0@sha256:925a86ec775fe737f1d65371ad7b2e01e81390c3c327ce3c06866a8ce8a4e1a2                           0.0s
 => CACHED [bannou-edge-tester intermediate 1/8] FROM mcr.microsoft.com/dotnet/sdk:9.0@sha256:584cdb686f8ff7d2ffd636581b9bba8c9de38df1e751e9275438cddecdfbbcd2                         0.0s
 => [bannou-edge-tester internal] load build context                                                                                                                                   0.1s
 => => transferring context: 29.14kB                                                                                                                                                   0.0s
 => [bannou-edge-tester bannou-base 1/1] FROM docker.io/library/bannou:latest                                                                                                          0.2s
 => CACHED [bannou-edge-tester runtime 2/4] WORKDIR /app                                                                                                                               0.0s
 => CACHED [bannou-edge-tester build 2/4] WORKDIR /app                                                                                                                                 0.0s
 => [bannou intermediate 2/8] COPY ./ /app/                                                                                                                                            0.2s
 => [bannou-edge-tester build 3/4] COPY . .                                                                                                                                            0.2s
 => [bannou intermediate 3/8] RUN apt-get update && apt-get install -y libxml2-utils && apt-get install -y rsync                                                                       4.8s
 => [bannou-edge-tester build 4/4] RUN dotnet build edge-tester --configuration Release                                                                                               23.9s
 => [bannou intermediate 4/8] WORKDIR /app                                                                                                                                             0.1ss
 => [bannou intermediate 5/8] RUN if [ -z "" ]; then         echo "ğŸ”§ Building all available services (no BANNOU_SERVICES specified)";         bash scripts/build-service-libs.sh;     36.4s
 => [bannou-edge-tester runtime 3/4] COPY --from=build /app/edge-tester/bin/Release/net9.0/ .                                                                                          0.1s
 => [bannou-edge-tester runtime 4/4] COPY --from=bannou-base /app/plugins/ ./plugins/                                                                                                  0.1s
 => [bannou-edge-tester] exporting to image                                                                                                                                            0.1s
 => => exporting layers                                                                                                                                                                0.1s
 => => writing image sha256:9046259381b52b7e05ef285583040c6fc1fe4f94e94dae68b16aba229cd43c44                                                                                           0.0s
 => => naming to docker.io/library/bannou-test-edge-bannou-edge-tester                                                                                                                 0.0s
 => [bannou-edge-tester] resolving provenance for metadata file                                                                                                                        0.0s
 => [bannou intermediate 6/8] RUN dotnet dev-certs https                                                                                                                               0.8s
 => [bannou intermediate 7/8] RUN dotnet publish -o /app/bannou-service/publish -c Release /app/bannou-service/                                                                        1.8s
 => [bannou stage-1 2/8] COPY --from=intermediate /app/bannou-service/publish /app                                                                                                     0.1s
 => [bannou stage-1 3/8] COPY --from=intermediate /app/plugins /app/plugins                                                                                                            0.1s
 => [bannou stage-1 4/8] COPY --from=intermediate /app/plugins/PLUGIN_MANIFEST.txt /PLUGIN_MANIFEST.txt                                                                                0.1s
 => [bannou stage-1 5/8] COPY --from=intermediate /root/.dotnet/corefx/cryptography/x509stores/my/* /root/.dotnet/corefx/cryptography/x509stores/my/                                   0.1s
 => [bannou stage-1 6/8] COPY --from=intermediate /root/.dotnet/corefx/cryptography/x509stores/my/* /certificates/                                                                     0.1s
 => [bannou stage-1 7/8] WORKDIR /app                                                                                                                                                  0.1s
 => [bannou stage-1 8/8] RUN apt-get update && apt-get install -y curl                                                                                                                 4.0s
 => [bannou] exporting to image                                                                                                                                                        0.1s
 => => exporting layers                                                                                                                                                                0.1s
 => => writing image sha256:eea79869d6803cafa025a467f8698e451e3252f1f0bedf4a6c6c61bc40053cf7                                                                                           0.0s
 => => naming to docker.io/library/bannou:latest                                                                                                                                       0.0s
 => [bannou] resolving provenance for metadata file                                                                                                                                    0.0s
[+] Building 2/2
 âœ” bannou              Built                                                                                                                                                           0.0s
 âœ” bannou-edge-tester  Built                                                                                                                                                           0.0s
WARN[0000] The "SERVICE_DOMAIN" variable is not set. Defaulting to a blank string.
[+] Running 18/18
 âœ” Network bannou-test-edge_default                 Created                                                                                                                            0.0s
 âœ” Network bannou-test-edge_external                Created                                                                                                                            0.0s
 âœ” Volume "bannou-test-edge_routing-redis-data"     Created                                                                                                                            0.0s
 âœ” Volume "bannou-test-edge_logs-data"              Created                                                                                                                            0.0s
 âœ” Volume "bannou-test-edge_bannou-redis-data"      Created                                                                                                                            0.0s
 âœ” Volume "bannou-test-edge_account-data"           Created                                                                                                                            0.0s
 âœ” Volume "bannou-test-edge_rabbitmq-data"          Created                                                                                                                            0.0s
 âœ” Volume "bannou-test-edge_auth-redis-data"        Created                                                                                                                            0.0s
 âœ” Container bannou-test-edge-auth-redis-1          Started                                                                                                                            0.4s
 âœ” Container bannou-test-edge-bannou-redis-1        Started                                                                                                                            0.6s
 âœ” Container bannou-test-edge-rabbitmq-1            Started                                                                                                                            0.5s
 âœ” Container bannou-test-edge-placement-1           Started                                                                                                                            0.5s
 âœ” Container bannou-test-edge-bannou-edge-tester-1  Started                                                                                                                            0.4s
 âœ” Container bannou-test-edge-openresty-1           Started                                                                                                                            0.7s
 âœ” Container bannou-test-edge-bannou-1              Started                                                                                                                            0.6s
 âœ” Container bannou-test-edge-account-db-1          Started                                                                                                                            0.3s
 âœ” Container bannou-test-edge-routing-redis-1       Started                                                                                                                            0.5s
 âœ” Container bannou-test-edge-bannou-dapr-1         Started                                                                                                                            0.6s
WARN[0000] The "SERVICE_DOMAIN" variable is not set. Defaulting to a blank string.
WARN[0000] The "SERVICE_DOMAIN" variable is not set. Defaulting to a blank string.
bannou-edge-tester-1  | â³ Waiting for services to become ready...
bannou-edge-tester-1  |    OpenResty health URL: http://openresty:80/health
bannou-edge-tester-1  |    Auth service health URL: http://openresty:80/auth/health
bannou-edge-tester-1  | â³ Connection failed (Connection refused (openresty:80)), retrying in 500ms...
bannou-edge-tester-1  | â³ Backend service not ready (BadGateway), retrying in 1000ms...
bannou-edge-tester-1  | â³ Backend service not ready (BadGateway), retrying in 2000ms...
bannou-edge-tester-1  | â³ Backend service not ready (BadGateway), retrying in 4000ms...
bannou-edge-tester-1  | â³ Backend service not ready (BadGateway), retrying in 5000ms...
bannou-edge-tester-1  | âœ… Basic services ready after 12.6s
bannou-edge-tester-1  | â³ Verifying Dapr sidecar readiness...
bannou-edge-tester-1  | âœ… Dapr sidecar ready after 13.1s (warmup returned OK)
bannou-edge-tester-1  | â³ Waiting for service permission registration to complete...
bannou-edge-tester-1  | âœ… Permission registration delay complete
bannou-edge-tester-1  | Attempting to log in.
bannou-edge-tester-1  | Credential login Uri: http://openresty/auth/login
bannou-edge-tester-1  | Server responded with: Unauthorized, Reason: Unauthorized
bannou-edge-tester-1  | Registration Uri: http://openresty/auth/register
bannou-edge-tester-1  | Registration successful.
bannou-edge-tester-1  | Parsing access token and refresh token from login result successful.
bannou-edge-tester-1  |
bannou-edge-tester-1  | === Admin Authentication ===
bannou-edge-tester-1  | Attempting to log in with admin credentials...
bannou-edge-tester-1  | Admin credential login Uri: http://openresty/auth/login
bannou-edge-tester-1  | Admin login responded with: Unauthorized, Reason: Unauthorized
bannou-edge-tester-1  | Admin login failed, attempting registration...
bannou-edge-tester-1  | Admin registration Uri: http://openresty/auth/register
bannou-edge-tester-1  | Admin registration successful.
bannou-edge-tester-1  | âœ… Admin authenticated as: admin@admin.test.local
bannou-edge-tester-1  |
bannou-edge-tester-1  | ğŸ§ª Enhanced WebSocket Protocol Testing - Binary Protocol Validation
bannou-edge-tester-1  | Base URL: ws://openresty:80/connect
bannou-edge-tester-1  |
bannou-edge-tester-1  | âœ… Connected to the server
bannou-edge-tester-1  | ğŸ“¤ Sending binary message (31-byte header + 52 bytes payload)
bannou-edge-tester-1  |    Flags: None
bannou-edge-tester-1  |    Channel: 1
bannou-edge-tester-1  |    SequenceNumber: 1
bannou-edge-tester-1  |    ServiceGuid: 89d89950-1752-4361-8a39-5183cf254869
bannou-edge-tester-1  |    MessageId: 115648311368432312
bannou-edge-tester-1  | âœ… Binary protocol message sent successfully
bannou-edge-tester-1  | ğŸ“¥ Received 169 bytes
bannou-edge-tester-1  | âœ… Successfully parsed binary protocol response:
bannou-edge-tester-1  |    Flags: Event
bannou-edge-tester-1  |    Channel: 0
bannou-edge-tester-1  |    SequenceNumber: 0
bannou-edge-tester-1  |    ServiceGuid: 00000000-0000-0000-0000-000000000000
bannou-edge-tester-1  |    MessageId: 115648311369737758
bannou-edge-tester-1  |    Payload: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653188623}
bannou-edge-tester-1  | âœ… Basic WebSocket connectivity test PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | ğŸ”„ Running full edge test suite in daemon mode...
bannou-edge-tester-1  |    Total tests registered: 17
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Auth - Registration Flow
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Registration Flow Test ===
bannou-edge-tester-1  | Testing user registration through OpenResty gateway...
bannou-edge-tester-1  | ğŸ“¡ Testing registration at: http://openresty:80/auth/register
bannou-edge-tester-1  | ğŸ“¥ Response: OK
bannou-edge-tester-1  |    Body: {"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZXNzaW9uX2tleSI6IjEwYTJmYTkzNzQzZjRhNWRhNzM3NDk1MmI5OWFlNGNmIiwibmFtZWlkIjoiZmFmMWViNTktMTQ1Ny00NTgzLTkwN2YtNzdmZmI1MDdkMTA1Iiwic3ViIjoiZmFmMWViNTktMTQ1Ny00NTgzLTkwN2YtNzdmZmI1MDdkMTA1IiwianRpIjoiODQyMmNhOGUtMTFlOC00NDExLThjZjgtNzg2OGZlY2JkZjRhIiwiaWF0IjoxNzY0NjUzMTg4LCJuYmYiOjE3NjQ2NTMxODgsImV4cCI6MTc2NDY1Njc4OCwiaXNzIjoiYmFubm91LWF1dGgtY2kiLCJhdWQiOiJiYW5ub3UtYXBpLWNpIn0._2b_9N3pvmo26z8AzNFPnBofM5u6bRlG1rHbyW5lebg","refreshToken":"65ae77
bannou-edge-tester-1  | âœ… Registration returned valid tokens for regtest_d2c1b9bcf4924281@test.local
bannou-edge-tester-1  | âœ… Registration flow test PASSED
bannou-edge-tester-1  | âœ… Test Auth - Registration Flow PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Auth - Login with Credentials
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Login with Credentials Test ===
bannou-edge-tester-1  | Testing login with email/password returns valid tokens...
bannou-edge-tester-1  | ğŸ“¡ Testing login at: http://openresty:80/auth/login
bannou-edge-tester-1  | ğŸ“¥ Response: OK
bannou-edge-tester-1  | âœ… Login returned valid JWT tokens
bannou-edge-tester-1  | âœ… Login with credentials test PASSED
bannou-edge-tester-1  | âœ… Test Auth - Login with Credentials PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Auth - Token Refresh
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Token Refresh Test ===
bannou-edge-tester-1  | Testing refresh token can obtain new access token...
bannou-edge-tester-1  | ğŸ“¡ Testing token refresh at: http://openresty:80/auth/refresh
bannou-edge-tester-1  | ğŸ“¥ Response: OK
bannou-edge-tester-1  | âœ… Token refresh returned new access token
bannou-edge-tester-1  | âœ… Token refresh test PASSED
bannou-edge-tester-1  | âœ… Test Auth - Token Refresh PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Auth - Invalid Credentials
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Invalid Credentials Test ===
bannou-edge-tester-1  | Testing login with invalid credentials returns proper error...
bannou-edge-tester-1  | ğŸ“¡ Testing invalid login at: http://openresty:80/auth/login
bannou-edge-tester-1  | ğŸ“¥ Response: Unauthorized
bannou-edge-tester-1  | âœ… Invalid credentials correctly rejected with Unauthorized
bannou-edge-tester-1  | âœ… Invalid credentials test PASSED
bannou-edge-tester-1  | âœ… Test Auth - Invalid Credentials PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: WebSocket - Upgrade
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === WebSocket Upgrade Test ===
bannou-edge-tester-1  | Testing WebSocket connection upgrade with JWT authentication...
bannou-edge-tester-1  | ğŸ“¡ Connecting to WebSocket: ws://openresty/connect
bannou-edge-tester-1  | âœ… WebSocket connection established successfully
bannou-edge-tester-1  | âœ… WebSocket is in Open state
bannou-edge-tester-1  | âœ… WebSocket upgrade test PASSED
bannou-edge-tester-1  | âœ… Test WebSocket - Upgrade PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: WebSocket - Binary Protocol
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Binary Protocol Echo Test ===
bannou-edge-tester-1  | Testing binary protocol message sending and receiving...
bannou-edge-tester-1  | âœ… WebSocket connected for binary protocol test
bannou-edge-tester-1  | ğŸ“¤ Sending binary message:
bannou-edge-tester-1  |    Flags: None
bannou-edge-tester-1  |    Channel: 1
bannou-edge-tester-1  |    Sequence: 1
bannou-edge-tester-1  |    Service GUID: 1aa59c00-9731-40ea-835f-445682365cc0
bannou-edge-tester-1  |    Message ID: 115648311423255390
bannou-edge-tester-1  |    Payload size: 80 bytes
bannou-edge-tester-1  | âœ… Binary message sent successfully
bannou-edge-tester-1  | ğŸ“¥ Received 169 bytes
bannou-edge-tester-1  | âœ… Successfully parsed binary protocol response:
bannou-edge-tester-1  |    Flags: Event
bannou-edge-tester-1  |    Channel: 0
bannou-edge-tester-1  |    Sequence: 0
bannou-edge-tester-1  |    Service GUID: 00000000-0000-0000-0000-000000000000
bannou-edge-tester-1  |    Message ID: 115648311421763758
bannou-edge-tester-1  |    Payload: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653189419}
bannou-edge-tester-1  | âœ… Binary protocol echo test PASSED
bannou-edge-tester-1  | âœ… Test WebSocket - Binary Protocol PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: WebSocket - Service Discovery
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Service Discovery Test ===
bannou-edge-tester-1  | Testing API discovery through WebSocket binary protocol...
bannou-edge-tester-1  | âœ… WebSocket connected for service discovery test
bannou-edge-tester-1  | ğŸ“¤ Sending service discovery request:
bannou-edge-tester-1  |    Request: {"action":"discover_apis","sessionId":"test-session-afc4d067"}
bannou-edge-tester-1  | ğŸ“¥ Received service discovery response: 169 bytes
bannou-edge-tester-1  | âœ… Service discovery response: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653189458}
bannou-edge-tester-1  | âœ… Service discovery response is valid JSON
bannou-edge-tester-1  | âœ… Service discovery test PASSED
bannou-edge-tester-1  | âœ… Test WebSocket - Service Discovery PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: WebSocket - Internal API Proxy
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Internal API Proxy Test ===
bannou-edge-tester-1  | Testing internal API proxying through WebSocket binary protocol...
bannou-edge-tester-1  | âœ… WebSocket connected for internal API proxy test
bannou-edge-tester-1  | ğŸ“¤ Sending internal API proxy request:
bannou-edge-tester-1  |    Method: GET
bannou-edge-tester-1  |    Path: /connect/service-mappings
bannou-edge-tester-1  | ğŸ“¥ Received API proxy response: 169 bytes
bannou-edge-tester-1  | âœ… API proxy response: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653189478}
bannou-edge-tester-1  | âœ… API proxy response is valid JSON
bannou-edge-tester-1  | âœ… Internal API proxy test PASSED
bannou-edge-tester-1  | âœ… Test WebSocket - Internal API Proxy PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Capability - Session Init
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Capability Session Initialization Test ===
bannou-edge-tester-1  | Testing that WebSocket connection initializes session capabilities...
bannou-edge-tester-1  | âœ… WebSocket connected
bannou-edge-tester-1  | ğŸ“¤ Sending capability discovery request...
bannou-edge-tester-1  | ğŸ“¥ Received 169 bytes
bannou-edge-tester-1  |    Response payload: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653189495}
bannou-edge-tester-1  | âœ… WebSocket connection established (capability initialization triggered server-side)
bannou-edge-tester-1  | âœ… Capability session initialization test PASSED
bannou-edge-tester-1  | âœ… Test Capability - Session Init PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Capability - Unique GUIDs
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Unique GUID Per Session Test ===
bannou-edge-tester-1  | Testing that different sessions receive unique GUIDs...
bannou-edge-tester-1  | ğŸ“¡ Establishing first WebSocket session...
bannou-edge-tester-1  | âœ… First session connected
bannou-edge-tester-1  | ğŸ“¡ Establishing second WebSocket session...
bannou-edge-tester-1  | âœ… Second session connected
bannou-edge-tester-1  | âœ… Both sessions established independently
bannou-edge-tester-1  |    Server assigns unique client-salted GUIDs to each session
bannou-edge-tester-1  | âœ… Unique GUID per session test PASSED
bannou-edge-tester-1  | âœ… Test Capability - Unique GUIDs PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Capability - Authenticated User
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Authenticated User Capabilities Test ===
bannou-edge-tester-1  | Testing that authenticated users receive role-based capabilities...
bannou-edge-tester-1  | ğŸ“¡ Connecting with authenticated user credentials...
bannou-edge-tester-1  | âœ… Authenticated WebSocket connection established
bannou-edge-tester-1  | ğŸ“¤ Sent authenticated test message
bannou-edge-tester-1  | ğŸ“¥ Received response: 169 bytes
bannou-edge-tester-1  |    Response: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653190031}
bannou-edge-tester-1  | âœ… Authenticated session established successfully
bannou-edge-tester-1  | âœ… Authenticated user capabilities test PASSED
bannou-edge-tester-1  | âœ… Test Capability - Authenticated User PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Capability - Discovery Request
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Capability Discovery Request Test ===
bannou-edge-tester-1  | Testing explicit capability discovery request via WebSocket...
bannou-edge-tester-1  | âœ… WebSocket connected for capability discovery test
bannou-edge-tester-1  | ğŸ“¤ Sending explicit API discovery request...
bannou-edge-tester-1  | ğŸ“¥ Received API discovery response: 169 bytes
bannou-edge-tester-1  |    Response preview: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653190052}
bannou-edge-tester-1  | âœ… Response is valid JSON
bannou-edge-tester-1  | âœ… Server responded to capability discovery request
bannou-edge-tester-1  | âœ… Capability discovery request test PASSED
bannou-edge-tester-1  | âœ… Test Capability - Discovery Request PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Capability - GUID Routing
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Service GUID Routing Test ===
bannou-edge-tester-1  | Testing that service requests with valid GUIDs are routed correctly...
bannou-edge-tester-1  | âœ… WebSocket connected for GUID routing test
bannou-edge-tester-1  | ğŸ“¤ Sending request with random GUID: 811be3c3-b6ff-4a25-80dc-08b7b9d62fab
bannou-edge-tester-1  | ğŸ“¥ Received routing response: 169 bytes
bannou-edge-tester-1  |    Response: {"type":"capability_manifest","sessionId":"79ce01ec-86ef-4774-a4eb-8357477ef7bd","availableAPIs":[],"version":1,"timestamp":1764653190065}
bannou-edge-tester-1  | âœ… Server processed the GUID-based request
bannou-edge-tester-1  | âœ… Service GUID routing test PASSED
bannou-edge-tester-1  | âœ… Test Capability - GUID Routing PASSED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Orchestrator - Infrastructure Health (WebSocket)
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Orchestrator Infrastructure Health Test (WebSocket) ===
bannou-edge-tester-1  | Testing /orchestrator/health/infrastructure via WebSocket binary protocol...
bannou-edge-tester-1  | ğŸ”‘ Using admin access token: eyJhbGciOiJIUzI1NiIs...
bannou-edge-tester-1  |    JWT payload: {"session_key":"f28d6f1581a5419eb43418c3a839f3dd","nameid":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","sub":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","jti":"39d367a5-37c8-4ba6-95d2-5c81797e3ee5","iat":1764653188,"nbf":1764653188,"exp":1764656788,"iss":"bannou-auth-ci","aud":"bannou-api-ci"}
bannou-edge-tester-1  | âœ… WebSocket connected for orchestrator API test
bannou-edge-tester-1  | ğŸ“¥ Waiting for capability manifest...
bannou-edge-tester-1  | ğŸ“¥ Received capability manifest: 3358 bytes (reason: initial)
bannou-edge-tester-1  |    Manifest preview: {"type":"capability_manifest","sessionId":"5e6cd023-d7e7-4073-aeab-322c1bbc9e6e","availableAPIs":[{"serviceGuid":"a8bc367e-d8c0-0e59-ad83-abb7e8729222","serviceName":"orchestrator","method":"GET","path":"/orchestrator/health/infrastructure","endpointKey":"orchestrator:GET:/orchestrator/health/infras...
bannou-edge-tester-1  |    Available APIs: 16
bannou-edge-tester-1  |    âœ… Found API by exact match: GET:/orchestrator/health/infrastructure
bannou-edge-tester-1  | âœ… Found service GUID for GET:/orchestrator/health/infrastructure: a8bc367e-d8c0-0e59-ad83-abb7e8729222
bannou-edge-tester-1  | ğŸ“¤ Sending orchestrator API request:
bannou-edge-tester-1  |    Method: GET
bannou-edge-tester-1  |    Path: /orchestrator/health/infrastructure
bannou-edge-tester-1  |    ServiceGuid: a8bc367e-d8c0-0e59-ad83-abb7e8729222
bannou-edge-tester-1  | ğŸ“¥ Received API response: 50 bytes
bannou-edge-tester-1  |    Response payload: {"responseCode":60}...
bannou-edge-tester-1  | âŒ Orchestrator infrastructure health test FAILED
bannou-edge-tester-1  | âŒ Test Orchestrator - Infrastructure Health (WebSocket) FAILED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Orchestrator - Services Health (WebSocket)
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Orchestrator Services Health Test (WebSocket) ===
bannou-edge-tester-1  | Testing /orchestrator/health/services via WebSocket binary protocol...
bannou-edge-tester-1  | ğŸ”‘ Using admin access token: eyJhbGciOiJIUzI1NiIs...
bannou-edge-tester-1  |    JWT payload: {"session_key":"f28d6f1581a5419eb43418c3a839f3dd","nameid":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","sub":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","jti":"39d367a5-37c8-4ba6-95d2-5c81797e3ee5","iat":1764653188,"nbf":1764653188,"exp":1764656788,"iss":"bannou-auth-ci","aud":"bannou-api-ci"}
bannou-edge-tester-1  | âœ… WebSocket connected for orchestrator API test
bannou-edge-tester-1  | ğŸ“¥ Waiting for capability manifest...
bannou-edge-tester-1  | ğŸ“¥ Received capability manifest: 3358 bytes (reason: initial)
bannou-edge-tester-1  |    Manifest preview: {"type":"capability_manifest","sessionId":"5e6cd023-d7e7-4073-aeab-322c1bbc9e6e","availableAPIs":[{"serviceGuid":"a8bc367e-d8c0-0e59-ad83-abb7e8729222","serviceName":"orchestrator","method":"GET","path":"/orchestrator/health/infrastructure","endpointKey":"orchestrator:GET:/orchestrator/health/infras...
bannou-edge-tester-1  |    Available APIs: 16
bannou-edge-tester-1  |    âœ… Found API by exact match: GET:/orchestrator/health/services
bannou-edge-tester-1  | âœ… Found service GUID for GET:/orchestrator/health/services: 9857cdc6-9881-405b-b394-471c3e5c0257
bannou-edge-tester-1  | ğŸ“¤ Sending orchestrator API request:
bannou-edge-tester-1  |    Method: GET
bannou-edge-tester-1  |    Path: /orchestrator/health/services
bannou-edge-tester-1  |    ServiceGuid: 9857cdc6-9881-405b-b394-471c3e5c0257
bannou-edge-tester-1  | ğŸ“¥ Received API response: 50 bytes
bannou-edge-tester-1  |    Response payload: {"responseCode":60}...
bannou-edge-tester-1  | âŒ Orchestrator services health test FAILED
bannou-edge-tester-1  | âŒ Test Orchestrator - Services Health (WebSocket) FAILED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Orchestrator - Get Backends (WebSocket)
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Orchestrator Get Backends Test (WebSocket) ===
bannou-edge-tester-1  | Testing /orchestrator/backends via WebSocket binary protocol...
bannou-edge-tester-1  | ğŸ”‘ Using admin access token: eyJhbGciOiJIUzI1NiIs...
bannou-edge-tester-1  |    JWT payload: {"session_key":"f28d6f1581a5419eb43418c3a839f3dd","nameid":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","sub":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","jti":"39d367a5-37c8-4ba6-95d2-5c81797e3ee5","iat":1764653188,"nbf":1764653188,"exp":1764656788,"iss":"bannou-auth-ci","aud":"bannou-api-ci"}
bannou-edge-tester-1  | âœ… WebSocket connected for orchestrator API test
bannou-edge-tester-1  | ğŸ“¥ Waiting for capability manifest...
bannou-edge-tester-1  | ğŸ“¥ Received capability manifest: 3358 bytes (reason: initial)
bannou-edge-tester-1  |    Manifest preview: {"type":"capability_manifest","sessionId":"5e6cd023-d7e7-4073-aeab-322c1bbc9e6e","availableAPIs":[{"serviceGuid":"a8bc367e-d8c0-0e59-ad83-abb7e8729222","serviceName":"orchestrator","method":"GET","path":"/orchestrator/health/infrastructure","endpointKey":"orchestrator:GET:/orchestrator/health/infras...
bannou-edge-tester-1  |    Available APIs: 16
bannou-edge-tester-1  |    âœ… Found API by exact match: GET:/orchestrator/backends
bannou-edge-tester-1  | âœ… Found service GUID for GET:/orchestrator/backends: 03e0513e-b09d-2a51-91a7-7013f0b8caea
bannou-edge-tester-1  | ğŸ“¤ Sending orchestrator API request:
bannou-edge-tester-1  |    Method: GET
bannou-edge-tester-1  |    Path: /orchestrator/backends
bannou-edge-tester-1  |    ServiceGuid: 03e0513e-b09d-2a51-91a7-7013f0b8caea
bannou-edge-tester-1  | ğŸ“¥ Received API response: 50 bytes
bannou-edge-tester-1  |    Response payload: {"responseCode":60}...
bannou-edge-tester-1  | âŒ Orchestrator get backends test FAILED
bannou-edge-tester-1  | âŒ Test Orchestrator - Get Backends (WebSocket) FAILED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“‹ Running: Orchestrator - Get Status (WebSocket)
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | === Orchestrator Get Status Test (WebSocket) ===
bannou-edge-tester-1  | Testing /orchestrator/status via WebSocket binary protocol...
bannou-edge-tester-1  | ğŸ”‘ Using admin access token: eyJhbGciOiJIUzI1NiIs...
bannou-edge-tester-1  |    JWT payload: {"session_key":"f28d6f1581a5419eb43418c3a839f3dd","nameid":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","sub":"bcc0e781-1c45-46bb-9c63-505a5c1c64cc","jti":"39d367a5-37c8-4ba6-95d2-5c81797e3ee5","iat":1764653188,"nbf":1764653188,"exp":1764656788,"iss":"bannou-auth-ci","aud":"bannou-api-ci"}
bannou-edge-tester-1  | âœ… WebSocket connected for orchestrator API test
bannou-edge-tester-1  | ğŸ“¥ Waiting for capability manifest...
bannou-edge-tester-1  | ğŸ“¥ Received capability manifest: 3358 bytes (reason: initial)
bannou-edge-tester-1  |    Manifest preview: {"type":"capability_manifest","sessionId":"5e6cd023-d7e7-4073-aeab-322c1bbc9e6e","availableAPIs":[{"serviceGuid":"a8bc367e-d8c0-0e59-ad83-abb7e8729222","serviceName":"orchestrator","method":"GET","path":"/orchestrator/health/infrastructure","endpointKey":"orchestrator:GET:/orchestrator/health/infras...
bannou-edge-tester-1  |    Available APIs: 16
bannou-edge-tester-1  |    âœ… Found API by exact match: GET:/orchestrator/status
bannou-edge-tester-1  | âœ… Found service GUID for GET:/orchestrator/status: 0b1286dd-9dbc-665f-bbac-5a575ab40bbb
bannou-edge-tester-1  | ğŸ“¤ Sending orchestrator API request:
bannou-edge-tester-1  |    Method: GET
bannou-edge-tester-1  |    Path: /orchestrator/status
bannou-edge-tester-1  |    ServiceGuid: 0b1286dd-9dbc-665f-bbac-5a575ab40bbb
bannou-edge-tester-1  | ğŸ“¥ Received API response: 50 bytes
bannou-edge-tester-1  |    Response payload: {"responseCode":60}...
bannou-edge-tester-1  | âŒ Orchestrator get status test FAILED
bannou-edge-tester-1  | âŒ Test Orchestrator - Get Status (WebSocket) FAILED
bannou-edge-tester-1  |
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  | ğŸ“Š TEST SUMMARY
bannou-edge-tester-1  | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bannou-edge-tester-1  |    Total:  17
bannou-edge-tester-1  |    Passed: 13
bannou-edge-tester-1  |    Failed: 4
bannou-edge-tester-1  |
bannou-edge-tester-1  | âŒ Failed tests:
bannou-edge-tester-1  |    - Orchestrator - Infrastructure Health (WebSocket)
bannou-edge-tester-1  |    - Orchestrator - Services Health (WebSocket)
bannou-edge-tester-1  |    - Orchestrator - Get Backends (WebSocket)
bannou-edge-tester-1  |    - Orchestrator - Get Status (WebSocket)