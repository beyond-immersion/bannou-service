# Bannou Service Configuration Template
# Copy this file to .env and update with your actual values
# Uses canonical environment variable naming per Tenet 21:
#   - Service prefix: {SERVICE}_ (e.g., AUTH_, CONNECT_, ACCOUNTS_)
#   - Property names: UPPER_SNAKE_CASE that normalizes to PascalCase
#   - Example: AUTH_JWT_SECRET -> JwtSecret

# =============================================================================
# Database Configuration
# =============================================================================
ACCOUNT_DB_USER=your_db_user
ACCOUNT_DB_PASSWORD=your_db_password

# =============================================================================
# Auth Service Configuration (AUTH_*)
# =============================================================================
AUTH_JWT_SECRET=your-jwt-secret-key-change-in-production
AUTH_JWT_ISSUER=bannou-auth-dev
AUTH_JWT_AUDIENCE=bannou-api-dev
AUTH_JWT_EXPIRATION_MINUTES=60
AUTH_CONNECT_URL=ws://localhost:5014/connect

# OAuth Mock Providers (for development/testing)
AUTH_MOCK_PROVIDERS=false
AUTH_MOCK_STEAM_ID=76561198000000000
AUTH_MOCK_DISCORD_ID=123456789012345678
AUTH_MOCK_GOOGLE_ID=mock-google-user-id

# Discord OAuth Configuration
AUTH_DISCORD_CLIENT_ID=your-discord-client-id
AUTH_DISCORD_CLIENT_SECRET=your-discord-client-secret
AUTH_DISCORD_REDIRECT_URI=https://your-domain.com/auth/callback/discord

# Google OAuth Configuration
AUTH_GOOGLE_CLIENT_ID=your-google-client-id
AUTH_GOOGLE_CLIENT_SECRET=your-google-client-secret
AUTH_GOOGLE_REDIRECT_URI=https://your-domain.com/auth/callback/google

# Twitch OAuth Configuration
AUTH_TWITCH_CLIENT_ID=your-twitch-client-id
AUTH_TWITCH_CLIENT_SECRET=your-twitch-client-secret
AUTH_TWITCH_REDIRECT_URI=https://your-domain.com/auth/callback/twitch

# Steam Configuration
AUTH_STEAM_API_KEY=your-steam-api-key
AUTH_STEAM_APP_ID=your-steam-app-id

# Password Reset Configuration
AUTH_PASSWORD_RESET_TOKEN_TTL_MINUTES=30
AUTH_PASSWORD_RESET_BASE_URL=https://your-domain.com/reset-password

# =============================================================================
# Accounts Service Configuration (ACCOUNTS_*)
# =============================================================================
# Admin emails (comma-separated list for explicit admin accounts)
ACCOUNTS_ADMIN_EMAILS=admin@example.com
# Admin email domain (any email from this domain gets admin role)
ACCOUNTS_ADMIN_EMAIL_DOMAIN=@admin.example.com

# =============================================================================
# Connect Service Configuration (CONNECT_*)
# =============================================================================
CONNECT_MAX_CONCURRENT_CONNECTIONS=10000
CONNECT_CONNECTION_TIMEOUT_SECONDS=300
CONNECT_HEARTBEAT_INTERVAL_SECONDS=30
CONNECT_MESSAGE_QUEUE_SIZE=1000
CONNECT_BINARY_PROTOCOL_VERSION=2.0
CONNECT_BUFFER_SIZE=65536
CONNECT_ENABLE_CLIENT_TO_CLIENT_ROUTING=true
CONNECT_MAX_MESSAGES_PER_MINUTE=1000
CONNECT_RATE_LIMIT_WINDOW_MINUTES=1
CONNECT_JWT_PUBLIC_KEY=
CONNECT_RABBIT_MQ_CONNECTION_STRING=amqp://guest:guest@rabbitmq:5672
CONNECT_SERVER_SALT=your-server-salt-for-guid-generation
CONNECT_CONNECT_URL=ws://localhost:5014/connect

# =============================================================================
# Game Session Service Configuration (GAMESESSION_*)
# =============================================================================
GAMESESSION_ENABLED=true
GAMESESSION_SERVER_SALT=your-server-salt-for-session-guids
GAMESESSION_MAX_PLAYERS_PER_SESSION=16
GAMESESSION_DEFAULT_SESSION_TIMEOUT_SECONDS=7200

# =============================================================================
# Orchestrator Service Configuration (ORCHESTRATOR_*)
# =============================================================================
ORCHESTRATOR_ORCHESTRATOR_CACHE_TTL_MINUTES=5
ORCHESTRATOR_HEARTBEAT_TIMEOUT_SECONDS=90
ORCHESTRATOR_DEGRADATION_THRESHOLD_MINUTES=5
ORCHESTRATOR_PORTAINER_URL=
ORCHESTRATOR_PORTAINER_API_KEY=
ORCHESTRATOR_PORTAINER_ENDPOINT_ID=1
ORCHESTRATOR_DOCKER_HOST=unix:///var/run/docker.sock
ORCHESTRATOR_DOCKER_NETWORK=bannou_default
ORCHESTRATOR_DAPR_COMPONENTS_HOST_PATH=/app/provisioning/dapr/components
ORCHESTRATOR_DAPR_COMPONENTS_CONTAINER_PATH=/tmp/dapr-components
ORCHESTRATOR_DAPR_IMAGE=daprio/daprd:1.16.3
ORCHESTRATOR_PLACEMENT_HOST=placement:50006
ORCHESTRATOR_CERTIFICATES_HOST_PATH=/app/provisioning/certificates
ORCHESTRATOR_PRESETS_HOST_PATH=/app/provisioning/orchestrator/presets
ORCHESTRATOR_LOGS_VOLUME_NAME=logs-data
ORCHESTRATOR_KUBERNETES_NAMESPACE=default
ORCHESTRATOR_REDIS_CONNECTION_STRING=bannou-redis:6379
ORCHESTRATOR_RABBITMQ_CONNECTION_STRING=amqp://guest:guest@rabbitmq:5672

# =============================================================================
# State Service Configuration (STATE_*)
# =============================================================================
STATE_REDIS_CONNECTION_STRING=bannou-redis:6379
STATE_MY_SQL_CONNECTION_STRING=Server=account-db;Port=3306;Database=bannou_state;User=guest;Password=guest;
STATE_DEFAULT_CONSISTENCY=strong
STATE_ENABLE_METRICS=true
STATE_ENABLE_TRACING=true

# =============================================================================
# Mesh Service Configuration (MESH_*)
# =============================================================================
MESH_REDIS_CONNECTION_STRING=bannou-redis:6379
MESH_REDIS_KEY_PREFIX=mesh:
MESH_HEARTBEAT_INTERVAL_SECONDS=30
MESH_ENDPOINT_TTL_SECONDS=90
MESH_DEGRADATION_THRESHOLD_SECONDS=60
MESH_DEFAULT_LOAD_BALANCER=RoundRobin
MESH_LOAD_THRESHOLD_PERCENT=80
MESH_DEFAULT_APP_ID=bannou
MESH_ENABLE_SERVICE_MAPPING_SYNC=true
MESH_HEALTH_CHECK_ENABLED=false
MESH_HEALTH_CHECK_INTERVAL_SECONDS=60
MESH_HEALTH_CHECK_TIMEOUT_SECONDS=5
MESH_CIRCUIT_BREAKER_ENABLED=true
MESH_CIRCUIT_BREAKER_THRESHOLD=5
MESH_CIRCUIT_BREAKER_RESET_SECONDS=30
MESH_MAX_RETRIES=3
MESH_RETRY_DELAY_MILLISECONDS=100
MESH_ENABLE_DETAILED_LOGGING=false
MESH_METRICS_ENABLED=true

# =============================================================================
# Messaging Service Configuration (MESSAGING_*)
# =============================================================================
MESSAGING_RABBIT_MQHOST=rabbitmq
MESSAGING_RABBIT_MQPORT=5672
MESSAGING_RABBIT_MQUSERNAME=guest
MESSAGING_RABBIT_MQPASSWORD=guest
MESSAGING_RABBIT_MQVIRTUAL_HOST=/
MESSAGING_DEFAULT_EXCHANGE=bannou
MESSAGING_ENABLE_PUBLISHER_CONFIRMS=true
MESSAGING_CONNECTION_RETRY_COUNT=5
MESSAGING_CONNECTION_RETRY_DELAY_MS=1000
MESSAGING_DEFAULT_PREFETCH_COUNT=10
MESSAGING_DEFAULT_AUTO_ACK=false
MESSAGING_DEAD_LETTER_EXCHANGE=bannou-dlx
MESSAGING_RETRY_MAX_ATTEMPTS=3
MESSAGING_RETRY_DELAY_MS=5000
MESSAGING_USE_MASS_TRANSIT=true
MESSAGING_ENABLE_METRICS=true
MESSAGING_ENABLE_TRACING=true

# =============================================================================
# Asset Service Configuration (ASSET_*)
# =============================================================================
ASSET_STORAGE_PROVIDER=minio
ASSET_STORAGE_BUCKET=bannou-assets
ASSET_STORAGE_ENDPOINT=http://minio:9000
ASSET_STORAGE_ACCESS_KEY=minioadmin
ASSET_STORAGE_SECRET_KEY=minioadmin
ASSET_STORAGE_REGION=us-east-1
ASSET_STORAGE_FORCE_PATH_STYLE=true
ASSET_STORAGE_USE_SSL=false
ASSET_TOKEN_TTL_SECONDS=3600
ASSET_DOWNLOAD_TOKEN_TTL_SECONDS=900
ASSET_MAX_UPLOAD_SIZE_MB=500
ASSET_MULTIPART_THRESHOLD_MB=50
ASSET_MULTIPART_PART_SIZE_MB=16
ASSET_LARGE_FILE_THRESHOLD_MB=50
ASSET_PROCESSING_POOL_TYPE=asset-processor
ASSET_PROCESSING_MODE=both
ASSET_WORKER_POOL=
ASSET_BUNDLE_COMPRESSION_DEFAULT=lz4
ASSET_ZIP_CACHE_TTL_HOURS=24
ASSET_MINIO_WEBHOOK_SECRET=

# =============================================================================
# Voice Service Configuration (VOICE_*)
# =============================================================================
VOICE_SCALED_TIER_ENABLED=false
VOICE_TIER_UPGRADE_ENABLED=false
VOICE_TIER_UPGRADE_MIGRATION_DEADLINE_MS=30000
VOICE_P2P_MAX_PARTICIPANTS=8
VOICE_SCALED_MAX_PARTICIPANTS=100
VOICE_STUN_SERVERS=stun:stun.l.google.com:19302
VOICE_SIP_PASSWORD_SALT=
VOICE_SIP_DOMAIN=voice.bannou.local
VOICE_KAMAILIO_HOST=localhost
VOICE_KAMAILIO_RPC_PORT=5080
VOICE_RTP_ENGINE_HOST=localhost
VOICE_RTP_ENGINE_PORT=22222

# =============================================================================
# Character Service Configuration (CHARACTER_*)
# =============================================================================
CHARACTER_MAX_PAGE_SIZE=100
CHARACTER_DEFAULT_PAGE_SIZE=20
CHARACTER_CHARACTER_RETENTION_DAYS=90

# =============================================================================
# Documentation Service Configuration (DOCUMENTATION_*)
# =============================================================================
DOCUMENTATION_SEARCH_INDEX_REBUILD_ON_STARTUP=true
DOCUMENTATION_SESSION_TTL_SECONDS=86400
DOCUMENTATION_MAX_CONTENT_SIZE_BYTES=524288
DOCUMENTATION_TRASHCAN_TTL_DAYS=7
DOCUMENTATION_VOICE_SUMMARY_MAX_LENGTH=200
DOCUMENTATION_SEARCH_CACHE_TTL_SECONDS=300
DOCUMENTATION_MIN_RELEVANCE_SCORE=0.3
DOCUMENTATION_MAX_SEARCH_RESULTS=20
DOCUMENTATION_MAX_IMPORT_DOCUMENTS=0
DOCUMENTATION_AI_ENHANCEMENTS_ENABLED=false
DOCUMENTATION_AI_EMBEDDINGS_MODEL=

# =============================================================================
# ServiceData Service Configuration (SERVICEDATA_*)
# =============================================================================
SERVICEDATA_STATE_STORE_NAME=servicedata-statestore

# =============================================================================
# Subscriptions Service Configuration (SUBSCRIPTIONS_*)
# =============================================================================
SUBSCRIPTIONS_STATE_STORE_NAME=subscriptions-statestore
SUBSCRIPTIONS_AUTHORIZATION_SUFFIX=authorized

# =============================================================================
# Simple Enable/Disable Services (ENABLED property only)
# =============================================================================
BEHAVIOR_ENABLED=true
PERMISSIONS_ENABLED=true
REALM_ENABLED=true
LOCATION_ENABLED=true
SPECIES_ENABLED=true
RELATIONSHIP_ENABLED=true
RELATIONSHIPTYPE_ENABLED=true
WEBSITE_ENABLED=true

# =============================================================================
# Service Domain
# =============================================================================
SERVICE_DOMAIN=localhost

# =============================================================================
# Service Enable/Disable Flags (Loading Control)
# These control which services are loaded at startup, not configuration properties
# =============================================================================
SERVICES_ENABLED=true
AUTH_SERVICE_ENABLED=true
ACCOUNTS_SERVICE_ENABLED=true
PERMISSIONS_SERVICE_ENABLED=true
CONNECT_SERVICE_ENABLED=true
ORCHESTRATOR_SERVICE_ENABLED=true
BEHAVIOR_SERVICE_ENABLED=true
# Add _SERVICE_DISABLED=true to explicitly disable a service

# =============================================================================
# Local Development Port Configuration
# =============================================================================
HTTP_Web_Host_Port=8080
HTTPS_Web_Host_Port=8443
BANNOU_HTTP_Web_Host_Port=8080
BANNOU_HTTPS_Web_Host_Port=8443

# =============================================================================
# Main App JWT Validation Configuration (BANNOU_*)
# These must match AUTH_ JWT settings for token validation to work.
# REQUIRED - application will fail to start if BANNOU_JWTSECRET is not set.
# =============================================================================
BANNOU_JWTSECRET=your-jwt-secret-key-change-in-production
BANNOU_JWTISSUER=bannou-auth-dev
BANNOU_JWTAUDIENCE=bannou-api-dev

# =============================================================================
# Logging Configuration
# =============================================================================
BANNOU_App_Logging_Level=Information

# =============================================================================
# Infrastructure Backend Configuration
# =============================================================================
BANNOU_MESSAGING_BACKEND=dapr
BANNOU_STATE_BACKEND=dapr
BANNOU_DAPR_ENABLED=true
DAPR_APP_ID=bannou
ASPNETCORE_ENVIRONMENT=Development

# =============================================================================
# Heartbeat Configuration
# =============================================================================
HEARTBEAT_INTERVAL_SECONDS=30
HEARTBEAT_ENABLED=true
PERMISSION_HEARTBEAT_ENABLED=true
