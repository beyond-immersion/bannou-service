apiVersion: dapr.io/v1alpha1
kind: Component
metadata:
  name: asset-statestore
spec:
  type: state.redis
  version: v1
  metadata:
    # Use Redis Stack instance with RediSearch support
    - name: redisHost
      value: "asset-redis:6379"
    - name: redisPassword
      value: ""
    - name: actorStateStore
      value: "false"
    - name: ttlInSeconds
      value: "0"
    # Query indexes for efficient asset search via QueryStateAsync
    # Requires Redis Stack (RediSearch + RedisJSON modules)
    - name: queryIndexes
      value: |
        [
          {
            "name": "assetMetadataIndex",
            "indexes": [
              {"key": "asset_type", "type": "TEXT"},
              {"key": "realm", "type": "TEXT"},
              {"key": "content_type", "type": "TEXT"},
              {"key": "is_archived", "type": "TEXT"},
              {"key": "processing_status", "type": "TEXT"},
              {"key": "created_at", "type": "TEXT"}
            ]
          }
        ]
