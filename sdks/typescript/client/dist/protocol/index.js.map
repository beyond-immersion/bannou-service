{"version":3,"sources":["../../src/protocol/MessageFlags.ts","../../src/protocol/ResponseCodes.ts","../../src/protocol/NetworkByteOrder.ts","../../src/protocol/BinaryMessage.ts"],"names":["isResponse","isSuccess","isError","isMeta"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Bit flags controlling message behavior in the enhanced 31-byte binary protocol.\n * These flags provide zero-copy routing and performance optimizations.\n *\n * Flags can be combined using bitwise OR operations.\n *\n * @example\n * ```typescript\n * const flags = MessageFlags.Binary | MessageFlags.HighPriority;\n * ```\n */\nexport const MessageFlags = {\n  /**\n   * Default - JSON text, service request, unencrypted, standard priority, expects response\n   */\n  None: 0x00,\n\n  /**\n   * Message payload is binary data (not JSON)\n   */\n  Binary: 0x01,\n\n  /**\n   * Message payload is encrypted\n   */\n  Encrypted: 0x02,\n\n  /**\n   * Message payload is compressed (gzip)\n   */\n  Compressed: 0x04,\n\n  /**\n   * Deliver at high priority, skip to front of queues\n   */\n  HighPriority: 0x08,\n\n  /**\n   * Fire-and-forget message, no response expected\n   */\n  Event: 0x10,\n\n  /**\n   * Route to another WebSocket client (not a Bannou service)\n   */\n  Client: 0x20,\n\n  /**\n   * Message is a response to an RPC (not a new request)\n   */\n  Response: 0x40,\n\n  /**\n   * Request metadata about endpoint instead of executing it.\n   * When set, the Channel field specifies the meta type:\n   * 0 = endpoint-info, 1 = request-schema, 2 = response-schema, 3 = full-schema.\n   * Connect service transforms the path and routes to companion endpoints.\n   */\n  Meta: 0x80,\n} as const;\n\nexport type MessageFlagsType = (typeof MessageFlags)[keyof typeof MessageFlags];\n\n/**\n * Check if a flags byte has a specific flag set.\n */\nexport function hasFlag(flags: number, flag: number): boolean {\n  return (flags & flag) === flag;\n}\n\n/**\n * Check if this is a response message.\n */\nexport function isResponse(flags: number): boolean {\n  return hasFlag(flags, MessageFlags.Response);\n}\n\n/**\n * Check if this is an event message (fire-and-forget).\n */\nexport function isEvent(flags: number): boolean {\n  return hasFlag(flags, MessageFlags.Event);\n}\n\n/**\n * Check if this is a meta request.\n */\nexport function isMeta(flags: number): boolean {\n  return hasFlag(flags, MessageFlags.Meta);\n}\n\n/**\n * Check if payload is binary (not JSON).\n */\nexport function isBinary(flags: number): boolean {\n  return hasFlag(flags, MessageFlags.Binary);\n}\n","/**\n * Response codes used in the binary WebSocket protocol for success/error indication.\n * These codes are returned in the response header's ResponseCode field.\n *\n * Code ranges:\n * - 0-49: Protocol-level errors (Connect service)\n * - 50-69: Service-level errors (downstream service responses)\n * - 70+: Shortcut-specific errors\n */\nexport const ResponseCodes = {\n  /** Request completed successfully. */\n  OK: 0,\n\n  /** Generic request error (malformed message, invalid format). */\n  RequestError: 10,\n\n  /** Request payload exceeds maximum allowed size. */\n  RequestTooLarge: 11,\n\n  /** Rate limit exceeded for this client/session. */\n  TooManyRequests: 12,\n\n  /** Invalid channel number in request header. */\n  InvalidRequestChannel: 13,\n\n  /** Authentication required but not provided or invalid. */\n  Unauthorized: 20,\n\n  /** Target service GUID not found in capability manifest. */\n  ServiceNotFound: 30,\n\n  /** Target client GUID not found (for client-to-client messages). */\n  ClientNotFound: 31,\n\n  /** Referenced message ID not found. */\n  MessageNotFound: 32,\n\n  /** Broadcast not allowed in this connection mode (External mode blocks broadcast). */\n  BroadcastNotAllowed: 40,\n\n  /** Service returned 400 Bad Request. */\n  Service_BadRequest: 50,\n\n  /** Service returned 404 Not Found. */\n  Service_NotFound: 51,\n\n  /** Service returned 401/403 Unauthorized/Forbidden. */\n  Service_Unauthorized: 52,\n\n  /** Service returned 409 Conflict. */\n  Service_Conflict: 53,\n\n  /** Service returned 500 Internal Server Error. */\n  Service_InternalServerError: 60,\n\n  /** Shortcut has expired and is no longer valid. */\n  ShortcutExpired: 70,\n\n  /** Shortcut target endpoint no longer exists. */\n  ShortcutTargetNotFound: 71,\n\n  /** Shortcut was explicitly revoked. */\n  ShortcutRevoked: 72,\n} as const;\n\nexport type ResponseCodesType = (typeof ResponseCodes)[keyof typeof ResponseCodes];\n\n/**\n * Maps protocol response codes to HTTP status codes.\n * This hides the binary protocol implementation details from client code.\n */\nexport function mapToHttpStatus(code: number): number {\n  switch (code) {\n    case ResponseCodes.OK:\n      return 200;\n    case ResponseCodes.RequestError:\n    case ResponseCodes.RequestTooLarge:\n    case ResponseCodes.InvalidRequestChannel:\n    case ResponseCodes.Service_BadRequest:\n      return 400;\n    case ResponseCodes.Unauthorized:\n    case ResponseCodes.Service_Unauthorized:\n      return 401;\n    case ResponseCodes.TooManyRequests:\n      return 429;\n    case ResponseCodes.ServiceNotFound:\n    case ResponseCodes.ClientNotFound:\n    case ResponseCodes.MessageNotFound:\n    case ResponseCodes.Service_NotFound:\n    case ResponseCodes.ShortcutTargetNotFound:\n      return 404;\n    case ResponseCodes.Service_Conflict:\n      return 409;\n    case ResponseCodes.BroadcastNotAllowed:\n      return 403;\n    case ResponseCodes.ShortcutExpired:\n    case ResponseCodes.ShortcutRevoked:\n      return 410; // Gone\n    case ResponseCodes.Service_InternalServerError:\n    default:\n      return 500;\n  }\n}\n\n/**\n * Gets a human-readable error name for a response code.\n */\nexport function getResponseCodeName(code: number): string {\n  const entries = Object.entries(ResponseCodes);\n  for (const [name, value] of entries) {\n    if (value === code) {\n      return name;\n    }\n  }\n  return 'UnknownError';\n}\n\n/**\n * Check if a response code indicates success.\n */\nexport function isSuccess(code: number): boolean {\n  return code === ResponseCodes.OK;\n}\n\n/**\n * Check if a response code indicates an error.\n */\nexport function isError(code: number): boolean {\n  return code !== ResponseCodes.OK;\n}\n","/**\n * Network byte order utilities for cross-platform binary protocol compatibility.\n * Ensures consistent endianness across all client and server implementations.\n *\n * All multi-byte integers in the Bannou protocol use BIG-ENDIAN (network) byte order.\n * GUIDs follow RFC 4122 network byte ordering.\n */\n\n/**\n * Writes a 16-bit unsigned integer in network byte order (big-endian).\n */\nexport function writeUInt16(view: DataView, offset: number, value: number): void {\n  view.setUint16(offset, value, false); // false = big-endian\n}\n\n/**\n * Writes a 32-bit unsigned integer in network byte order (big-endian).\n */\nexport function writeUInt32(view: DataView, offset: number, value: number): void {\n  view.setUint32(offset, value, false); // false = big-endian\n}\n\n/**\n * Writes a 64-bit unsigned integer in network byte order (big-endian).\n * JavaScript's DataView doesn't have native BigInt support in all versions,\n * so we write it as two 32-bit values.\n */\nexport function writeUInt64(view: DataView, offset: number, value: bigint): void {\n  const high = Number(value >> 32n);\n  const low = Number(value & 0xffffffffn);\n  view.setUint32(offset, high, false); // High 32 bits first (big-endian)\n  view.setUint32(offset + 4, low, false); // Low 32 bits second\n}\n\n/**\n * Reads a 16-bit unsigned integer from network byte order (big-endian).\n */\nexport function readUInt16(view: DataView, offset: number): number {\n  return view.getUint16(offset, false); // false = big-endian\n}\n\n/**\n * Reads a 32-bit unsigned integer from network byte order (big-endian).\n */\nexport function readUInt32(view: DataView, offset: number): number {\n  return view.getUint32(offset, false); // false = big-endian\n}\n\n/**\n * Reads a 64-bit unsigned integer from network byte order (big-endian).\n */\nexport function readUInt64(view: DataView, offset: number): bigint {\n  const high = BigInt(view.getUint32(offset, false));\n  const low = BigInt(view.getUint32(offset + 4, false));\n  return (high << 32n) | low;\n}\n\n/**\n * Writes a GUID in consistent network byte order.\n * Uses RFC 4122 standard byte ordering for cross-platform compatibility.\n *\n * RFC 4122 specifies that the time fields (first 8 bytes) use network byte order.\n * .NET's Guid.ToByteArray() returns little-endian for time fields, so we need\n * to reverse bytes 0-3, 4-5, 6-7 when writing. Bytes 8-15 remain as-is.\n *\n * @param view - DataView to write to\n * @param offset - Byte offset to start writing\n * @param guid - GUID string in standard format (e.g., \"12345678-1234-5678-9abc-def012345678\")\n */\nexport function writeGuid(view: DataView, offset: number, guid: string): void {\n  // Parse GUID string (format: \"12345678-1234-5678-9abc-def012345678\")\n  const cleanGuid = guid.replace(/-/g, '');\n\n  if (cleanGuid.length !== 32) {\n    throw new Error(`Invalid GUID format: ${guid}`);\n  }\n\n  // Parse each hex pair as bytes\n  const bytes = new Uint8Array(16);\n  for (let i = 0; i < 16; i++) {\n    bytes[i] = parseInt(cleanGuid.slice(i * 2, i * 2 + 2), 16);\n  }\n\n  // RFC 4122 network byte order transformation:\n  // Time-low (4 bytes, indices 0-3) - reverse\n  view.setUint8(offset + 0, bytes[3]);\n  view.setUint8(offset + 1, bytes[2]);\n  view.setUint8(offset + 2, bytes[1]);\n  view.setUint8(offset + 3, bytes[0]);\n\n  // Time-mid (2 bytes, indices 4-5) - reverse\n  view.setUint8(offset + 4, bytes[5]);\n  view.setUint8(offset + 5, bytes[4]);\n\n  // Time-high-and-version (2 bytes, indices 6-7) - reverse\n  view.setUint8(offset + 6, bytes[7]);\n  view.setUint8(offset + 7, bytes[6]);\n\n  // Clock-seq-and-reserved + clock-seq-low + node (8 bytes, indices 8-15) - keep as-is\n  for (let i = 8; i < 16; i++) {\n    view.setUint8(offset + i, bytes[i]);\n  }\n}\n\n/**\n * Reads a GUID from consistent network byte order.\n * Uses RFC 4122 standard byte ordering for cross-platform compatibility.\n *\n * @param view - DataView to read from\n * @param offset - Byte offset to start reading\n * @returns GUID string in standard format (lowercase)\n */\nexport function readGuid(view: DataView, offset: number): string {\n  const bytes = new Uint8Array(16);\n\n  // Reverse the RFC 4122 transformation:\n  // Time-low (4 bytes) - reverse back\n  bytes[0] = view.getUint8(offset + 3);\n  bytes[1] = view.getUint8(offset + 2);\n  bytes[2] = view.getUint8(offset + 1);\n  bytes[3] = view.getUint8(offset + 0);\n\n  // Time-mid (2 bytes) - reverse back\n  bytes[4] = view.getUint8(offset + 5);\n  bytes[5] = view.getUint8(offset + 4);\n\n  // Time-high-and-version (2 bytes) - reverse back\n  bytes[6] = view.getUint8(offset + 7);\n  bytes[7] = view.getUint8(offset + 6);\n\n  // Clock-seq and node (8 bytes) - keep as-is\n  for (let i = 8; i < 16; i++) {\n    bytes[i] = view.getUint8(offset + i);\n  }\n\n  // Format as GUID string\n  const hex = Array.from(bytes)\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n\n  return (\n    `${hex.slice(0, 8)}-${hex.slice(8, 12)}-${hex.slice(12, 16)}-` +\n    `${hex.slice(16, 20)}-${hex.slice(20, 32)}`\n  );\n}\n\n/**\n * Generates an empty GUID (all zeros).\n */\nexport const EMPTY_GUID = '00000000-0000-0000-0000-000000000000';\n\n/**\n * Tests cross-platform compatibility of network byte order operations.\n * Useful for unit testing and validation.\n */\nexport function testNetworkByteOrderCompatibility(): boolean {\n  try {\n    const buffer = new ArrayBuffer(32);\n    const view = new DataView(buffer);\n\n    // Test all data types\n    writeUInt16(view, 0, 0x1234);\n    writeUInt32(view, 2, 0x12345678);\n    writeUInt64(view, 6, 0x123456789abcdef0n);\n\n    const testGuid = '12345678-1234-5678-9abc-def012345678';\n    writeGuid(view, 14, testGuid);\n\n    // Read back and verify\n    const readU16 = readUInt16(view, 0);\n    const readU32 = readUInt32(view, 2);\n    const readU64 = readUInt64(view, 6);\n    const readG = readGuid(view, 14);\n\n    return (\n      readU16 === 0x1234 &&\n      readU32 === 0x12345678 &&\n      readU64 === 0x123456789abcdef0n &&\n      readG === testGuid\n    );\n  } catch {\n    return false;\n  }\n}\n","/**\n * Represents a complete binary message in the Bannou WebSocket protocol.\n * Request messages use a 31-byte header, response messages use a 16-byte header.\n * Provides zero-copy parsing and serialization for optimal performance.\n */\n\nimport { MessageFlags, hasFlag, isResponse as checkIsResponse } from './MessageFlags.js';\nimport {\n  readUInt16,\n  readUInt32,\n  readUInt64,\n  readGuid,\n  writeUInt16,\n  writeUInt32,\n  writeUInt64,\n  writeGuid,\n  EMPTY_GUID,\n} from './NetworkByteOrder.js';\n\n/**\n * Size of the binary header in bytes for request messages.\n *\n * Request header layout (31 bytes):\n * - [0]     Flags (1 byte)\n * - [1-2]   Channel (uint16 BE)\n * - [3-6]   Sequence (uint32 BE)\n * - [7-22]  ServiceGUID (16 bytes, RFC 4122)\n * - [23-30] MessageID (uint64 BE)\n * - [31+]   Payload (JSON UTF-8)\n */\nexport const HEADER_SIZE = 31;\n\n/**\n * Size of the binary header in bytes for response messages.\n * Response headers are smaller because ServiceGuid is not needed (client correlates via MessageId).\n *\n * Response header layout (16 bytes):\n * - [0]     Flags (1 byte, Response flag set)\n * - [1-2]   Channel (uint16 BE)\n * - [3-6]   Sequence (uint32 BE)\n * - [7-14]  MessageID (uint64 BE)\n * - [15]    ResponseCode (1 byte)\n * - [16+]   Payload (empty for errors)\n */\nexport const RESPONSE_HEADER_SIZE = 16;\n\n/**\n * Represents a parsed or constructed binary message.\n */\nexport interface BinaryMessage {\n  /** Message behavior flags */\n  flags: number;\n\n  /** Channel for sequential message processing (0-65535, 0 = default) */\n  channel: number;\n\n  /** Per-channel sequence number for message ordering */\n  sequenceNumber: number;\n\n  /** Client-salted service GUID for routing (only used in request messages) */\n  serviceGuid: string;\n\n  /** Unique message ID for request/response correlation */\n  messageId: bigint;\n\n  /** Response code for response messages (0 = OK, non-zero = error) */\n  responseCode: number;\n\n  /** Message payload (JSON or binary data based on flags) */\n  payload: Uint8Array;\n}\n\n/**\n * Creates a request message.\n */\nexport function createRequest(\n  flags: number,\n  channel: number,\n  sequenceNumber: number,\n  serviceGuid: string,\n  messageId: bigint,\n  payload: Uint8Array\n): BinaryMessage {\n  return {\n    flags,\n    channel,\n    sequenceNumber,\n    serviceGuid,\n    messageId,\n    responseCode: 0,\n    payload,\n  };\n}\n\n/**\n * Creates a response message.\n */\nexport function createResponse(\n  flags: number,\n  channel: number,\n  sequenceNumber: number,\n  messageId: bigint,\n  responseCode: number,\n  payload: Uint8Array\n): BinaryMessage {\n  return {\n    flags: flags | MessageFlags.Response,\n    channel,\n    sequenceNumber,\n    serviceGuid: EMPTY_GUID,\n    messageId,\n    responseCode,\n    payload,\n  };\n}\n\n/**\n * Creates a binary message from a JSON string payload.\n */\nexport function fromJson(\n  channel: number,\n  sequenceNumber: number,\n  serviceGuid: string,\n  messageId: bigint,\n  jsonPayload: string,\n  additionalFlags: number = MessageFlags.None\n): BinaryMessage {\n  const payloadBytes = new TextEncoder().encode(jsonPayload);\n  return createRequest(\n    additionalFlags,\n    channel,\n    sequenceNumber,\n    serviceGuid,\n    messageId,\n    payloadBytes\n  );\n}\n\n/**\n * Gets the JSON payload as a string (if the message is JSON).\n * @throws Error if the message has the Binary flag set\n */\nexport function getJsonPayload(message: BinaryMessage): string {\n  if (hasFlag(message.flags, MessageFlags.Binary)) {\n    throw new Error('Cannot get JSON payload from binary message');\n  }\n  return new TextDecoder().decode(message.payload);\n}\n\n/**\n * Parses a binary message from a byte array.\n * Automatically detects whether this is a request (31-byte header) or response (16-byte header).\n */\nexport function parse(buffer: ArrayBuffer | Uint8Array): BinaryMessage {\n  const bytes = buffer instanceof Uint8Array ? buffer : new Uint8Array(buffer);\n  const view = new DataView(bytes.buffer, bytes.byteOffset, bytes.byteLength);\n\n  if (bytes.length < 1) {\n    throw new Error('Message too short. Expected at least 1 byte for flags.');\n  }\n\n  const flags = view.getUint8(0);\n\n  // Check if this is a response message (16-byte header) or request message (31-byte header)\n  if (checkIsResponse(flags)) {\n    return parseResponse(view, bytes);\n  } else {\n    return parseRequest(view, bytes);\n  }\n}\n\nfunction parseRequest(view: DataView, bytes: Uint8Array): BinaryMessage {\n  if (bytes.length < HEADER_SIZE) {\n    throw new Error(\n      `Request message too short. Expected at least ${HEADER_SIZE} bytes, got ${bytes.length}`\n    );\n  }\n\n  const flags = view.getUint8(0);\n  const channel = readUInt16(view, 1);\n  const sequenceNumber = readUInt32(view, 3);\n  const serviceGuid = readGuid(view, 7);\n  const messageId = readUInt64(view, 23);\n\n  // Extract payload (remaining bytes after 31-byte header)\n  const payload = bytes.slice(HEADER_SIZE);\n\n  return {\n    flags,\n    channel,\n    sequenceNumber,\n    serviceGuid,\n    messageId,\n    responseCode: 0,\n    payload,\n  };\n}\n\nfunction parseResponse(view: DataView, bytes: Uint8Array): BinaryMessage {\n  if (bytes.length < RESPONSE_HEADER_SIZE) {\n    throw new Error(\n      `Response message too short. Expected at least ` +\n        `${RESPONSE_HEADER_SIZE} bytes, got ${bytes.length}`,\n    );\n  }\n\n  const flags = view.getUint8(0);\n  const channel = readUInt16(view, 1);\n  const sequenceNumber = readUInt32(view, 3);\n  const messageId = readUInt64(view, 7);\n  const responseCode = view.getUint8(15);\n\n  // Extract payload (remaining bytes after 16-byte header)\n  const payload = bytes.slice(RESPONSE_HEADER_SIZE);\n\n  return {\n    flags,\n    channel,\n    sequenceNumber,\n    serviceGuid: EMPTY_GUID,\n    messageId,\n    responseCode,\n    payload,\n  };\n}\n\n/**\n * Serializes the binary message to a byte array.\n * Uses 31-byte header for requests, 16-byte header for responses.\n */\nexport function toByteArray(message: BinaryMessage): Uint8Array {\n  if (checkIsResponse(message.flags)) {\n    return toResponseByteArray(message);\n  } else {\n    return toRequestByteArray(message);\n  }\n}\n\nfunction toRequestByteArray(message: BinaryMessage): Uint8Array {\n  const totalLength = HEADER_SIZE + message.payload.length;\n  const result = new Uint8Array(totalLength);\n  const view = new DataView(result.buffer);\n\n  // Build 31-byte request header\n  view.setUint8(0, message.flags);\n  writeUInt16(view, 1, message.channel);\n  writeUInt32(view, 3, message.sequenceNumber);\n  writeGuid(view, 7, message.serviceGuid);\n  writeUInt64(view, 23, message.messageId);\n\n  // Append payload\n  if (message.payload.length > 0) {\n    result.set(message.payload, HEADER_SIZE);\n  }\n\n  return result;\n}\n\nfunction toResponseByteArray(message: BinaryMessage): Uint8Array {\n  const totalLength = RESPONSE_HEADER_SIZE + message.payload.length;\n  const result = new Uint8Array(totalLength);\n  const view = new DataView(result.buffer);\n\n  // Build 16-byte response header\n  view.setUint8(0, message.flags);\n  writeUInt16(view, 1, message.channel);\n  writeUInt32(view, 3, message.sequenceNumber);\n  writeUInt64(view, 7, message.messageId);\n  view.setUint8(15, message.responseCode);\n\n  // Append payload (empty for error responses)\n  if (message.payload.length > 0) {\n    result.set(message.payload, RESPONSE_HEADER_SIZE);\n  }\n\n  return result;\n}\n\n/**\n * Returns true if this message expects a response.\n */\nexport function expectsResponse(message: BinaryMessage): boolean {\n  return !hasFlag(message.flags, MessageFlags.Event) && !checkIsResponse(message.flags);\n}\n\n/**\n * Returns true if this message is a response to another message.\n */\nexport function isResponse(message: BinaryMessage): boolean {\n  return checkIsResponse(message.flags);\n}\n\n/**\n * Returns true if this message should be routed to a client (not a service).\n */\nexport function isClientRouted(message: BinaryMessage): boolean {\n  return hasFlag(message.flags, MessageFlags.Client);\n}\n\n/**\n * Returns true if this message has high priority.\n */\nexport function isHighPriority(message: BinaryMessage): boolean {\n  return hasFlag(message.flags, MessageFlags.HighPriority);\n}\n\n/**\n * Returns true if this is a successful response (ResponseCode is 0).\n */\nexport function isSuccess(message: BinaryMessage): boolean {\n  return checkIsResponse(message.flags) && message.responseCode === 0;\n}\n\n/**\n * Returns true if this is an error response (ResponseCode is non-zero).\n */\nexport function isError(message: BinaryMessage): boolean {\n  return checkIsResponse(message.flags) && message.responseCode !== 0;\n}\n\n/**\n * Returns true if this message requests endpoint metadata.\n */\nexport function isMeta(message: BinaryMessage): boolean {\n  return hasFlag(message.flags, MessageFlags.Meta);\n}\n"]}