// <auto-generated>
// This code was generated by generate-client-proxies.py
// Do not edit this file manually.
// </auto-generated>

#nullable enable

using BeyondImmersion.Bannou.Core;
using BeyondImmersion.BannouService.Messaging;

namespace BeyondImmersion.Bannou.Client.Proxies;

/// <summary>
/// Typed proxy for Bannou Messaging Service API API endpoints.
/// </summary>
public sealed class MessagingProxy
{
    private readonly IBannouClient _client;

    /// <summary>
    /// Creates a new MessagingProxy instance.
    /// </summary>
    /// <param name="client">The underlying Bannou client.</param>
    internal MessagingProxy(IBannouClient client)
    {
        _client = client ?? throw new ArgumentNullException(nameof(client));
    }

    /// <summary>
    /// Publish an event to a topic
    /// </summary>
    /// <param name="request">The request payload.</param>
    /// <param name="channel">Message channel for ordering (default 0).</param>
    /// <param name="timeout">Request timeout.</param>
    /// <param name="cancellationToken">Cancellation token.</param>
    /// <returns>ApiResponse containing PublishEventResponse on success.</returns>
    public Task<ApiResponse<PublishEventResponse>> PublishEventAsync(
        PublishEventRequest request,
        ushort channel = 0,
        TimeSpan? timeout = null,
        CancellationToken cancellationToken = default)
    {
        return _client.InvokeAsync<PublishEventRequest, PublishEventResponse>(
            "POST", "/messaging/publish", request, channel, timeout, cancellationToken);
    }

    /// <summary>
    /// Create a dynamic subscription to a topic
    /// </summary>
    /// <param name="request">The request payload.</param>
    /// <param name="channel">Message channel for ordering (default 0).</param>
    /// <param name="timeout">Request timeout.</param>
    /// <param name="cancellationToken">Cancellation token.</param>
    /// <returns>ApiResponse containing CreateSubscriptionResponse on success.</returns>
    public Task<ApiResponse<CreateSubscriptionResponse>> CreateSubscriptionAsync(
        CreateSubscriptionRequest request,
        ushort channel = 0,
        TimeSpan? timeout = null,
        CancellationToken cancellationToken = default)
    {
        return _client.InvokeAsync<CreateSubscriptionRequest, CreateSubscriptionResponse>(
            "POST", "/messaging/subscribe", request, channel, timeout, cancellationToken);
    }

    /// <summary>
    /// Remove a dynamic subscription
    /// </summary>
    /// <param name="request">The request payload.</param>
    /// <param name="channel">Message channel for ordering (default 0).</param>
    /// <param name="cancellationToken">Cancellation token.</param>
    /// <returns>Task that completes when the event is sent.</returns>
    public Task RemoveSubscriptionEventAsync(
        RemoveSubscriptionRequest request,
        ushort channel = 0,
        CancellationToken cancellationToken = default)
    {
        return _client.SendEventAsync<RemoveSubscriptionRequest>(
            "POST", "/messaging/unsubscribe", request, channel, cancellationToken);
    }

    /// <summary>
    /// List all known topics
    /// </summary>
    /// <param name="request">The request payload.</param>
    /// <param name="channel">Message channel for ordering (default 0).</param>
    /// <param name="timeout">Request timeout.</param>
    /// <param name="cancellationToken">Cancellation token.</param>
    /// <returns>ApiResponse containing ListTopicsResponse on success.</returns>
    public Task<ApiResponse<ListTopicsResponse>> ListTopicsAsync(
        ListTopicsRequest request,
        ushort channel = 0,
        TimeSpan? timeout = null,
        CancellationToken cancellationToken = default)
    {
        return _client.InvokeAsync<ListTopicsRequest, ListTopicsResponse>(
            "POST", "/messaging/list-topics", request, channel, timeout, cancellationToken);
    }
}
